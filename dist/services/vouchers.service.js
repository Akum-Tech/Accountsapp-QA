"use strict";var _journalVoucher2=_interopRequireDefault(require("../models/journalVoucher"));var _journalInteries=_interopRequireDefault(require("../models/journalInteries"));var _company=_interopRequireDefault(require("../models/company"));var _saleVoucher=_interopRequireDefault(require("../models/saleVoucher"));var _purchaseVoucher=_interopRequireDefault(require("../models/purchaseVoucher"));var _creditVoucher=_interopRequireDefault(require("../models/creditVoucher"));var _debitVoucher=_interopRequireDefault(require("../models/debitVoucher"));var _taxInteries=_interopRequireDefault(require("../models/taxInteries"));var _voucherInteries=_interopRequireDefault(require("../models/voucherInteries"));var _itemInteries=_interopRequireDefault(require("../models/itemInteries"));var _accountGroup=_interopRequireDefault(require("../models/accountGroup"));var _recieptVoucher=_interopRequireDefault(require("../models/recieptVoucher"));var _paymentVoucher=_interopRequireDefault(require("../models/paymentVoucher"));var _subAccountGroup=_interopRequireDefault(require("../models/subAccountGroup"));var _states=_interopRequireDefault(require("../models/states"));var _cities=_interopRequireDefault(require("../models/cities"));var _purpose=_interopRequireDefault(require("../models/purpose"));var _ledger=_interopRequireDefault(require("../models/ledger"));var _sequelize=_interopRequireWildcard(require("sequelize"));var _arraySort=_interopRequireDefault(require("array-sort"));var _database=require("../database/database");var _oldBalance=require("../utility/oldBalance");var _voucherReport=require("../security/voucherReport");var _ledger2=require("../security/ledger");var _salesvoucher=require("../security/salesvoucher");var _paymentvoucher=require("../security/paymentvoucher");var _purchasevoucher=require("../security/purchasevoucher");var _receiptvoucher=require("../security/receiptvoucher");var _creditvoucher=require("../security/creditvoucher");var _debitvoucher=require("../security/debitvoucher");var _journalvoucher=require("../security/journalvoucher");var _journalEntries=require("../security/journalEntries");var _itemEntries=require("../security/itemEntries");var _taxEntries=require("../security/taxEntries");var _voucherEntries=require("../security/voucherEntries");var _item_stock_voucher_entries=_interopRequireDefault(require("../models/item_stock_voucher_entries"));var _config=_interopRequireDefault(require("../constant/config"));var _manualClosingStock=require("../security/manualClosingStock");var _balanceGroup=_interopRequireDefault(require("../constant/balanceGroup"));var _accountData=require("../utility/accountData");require("@babel/polyfill");var _items=_interopRequireDefault(require("../models/items"));function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{"default":obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj["default"]=obj;if(cache){cache.set(obj,newObj);}return newObj;}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1;}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err;}finally{try{if(!_n&&null!=_i["return"]&&(_r=_i["return"](),Object(_r)!==_r))return;}finally{if(_d)throw _e;}}return _arr;}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2;}function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return exports;};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value;},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key];}try{define({},"");}catch(err){define=function define(obj,key,value){return obj[key]=value;};}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator;}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)};}catch(err){return{type:"throw",arg:err};}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this;});var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg);});});}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject);},function(err){invoke("throw",err,resolve,reject);}):PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result);},function(error){return invoke("throw",error,resolve,reject);});}reject(record.arg);}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject);});}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();}});}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult();}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult;}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg);}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done};}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg);}};}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(undefined===method)return context.delegate=null,"throw"===methodName&&delegate.iterator["return"]&&(context.method="return",context.arg=undefined,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel);}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry);}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record;}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0);}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=undefined,next.done=!0,next;};return next.next=next;}}return{next:doneResult};}function doneResult(){return{value:undefined,done:!0};}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name));},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun;},exports.awrap=function(arg){return{__await:arg};},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this;}),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next();});},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,function(){return this;}),define(Gp,"toString",function(){return"[object Generator]";}),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next;}return next.done=!0,next;};},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined);},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval;},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=undefined),!!caught;}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break;}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record);},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel;},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel;}},"catch":function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry);}return thrown;}}throw new Error("illegal catch attempt");},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=undefined),ContinueSentinel;}},exports;}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key);}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.");}return(hint==="string"?String:Number)(input);}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{Promise.resolve(value).then(_next,_throw);}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value);}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err);}_next(undefined);});};}var Op=_sequelize["default"].Op;function groupFuncation(_x){return _groupFuncation.apply(this,arguments);}function _groupFuncation(){_groupFuncation=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee12(array){return _regeneratorRuntime().wrap(function _callee12$(_context14){while(1)switch(_context14.prev=_context14.next){case 0:return _context14.abrupt("return",array.reduce(function(acc,obj){var key;if(obj.subAccount&&obj.subAccount.name){key=obj.subAccount.name;}else{key='MainGroup';}if(!acc[key]){acc[key]=[];}// Add object to list for given key's value
acc[key].push(obj);return acc;},{}));case 1:case"end":return _context14.stop();}},_callee12);}));return _groupFuncation.apply(this,arguments);}function checkValid(_x2){return _checkValid.apply(this,arguments);}// async function getopeingbalanceStockcalculation(data, res){
//     try {
//         let totalvalue = 0;
//         let getCompanydetail = await sequelize.query(
//             `SELECT * FROM companies WHERE uid='${data.company_id}'`, {
//                 type: sequelize.QueryTypes.SELECT
//             }
//         );
//         if (getCompanydetail) {
//             if (getCompanydetail[0].manualstock_closing === "Yes") {
//                 // let getdata = await sequelize.query(
//                 //     `SELECT * FROM maual_closingstock WHERE closingdate <= '${data.start_date}' and company_id='${data.company_id}' order by closingdate DESC limit 1`, {
//                 //         type: sequelize.QueryTypes.SELECT
//                 //     }
//                 // );
//                 // if (getdata.length > 0) {
//                 //     let response = await decreptionmnualstock(
//                 //         getdata,
//                 //         "array",
//                 //         data.data.email
//                 //     );
//                 //     totalvalue = Number(response[0].stockvalue);
//                 // }
//                 let ledgerData = await Ledger.findOne({where:{
//                     account_group_id:Constant.stockinhand_id,
//                     company_id:data.company_id
//                 }})
//                 if(ledgerData){
//                     ledgerData =await decreption(ledgerData, "object", data.data.email);
//                     totalvalue = ledgerData.dataValuesopening_balance=="credit"?Number(ledgerData.dataValues.amount):-1*Number(ledgerData.dataValues.amount);
//                 }else{
//                     totalvalue = 0;   
//                 }
//             } else {
//                 // calculation
//                 let ledger = await Ledger.findOne({
//                     where:{
//                         account_group_id:Constant.stockinhand_id,
//                         company_id: data.company_id
//                     }
//                 })
//                 ledger = await decreption(ledger, 'object', data.data.email)
//                 // return {getCompanydetail:getCompanydetail, data:data};
//                 // let bookStartyear = await yearexist(getCompanydetail[0].bookstart_date, data.start_date, data.end_date)
//                 // let findOldEntry = await 
//                 // return bookStartyear;
//                 let currentYeardata = await getOldYearData(data, res);
//                 console.log(currentYeardata, "currentYeardata", ledger.dataValues);
//                 if(ledger){
//                     if(currentYeardata.finalAmount==0){
//                         if(ledger.dataValues.opening_balance=="credit"){
//                             currentYeardata.finalAmount = Number(currentYeardata.finalAmount)-Number(ledger.dataValues.amount);
//                         }else{
//                             currentYeardata.finalAmount = Number(currentYeardata.finalAmount)+Number(ledger.dataValues.amount);
//                         }
//                     }else{
//                         let findOldAmountdiffrence = 0
//                         if(Number(currentYeardata.finalAmount)>=Number(ledger.dataValues.amount)){
//                             findOldAmountdiffrence = Number(currentYeardata.finalAmount)-Number(ledger.dataValues.amount)
//                         }else{
//                             findOldAmountdiffrence = Number(ledger.dataValues.amount) - Number(currentYeardata.finalAmount);
//                         }
//                         if(ledger.dataValues.opening_balance=="credit"){
//                             currentYeardata.finalAmount = Number(currentYeardata.finalAmount)-Number(findOldAmountdiffrencet);
//                         }else{
//                             currentYeardata.finalAmount = Number(currentYeardata.finalAmount)+Number(findOldAmountdiffrence);
//                         }
//                     }
//                 }
//                 console.log(currentYeardata.finalAmount)
//                 return currentYeardata.finalAmount?currentYeardata.finalAmount:0;
//                 // let amountledger = await  ledger.reduce( function(a, b){
//                 //     return a + Number(b['amount']);
//                 // }, 0);
//                 // return amountledger
//             }
//         }
//         return totalvalue;
//     } catch (e) {
//         return {
//             statusCode: res.statusCode,
//             success: false,
//             error: e.message,
//             message: "Something went wrong-->!"
//         };
//     }
// }
// async function getcloasingbalanceStockcalculation(data, openstock, res) {
//     try {
//         let totalvalue = 0;
//         let getCompanydetail = await sequelize.query(
//             `SELECT * FROM companies WHERE uid='${data.company_id}'`, {
//                 type: sequelize.QueryTypes.SELECT
//             }
//         );
//         if (getCompanydetail) {
//             if (getCompanydetail[0].manualstock_closing === "Yes") {
//                 let getdata = await sequelize.query(
//                     `SELECT * FROM maual_closingstock WHERE (closingdate BETWEEN '${data.start_date}' and '${data.end_date}') and company_id='${data.company_id}' order by closingdate DESC limit 1`, {
//                         type: sequelize.QueryTypes.SELECT
//                     }
//                 );
//                 if (getdata.length > 0) {
//                     let response = await decreptionmnualstock(
//                         getdata,
//                         "array",
//                         data.data.email
//                     );
//                     console.log("closeingStock<0?'credit':'debit',", response)
//                     totalvalue = Number(response[0].stockvalue);
//                 }
//             } else {
//                 // calculation
//                 let ledger = await Ledger.findOne({
//                     where:{
//                         account_group_id:Constant.stockinhand_id,
//                         company_id: data.company_id
//                     }
//                 })
//                 ledger = await decreption(ledger, 'object', data.data.email)
//                 let finalAmount = await getOldYearData(data, res);
//                 let oldPrice = await getOldPriceCurrentItem(data, res)
//                 let currentYeardata = await getCurrentYearData(data, res, finalAmount.finalAmountqty?finalAmount.finalAmountqty:0, oldPrice);
//                 console.log("currentYeardata", currentYeardata.closeStockAmount);
//                 if(ledger){
//                     if(currentYeardata==0){
//                         if(ledger.dataValues.opening_balance=="credit"){
//                             currentYeardata.closeStockAmount = Number(ledger.dataValues.amount)
//                         }else{
//                             currentYeardata.closeStockAmount = -1*Number(ledger.dataValues.amount)
//                         }
//                     }else{
//                         let findOldAmountdiffrence = 0
//                         if(Number(currentYeardata)>=Number(ledger.dataValues.amount)){
//                             findOldAmountdiffrence = Number(currentYeardata.returnAmount)-Number(ledger.dataValues.amount)
//                         }else{
//                             findOldAmountdiffrence = Number(ledger.dataValues.amount) - Number(currentYeardata.returnAmount);
//                         }
//                         if(ledger.dataValues.opening_balance=="credit"){
//                             currentYeardata.closeStockAmount = Number(currentYeardata.closeStockAmount)-Number(findOldAmountdiffrencet);
//                         }else{
//                             currentYeardata.closeStockAmount = Number(currentYeardata.closeStockAmount)+Number(findOldAmountdiffrence);
//                         }
//                         console.log("findOldAmountdiffrence", findOldAmountdiffrence)
//                     }
//                 }
//                 console.log("currentYeardata", currentYeardata)
//                 return currentYeardata.closeStockAmount;
//                 let amountledger = await  ledger.reduce( function(a, b){
//                     return a + Number(b['amount']);
//                 }, 0);
//                 return Number(currentYeardata);
//             }
//         }
//         return totalvalue;
//     } catch (e) {
//         return {
//             statusCode: res.statusCode,
//             success: false,
//             error: e.message,
//             message: "Something went wrong-->!"
//         };
//     }
// }
function _checkValid(){_checkValid=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee13(id){var data;return _regeneratorRuntime().wrap(function _callee13$(_context15){while(1)switch(_context15.prev=_context15.next){case 0:data=_balanceGroup["default"].profitids.find(function(item){return item==id;});if(!data){_context15.next=5;break;}return _context15.abrupt("return",true);case 5:return _context15.abrupt("return",false);case 6:case"end":return _context15.stop();}},_callee13);}));return _checkValid.apply(this,arguments);}function getopeingbalanceStockcalculation(_x3,_x4){return _getopeingbalanceStockcalculation.apply(this,arguments);}function _getopeingbalanceStockcalculation(){_getopeingbalanceStockcalculation=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee14(data,res){var totalvalue,getCompanydetail,ledgerData,ledger,currentYeardata,findOldAmountdiffrence;return _regeneratorRuntime().wrap(function _callee14$(_context16){while(1)switch(_context16.prev=_context16.next){case 0:_context16.prev=0;totalvalue=0;_context16.next=4;return _database.sequelize.query("SELECT * FROM companies WHERE uid='".concat(data.company_id,"'"),{type:_database.sequelize.QueryTypes.SELECT});case 4:getCompanydetail=_context16.sent;if(!getCompanydetail){_context16.next=31;break;}if(!(getCompanydetail[0].manualstock_closing==="Yes")){_context16.next=20;break;}_context16.next=9;return _ledger["default"].findOne({where:{account_group_id:_config["default"].stockinhand_id,company_id:data.company_id}});case 9:ledgerData=_context16.sent;if(!ledgerData){_context16.next=17;break;}_context16.next=13;return(0,_ledger2.decreption)(ledgerData,"object",data.data.email);case 13:ledgerData=_context16.sent;totalvalue=ledgerData.dataValues.opening_balance=="credit"?-1*Number(ledgerData.dataValues.amount):Number(ledgerData.dataValues.amount);_context16.next=18;break;case 17:totalvalue=0;case 18:_context16.next=31;break;case 20:_context16.next=22;return _ledger["default"].findOne({where:{account_group_id:_config["default"].stockinhand_id,company_id:data.company_id}});case 22:ledger=_context16.sent;_context16.next=25;return(0,_ledger2.decreption)(ledger,'object',data.data.email);case 25:ledger=_context16.sent;_context16.next=28;return(0,_accountData.getOldYearData)(data,res);case 28:currentYeardata=_context16.sent;if(ledger){if(currentYeardata.finalAmount==0){if(ledger.dataValues.opening_balance=="credit"){currentYeardata.finalAmount=Number(currentYeardata.finalAmount)-Number(ledger.dataValues.amount);}else{currentYeardata.finalAmount=Number(currentYeardata.finalAmount)+Number(ledger.dataValues.amount);}}else{findOldAmountdiffrence=0;if(Number(currentYeardata.finalAmount)>=Number(ledger.dataValues.amount)){findOldAmountdiffrence=Number(currentYeardata.finalAmount)-Number(ledger.dataValues.amount);}else{findOldAmountdiffrence=Number(ledger.dataValues.amount)-Number(currentYeardata.finalAmount);}if(ledger.dataValues.opening_balance=="credit"){currentYeardata.finalAmount=Number(currentYeardata.finalAmount)-Number(findOldAmountdiffrencet);}else{currentYeardata.finalAmount=Number(currentYeardata.finalAmount)+Number(findOldAmountdiffrence);}}}return _context16.abrupt("return",currentYeardata.finalAmount?currentYeardata.finalAmount:0);case 31:return _context16.abrupt("return",totalvalue);case 34:_context16.prev=34;_context16.t0=_context16["catch"](0);return _context16.abrupt("return",{statusCode:res.statusCode,success:false,error:_context16.t0.message,message:"Something went wrong-->!"});case 37:case"end":return _context16.stop();}},_callee14,null,[[0,34]]);}));return _getopeingbalanceStockcalculation.apply(this,arguments);}function getcloasingbalanceStockcalculation(_x5,_x6,_x7){return _getcloasingbalanceStockcalculation.apply(this,arguments);}function _getcloasingbalanceStockcalculation(){_getcloasingbalanceStockcalculation=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee15(data,openstock,res){var totalvalue,getCompanydetail,getdata,response,ledger,finalAmount,oldPrice,currentYeardata,findOldAmountdiffrence,amountledger;return _regeneratorRuntime().wrap(function _callee15$(_context17){while(1)switch(_context17.prev=_context17.next){case 0:_context17.prev=0;totalvalue=0;_context17.next=4;return _database.sequelize.query("SELECT * FROM companies WHERE uid='".concat(data.company_id,"'"),{type:_database.sequelize.QueryTypes.SELECT});case 4:getCompanydetail=_context17.sent;if(!getCompanydetail){_context17.next=38;break;}if(!(getCompanydetail[0].manualstock_closing==="Yes")){_context17.next=17;break;}_context17.next=9;return _database.sequelize.query("SELECT * FROM maual_closingstock WHERE (closingdate BETWEEN '".concat(data.start_date,"' and '").concat(data.end_date,"') and company_id='").concat(data.company_id,"' order by closingdate DESC limit 1"),{type:_database.sequelize.QueryTypes.SELECT});case 9:getdata=_context17.sent;if(!(getdata.length>0)){_context17.next=15;break;}_context17.next=13;return(0,_manualClosingStock.decreptionmnualstock)(getdata,"array",data.data.email);case 13:response=_context17.sent;totalvalue=Number(response[0].stockvalue);case 15:_context17.next=38;break;case 17:_context17.next=19;return _ledger["default"].findOne({where:{account_group_id:_config["default"].stockinhand_id,company_id:data.company_id}});case 19:ledger=_context17.sent;_context17.next=22;return(0,_ledger2.decreption)(ledger,'object',data.data.email);case 22:ledger=_context17.sent;_context17.next=25;return(0,_accountData.getOldYearData)(data,res);case 25:finalAmount=_context17.sent;_context17.next=28;return(0,_accountData.getOldPriceCurrentItem)(data,res);case 28:oldPrice=_context17.sent;_context17.next=31;return(0,_accountData.getCurrentYearData)(data,res,finalAmount.finalAmountqty?finalAmount.finalAmountqty:0,oldPrice);case 31:currentYeardata=_context17.sent;if(ledger){if(currentYeardata==0){if(ledger.dataValues.opening_balance=="credit"){currentYeardata.closeStockAmount=Number(ledger.dataValues.amount);}else{currentYeardata.closeStockAmount=-1*Number(ledger.dataValues.amount);}}else{findOldAmountdiffrence=0;if(Number(currentYeardata)>=Number(ledger.dataValues.amount)){findOldAmountdiffrence=Number(currentYeardata.returnAmount)-Number(ledger.dataValues.amount);}else{findOldAmountdiffrence=Number(ledger.dataValues.amount)-Number(currentYeardata.returnAmount);}if(ledger.dataValues.opening_balance=="credit"){currentYeardata.closeStockAmount=Number(currentYeardata.closeStockAmount)-Number(findOldAmountdiffrencet);}else{currentYeardata.closeStockAmount=Number(currentYeardata.closeStockAmount)+Number(findOldAmountdiffrence);}}}return _context17.abrupt("return",currentYeardata.closeStockAmount);case 36:amountledger=_context17.sent;return _context17.abrupt("return",Number(currentYeardata));case 38:return _context17.abrupt("return",totalvalue);case 41:_context17.prev=41;_context17.t0=_context17["catch"](0);return _context17.abrupt("return",{statusCode:res.statusCode,success:false,error:_context17.t0.message,message:"Something went wrong-->!"});case 44:case"end":return _context17.stop();}},_callee15,null,[[0,41]]);}));return _getcloasingbalanceStockcalculation.apply(this,arguments);}function getPurchaceAccountcalculaton(_x8,_x9,_x10){return _getPurchaceAccountcalculaton.apply(this,arguments);}function _getPurchaceAccountcalculaton(){_getPurchaceAccountcalculaton=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee16(accountGroupId,data,res){var _invoice_date71,_invoice_date72,findPurchaseItems,findDebitItems,mainArray,group,returnData,_i,_Object$entries,_Object$entries$_i,key,value,amount;return _regeneratorRuntime().wrap(function _callee16$(_context18){while(1)switch(_context18.prev=_context18.next){case 0:_context18.prev=0;_context18.next=3;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{type:'Purchase'},{invoice_date:(_invoice_date71={},_defineProperty(_invoice_date71,Op.gte,data.start_date),_defineProperty(_invoice_date71,Op.lte,data.end_date),_invoice_date71)}]),include:[{model:_items["default"],as:"itemone"},{model:_ledger["default"],as:"ledgerone"}]});case 3:findPurchaseItems=_context18.sent;_context18.next=6;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{type:'Credit'},{invoice_date:(_invoice_date72={},_defineProperty(_invoice_date72,Op.gte,data.start_date),_defineProperty(_invoice_date72,Op.lte,data.end_date),_invoice_date72)}]),include:[{model:_items["default"],as:"itemone"},{model:_ledger["default"],as:"ledgerone"}]});case 6:findDebitItems=_context18.sent;mainArray=[];_context18.next=10;return(0,_itemEntries.decreptionItem)(findPurchaseItems,"array",data.data.email);case 10:findPurchaseItems=_context18.sent;_context18.next=13;return(0,_itemEntries.decreptionItem)(findDebitItems,"array",data.data.email);case 13:findDebitItems=_context18.sent;if(findPurchaseItems.length>0){findPurchaseItems.map(function(item){var data={buyer_ledger_id:item.ledger_id,isgst:item.igst_tax,is_return:0,ledgerdata:item.ledgerone,quantity:item.quantity?item.quantity:0,total_amount:Number(item.total_amount),invoice_date:item.invoice_date,name:item.ledgerone&&item.ledgerone.name?item.ledgerone.name:''};mainArray.push(data);});}if(findDebitItems.length>0){findDebitItems.map(function(item){var data={buyer_ledger_id:item.ledger_id,isgst:item.igst_tax,is_return:1,quantity:item.quantity?item.quantity:0,total_amount:Number(item.total_amount),ledgerdata:item.ledgerone,invoice_date:item.invoice_date,name:item.ledgerone&&item.ledgerone.name?item.ledgerone.name:''};mainArray.push(data);});}group=mainArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});returnData=[];_i=0,_Object$entries=Object.entries(group);case 19:if(!(_i<_Object$entries.length)){_context18.next=42;break;}_Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];_context18.next=23;return value.map(function(calAmount){return Number(calAmount.total_amount);});case 23:amount=_context18.sent;_context18.t0=returnData;_context18.t1=value[0].buyer_ledger_id;_context18.t2=value[0].igst_tax;_context18.t3=value[0].is_return;_context18.t4=value[0].is_local;_context18.t5=value[0].ledgerone?value[0].ledgerone:{};_context18.next=32;return Number(Number(amount.reduce(function(a,b){return Number(a)+Number(b);},0)).toFixed(2));case 32:_context18.t6=_context18.sent;_context18.t7=Number(value[0].ledgerdata.amount);_context18.t8=_context18.t6+_context18.t7;_context18.t9=value[0].invoice_date;_context18.t10=key;_context18.t11={buyer_ledger_id:_context18.t1,isgst:_context18.t2,is_return:_context18.t3,is_local:_context18.t4,ledgerdata:_context18.t5,total_amount:_context18.t8,invoice_date:_context18.t9,name:_context18.t10};_context18.t0.push.call(_context18.t0,_context18.t11);case 39:_i++;_context18.next=19;break;case 42:return _context18.abrupt("return",returnData);case 45:_context18.prev=45;_context18.t12=_context18["catch"](0);return _context18.abrupt("return",{statusCode:res.statusCode,success:false,error:_context18.t12.message,message:"Something went wrong-->!"});case 48:case"end":return _context18.stop();}},_callee16,null,[[0,45]]);}));return _getPurchaceAccountcalculaton.apply(this,arguments);}function getSaleAccountcalculaton(_x11,_x12,_x13){return _getSaleAccountcalculaton.apply(this,arguments);}function _getSaleAccountcalculaton(){_getSaleAccountcalculaton=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee17(accountGroupId,data,res){var _invoice_date73,_invoice_date74,findSalesItems,findCreditItems,mainArray,group,returnData,_i2,_Object$entries2,_Object$entries2$_i,key,value,amount;return _regeneratorRuntime().wrap(function _callee17$(_context19){while(1)switch(_context19.prev=_context19.next){case 0:_context19.prev=0;_context19.next=3;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{type:'Sales'},{invoice_date:(_invoice_date73={},_defineProperty(_invoice_date73,Op.gte,data.start_date),_defineProperty(_invoice_date73,Op.lte,data.end_date),_invoice_date73)}]),include:[{model:_items["default"],as:"itemone"},{model:_ledger["default"],as:"ledgerone"}]});case 3:findSalesItems=_context19.sent;_context19.next=6;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{type:'Debit'},{invoice_date:(_invoice_date74={},_defineProperty(_invoice_date74,Op.gte,data.start_date),_defineProperty(_invoice_date74,Op.lte,data.end_date),_invoice_date74)}]),include:[{model:_items["default"],as:"itemone"},{model:_ledger["default"],as:"ledgerone"}]});case 6:findCreditItems=_context19.sent;mainArray=[];_context19.next=10;return(0,_itemEntries.decreptionItem)(findSalesItems,"array",data.data.email);case 10:findSalesItems=_context19.sent;_context19.next=13;return(0,_itemEntries.decreptionItem)(findCreditItems,"array",data.data.email);case 13:findCreditItems=_context19.sent;// return {findSalesItems:findSalesItems, findCreditItems:findCreditItems}
if(findSalesItems.length>0){findSalesItems.map(function(item){var data={buyer_ledger_id:item.ledger_id,isgst:item.igst_tax,is_return:0,quantity:item.quantity?item.quantity:0,total_amount:Number(item.total_amount),invoice_date:item.invoice_date,ledgerdata:item.ledgerone,name:item.ledgerone&&item.ledgerone.name?item.ledgerone.name:''};mainArray.push(data);});}if(findCreditItems.length>0){findCreditItems.map(function(item){var data={buyer_ledger_id:item.ledger_id,isgst:item.igst_tax,is_return:1,quantity:item.quantity?item.quantity:0,total_amount:Number(item.total_amount),ledgerdata:item.ledgerone,invoice_date:item.invoice_date,name:item.ledgerone&&item.ledgerone.name?item.ledgerone.name:''};mainArray.push(data);});}group=mainArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});returnData=[];_i2=0,_Object$entries2=Object.entries(group);case 19:if(!(_i2<_Object$entries2.length)){_context19.next=41;break;}_Object$entries2$_i=_slicedToArray(_Object$entries2[_i2],2),key=_Object$entries2$_i[0],value=_Object$entries2$_i[1];_context19.next=23;return value.map(function(calAmount){return Number(calAmount.total_amount);});case 23:amount=_context19.sent;_context19.t0=returnData;_context19.t1=value[0].buyer_ledger_id;_context19.t2=value[0].igst_tax;_context19.t3=value[0].is_return;_context19.t4=value[0].is_local;_context19.next=31;return Number(Number(amount.reduce(function(a,b){return Number(a)+Number(b);},0)).toFixed(2));case 31:_context19.t5=_context19.sent;_context19.t6=Number(value[0].ledgerdata.amount);_context19.t7=_context19.t5+_context19.t6;_context19.t8=value[0].invoice_date;_context19.t9=key;_context19.t10={buyer_ledger_id:_context19.t1,isgst:_context19.t2,is_return:_context19.t3,is_local:_context19.t4,total_amount:_context19.t7,invoice_date:_context19.t8,name:_context19.t9};_context19.t0.push.call(_context19.t0,_context19.t10);case 38:_i2++;_context19.next=19;break;case 41:return _context19.abrupt("return",returnData);case 44:_context19.prev=44;_context19.t11=_context19["catch"](0);return _context19.abrupt("return",{statusCode:res.statusCode,success:false,error:_context19.t11.message,message:"Something went wrong-->!"});case 47:case"end":return _context19.stop();}},_callee17,null,[[0,44]]);}));return _getSaleAccountcalculaton.apply(this,arguments);}function profitCal(_x14){return _profitCal.apply(this,arguments);}function _profitCal(){_profitCal=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee18(object){var salesAmount,purchaseAmount,directIncomeAmount,directExpenseAmount,indirectExpenseAmount,indirectIncomeAmount,closeAmount,openAmount,purchaseCreditAmount,salesCreditAmount,indirectgrossAmount,netProfite,grossProfitAmount;return _regeneratorRuntime().wrap(function _callee18$(_context20){while(1)switch(_context20.prev=_context20.next){case 0:salesAmount=0;purchaseAmount=0;directIncomeAmount=0;directExpenseAmount=0;indirectExpenseAmount=0;indirectIncomeAmount=0;closeAmount=object.closeingStock?object.closeingStock:0;openAmount=object.openingStock?object.openingStock:0;purchaseCreditAmount=0;salesCreditAmount=0;indirectgrossAmount=0;// let grossProfitAmount = 0;
netProfite=0;grossProfitAmount=0;if(object.SaleAccount&&object.SaleAccount.length>0){object.SaleAccount.map(function(item){salesAmount=Number(salesAmount)+Number(item.total_amount);});}if(object.PurchaseAccount&&object.PurchaseAccount.length>0){object.PurchaseAccount.map(function(item){purchaseAmount=Number(purchaseAmount)+Number(item.total_amount);});}if(object.directIncome&&object.directIncome.length>0){object.directIncome.map(function(item){directIncomeAmount=Number(directIncomeAmount)+Number(item.total_amount);});}if(object.directExpense&&object.directExpense.length>0){object.directExpense.map(function(item){directExpenseAmount=Number(directExpenseAmount)+Number(item.total_amount);});}if(object.indirectExpense&&object.indirectExpense.length>0){object.indirectExpense.map(function(item){indirectExpenseAmount=Number(indirectExpenseAmount)+Number(item.total_amount);});}if(object.indirectIncome&&object.indirectIncome.length>0){object.indirectIncome.map(function(item){indirectIncomeAmount=Number(indirectIncomeAmount)+Number(item.total_amount);});}salesCreditAmount=Number(salesAmount)+Number(directIncomeAmount)+Number(closeAmount);purchaseCreditAmount=Number(openAmount)+Number(purchaseAmount)+Number(directExpenseAmount);grossProfitAmount=Number(salesCreditAmount)-Number(purchaseCreditAmount);indirectgrossAmount=Number(grossProfitAmount)+Number(indirectIncomeAmount);netProfite=Number(indirectgrossAmount)-Number(indirectExpenseAmount);return _context20.abrupt("return",{salesAmount:salesAmount,purchaseAmount:purchaseAmount,directIncomeAmount:directIncomeAmount,directExpenseAmount:directExpenseAmount,indirectExpenseAmount:indirectExpenseAmount,indirectIncomeAmount:indirectIncomeAmount,closeAmount:closeAmount,openAmount:openAmount,salesCreditAmount:salesCreditAmount,purchaseCreditAmount:purchaseCreditAmount,grossProfitAmount:grossProfitAmount,indirectgrossAmount:indirectgrossAmount,netProfite:netProfite});case 25:case"end":return _context20.stop();}},_callee18);}));return _profitCal.apply(this,arguments);};function currentprofitLoss(_x15,_x16){return _currentprofitLoss.apply(this,arguments);}function _currentprofitLoss(){_currentprofitLoss=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee19(data,res){var letmainobject,purcseobjcet,saleobject,directExpenseobject,directIncomeobject,indirectExpenseobject,indirectIncomebject,openingStock,closeingStock;return _regeneratorRuntime().wrap(function _callee19$(_context21){while(1)switch(_context21.prev=_context21.next){case 0:_context21.prev=0;letmainobject={};_context21.next=4;return getPurchaceAccountcalculaton(_config["default"].PurchaseAccounts,data,res);case 4:purcseobjcet=_context21.sent;_context21.next=7;return getSaleAccountcalculaton(_config["default"].sale_account_id,data,res);case 7:saleobject=_context21.sent;_context21.next=10;return(0,_accountData.groupData)(_config["default"].direct_expense_id,data,res);case 10:directExpenseobject=_context21.sent;_context21.next=13;return(0,_accountData.groupData)(_config["default"].direct_income_id,data,res);case 13:directIncomeobject=_context21.sent;_context21.next=16;return(0,_accountData.groupData)(_config["default"].indirect_Expenses_id,data,res);case 16:indirectExpenseobject=_context21.sent;_context21.next=19;return(0,_accountData.groupData)(_config["default"].indirect_income_id,data,res);case 19:indirectIncomebject=_context21.sent;_context21.next=22;return getopeingbalanceStockcalculation(data,res);case 22:openingStock=_context21.sent;_context21.next=25;return getcloasingbalanceStockcalculation(data,openingStock,res);case 25:closeingStock=_context21.sent;//getcloasingbalancecalculation(data, res);
letmainobject.PurchaseAccount=purcseobjcet;letmainobject.SaleAccount=saleobject;letmainobject.directExpense=directExpenseobject;letmainobject.directIncome=directIncomeobject;letmainobject.indirectExpense=indirectExpenseobject;letmainobject.indirectIncome=indirectIncomebject;letmainobject.openingStock=openingStock;letmainobject.closeingStock=closeingStock;if(!letmainobject){_context21.next=38;break;}return _context21.abrupt("return",{statusCode:res.statusCode,success:true,message:"Data fetch Successfully",sheetdata:letmainobject});case 38:return _context21.abrupt("return",{statusCode:res.statusCode,success:true,message:"Data not Found!",sheetdata:letmainobject});case 39:_context21.next=44;break;case 41:_context21.prev=41;_context21.t0=_context21["catch"](0);return _context21.abrupt("return",{statusCode:res.statusCode,success:false,error:_context21.t0.message,message:"Something went wrong!"});case 44:case"end":return _context21.stop();}},_callee19,null,[[0,41]]);}));return _currentprofitLoss.apply(this,arguments);}function oldprofitLoss(_x17,_x18){return _oldprofitLoss.apply(this,arguments);}function _oldprofitLoss(){_oldprofitLoss=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee20(data,res){var letmainobject,purcseobjcet,saleobject,directExpenseobject,directIncomeobject,indirectExpenseobject,indirectIncomebject,openingStock,closeingStock;return _regeneratorRuntime().wrap(function _callee20$(_context22){while(1)switch(_context22.prev=_context22.next){case 0:_context22.prev=0;letmainobject={};_context22.next=4;return getPurchaceAccountcalculaton(_config["default"].PurchaseAccounts,data,res);case 4:purcseobjcet=_context22.sent;_context22.next=7;return getSaleAccountcalculaton(_config["default"].sale_account_id,data,res);case 7:saleobject=_context22.sent;_context22.next=10;return(0,_accountData.groupData)(_config["default"].direct_expense_id,data,res);case 10:directExpenseobject=_context22.sent;_context22.next=13;return(0,_accountData.groupData)(_config["default"].direct_income_id,data,res);case 13:directIncomeobject=_context22.sent;_context22.next=16;return(0,_accountData.groupData)(_config["default"].indirect_Expenses_id,data,res);case 16:indirectExpenseobject=_context22.sent;_context22.next=19;return(0,_accountData.groupData)(_config["default"].indirect_income_id,data,res);case 19:indirectIncomebject=_context22.sent;_context22.next=22;return getopeingbalanceStockcalculation(data,res);case 22:openingStock=_context22.sent;_context22.next=25;return getcloasingbalanceStockcalculation(data,openingStock,res);case 25:closeingStock=_context22.sent;//getcloasingbalancecalculation(data, res);
letmainobject.PurchaseAccount=purcseobjcet;letmainobject.SaleAccount=saleobject;letmainobject.directExpense=directExpenseobject;letmainobject.directIncome=directIncomeobject;letmainobject.indirectExpense=indirectExpenseobject;letmainobject.indirectIncome=indirectIncomebject;letmainobject.openingStock=openingStock;letmainobject.closeingStock=closeingStock;if(!letmainobject){_context22.next=38;break;}return _context22.abrupt("return",{statusCode:res.statusCode,success:true,message:"Data fetch Successfully",sheetdata:letmainobject});case 38:return _context22.abrupt("return",{statusCode:res.statusCode,success:true,message:"Data not Found!",sheetdata:letmainobject});case 39:_context22.next=44;break;case 41:_context22.prev=41;_context22.t0=_context22["catch"](0);return _context22.abrupt("return",{statusCode:res.statusCode,success:false,error:_context22.t0.message,message:"Something went wrong!"});case 44:case"end":return _context22.stop();}},_callee20,null,[[0,41]]);}));return _oldprofitLoss.apply(this,arguments);}function getAllLedgerVoucherprivious(_x19,_x20,_x21,_x22,_x23,_x24,_x25){return _getAllLedgerVoucherprivious.apply(this,arguments);}function _getAllLedgerVoucherprivious(){_getAllLedgerVoucherprivious=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee21(start_date,end_date,ledger_id,company_id,openingbalncecredit,openingbalncedebit,email){var journalVoucher,saleVoucher,purchaseVoucher,creditVoucher,debitVoucher,recieptVoucher,paymentVoucher,discountsaleVoucher,discountdebitVoucher,discountpurchaseVoucher,discountcreditVoucher,reciverrecieptVoucher,reciverpaymentVoucher,ledger,array,i,salearray,s,findSales,purchasearray,_findSales2,_salearray5,_salearray6,_salearray7,_salearray8,mainArray,creditamount,debetamount,totalbalnce;return _regeneratorRuntime().wrap(function _callee21$(_context23){while(1)switch(_context23.prev=_context23.next){case 0:_context23.prev=0;reciverpaymentVoucher=[];_context23.next=4;return _ledger["default"].findOne({where:{uid:ledger_id,company_id:company_id},include:[{model:_accountGroup["default"]}]});case 4:ledger=_context23.sent;if(!(ledger&&ledger.dataValues.id)){_context23.next=1348;break;}if(!ledger.dataValues.tax_key){_context23.next=30;break;}_context23.next=9;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Sales'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_saleVoucher["default"],as:'tax',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 9:saleVoucher=_context23.sent;_context23.next=12;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Purchase'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_purchaseVoucher["default"],as:'taxp',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 12:purchaseVoucher=_context23.sent;_context23.next=15;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Debit'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_creditVoucher["default"],as:'taxc',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 15:creditVoucher=_context23.sent;_context23.next=18;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Credit'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_debitVoucher["default"],as:'taxd',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 18:debitVoucher=_context23.sent;_context23.next=21;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 21:journalVoucher=_context23.sent;_context23.next=24;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 24:recieptVoucher=_context23.sent;_context23.next=27;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 27:paymentVoucher=_context23.sent;_context23.next=87;break;case 30:if(!ledger.dataValues.sale_key){_context23.next=54;break;}_context23.next=33;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Sales'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_saleVoucher["default"],as:'Voucheris',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 33:saleVoucher=_context23.sent;_context23.next=36;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Purchase'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_purchaseVoucher["default"],as:'Voucherip',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 36:purchaseVoucher=_context23.sent;_context23.next=39;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Debit'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_creditVoucher["default"],as:'Voucheric',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 39:creditVoucher=_context23.sent;_context23.next=42;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Credit'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_debitVoucher["default"],as:'Voucherid',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 42:debitVoucher=_context23.sent;_context23.next=45;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 45:journalVoucher=_context23.sent;_context23.next=48;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 48:recieptVoucher=_context23.sent;_context23.next=51;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 51:paymentVoucher=_context23.sent;_context23.next=87;break;case 54:_context23.next=56;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 56:journalVoucher=_context23.sent;_context23.next=59;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 59:saleVoucher=_context23.sent;_context23.next=62;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 62:purchaseVoucher=_context23.sent;_context23.next=65;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'CreditBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 65:creditVoucher=_context23.sent;_context23.next=68;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'DebitBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 68:debitVoucher=_context23.sent;_context23.next=71;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 71:recieptVoucher=_context23.sent;_context23.next=74;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 74:paymentVoucher=_context23.sent;_context23.next=77;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'SalesDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 77:discountsaleVoucher=_context23.sent;_context23.next=80;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PurchaseDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 80:discountpurchaseVoucher=_context23.sent;_context23.next=83;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'CreditDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 83:discountcreditVoucher=_context23.sent;_context23.next=86;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'DebitDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 86:discountdebitVoucher=_context23.sent;case 87:_context23.next=89;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{receive_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'ReciptReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 89:reciverrecieptVoucher=_context23.sent;_context23.next=92;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{receive_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PaymentReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 92:reciverpaymentVoucher=_context23.sent;_context23.next=95;return(0,_ledger2.decreption)(ledger,'object',email);case 95:ledger=_context23.sent;_context23.next=98;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',email);case 98:journalVoucher=_context23.sent;_context23.next=101;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',email);case 101:recieptVoucher=_context23.sent;_context23.next=104;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',email);case 104:paymentVoucher=_context23.sent;_context23.next=107;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',email);case 107:saleVoucher=_context23.sent;_context23.next=110;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',email);case 110:purchaseVoucher=_context23.sent;_context23.next=113;return(0,_creditvoucher.decreptionCredit)(creditVoucher,'array',email);case 113:creditVoucher=_context23.sent;_context23.next=116;return(0,_debitvoucher.decreptionDebit)(debitVoucher,'array',email);case 116:debitVoucher=_context23.sent;_context23.next=119;return(0,_receiptvoucher.decreptionReceipt)(reciverrecieptVoucher,'array',email);case 119:reciverrecieptVoucher=_context23.sent;_context23.next=122;return(0,_paymentvoucher.decreptionPayment)(reciverpaymentVoucher,'array',email);case 122:reciverpaymentVoucher=_context23.sent;if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context23.next=127;break;}_context23.next=126;return(0,_salesvoucher.decreptionSale)(discountsaleVoucher,'array',email);case 126:discountsaleVoucher=_context23.sent;case 127:if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context23.next=131;break;}_context23.next=130;return(0,_purchasevoucher.decreptionPurchase)(discountpurchaseVoucher,'array',email);case 130:discountpurchaseVoucher=_context23.sent;case 131:if(!(discountcreditVoucher&&discountcreditVoucher.length>0)){_context23.next=135;break;}_context23.next=134;return(0,_creditvoucher.decreptionCredit)(discountcreditVoucher,'array',email);case 134:discountcreditVoucher=_context23.sent;case 135:if(!(discountdebitVoucher&&discountdebitVoucher.length>0)){_context23.next=139;break;}_context23.next=138;return(0,_debitvoucher.decreptionDebit)(discountdebitVoucher,'array',email);case 138:discountdebitVoucher=_context23.sent;case 139:_context23.next=141;return[];case 141:array=_context23.sent;if(!(journalVoucher&&journalVoucher.length>0)){_context23.next=196;break;}i=0;case 144:if(!(i<journalVoucher.length)){_context23.next=196;break;}_context23.next=147;return journalVoucher[i].type;case 147:_context23.t0=_context23.sent;if(!(_context23.t0==='debit')){_context23.next=157;break;}_context23.next=151;return journalVoucher[i].amount;case 151:journalVoucher[i].debitAmount=_context23.sent;_context23.next=154;return 0;case 154:journalVoucher[i].creditAmount=_context23.sent;_context23.next=163;break;case 157:_context23.next=159;return 0;case 159:journalVoucher[i].debitAmount=_context23.sent;_context23.next=162;return journalVoucher[i].amount;case 162:journalVoucher[i].creditAmount=_context23.sent;case 163:if(!journalVoucher[i].Voucher){_context23.next=181;break;}_context23.next=166;return journalVoucher[i].Voucher.invoice_date;case 166:journalVoucher[i].invoice_date=_context23.sent;_context23.next=169;return journalVoucher[i].Voucher.id;case 169:journalVoucher[i].voucher_number=_context23.sent;_context23.next=172;return journalVoucher[i].Voucher.invoice_id;case 172:_context23.t1=_context23.sent;if(!(_context23.t1<=9)){_context23.next=177;break;}_context23.t2="".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(journalVoucher[i].Voucher.invoice_id);_context23.next=178;break;case 177:_context23.t2=journalVoucher[i].Voucher.invoice_id>9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(journalVoucher[i].Voucher.invoice_id):"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(journalVoucher[i].Voucher.invoice_id);case 178:journalVoucher[i].invoice_id=_context23.t2;_context23.next=184;break;case 181:journalVoucher[i].invoice_date='';journalVoucher[i].voucher_number='';journalVoucher[i].invoice_id='';case 184:_context23.next=186;return'journal';case 186:journalVoucher[i].voucher_type=_context23.sent;_context23.next=189;return journalVoucher[i].VoucherLedger;case 189:journalVoucher[i].ledger=_context23.sent;delete journalVoucher[i].VoucherLedger;_context23.next=193;return array.push(journalVoucher[i]);case 193:i++;_context23.next=144;break;case 196:if(!(saleVoucher&&saleVoucher.length>0)){_context23.next=438;break;}salearray=[];s=0;case 199:if(!(s<saleVoucher.length)){_context23.next=438;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context23.next=247;break;}_context23.next=203;return'sale';case 203:saleVoucher[s].voucher_type=_context23.sent;_context23.next=206;return saleVoucher[s].RoundOff;case 206:saleVoucher[s].ledger=_context23.sent;_context23.next=209;return{};case 209:saleVoucher[s].Voucher=_context23.sent;saleVoucher[s].type=saleVoucher[s].roundoff_type;_context23.next=213;return saleVoucher[s].roundoff_type;case 213:_context23.t3=_context23.sent;if(!(_context23.t3=="debit")){_context23.next=218;break;}_context23.t4=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context23.next=219;break;case 218:_context23.t4=0;case 219:saleVoucher[s].debitAmount=_context23.t4;_context23.next=222;return saleVoucher[s].roundoff_type;case 222:_context23.t5=_context23.sent;if(!(_context23.t5=="credit")){_context23.next=227;break;}_context23.t6=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context23.next=228;break;case 227:_context23.t6=0;case 228:saleVoucher[s].creditAmount=_context23.t6;saleVoucher[s].amount=saleVoucher[s].roundoff_value;_context23.next=232;return saleVoucher[s].id;case 232:saleVoucher[s].voucher_number=_context23.sent;_context23.next=235;return saleVoucher[s].invoice_id;case 235:_context23.t7=_context23.sent;if(!(_context23.t7<=9)){_context23.next=240;break;}_context23.t8="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context23.next=241;break;case 240:_context23.t8=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(ssaleVoucher[s].invoice_id);case 241:saleVoucher[s].invoice_id=_context23.t8;delete saleVoucher[s].RoundOff;_context23.next=245;return array.push(saleVoucher[s]);case 245:_context23.next=435;break;case 247:if(!ledger.dataValues.sale_key){_context23.next=354;break;}if(!(salearray.length>0)){_context23.next=305;break;}_context23.next=251;return salearray.find(function(it){return saleVoucher[s].Voucheris&&it.invoice_idold==saleVoucher[s].Voucheris.invoice_id;});case 251:findSales=_context23.sent;if(!(findSales&&findSales.Voucher)){_context23.next=255;break;}_context23.next=303;break;case 255:_context23.next=257;return'sale';case 257:saleVoucher[s].voucher_type=_context23.sent;if(!saleVoucher[s].Voucheris){_context23.next=265;break;}_context23.next=261;return saleVoucher[s].Voucheris.SalesLedger;case 261:saleVoucher[s].ledger=_context23.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context23.next=266;break;case 265:saleVoucher[s].ledger={};case 266:_context23.next=268;return saleVoucher[s].Voucheris;case 268:if(!_context23.sent){_context23.next=272;break;}_context23.t9=saleVoucher[s].Voucheris;_context23.next=273;break;case 272:_context23.t9={};case 273:saleVoucher[s].Voucher=_context23.t9;saleVoucher[s].type='credit';_context23.next=277;return 0;case 277:saleVoucher[s].debitAmount=_context23.sent;_context23.next=280;return saleVoucher[s].total_amount;case 280:saleVoucher[s].creditAmount=_context23.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context23.next=284;return saleVoucher[s].Voucheris;case 284:if(!_context23.sent){_context23.next=288;break;}_context23.t10=saleVoucher[s].Voucheris.id;_context23.next=289;break;case 288:_context23.t10='';case 289:saleVoucher[s].voucher_number=_context23.t10;_context23.next=292;return saleVoucher[s].Voucheris;case 292:if(!_context23.sent){_context23.next=296;break;}_context23.t11=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context23.next=297;break;case 296:_context23.t11='';case 297:saleVoucher[s].invoice_id=_context23.t11;delete saleVoucher[s].Voucheris;_context23.next=301;return salearray.push(saleVoucher[s]);case 301:_context23.next=303;return array.push(saleVoucher[s]);case 303:_context23.next=352;break;case 305:_context23.next=307;return'sale';case 307:saleVoucher[s].voucher_type=_context23.sent;if(!saleVoucher[s].Voucheris){_context23.next=315;break;}_context23.next=311;return saleVoucher[s].Voucheris.SalesLedger;case 311:saleVoucher[s].ledger=_context23.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context23.next=316;break;case 315:saleVoucher[s].ledger={};case 316:_context23.next=318;return saleVoucher[s].Voucheris;case 318:if(!_context23.sent){_context23.next=322;break;}_context23.t12=saleVoucher[s].Voucheris;_context23.next=323;break;case 322:_context23.t12={};case 323:saleVoucher[s].Voucher=_context23.t12;saleVoucher[s].type='credit';_context23.next=327;return 0;case 327:saleVoucher[s].debitAmount=_context23.sent;_context23.next=330;return saleVoucher[s].total_amount;case 330:saleVoucher[s].creditAmount=_context23.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context23.next=334;return saleVoucher[s].Voucheris;case 334:if(!_context23.sent){_context23.next=338;break;}_context23.t13=saleVoucher[s].Voucheris.id;_context23.next=339;break;case 338:_context23.t13='';case 339:saleVoucher[s].voucher_number=_context23.t13;_context23.next=342;return saleVoucher[s].Voucheris;case 342:if(!_context23.sent){_context23.next=346;break;}_context23.t14=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context23.next=347;break;case 346:_context23.t14='';case 347:saleVoucher[s].invoice_id=_context23.t14;_context23.next=350;return salearray.push(saleVoucher[s]);case 350:_context23.next=352;return array.push(saleVoucher[s]);case 352:_context23.next=435;break;case 354:if(!ledger.dataValues.tax_key){_context23.next=403;break;}_context23.next=357;return'sale';case 357:saleVoucher[s].voucher_type=_context23.sent;if(!saleVoucher[s].tax){_context23.next=365;break;}_context23.next=361;return saleVoucher[s].tax.SalesLedger;case 361:saleVoucher[s].ledger=_context23.sent;delete saleVoucher[s].tax.SalesLedger;_context23.next=366;break;case 365:saleVoucher[s].ledger={};case 366:_context23.next=368;return saleVoucher[s].tax;case 368:if(!_context23.sent){_context23.next=372;break;}_context23.t15=saleVoucher[s].tax;_context23.next=373;break;case 372:_context23.t15={};case 373:saleVoucher[s].Voucher=_context23.t15;saleVoucher[s].type='credit';_context23.next=377;return 0;case 377:saleVoucher[s].debitAmount=_context23.sent;_context23.next=380;return saleVoucher[s].amount;case 380:saleVoucher[s].creditAmount=_context23.sent;saleVoucher[s].amount=saleVoucher[s].amount;_context23.next=384;return saleVoucher[s].tax;case 384:if(!_context23.sent){_context23.next=388;break;}_context23.t16=saleVoucher[s].tax.id;_context23.next=389;break;case 388:_context23.t16='';case 389:saleVoucher[s].voucher_number=_context23.t16;_context23.next=392;return saleVoucher[s].tax;case 392:if(!_context23.sent){_context23.next=396;break;}_context23.t17=saleVoucher[s].tax.invoice_id<=9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].tax.invoice_id):saleVoucher[s].tax.invoice_id>9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].tax.invoice_id):"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/").concat(saleVoucher[s].tax.invoice_id);_context23.next=397;break;case 396:_context23.t17='';case 397:saleVoucher[s].invoice_id=_context23.t17;delete saleVoucher[s].tax;_context23.next=401;return array.push(saleVoucher[s]);case 401:_context23.next=435;break;case 403:_context23.next=405;return'sale';case 405:saleVoucher[s].voucher_type=_context23.sent;_context23.next=408;return saleVoucher[s].SalesLedger;case 408:saleVoucher[s].ledger=_context23.sent;_context23.next=411;return{};case 411:saleVoucher[s].Voucher=_context23.sent;saleVoucher[s].type='Credit';_context23.next=415;return 0;case 415:saleVoucher[s].debitAmount=_context23.sent;_context23.next=418;return saleVoucher[s].total_amount;case 418:saleVoucher[s].creditAmount=_context23.sent;saleVoucher[s].amount=saleVoucher[s].total_amount;_context23.next=422;return saleVoucher[s].id;case 422:saleVoucher[s].voucher_number=_context23.sent;_context23.next=425;return saleVoucher[s].invoice_id;case 425:_context23.t18=_context23.sent;if(!(_context23.t18<=9)){_context23.next=430;break;}_context23.t19="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context23.next=431;break;case 430:_context23.t19=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(saleVoucher[s].invoice_id);case 431:saleVoucher[s].invoice_id=_context23.t19;delete saleVoucher[s].SalesLedger;_context23.next=435;return array.push(saleVoucher[s]);case 435:s++;_context23.next=199;break;case 438:if(!(purchaseVoucher&&purchaseVoucher.length>0)){_context23.next=689;break;}purchasearray=[];s=0;case 441:if(!(s<purchaseVoucher.length)){_context23.next=689;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context23.next=489;break;}_context23.next=445;return'purchase';case 445:purchaseVoucher[s].voucher_type=_context23.sent;_context23.next=448;return purchaseVoucher[s].RoundOff;case 448:purchaseVoucher[s].ledger=_context23.sent;_context23.next=451;return{};case 451:purchaseVoucher[s].Voucher=_context23.sent;purchaseVoucher[s].type=purchaseVoucher[s].roundoff_type;_context23.next=455;return purchaseVoucher[s].roundoff_type;case 455:_context23.t20=_context23.sent;if(!(_context23.t20=="debit")){_context23.next=460;break;}_context23.t21=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context23.next=461;break;case 460:_context23.t21=0;case 461:purchaseVoucher[s].debitAmount=_context23.t21;_context23.next=464;return purchaseVoucher[s].roundoff_type;case 464:_context23.t22=_context23.sent;if(!(_context23.t22=="credit")){_context23.next=469;break;}_context23.t23=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context23.next=470;break;case 469:_context23.t23=0;case 470:purchaseVoucher[s].creditAmount=_context23.t23;purchaseVoucher[s].amount=purchaseVoucher[s].roundoff_value;_context23.next=474;return purchaseVoucher[s].id;case 474:purchaseVoucher[s].voucher_number=_context23.sent;_context23.next=477;return purchaseVoucher[s].invoice_id;case 477:_context23.t24=_context23.sent;if(!(_context23.t24<=9)){_context23.next=482;break;}_context23.t25="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context23.next=483;break;case 482:_context23.t25=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 483:purchaseVoucher[s].invoice_id=_context23.t25;delete purchaseVoucher[s].RoundOff;_context23.next=487;return array.push(purchaseVoucher[s]);case 487:_context23.next=686;break;case 489:if(!ledger.dataValues.sale_key){_context23.next=605;break;}if(!(purchaseVoucher.length>0)){_context23.next=551;break;}_context23.next=493;return purchasearray.find(function(it){return purchaseVoucher[s].Voucherip&&it.invoice_idold==purchaseVoucher[s].Voucherip.invoice_id;});case 493:_findSales2=_context23.sent;if(!(_findSales2&&_findSales2.Voucher)){_context23.next=497;break;}_context23.next=549;break;case 497:_context23.next=499;return'purchase';case 499:purchaseVoucher[s].voucher_type=_context23.sent;if(!purchaseVoucher[s].Voucherip){_context23.next=507;break;}_context23.next=503;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 503:purchaseVoucher[s].ledger=_context23.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context23.next=508;break;case 507:purchaseVoucher[s].ledger={};case 508:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context23.next=511;return purchaseVoucher[s].Voucherip;case 511:if(!_context23.sent){_context23.next=515;break;}_context23.t26=purchaseVoucher[s].Voucherip;_context23.next=516;break;case 515:_context23.t26={};case 516:purchaseVoucher[s].Voucher=_context23.t26;purchaseVoucher[s].type='debit';_context23.next=520;return purchaseVoucher[s].total_amount;case 520:purchaseVoucher[s].debitAmount=_context23.sent;_context23.next=523;return 0;case 523:purchaseVoucher[s].creditAmount=_context23.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context23.next=527;return purchaseVoucher[s].Voucherip;case 527:if(!_context23.sent){_context23.next=531;break;}_context23.t27=purchaseVoucher[s].Voucherip.id;_context23.next=532;break;case 531:_context23.t27='';case 532:purchaseVoucher[s].voucher_number=_context23.t27;_context23.next=535;return purchaseVoucher[s].Voucherip;case 535:_context23.t28=_context23.sent;if(!_context23.t28){_context23.next=538;break;}_context23.t28=purchaseVoucher[s].Voucherip.invoice_id;case 538:if(!_context23.t28){_context23.next=542;break;}_context23.t29=purchaseVoucher[s].Voucherip.invoice_id;_context23.next=543;break;case 542:_context23.t29='';case 543:purchaseVoucher[s].invoice_id=_context23.t29;delete purchaseVoucher[s].Voucherip;_context23.next=547;return purchasearray.push(purchaseVoucher[s]);case 547:_context23.next=549;return array.push(purchaseVoucher[s]);case 549:_context23.next=603;break;case 551:_context23.next=553;return'purchase';case 553:purchaseVoucher[s].voucher_type=_context23.sent;if(!purchaseVoucher[s].Voucherip){_context23.next=561;break;}_context23.next=557;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 557:purchaseVoucher[s].ledger=_context23.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context23.next=562;break;case 561:purchaseVoucher[s].ledger={};case 562:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context23.next=565;return purchaseVoucher[s].Voucherip;case 565:if(!_context23.sent){_context23.next=569;break;}_context23.t30=purchaseVoucher[s].Voucherip;_context23.next=570;break;case 569:_context23.t30={};case 570:purchaseVoucher[s].Voucher=_context23.t30;purchaseVoucher[s].type='debit';_context23.next=574;return purchaseVoucher[s].total_amount;case 574:purchaseVoucher[s].debitAmount=_context23.sent;_context23.next=577;return 0;case 577:purchaseVoucher[s].creditAmount=_context23.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context23.next=581;return purchaseVoucher[s].Voucherip;case 581:if(!_context23.sent){_context23.next=585;break;}_context23.t31=purchaseVoucher[s].Voucherip.id;_context23.next=586;break;case 585:_context23.t31='';case 586:purchaseVoucher[s].voucher_number=_context23.t31;_context23.next=589;return purchaseVoucher[s].Voucherip;case 589:_context23.t32=_context23.sent;if(!_context23.t32){_context23.next=592;break;}_context23.t32=purchaseVoucher[s].Voucherip.invoice_id;case 592:if(!_context23.t32){_context23.next=596;break;}_context23.t33=purchaseVoucher[s].Voucherip.invoice_id;_context23.next=597;break;case 596:_context23.t33='';case 597:purchaseVoucher[s].invoice_id=_context23.t33;delete purchaseVoucher[s].Voucherip;_context23.next=601;return purchasearray.push(purchaseVoucher[s]);case 601:_context23.next=603;return array.push(purchaseVoucher[s]);case 603:_context23.next=686;break;case 605:if(!ledger.dataValues.tax_key){_context23.next=654;break;}_context23.next=608;return'purchase';case 608:purchaseVoucher[s].voucher_type=_context23.sent;if(!purchaseVoucher[s].taxp){_context23.next=616;break;}_context23.next=612;return purchaseVoucher[s].taxp.PurchaseLedger;case 612:purchaseVoucher[s].ledger=_context23.sent;delete purchaseVoucher[s].taxp.PurchaseLedger;_context23.next=617;break;case 616:purchaseVoucher[s].ledger={};case 617:_context23.next=619;return purchaseVoucher[s].taxp;case 619:if(!_context23.sent){_context23.next=623;break;}_context23.t34=purchaseVoucher[s].taxp;_context23.next=624;break;case 623:_context23.t34={};case 624:purchaseVoucher[s].Voucher=_context23.t34;purchaseVoucher[s].type='debit';_context23.next=628;return purchaseVoucher[s].amount;case 628:purchaseVoucher[s].debitAmount=_context23.sent;_context23.next=631;return 0;case 631:purchaseVoucher[s].creditAmount=_context23.sent;purchaseVoucher[s].amount=purchaseVoucher[s].amount;_context23.next=635;return purchaseVoucher[s].taxp;case 635:if(!_context23.sent){_context23.next=639;break;}_context23.t35=purchaseVoucher[s].taxp.id;_context23.next=640;break;case 639:_context23.t35='';case 640:purchaseVoucher[s].voucher_number=_context23.t35;_context23.next=643;return purchaseVoucher[s].taxp;case 643:if(!_context23.sent){_context23.next=647;break;}_context23.t36=purchaseVoucher[s].taxp.invoice_id<=9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):purchaseVoucher[s].taxp.invoice_id>9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id);_context23.next=648;break;case 647:_context23.t36='';case 648:purchaseVoucher[s].invoice_id=_context23.t36;delete purchaseVoucher[s].tax;_context23.next=652;return array.push(purchaseVoucher[s]);case 652:_context23.next=686;break;case 654:_context23.next=656;return'purchase';case 656:purchaseVoucher[s].voucher_type=_context23.sent;_context23.next=659;return purchaseVoucher[s].PurchaseLedger;case 659:purchaseVoucher[s].ledger=_context23.sent;_context23.next=662;return{};case 662:purchaseVoucher[s].Voucher=_context23.sent;purchaseVoucher[s].type='debit';_context23.next=666;return purchaseVoucher[s].total_amount;case 666:purchaseVoucher[s].debitAmount=_context23.sent;_context23.next=669;return 0;case 669:purchaseVoucher[s].creditAmount=_context23.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context23.next=673;return purchaseVoucher[s].id;case 673:purchaseVoucher[s].voucher_number=_context23.sent;_context23.next=676;return purchaseVoucher[s].invoice_id;case 676:_context23.t37=_context23.sent;if(!(_context23.t37<=9)){_context23.next=681;break;}_context23.t38="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context23.next=682;break;case 681:_context23.t38=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 682:purchaseVoucher[s].invoice_id=_context23.t38;delete purchaseVoucher[s].PurchaseLedger;_context23.next=686;return array.push(purchaseVoucher[s]);case 686:s++;_context23.next=441;break;case 689:if(!(creditVoucher&&creditVoucher.length>0)){_context23.next=825;break;}s=0;case 691:if(!(s<creditVoucher.length)){_context23.next=825;break;}if(!ledger.dataValues.sale_key){_context23.next=741;break;}_context23.next=695;return'Sale Return';case 695:creditVoucher[s].voucher_type=_context23.sent;if(!creditVoucher[s].Voucheric){_context23.next=703;break;}_context23.next=699;return creditVoucher[s].Voucheric.CreditBuyer;case 699:creditVoucher[s].ledger=_context23.sent;delete creditVoucher[s].Voucheric.CreditBuyer;_context23.next=704;break;case 703:creditVoucher[s].ledger={};case 704:_context23.next=706;return creditVoucher[s].Voucheric;case 706:if(!_context23.sent){_context23.next=710;break;}_context23.t39=creditVoucher[s].Voucheric;_context23.next=711;break;case 710:_context23.t39={};case 711:creditVoucher[s].Voucher=_context23.t39;creditVoucher[s].type='debit';_context23.next=715;return creditVoucher[s].total_amount;case 715:creditVoucher[s].debitAmount=_context23.sent;_context23.next=718;return 0;case 718:creditVoucher[s].creditAmount=_context23.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context23.next=722;return creditVoucher[s].Voucheric;case 722:if(!_context23.sent){_context23.next=726;break;}_context23.t40=creditVoucher[s].Voucheric.id;_context23.next=727;break;case 726:_context23.t40='';case 727:creditVoucher[s].voucher_number=_context23.t40;_context23.next=730;return creditVoucher[s].Voucheric;case 730:if(!_context23.sent){_context23.next=734;break;}_context23.t41=creditVoucher[s].Voucheric.invoice_id<=9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].Voucheric.invoice_id):creditVoucher[s].Voucheric.invoice_id>9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].Voucheric.invoice_id):"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/").concat(creditVoucher[s].Voucheric.invoice_id);_context23.next=735;break;case 734:_context23.t41='';case 735:creditVoucher[s].invoice_id=_context23.t41;delete creditVoucher[s].Voucheric;_context23.next=739;return array.push(creditVoucher[s]);case 739:_context23.next=822;break;case 741:if(!ledger.dataValues.tax_key){_context23.next=790;break;}_context23.next=744;return'Sale Return';case 744:creditVoucher[s].voucher_type=_context23.sent;if(!creditVoucher[s].taxc){_context23.next=752;break;}_context23.next=748;return creditVoucher[s].taxc.CreditBuyer;case 748:creditVoucher[s].ledger=_context23.sent;delete creditVoucher[s].taxc.CreditBuyer;_context23.next=753;break;case 752:creditVoucher[s].ledger={};case 753:_context23.next=755;return creditVoucher[s].taxc;case 755:if(!_context23.sent){_context23.next=759;break;}_context23.t42=creditVoucher[s].taxc;_context23.next=760;break;case 759:_context23.t42={};case 760:creditVoucher[s].Voucher=_context23.t42;creditVoucher[s].type='debit';_context23.next=764;return creditVoucher[s].amount;case 764:creditVoucher[s].debitAmount=_context23.sent;_context23.next=767;return 0;case 767:creditVoucher[s].creditAmount=_context23.sent;creditVoucher[s].amount=creditVoucher[s].amount;_context23.next=771;return creditVoucher[s].taxc;case 771:if(!_context23.sent){_context23.next=775;break;}_context23.t43=creditVoucher[s].taxc.id;_context23.next=776;break;case 775:_context23.t43='';case 776:creditVoucher[s].voucher_number=_context23.t43;_context23.next=779;return creditVoucher[s].taxc;case 779:if(!_context23.sent){_context23.next=783;break;}_context23.t44=creditVoucher[s].taxc.invoice_id<=9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].taxc.invoice_id):creditVoucher[s].taxc.invoice_id>9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].taxc.invoice_id):"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/").concat(creditVoucher[s].taxc.invoice_id);_context23.next=784;break;case 783:_context23.t44='';case 784:creditVoucher[s].invoice_id=_context23.t44;delete creditVoucher[s].taxc;_context23.next=788;return array.push(creditVoucher[s]);case 788:_context23.next=822;break;case 790:_context23.next=792;return'Sale Return';case 792:creditVoucher[s].voucher_type=_context23.sent;_context23.next=795;return creditVoucher[s].CreditBuyer;case 795:creditVoucher[s].ledger=_context23.sent;_context23.next=798;return{};case 798:creditVoucher[s].Voucher=_context23.sent;creditVoucher[s].type='debit';_context23.next=802;return creditVoucher[s].total_amount;case 802:creditVoucher[s].debitAmount=_context23.sent;_context23.next=805;return 0;case 805:creditVoucher[s].creditAmount=_context23.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context23.next=809;return creditVoucher[s].id;case 809:creditVoucher[s].voucher_number=_context23.sent;_context23.next=812;return creditVoucher[s].invoice_id;case 812:_context23.t45=_context23.sent;if(!(_context23.t45<=9)){_context23.next=817;break;}_context23.t46="".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/00").concat(creditVoucher[s].invoice_id);_context23.next=818;break;case 817:_context23.t46=creditVoucher[s].invoice_id>9?"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/0").concat(creditVoucher[s].invoice_id):"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/").concat(creditVoucher[s].invoice_id);case 818:creditVoucher[s].invoice_id=_context23.t46;delete creditVoucher[s].CreditBuyer;_context23.next=822;return array.push(creditVoucher[s]);case 822:s++;_context23.next=691;break;case 825:if(!(debitVoucher&&debitVoucher.length>0)){_context23.next=961;break;}s=0;case 827:if(!(s<debitVoucher.length)){_context23.next=961;break;}if(!ledger.dataValues.sale_key){_context23.next=877;break;}_context23.next=831;return'Purchase Return';case 831:debitVoucher[s].voucher_type=_context23.sent;if(!debitVoucher[s].Voucherid){_context23.next=839;break;}_context23.next=835;return debitVoucher[s].Voucherid.DebitBuyer;case 835:debitVoucher[s].ledger=_context23.sent;delete debitVoucher[s].Voucherid.DebitBuyer;_context23.next=840;break;case 839:debitVoucher[s].ledger={};case 840:_context23.next=842;return debitVoucher[s].Voucherid;case 842:if(!_context23.sent){_context23.next=846;break;}_context23.t47=debitVoucher[s].Voucherid;_context23.next=847;break;case 846:_context23.t47={};case 847:debitVoucher[s].Voucher=_context23.t47;debitVoucher[s].type='Credit';_context23.next=851;return 0;case 851:debitVoucher[s].debitAmount=_context23.sent;_context23.next=854;return debitVoucher[s].total_amount;case 854:debitVoucher[s].creditAmount=_context23.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context23.next=858;return debitVoucher[s].Voucherid;case 858:if(!_context23.sent){_context23.next=862;break;}_context23.t48=debitVoucher[s].Voucherid.id;_context23.next=863;break;case 862:_context23.t48='';case 863:debitVoucher[s].voucher_number=_context23.t48;_context23.next=866;return debitVoucher[s].Voucherid;case 866:if(!_context23.sent){_context23.next=870;break;}_context23.t49=debitVoucher[s].Voucherid.invoice_id<=9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].Voucherid.invoice_id):debitVoucher[s].Voucherid.invoice_id>9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].Voucherid.invoice_id):"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/").concat(debitVoucher[s].Voucherid.invoice_id);_context23.next=871;break;case 870:_context23.t49='';case 871:debitVoucher[s].invoice_id=_context23.t49;delete debitVoucher[s].Voucherid;_context23.next=875;return array.push(debitVoucher[s]);case 875:_context23.next=958;break;case 877:if(!ledger.dataValues.tax_key){_context23.next=926;break;}_context23.next=880;return'Purchase Return';case 880:debitVoucher[s].voucher_type=_context23.sent;if(!debitVoucher[s].taxd){_context23.next=888;break;}_context23.next=884;return debitVoucher[s].taxd.DebitBuyer;case 884:debitVoucher[s].ledger=_context23.sent;delete debitVoucher[s].taxd.DebitBuyer;_context23.next=889;break;case 888:debitVoucher[s].ledger={};case 889:_context23.next=891;return debitVoucher[s].taxd;case 891:if(!_context23.sent){_context23.next=895;break;}_context23.t50=debitVoucher[s].taxd;_context23.next=896;break;case 895:_context23.t50={};case 896:debitVoucher[s].Voucher=_context23.t50;debitVoucher[s].type='Credit';_context23.next=900;return 0;case 900:debitVoucher[s].debitAmount=_context23.sent;_context23.next=903;return debitVoucher[s].amount;case 903:debitVoucher[s].creditAmount=_context23.sent;debitVoucher[s].amount=debitVoucher[s].amount;_context23.next=907;return debitVoucher[s].taxd;case 907:if(!_context23.sent){_context23.next=911;break;}_context23.t51=debitVoucher[s].taxd.id;_context23.next=912;break;case 911:_context23.t51='';case 912:debitVoucher[s].voucher_number=_context23.t51;_context23.next=915;return debitVoucher[s].taxd;case 915:if(!_context23.sent){_context23.next=919;break;}_context23.t52=debitVoucher[s].taxd.invoice_id<=9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].taxd.invoice_id):debitVoucher[s].taxd.invoice_id>9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].taxd.invoice_id):"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/").concat(debitVoucher[s].taxd.invoice_id);_context23.next=920;break;case 919:_context23.t52='';case 920:debitVoucher[s].invoice_id=_context23.t52;delete debitVoucher[s].taxd;_context23.next=924;return array.push(debitVoucher[s]);case 924:_context23.next=958;break;case 926:_context23.next=928;return'Purchase Return';case 928:debitVoucher[s].voucher_type=_context23.sent;_context23.next=931;return debitVoucher[s].DebitBuyer;case 931:debitVoucher[s].ledger=_context23.sent;_context23.next=934;return{};case 934:debitVoucher[s].Voucher=_context23.sent;debitVoucher[s].type='Credit';_context23.next=938;return 0;case 938:debitVoucher[s].debitAmount=_context23.sent;_context23.next=941;return debitVoucher[s].total_amount;case 941:debitVoucher[s].creditAmount=_context23.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context23.next=945;return debitVoucher[s].id;case 945:debitVoucher[s].voucher_number=_context23.sent;_context23.next=948;return debitVoucher[s].invoice_id;case 948:_context23.t53=_context23.sent;if(!(_context23.t53<=9)){_context23.next=953;break;}_context23.t54="".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/00").concat(debitVoucher[s].invoice_id);_context23.next=954;break;case 953:_context23.t54=debitVoucher[s].invoice_id>9?"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/0").concat(debitVoucher[s].invoice_id):"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/").concat(debitVoucher[s].invoice_id);case 954:debitVoucher[s].invoice_id=_context23.t54;delete debitVoucher[s].DebitBuyer;_context23.next=958;return array.push(debitVoucher[s]);case 958:s++;_context23.next=827;break;case 961:if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context23.next=1016;break;}_salearray5=[];s=0;case 964:if(!(s<discountsaleVoucher.length)){_context23.next=1016;break;}_context23.next=967;return'sale';case 967:discountsaleVoucher[s].voucher_type=_context23.sent;_context23.next=970;return discountsaleVoucher[s].SalesDiscountLedger;case 970:discountsaleVoucher[s].ledger=_context23.sent;_context23.next=973;return{};case 973:discountsaleVoucher[s].Voucher=_context23.sent;discountsaleVoucher[s].type=discountsaleVoucher[s].discount&&Number(discountsaleVoucher[s].discount)>0?'Credit':'Debit';_context23.next=977;return discountsaleVoucher[s].discount;case 977:_context23.t55=_context23.sent;if(!_context23.t55){_context23.next=980;break;}_context23.t55=Number(discountsaleVoucher[s].discount)<0;case 980:if(!_context23.t55){_context23.next=984;break;}_context23.t56=-1*Number(discountsaleVoucher[s].discount);_context23.next=985;break;case 984:_context23.t56=0;case 985:discountsaleVoucher[s].debitAmount=_context23.t56;_context23.next=988;return discountsaleVoucher[s].discount;case 988:_context23.t57=_context23.sent;if(!_context23.t57){_context23.next=991;break;}_context23.t57=Number(discountsaleVoucher[s].discount)>0;case 991:if(!_context23.t57){_context23.next=995;break;}_context23.t58=Number(discountsaleVoucher[s].discount);_context23.next=996;break;case 995:_context23.t58=0;case 996:discountsaleVoucher[s].creditAmount=_context23.t58;discountsaleVoucher[s].amount=discountsaleVoucher[s].discount&&Number(discountsaleVoucher[s].discount)>0?Number(discountsaleVoucher[s].discount):Number(discountsaleVoucher[s].discount);_context23.next=1000;return discountsaleVoucher[s].id;case 1000:discountsaleVoucher[s].voucher_number=_context23.sent;_context23.next=1003;return discountsaleVoucher[s].invoice_id;case 1003:_context23.t59=_context23.sent;if(!(_context23.t59<=9)){_context23.next=1008;break;}_context23.t60="".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/00").concat(discountsaleVoucher[s].invoice_id);_context23.next=1009;break;case 1008:_context23.t60=discountsaleVoucher[s].invoice_id>9?"".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/0").concat(discountsaleVoucher[s].invoice_id):"".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/").concat(discountsaleVoucher[s].invoice_id);case 1009:discountsaleVoucher[s].invoice_id=_context23.t60;delete discountsaleVoucher[s].SalesDiscountLedger;_context23.next=1013;return array.push(discountsaleVoucher[s]);case 1013:s++;_context23.next=964;break;case 1016:if(!(discountpurchaseVoucher&&discountpurchaseVoucher.length>0)){_context23.next=1065;break;}_salearray6=[];s=0;case 1019:if(!(s<discountpurchaseVoucher.length)){_context23.next=1065;break;}_context23.next=1022;return'purchase';case 1022:discountpurchaseVoucher[s].voucher_type=_context23.sent;_context23.next=1025;return discountpurchaseVoucher[s].PurchaseDiscountLedger;case 1025:discountpurchaseVoucher[s].ledger=_context23.sent;_context23.next=1028;return{};case 1028:discountpurchaseVoucher[s].Voucher=_context23.sent;discountpurchaseVoucher[s].type=discountpurchaseVoucher[s].discount&&Number(discountpurchaseVoucher[s].discount)>0?'Debit':'Credit';_context23.next=1032;return discountpurchaseVoucher[s].discount;case 1032:_context23.t61=_context23.sent;if(!_context23.t61){_context23.next=1035;break;}_context23.t61=Number(discountpurchaseVoucher[s].discount)>0;case 1035:if(!_context23.t61){_context23.next=1039;break;}_context23.t62=Number(discountpurchaseVoucher[s].discount);_context23.next=1040;break;case 1039:_context23.t62=0;case 1040:discountpurchaseVoucher[s].debitAmount=_context23.t62;_context23.next=1043;return discountpurchaseVoucher[s].discount;case 1043:_context23.t63=_context23.sent;if(!_context23.t63){_context23.next=1046;break;}_context23.t63=Number(discountpurchaseVoucher[s].discount)<0;case 1046:if(!_context23.t63){_context23.next=1050;break;}_context23.t64=-1*Number(discountpurchaseVoucher[s].discount);_context23.next=1051;break;case 1050:_context23.t64=0;case 1051:discountpurchaseVoucher[s].creditAmount=_context23.t64;discountpurchaseVoucher[s].amount=discountpurchaseVoucher[s].discount&&Number(discountpurchaseVoucher[s].discount)>0?Number(discountpurchaseVoucher[s].discount):Number(discountpurchaseVoucher[s].discount);_context23.next=1055;return discountpurchaseVoucher[s].id;case 1055:discountpurchaseVoucher[s].voucher_number=_context23.sent;_context23.next=1058;return discountpurchaseVoucher[s].invoice_id;case 1058:discountpurchaseVoucher[s].invoice_id=_context23.sent;delete discountpurchaseVoucher[s].PurchaseDiscountLedger;_context23.next=1062;return array.push(discountpurchaseVoucher[s]);case 1062:s++;_context23.next=1019;break;case 1065:if(!(discountcreditVoucher&&discountcreditVoucher.length>0)){_context23.next=1123;break;}_salearray7=[];s=0;case 1068:if(!(s<discountcreditVoucher.length)){_context23.next=1123;break;}_context23.next=1071;return'sales return';case 1071:discountcreditVoucher[s].voucher_type=_context23.sent;_context23.next=1074;return discountcreditVoucher[s].CreditDiscountLedger;case 1074:discountcreditVoucher[s].ledger=_context23.sent;_context23.next=1077;return{};case 1077:discountcreditVoucher[s].Voucher=_context23.sent;discountcreditVoucher[s].type=discountcreditVoucher[s].discount&&Number(discountcreditVoucher[s].discount)>0?'Debit':'Credit';_context23.next=1081;return discountcreditVoucher[s].discount;case 1081:_context23.t65=_context23.sent;if(!_context23.t65){_context23.next=1084;break;}_context23.t65=Number(discountcreditVoucher[s].discount)>0;case 1084:if(!_context23.t65){_context23.next=1088;break;}_context23.t66=Number(discountcreditVoucher[s].discount);_context23.next=1089;break;case 1088:_context23.t66=0;case 1089:discountcreditVoucher[s].debitAmount=_context23.t66;_context23.next=1092;return discountcreditVoucher[s].discount;case 1092:_context23.t67=_context23.sent;if(!_context23.t67){_context23.next=1095;break;}_context23.t67=Number(discountcreditVoucher[s].discount)<0;case 1095:if(!_context23.t67){_context23.next=1099;break;}_context23.t68=-1*Number(discountcreditVoucher[s].discount);_context23.next=1100;break;case 1099:_context23.t68=0;case 1100:discountcreditVoucher[s].creditAmount=_context23.t68;discountcreditVoucher[s].amount=discountcreditVoucher[s].discount&&Number(discountcreditVoucher[s].discount)>0?Number(discountcreditVoucher[s].discount):Number(discountcreditVoucher[s].discount);_context23.next=1104;return discountcreditVoucher[s].invoice_id;case 1104:_context23.t69=_context23.sent;if(!(_context23.t69<=9)){_context23.next=1109;break;}_context23.t70="".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/00").concat(discountcreditVoucher[s].invoice_id);_context23.next=1110;break;case 1109:_context23.t70=discountcreditVoucher[s].invoice_id>9?"".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/0").concat(discountcreditVoucher[s].invoice_id):"".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/").concat(discountcreditVoucher[s].invoice_id);case 1110:discountcreditVoucher[s].invoice_id=_context23.t70;_context23.next=1113;return discountcreditVoucher[s].id;case 1113:discountcreditVoucher[s].voucher_number=_context23.sent;_context23.next=1116;return discountcreditVoucher[s].invoice_id;case 1116:discountcreditVoucher[s].invoice_id=_context23.sent;delete discountcreditVoucher[s].CreditDiscountLedger;_context23.next=1120;return array.push(discountcreditVoucher[s]);case 1120:s++;_context23.next=1068;break;case 1123:if(!(discountdebitVoucher&&discountdebitVoucher.length>0)){_context23.next=1178;break;}_salearray8=[];s=0;case 1126:if(!(s<discountdebitVoucher.length)){_context23.next=1178;break;}_context23.next=1129;return'purchase return';case 1129:discountdebitVoucher[s].voucher_type=_context23.sent;_context23.next=1132;return discountdebitVoucher[s].DebitDiscountLedger;case 1132:discountdebitVoucher[s].ledger=_context23.sent;_context23.next=1135;return{};case 1135:discountdebitVoucher[s].Voucher=_context23.sent;discountdebitVoucher[s].type=discountdebitVoucher[s].discount&&Number(discountdebitVoucher[s].discount)>0?'Credit':'debit';_context23.next=1139;return discountdebitVoucher[s].discount;case 1139:_context23.t71=_context23.sent;if(!_context23.t71){_context23.next=1142;break;}_context23.t71=Number(discountdebitVoucher[s].discount)<0;case 1142:if(!_context23.t71){_context23.next=1146;break;}_context23.t72=-1*Number(discountdebitVoucher[s].discount);_context23.next=1147;break;case 1146:_context23.t72=0;case 1147:discountdebitVoucher[s].debitAmount=_context23.t72;_context23.next=1150;return discountdebitVoucher[s].discount;case 1150:_context23.t73=_context23.sent;if(!_context23.t73){_context23.next=1153;break;}_context23.t73=Number(discountdebitVoucher[s].discount)>0;case 1153:if(!_context23.t73){_context23.next=1157;break;}_context23.t74=Number(discountdebitVoucher[s].discount);_context23.next=1158;break;case 1157:_context23.t74=0;case 1158:discountdebitVoucher[s].creditAmount=_context23.t74;discountdebitVoucher[s].amount=discountdebitVoucher[s].discount&&Number(discountdebitVoucher[s].discount)>0?Number(discountdebitVoucher[s].discount):Number(discountdebitVoucher[s].discount);_context23.next=1162;return discountdebitVoucher[s].id;case 1162:discountdebitVoucher[s].voucher_number=_context23.sent;_context23.next=1165;return discountdebitVoucher[s].invoice_id;case 1165:_context23.t75=_context23.sent;if(!(_context23.t75<=9)){_context23.next=1170;break;}_context23.t76="".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/00").concat(discountdebitVoucher[s].invoice_id);_context23.next=1171;break;case 1170:_context23.t76=discountdebitVoucher[s].invoice_id>9?"".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/0").concat(discountdebitVoucher[s].invoice_id):"".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/").concat(discountdebitVoucher[s].invoice_id);case 1171:discountdebitVoucher[s].invoice_id=_context23.t76;delete discountdebitVoucher[s].DebitDiscountLedger;_context23.next=1175;return array.push(discountdebitVoucher[s]);case 1175:s++;_context23.next=1126;break;case 1178:if(!(recieptVoucher&&recieptVoucher.length>0)){_context23.next=1223;break;}i=0;case 1180:if(!(i<recieptVoucher.length)){_context23.next=1223;break;}_context23.next=1183;return recieptVoucher[i].type;case 1183:_context23.t77=_context23.sent;if(!(_context23.t77==='debit')){_context23.next=1193;break;}_context23.next=1187;return recieptVoucher[i].total_amount;case 1187:recieptVoucher[i].debitAmount=_context23.sent;_context23.next=1190;return 0;case 1190:recieptVoucher[i].creditAmount=_context23.sent;_context23.next=1199;break;case 1193:_context23.next=1195;return 0;case 1195:recieptVoucher[i].debitAmount=_context23.sent;_context23.next=1198;return recieptVoucher[i].total_amount;case 1198:recieptVoucher[i].creditAmount=_context23.sent;case 1199:_context23.next=1201;return recieptVoucher[i].ReciptBuyer;case 1201:recieptVoucher[i].ledger=_context23.sent;delete recieptVoucher[i].ReciptBuyer;_context23.next=1205;return'reciept';case 1205:recieptVoucher[i].voucher_type=_context23.sent;_context23.next=1208;return recieptVoucher[i].id;case 1208:recieptVoucher[i].voucher_number=_context23.sent;_context23.next=1211;return recieptVoucher[i].invoice_id;case 1211:_context23.t78=_context23.sent;if(!(_context23.t78<=9)){_context23.next=1216;break;}_context23.t79="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context23.next=1217;break;case 1216:_context23.t79=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 1217:recieptVoucher[i].invoice_id=_context23.t79;_context23.next=1220;return array.push(recieptVoucher[i]);case 1220:i++;_context23.next=1180;break;case 1223:if(!(paymentVoucher&&paymentVoucher.length>0)){_context23.next=1268;break;}i=0;case 1225:if(!(i<paymentVoucher.length)){_context23.next=1268;break;}_context23.next=1228;return paymentVoucher[i].type;case 1228:_context23.t80=_context23.sent;if(!(_context23.t80==='debit')){_context23.next=1238;break;}_context23.next=1232;return paymentVoucher[i].total_amount;case 1232:paymentVoucher[i].debitAmount=_context23.sent;_context23.next=1235;return 0;case 1235:paymentVoucher[i].creditAmount=_context23.sent;_context23.next=1244;break;case 1238:_context23.next=1240;return 0;case 1240:paymentVoucher[i].debitAmount=_context23.sent;_context23.next=1243;return paymentVoucher[i].total_amount;case 1243:paymentVoucher[i].creditAmount=_context23.sent;case 1244:_context23.next=1246;return paymentVoucher[i].PaymentBuyer;case 1246:paymentVoucher[i].ledger=_context23.sent;delete paymentVoucher[i].PaymentBuyer;_context23.next=1250;return'payment';case 1250:paymentVoucher[i].voucher_type=_context23.sent;_context23.next=1253;return paymentVoucher[i].id;case 1253:paymentVoucher[i].voucher_number=_context23.sent;_context23.next=1256;return paymentVoucher[i].invoice_id;case 1256:_context23.t81=_context23.sent;if(!(_context23.t81<=9)){_context23.next=1261;break;}_context23.t82="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context23.next=1262;break;case 1261:_context23.t82=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 1262:paymentVoucher[i].invoice_id=_context23.t82;_context23.next=1265;return array.push(paymentVoucher[i]);case 1265:i++;_context23.next=1225;break;case 1268:if(!(reciverrecieptVoucher&&reciverrecieptVoucher.length>0)){_context23.next=1302;break;}i=0;case 1270:if(!(i<reciverrecieptVoucher.length)){_context23.next=1302;break;}_context23.next=1273;return reciverrecieptVoucher[i].total_amount;case 1273:reciverrecieptVoucher[i].debitAmount=_context23.sent;_context23.next=1276;return 0;case 1276:reciverrecieptVoucher[i].creditAmount=_context23.sent;_context23.next=1279;return reciverrecieptVoucher[i].ReciptReciver;case 1279:reciverrecieptVoucher[i].ledger=_context23.sent;delete reciverrecieptVoucher[i].ReciptReciver;_context23.next=1283;return'reciept reciver';case 1283:reciverrecieptVoucher[i].voucher_type=_context23.sent;_context23.next=1286;return reciverrecieptVoucher[i].id;case 1286:reciverrecieptVoucher[i].voucher_number=_context23.sent;_context23.next=1289;return reciverrecieptVoucher[i].invoice_id;case 1289:_context23.t83=_context23.sent;if(!(_context23.t83<=9)){_context23.next=1294;break;}_context23.t84="".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverrecieptVoucher[i].invoice_id);_context23.next=1295;break;case 1294:_context23.t84=reciverrecieptVoucher[i].invoice_id>9?"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverrecieptVoucher[i].invoice_id):"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/").concat(reciverrecieptVoucher[i].invoice_id);case 1295:reciverrecieptVoucher[i].invoice_id=_context23.t84;reciverrecieptVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context23.next=1299;return array.push(reciverrecieptVoucher[i]);case 1299:i++;_context23.next=1270;break;case 1302:if(!(reciverpaymentVoucher&&reciverpaymentVoucher.length>0)){_context23.next=1336;break;}i=0;case 1304:if(!(i<reciverpaymentVoucher.length)){_context23.next=1336;break;}_context23.next=1307;return 0;case 1307:reciverpaymentVoucher[i].debitAmount=_context23.sent;_context23.next=1310;return reciverpaymentVoucher[i].total_amount;case 1310:reciverpaymentVoucher[i].creditAmount=_context23.sent;_context23.next=1313;return reciverpaymentVoucher[i].PaymentReciver;case 1313:reciverpaymentVoucher[i].ledger=_context23.sent;delete reciverpaymentVoucher[i].PaymentReciver;_context23.next=1317;return'payment reciver';case 1317:reciverpaymentVoucher[i].voucher_type=_context23.sent;_context23.next=1320;return reciverpaymentVoucher[i].id;case 1320:reciverpaymentVoucher[i].voucher_number=_context23.sent;_context23.next=1323;return reciverpaymentVoucher[i].invoice_id;case 1323:_context23.t85=_context23.sent;if(!(_context23.t85<=9)){_context23.next=1328;break;}_context23.t86="".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverpaymentVoucher[i].invoice_id);_context23.next=1329;break;case 1328:_context23.t86=reciverpaymentVoucher[i].invoice_id>9?"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverpaymentVoucher[i].invoice_id):"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/").concat(reciverpaymentVoucher[i].invoice_id);case 1329:reciverpaymentVoucher[i].invoice_id=_context23.t86;reciverpaymentVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context23.next=1333;return array.push(reciverpaymentVoucher[i]);case 1333:i++;_context23.next=1304;break;case 1336:_context23.next=1338;return(0,_arraySort["default"])(array,'invoice_date');case 1338:mainArray=_context23.sent;//array.sort((a, b) => new Date(b.invoice_date) - new Date(a.invoice_date));
creditamount=0;debetamount=0;totalbalnce=0;_context23.next=1344;return mainArray.map(function(item){if(item.creditAmount){creditamount=creditamount+Number(item.creditAmount);}else if(item.debitAmount){debetamount=debetamount+Number(item.debitAmount);}});case 1344:totalbalnce=Number(Number(openingbalncecredit)+Number(creditamount))-Number(Number(debetamount)+Number(openingbalncedebit));return _context23.abrupt("return",totalbalnce);case 1348:_context23.next=1353;break;case 1350:_context23.prev=1350;_context23.t87=_context23["catch"](0);console.log("e",_context23.t87);// return {
//     statusCode: res.statusCode,
//     success: false,
//     error: e,
//     message: "Something went wrong!"
// }
case 1353:case"end":return _context23.stop();}},_callee21,null,[[0,1350]]);}));return _getAllLedgerVoucherprivious.apply(this,arguments);}function getAllLedgerVouchercurrent(_x26,_x27,_x28,_x29,_x30,_x31,_x32){return _getAllLedgerVouchercurrent.apply(this,arguments);}function _getAllLedgerVouchercurrent(){_getAllLedgerVouchercurrent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee22(start_date,end_date,ledger_id,company_id,openingbalncecredit,openingbalncedebit,email){var currentyear,journalVoucher,saleVoucher,purchaseVoucher,creditVoucher,debitVoucher,recieptVoucher,paymentVoucher,discountsaleVoucher,discountdebitVoucher,discountpurchaseVoucher,discountcreditVoucher,reciverrecieptVoucher,reciverpaymentVoucher,ledger,_invoice_date127,_invoice_date128,_invoice_date102,_invoice_date103,_invoice_date104,_invoice_date105,_invoice_date106,_invoice_date107,_invoice_date108,_invoice_date109,_invoice_date110,_invoice_date111,_invoice_date112,_invoice_date113,_invoice_date114,_invoice_date115,_invoice_date116,_invoice_date117,_invoice_date118,_invoice_date119,_invoice_date120,_invoice_date121,_invoice_date122,_invoice_date123,_invoice_date124,_invoice_date125,_invoice_date126,array,i,salearray,s,findSales,purchasearray,_findSales3,_salearray9,_salearray10,_salearray11,_salearray12,mainArray,creditamount,debetamount,totalbalnce;return _regeneratorRuntime().wrap(function _callee22$(_context24){while(1)switch(_context24.prev=_context24.next){case 0:_context24.prev=0;currentyear=new Date(start_date).getFullYear();end_date=start_date;start_date="".concat(currentyear,"-04-01");// console.log("start_date", new Date(start_date))
reciverpaymentVoucher=[];_context24.next=7;return _ledger["default"].findOne({where:{uid:ledger_id,company_id:company_id},include:[{model:_accountGroup["default"]}]});case 7:ledger=_context24.sent;if(!(ledger&&ledger.dataValues.id)){_context24.next=1352;break;}if(!ledger.dataValues.tax_key){_context24.next=33;break;}_context24.next=12;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Sales'},{invoice_date:(_invoice_date102={},_defineProperty(_invoice_date102,Op.gte,start_date),_defineProperty(_invoice_date102,Op.lt,end_date),_invoice_date102)}]),include:[{model:_saleVoucher["default"],as:'tax',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 12:saleVoucher=_context24.sent;_context24.next=15;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Purchase'},{invoice_date:(_invoice_date103={},_defineProperty(_invoice_date103,Op.gte,start_date),_defineProperty(_invoice_date103,Op.lt,end_date),_invoice_date103)}]),include:[{model:_purchaseVoucher["default"],as:'taxp',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 15:purchaseVoucher=_context24.sent;_context24.next=18;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Debit'},{invoice_date:(_invoice_date104={},_defineProperty(_invoice_date104,Op.gte,start_date),_defineProperty(_invoice_date104,Op.lt,end_date),_invoice_date104)}]),include:[{model:_creditVoucher["default"],as:'taxc',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 18:creditVoucher=_context24.sent;_context24.next=21;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Credit'},{invoice_date:(_invoice_date105={},_defineProperty(_invoice_date105,Op.gte,start_date),_defineProperty(_invoice_date105,Op.lt,end_date),_invoice_date105)}]),include:[{model:_debitVoucher["default"],as:'taxd',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 21:debitVoucher=_context24.sent;_context24.next=24;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:(_invoice_date106={},_defineProperty(_invoice_date106,Op.gte,start_date),_defineProperty(_invoice_date106,Op.lt,end_date),_invoice_date106)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 24:journalVoucher=_context24.sent;_context24.next=27;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date107={},_defineProperty(_invoice_date107,Op.gte,start_date),_defineProperty(_invoice_date107,Op.lt,end_date),_invoice_date107)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 27:recieptVoucher=_context24.sent;_context24.next=30;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date108={},_defineProperty(_invoice_date108,Op.gte,start_date),_defineProperty(_invoice_date108,Op.lt,end_date),_invoice_date108)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 30:paymentVoucher=_context24.sent;_context24.next=90;break;case 33:if(!ledger.dataValues.sale_key){_context24.next=57;break;}_context24.next=36;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Sales'},{invoice_date:(_invoice_date109={},_defineProperty(_invoice_date109,Op.gte,start_date),_defineProperty(_invoice_date109,Op.lt,end_date),_invoice_date109)}]),include:[{model:_saleVoucher["default"],as:'Voucheris',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 36:saleVoucher=_context24.sent;_context24.next=39;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Purchase'},{invoice_date:(_invoice_date110={},_defineProperty(_invoice_date110,Op.gte,start_date),_defineProperty(_invoice_date110,Op.lt,end_date),_invoice_date110)}]),include:[{model:_purchaseVoucher["default"],as:'Voucherip',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 39:purchaseVoucher=_context24.sent;_context24.next=42;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Debit'},{invoice_date:(_invoice_date111={},_defineProperty(_invoice_date111,Op.gte,start_date),_defineProperty(_invoice_date111,Op.lt,end_date),_invoice_date111)}]),include:[{model:_creditVoucher["default"],as:'Voucheric',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 42:creditVoucher=_context24.sent;_context24.next=45;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Credit'},{invoice_date:(_invoice_date112={},_defineProperty(_invoice_date112,Op.gte,start_date),_defineProperty(_invoice_date112,Op.lt,end_date),_invoice_date112)}]),include:[{model:_debitVoucher["default"],as:'Voucherid',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 45:debitVoucher=_context24.sent;_context24.next=48;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:(_invoice_date113={},_defineProperty(_invoice_date113,Op.gte,start_date),_defineProperty(_invoice_date113,Op.lt,end_date),_invoice_date113)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 48:journalVoucher=_context24.sent;_context24.next=51;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date114={},_defineProperty(_invoice_date114,Op.gte,start_date),_defineProperty(_invoice_date114,Op.lt,end_date),_invoice_date114)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 51:recieptVoucher=_context24.sent;_context24.next=54;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date115={},_defineProperty(_invoice_date115,Op.gte,start_date),_defineProperty(_invoice_date115,Op.lt,end_date),_invoice_date115)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 54:paymentVoucher=_context24.sent;_context24.next=90;break;case 57:_context24.next=59;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:(_invoice_date116={},_defineProperty(_invoice_date116,Op.gte,start_date),_defineProperty(_invoice_date116,Op.lte,end_date),_invoice_date116)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 59:journalVoucher=_context24.sent;_context24.next=62;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:(_invoice_date117={},_defineProperty(_invoice_date117,Op.gte,start_date),_defineProperty(_invoice_date117,Op.lt,end_date),_invoice_date117)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 62:saleVoucher=_context24.sent;_context24.next=65;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:(_invoice_date118={},_defineProperty(_invoice_date118,Op.gte,start_date),_defineProperty(_invoice_date118,Op.lt,end_date),_invoice_date118)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 65:purchaseVoucher=_context24.sent;_context24.next=68;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:(_invoice_date119={},_defineProperty(_invoice_date119,Op.gte,start_date),_defineProperty(_invoice_date119,Op.lt,end_date),_invoice_date119)}]),include:[{model:_ledger["default"],as:'CreditBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 68:creditVoucher=_context24.sent;_context24.next=71;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:(_invoice_date120={},_defineProperty(_invoice_date120,Op.gte,start_date),_defineProperty(_invoice_date120,Op.lt,end_date),_invoice_date120)}]),include:[{model:_ledger["default"],as:'DebitBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 71:debitVoucher=_context24.sent;_context24.next=74;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date121={},_defineProperty(_invoice_date121,Op.gte,start_date),_defineProperty(_invoice_date121,Op.lt,end_date),_invoice_date121)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 74:recieptVoucher=_context24.sent;_context24.next=77;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date122={},_defineProperty(_invoice_date122,Op.gte,start_date),_defineProperty(_invoice_date122,Op.lt,end_date),_invoice_date122)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 77:paymentVoucher=_context24.sent;_context24.next=80;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date123={},_defineProperty(_invoice_date123,Op.gte,start_date),_defineProperty(_invoice_date123,Op.lt,end_date),_invoice_date123)}]),include:[{model:_ledger["default"],as:'SalesDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 80:discountsaleVoucher=_context24.sent;_context24.next=83;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date124={},_defineProperty(_invoice_date124,Op.gte,start_date),_defineProperty(_invoice_date124,Op.lt,end_date),_invoice_date124)}]),include:[{model:_ledger["default"],as:'PurchaseDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 83:discountpurchaseVoucher=_context24.sent;_context24.next=86;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date125={},_defineProperty(_invoice_date125,Op.gte,start_date),_defineProperty(_invoice_date125,Op.lt,end_date),_invoice_date125)}]),include:[{model:_ledger["default"],as:'CreditDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 86:discountcreditVoucher=_context24.sent;_context24.next=89;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date126={},_defineProperty(_invoice_date126,Op.gte,start_date),_defineProperty(_invoice_date126,Op.lt,end_date),_invoice_date126)}]),include:[{model:_ledger["default"],as:'DebitDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 89:discountdebitVoucher=_context24.sent;case 90:_context24.next=92;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{receive_id:ledger_id},{invoice_date:(_invoice_date127={},_defineProperty(_invoice_date127,Op.gte,start_date),_defineProperty(_invoice_date127,Op.lt,end_date),_invoice_date127)}]),include:[{model:_ledger["default"],as:'ReciptReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 92:reciverrecieptVoucher=_context24.sent;_context24.next=95;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{receive_id:ledger_id},{invoice_date:(_invoice_date128={},_defineProperty(_invoice_date128,Op.gte,start_date),_defineProperty(_invoice_date128,Op.lt,end_date),_invoice_date128)}]),include:[{model:_ledger["default"],as:'PaymentReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 95:reciverpaymentVoucher=_context24.sent;_context24.next=98;return(0,_ledger2.decreption)(ledger,'object',email);case 98:ledger=_context24.sent;_context24.next=101;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',email);case 101:journalVoucher=_context24.sent;_context24.next=104;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',email);case 104:recieptVoucher=_context24.sent;_context24.next=107;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',email);case 107:paymentVoucher=_context24.sent;_context24.next=110;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',email);case 110:saleVoucher=_context24.sent;_context24.next=113;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',email);case 113:purchaseVoucher=_context24.sent;_context24.next=116;return(0,_creditvoucher.decreptionCredit)(creditVoucher,'array',email);case 116:creditVoucher=_context24.sent;_context24.next=119;return(0,_debitvoucher.decreptionDebit)(debitVoucher,'array',email);case 119:debitVoucher=_context24.sent;_context24.next=122;return(0,_receiptvoucher.decreptionReceipt)(reciverrecieptVoucher,'array',email);case 122:reciverrecieptVoucher=_context24.sent;_context24.next=125;return(0,_paymentvoucher.decreptionPayment)(reciverpaymentVoucher,'array',email);case 125:reciverpaymentVoucher=_context24.sent;if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context24.next=130;break;}_context24.next=129;return(0,_salesvoucher.decreptionSale)(discountsaleVoucher,'array',email);case 129:discountsaleVoucher=_context24.sent;case 130:if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context24.next=134;break;}_context24.next=133;return(0,_purchasevoucher.decreptionPurchase)(discountpurchaseVoucher,'array',email);case 133:discountpurchaseVoucher=_context24.sent;case 134:if(!(discountcreditVoucher&&discountcreditVoucher.length>0)){_context24.next=138;break;}_context24.next=137;return(0,_creditvoucher.decreptionCredit)(discountcreditVoucher,'array',email);case 137:discountcreditVoucher=_context24.sent;case 138:if(!(discountdebitVoucher&&discountdebitVoucher.length>0)){_context24.next=142;break;}_context24.next=141;return(0,_debitvoucher.decreptionDebit)(discountdebitVoucher,'array',email);case 141:discountdebitVoucher=_context24.sent;case 142:_context24.next=144;return[];case 144:array=_context24.sent;if(!(journalVoucher&&journalVoucher.length>0)){_context24.next=199;break;}i=0;case 147:if(!(i<journalVoucher.length)){_context24.next=199;break;}_context24.next=150;return journalVoucher[i].type;case 150:_context24.t0=_context24.sent;if(!(_context24.t0==='debit')){_context24.next=160;break;}_context24.next=154;return journalVoucher[i].amount;case 154:journalVoucher[i].debitAmount=_context24.sent;_context24.next=157;return 0;case 157:journalVoucher[i].creditAmount=_context24.sent;_context24.next=166;break;case 160:_context24.next=162;return 0;case 162:journalVoucher[i].debitAmount=_context24.sent;_context24.next=165;return journalVoucher[i].amount;case 165:journalVoucher[i].creditAmount=_context24.sent;case 166:if(!journalVoucher[i].Voucher){_context24.next=184;break;}_context24.next=169;return journalVoucher[i].Voucher.invoice_date;case 169:journalVoucher[i].invoice_date=_context24.sent;_context24.next=172;return journalVoucher[i].Voucher.id;case 172:journalVoucher[i].voucher_number=_context24.sent;_context24.next=175;return journalVoucher[i].Voucher.invoice_id;case 175:_context24.t1=_context24.sent;if(!(_context24.t1<=9)){_context24.next=180;break;}_context24.t2="".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(journalVoucher[i].Voucher.invoice_id);_context24.next=181;break;case 180:_context24.t2=journalVoucher[i].Voucher.invoice_id>9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(journalVoucher[i].Voucher.invoice_id):"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(journalVoucher[i].Voucher.invoice_id);case 181:journalVoucher[i].invoice_id=_context24.t2;_context24.next=187;break;case 184:journalVoucher[i].invoice_date='';journalVoucher[i].voucher_number='';journalVoucher[i].invoice_id='';case 187:_context24.next=189;return'journal';case 189:journalVoucher[i].voucher_type=_context24.sent;_context24.next=192;return journalVoucher[i].VoucherLedger;case 192:journalVoucher[i].ledger=_context24.sent;delete journalVoucher[i].VoucherLedger;_context24.next=196;return array.push(journalVoucher[i]);case 196:i++;_context24.next=147;break;case 199:if(!(saleVoucher&&saleVoucher.length>0)){_context24.next=442;break;}salearray=[];s=0;case 202:if(!(s<saleVoucher.length)){_context24.next=442;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context24.next=250;break;}_context24.next=206;return'sale';case 206:saleVoucher[s].voucher_type=_context24.sent;_context24.next=209;return saleVoucher[s].RoundOff;case 209:saleVoucher[s].ledger=_context24.sent;_context24.next=212;return{};case 212:saleVoucher[s].Voucher=_context24.sent;saleVoucher[s].type=saleVoucher[s].roundoff_type;_context24.next=216;return saleVoucher[s].roundoff_type;case 216:_context24.t3=_context24.sent;if(!(_context24.t3=="debit")){_context24.next=221;break;}_context24.t4=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context24.next=222;break;case 221:_context24.t4=0;case 222:saleVoucher[s].debitAmount=_context24.t4;_context24.next=225;return saleVoucher[s].roundoff_type;case 225:_context24.t5=_context24.sent;if(!(_context24.t5=="credit")){_context24.next=230;break;}_context24.t6=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context24.next=231;break;case 230:_context24.t6=0;case 231:saleVoucher[s].creditAmount=_context24.t6;saleVoucher[s].amount=saleVoucher[s].roundoff_value;_context24.next=235;return saleVoucher[s].id;case 235:saleVoucher[s].voucher_number=_context24.sent;_context24.next=238;return saleVoucher[s].invoice_id;case 238:_context24.t7=_context24.sent;if(!(_context24.t7<=9)){_context24.next=243;break;}_context24.t8="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context24.next=244;break;case 243:_context24.t8=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(ssaleVoucher[s].invoice_id);case 244:saleVoucher[s].invoice_id=_context24.t8;delete saleVoucher[s].RoundOff;_context24.next=248;return array.push(saleVoucher[s]);case 248:_context24.next=439;break;case 250:if(!ledger.dataValues.sale_key){_context24.next=358;break;}if(!(salearray.length>0)){_context24.next=309;break;}console.log("saleVoucher[s]",saleVoucher[s]);_context24.next=255;return salearray.find(function(it){return saleVoucher[s].Voucheris&&it.invoice_idold==saleVoucher[s].Voucheris.invoice_id;});case 255:findSales=_context24.sent;if(!(findSales&&findSales.Voucher)){_context24.next=259;break;}_context24.next=307;break;case 259:_context24.next=261;return'sale';case 261:saleVoucher[s].voucher_type=_context24.sent;if(!saleVoucher[s].Voucheris){_context24.next=269;break;}_context24.next=265;return saleVoucher[s].Voucheris.SalesLedger;case 265:saleVoucher[s].ledger=_context24.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context24.next=270;break;case 269:saleVoucher[s].ledger={};case 270:_context24.next=272;return saleVoucher[s].Voucheris;case 272:if(!_context24.sent){_context24.next=276;break;}_context24.t9=saleVoucher[s].Voucheris;_context24.next=277;break;case 276:_context24.t9={};case 277:saleVoucher[s].Voucher=_context24.t9;saleVoucher[s].type='credit';_context24.next=281;return 0;case 281:saleVoucher[s].debitAmount=_context24.sent;_context24.next=284;return saleVoucher[s].total_amount;case 284:saleVoucher[s].creditAmount=_context24.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context24.next=288;return saleVoucher[s].Voucheris;case 288:if(!_context24.sent){_context24.next=292;break;}_context24.t10=saleVoucher[s].Voucheris.id;_context24.next=293;break;case 292:_context24.t10='';case 293:saleVoucher[s].voucher_number=_context24.t10;_context24.next=296;return saleVoucher[s].Voucheris;case 296:if(!_context24.sent){_context24.next=300;break;}_context24.t11=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context24.next=301;break;case 300:_context24.t11='';case 301:saleVoucher[s].invoice_id=_context24.t11;delete saleVoucher[s].Voucheris;_context24.next=305;return salearray.push(saleVoucher[s]);case 305:_context24.next=307;return array.push(saleVoucher[s]);case 307:_context24.next=356;break;case 309:_context24.next=311;return'sale';case 311:saleVoucher[s].voucher_type=_context24.sent;if(!saleVoucher[s].Voucheris){_context24.next=319;break;}_context24.next=315;return saleVoucher[s].Voucheris.SalesLedger;case 315:saleVoucher[s].ledger=_context24.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context24.next=320;break;case 319:saleVoucher[s].ledger={};case 320:_context24.next=322;return saleVoucher[s].Voucheris;case 322:if(!_context24.sent){_context24.next=326;break;}_context24.t12=saleVoucher[s].Voucheris;_context24.next=327;break;case 326:_context24.t12={};case 327:saleVoucher[s].Voucher=_context24.t12;saleVoucher[s].type='credit';_context24.next=331;return 0;case 331:saleVoucher[s].debitAmount=_context24.sent;_context24.next=334;return saleVoucher[s].total_amount;case 334:saleVoucher[s].creditAmount=_context24.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context24.next=338;return saleVoucher[s].Voucheris;case 338:if(!_context24.sent){_context24.next=342;break;}_context24.t13=saleVoucher[s].Voucheris.id;_context24.next=343;break;case 342:_context24.t13='';case 343:saleVoucher[s].voucher_number=_context24.t13;_context24.next=346;return saleVoucher[s].Voucheris;case 346:if(!_context24.sent){_context24.next=350;break;}_context24.t14=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context24.next=351;break;case 350:_context24.t14='';case 351:saleVoucher[s].invoice_id=_context24.t14;_context24.next=354;return salearray.push(saleVoucher[s]);case 354:_context24.next=356;return array.push(saleVoucher[s]);case 356:_context24.next=439;break;case 358:if(!ledger.dataValues.tax_key){_context24.next=407;break;}_context24.next=361;return'sale';case 361:saleVoucher[s].voucher_type=_context24.sent;if(!saleVoucher[s].tax){_context24.next=369;break;}_context24.next=365;return saleVoucher[s].tax.SalesLedger;case 365:saleVoucher[s].ledger=_context24.sent;delete saleVoucher[s].tax.SalesLedger;_context24.next=370;break;case 369:saleVoucher[s].ledger={};case 370:_context24.next=372;return saleVoucher[s].tax;case 372:if(!_context24.sent){_context24.next=376;break;}_context24.t15=saleVoucher[s].tax;_context24.next=377;break;case 376:_context24.t15={};case 377:saleVoucher[s].Voucher=_context24.t15;saleVoucher[s].type='credit';_context24.next=381;return 0;case 381:saleVoucher[s].debitAmount=_context24.sent;_context24.next=384;return saleVoucher[s].amount;case 384:saleVoucher[s].creditAmount=_context24.sent;saleVoucher[s].amount=saleVoucher[s].amount;_context24.next=388;return saleVoucher[s].tax;case 388:if(!_context24.sent){_context24.next=392;break;}_context24.t16=saleVoucher[s].tax.id;_context24.next=393;break;case 392:_context24.t16='';case 393:saleVoucher[s].voucher_number=_context24.t16;_context24.next=396;return saleVoucher[s].tax;case 396:if(!_context24.sent){_context24.next=400;break;}_context24.t17=saleVoucher[s].tax.invoice_id<=9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].tax.invoice_id):saleVoucher[s].tax.invoice_id>9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].tax.invoice_id):"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/").concat(saleVoucher[s].tax.invoice_id);_context24.next=401;break;case 400:_context24.t17='';case 401:saleVoucher[s].invoice_id=_context24.t17;delete saleVoucher[s].tax;_context24.next=405;return array.push(saleVoucher[s]);case 405:_context24.next=439;break;case 407:_context24.next=409;return'sale';case 409:saleVoucher[s].voucher_type=_context24.sent;_context24.next=412;return saleVoucher[s].SalesLedger;case 412:saleVoucher[s].ledger=_context24.sent;_context24.next=415;return{};case 415:saleVoucher[s].Voucher=_context24.sent;saleVoucher[s].type='Credit';_context24.next=419;return 0;case 419:saleVoucher[s].debitAmount=_context24.sent;_context24.next=422;return saleVoucher[s].total_amount;case 422:saleVoucher[s].creditAmount=_context24.sent;saleVoucher[s].amount=saleVoucher[s].total_amount;_context24.next=426;return saleVoucher[s].id;case 426:saleVoucher[s].voucher_number=_context24.sent;_context24.next=429;return saleVoucher[s].invoice_id;case 429:_context24.t18=_context24.sent;if(!(_context24.t18<=9)){_context24.next=434;break;}_context24.t19="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context24.next=435;break;case 434:_context24.t19=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(saleVoucher[s].invoice_id);case 435:saleVoucher[s].invoice_id=_context24.t19;delete saleVoucher[s].SalesLedger;_context24.next=439;return array.push(saleVoucher[s]);case 439:s++;_context24.next=202;break;case 442:if(!(purchaseVoucher&&purchaseVoucher.length>0)){_context24.next=693;break;}purchasearray=[];s=0;case 445:if(!(s<purchaseVoucher.length)){_context24.next=693;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context24.next=493;break;}_context24.next=449;return'purchase';case 449:purchaseVoucher[s].voucher_type=_context24.sent;_context24.next=452;return purchaseVoucher[s].RoundOff;case 452:purchaseVoucher[s].ledger=_context24.sent;_context24.next=455;return{};case 455:purchaseVoucher[s].Voucher=_context24.sent;purchaseVoucher[s].type=purchaseVoucher[s].roundoff_type;_context24.next=459;return purchaseVoucher[s].roundoff_type;case 459:_context24.t20=_context24.sent;if(!(_context24.t20=="debit")){_context24.next=464;break;}_context24.t21=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context24.next=465;break;case 464:_context24.t21=0;case 465:purchaseVoucher[s].debitAmount=_context24.t21;_context24.next=468;return purchaseVoucher[s].roundoff_type;case 468:_context24.t22=_context24.sent;if(!(_context24.t22=="credit")){_context24.next=473;break;}_context24.t23=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context24.next=474;break;case 473:_context24.t23=0;case 474:purchaseVoucher[s].creditAmount=_context24.t23;purchaseVoucher[s].amount=purchaseVoucher[s].roundoff_value;_context24.next=478;return purchaseVoucher[s].id;case 478:purchaseVoucher[s].voucher_number=_context24.sent;_context24.next=481;return purchaseVoucher[s].invoice_id;case 481:_context24.t24=_context24.sent;if(!(_context24.t24<=9)){_context24.next=486;break;}_context24.t25="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context24.next=487;break;case 486:_context24.t25=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 487:purchaseVoucher[s].invoice_id=_context24.t25;delete purchaseVoucher[s].RoundOff;_context24.next=491;return array.push(purchaseVoucher[s]);case 491:_context24.next=690;break;case 493:if(!ledger.dataValues.sale_key){_context24.next=609;break;}if(!(purchaseVoucher.length>0)){_context24.next=555;break;}_context24.next=497;return purchasearray.find(function(it){return purchaseVoucher[s].Voucherip&&it.invoice_idold==purchaseVoucher[s].Voucherip.invoice_id;});case 497:_findSales3=_context24.sent;if(!(_findSales3&&_findSales3.Voucher)){_context24.next=501;break;}_context24.next=553;break;case 501:_context24.next=503;return'purchase';case 503:purchaseVoucher[s].voucher_type=_context24.sent;if(!purchaseVoucher[s].Voucherip){_context24.next=511;break;}_context24.next=507;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 507:purchaseVoucher[s].ledger=_context24.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context24.next=512;break;case 511:purchaseVoucher[s].ledger={};case 512:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context24.next=515;return purchaseVoucher[s].Voucherip;case 515:if(!_context24.sent){_context24.next=519;break;}_context24.t26=purchaseVoucher[s].Voucherip;_context24.next=520;break;case 519:_context24.t26={};case 520:purchaseVoucher[s].Voucher=_context24.t26;purchaseVoucher[s].type='debit';_context24.next=524;return purchaseVoucher[s].total_amount;case 524:purchaseVoucher[s].debitAmount=_context24.sent;_context24.next=527;return 0;case 527:purchaseVoucher[s].creditAmount=_context24.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context24.next=531;return purchaseVoucher[s].Voucherip;case 531:if(!_context24.sent){_context24.next=535;break;}_context24.t27=purchaseVoucher[s].Voucherip.id;_context24.next=536;break;case 535:_context24.t27='';case 536:purchaseVoucher[s].voucher_number=_context24.t27;_context24.next=539;return purchaseVoucher[s].Voucherip;case 539:_context24.t28=_context24.sent;if(!_context24.t28){_context24.next=542;break;}_context24.t28=purchaseVoucher[s].Voucherip.invoice_id;case 542:if(!_context24.t28){_context24.next=546;break;}_context24.t29=purchaseVoucher[s].Voucherip.invoice_id;_context24.next=547;break;case 546:_context24.t29='';case 547:purchaseVoucher[s].invoice_id=_context24.t29;delete purchaseVoucher[s].Voucherip;_context24.next=551;return purchasearray.push(purchaseVoucher[s]);case 551:_context24.next=553;return array.push(purchaseVoucher[s]);case 553:_context24.next=607;break;case 555:_context24.next=557;return'purchase';case 557:purchaseVoucher[s].voucher_type=_context24.sent;if(!purchaseVoucher[s].Voucherip){_context24.next=565;break;}_context24.next=561;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 561:purchaseVoucher[s].ledger=_context24.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context24.next=566;break;case 565:purchaseVoucher[s].ledger={};case 566:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context24.next=569;return purchaseVoucher[s].Voucherip;case 569:if(!_context24.sent){_context24.next=573;break;}_context24.t30=purchaseVoucher[s].Voucherip;_context24.next=574;break;case 573:_context24.t30={};case 574:purchaseVoucher[s].Voucher=_context24.t30;purchaseVoucher[s].type='debit';_context24.next=578;return purchaseVoucher[s].total_amount;case 578:purchaseVoucher[s].debitAmount=_context24.sent;_context24.next=581;return 0;case 581:purchaseVoucher[s].creditAmount=_context24.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context24.next=585;return purchaseVoucher[s].Voucherip;case 585:if(!_context24.sent){_context24.next=589;break;}_context24.t31=purchaseVoucher[s].Voucherip.id;_context24.next=590;break;case 589:_context24.t31='';case 590:purchaseVoucher[s].voucher_number=_context24.t31;_context24.next=593;return purchaseVoucher[s].Voucherip;case 593:_context24.t32=_context24.sent;if(!_context24.t32){_context24.next=596;break;}_context24.t32=purchaseVoucher[s].Voucherip.invoice_id;case 596:if(!_context24.t32){_context24.next=600;break;}_context24.t33=purchaseVoucher[s].Voucherip.invoice_id;_context24.next=601;break;case 600:_context24.t33='';case 601:purchaseVoucher[s].invoice_id=_context24.t33;delete purchaseVoucher[s].Voucherip;_context24.next=605;return purchasearray.push(purchaseVoucher[s]);case 605:_context24.next=607;return array.push(purchaseVoucher[s]);case 607:_context24.next=690;break;case 609:if(!ledger.dataValues.tax_key){_context24.next=658;break;}_context24.next=612;return'purchase';case 612:purchaseVoucher[s].voucher_type=_context24.sent;if(!purchaseVoucher[s].taxp){_context24.next=620;break;}_context24.next=616;return purchaseVoucher[s].taxp.PurchaseLedger;case 616:purchaseVoucher[s].ledger=_context24.sent;delete purchaseVoucher[s].taxp.PurchaseLedger;_context24.next=621;break;case 620:purchaseVoucher[s].ledger={};case 621:_context24.next=623;return purchaseVoucher[s].taxp;case 623:if(!_context24.sent){_context24.next=627;break;}_context24.t34=purchaseVoucher[s].taxp;_context24.next=628;break;case 627:_context24.t34={};case 628:purchaseVoucher[s].Voucher=_context24.t34;purchaseVoucher[s].type='debit';_context24.next=632;return purchaseVoucher[s].amount;case 632:purchaseVoucher[s].debitAmount=_context24.sent;_context24.next=635;return 0;case 635:purchaseVoucher[s].creditAmount=_context24.sent;purchaseVoucher[s].amount=purchaseVoucher[s].amount;_context24.next=639;return purchaseVoucher[s].taxp;case 639:if(!_context24.sent){_context24.next=643;break;}_context24.t35=purchaseVoucher[s].taxp.id;_context24.next=644;break;case 643:_context24.t35='';case 644:purchaseVoucher[s].voucher_number=_context24.t35;_context24.next=647;return purchaseVoucher[s].taxp;case 647:if(!_context24.sent){_context24.next=651;break;}_context24.t36=purchaseVoucher[s].taxp.invoice_id<=9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):purchaseVoucher[s].taxp.invoice_id>9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id);_context24.next=652;break;case 651:_context24.t36='';case 652:purchaseVoucher[s].invoice_id=_context24.t36;delete purchaseVoucher[s].tax;_context24.next=656;return array.push(purchaseVoucher[s]);case 656:_context24.next=690;break;case 658:_context24.next=660;return'purchase';case 660:purchaseVoucher[s].voucher_type=_context24.sent;_context24.next=663;return purchaseVoucher[s].PurchaseLedger;case 663:purchaseVoucher[s].ledger=_context24.sent;_context24.next=666;return{};case 666:purchaseVoucher[s].Voucher=_context24.sent;purchaseVoucher[s].type='debit';_context24.next=670;return purchaseVoucher[s].total_amount;case 670:purchaseVoucher[s].debitAmount=_context24.sent;_context24.next=673;return 0;case 673:purchaseVoucher[s].creditAmount=_context24.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context24.next=677;return purchaseVoucher[s].id;case 677:purchaseVoucher[s].voucher_number=_context24.sent;_context24.next=680;return purchaseVoucher[s].invoice_id;case 680:_context24.t37=_context24.sent;if(!(_context24.t37<=9)){_context24.next=685;break;}_context24.t38="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context24.next=686;break;case 685:_context24.t38=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 686:purchaseVoucher[s].invoice_id=_context24.t38;delete purchaseVoucher[s].PurchaseLedger;_context24.next=690;return array.push(purchaseVoucher[s]);case 690:s++;_context24.next=445;break;case 693:if(!(creditVoucher&&creditVoucher.length>0)){_context24.next=829;break;}s=0;case 695:if(!(s<creditVoucher.length)){_context24.next=829;break;}if(!ledger.dataValues.sale_key){_context24.next=745;break;}_context24.next=699;return'Sale Return';case 699:creditVoucher[s].voucher_type=_context24.sent;if(!creditVoucher[s].Voucheric){_context24.next=707;break;}_context24.next=703;return creditVoucher[s].Voucheric.CreditBuyer;case 703:creditVoucher[s].ledger=_context24.sent;delete creditVoucher[s].Voucheric.CreditBuyer;_context24.next=708;break;case 707:creditVoucher[s].ledger={};case 708:_context24.next=710;return creditVoucher[s].Voucheric;case 710:if(!_context24.sent){_context24.next=714;break;}_context24.t39=creditVoucher[s].Voucheric;_context24.next=715;break;case 714:_context24.t39={};case 715:creditVoucher[s].Voucher=_context24.t39;creditVoucher[s].type='debit';_context24.next=719;return creditVoucher[s].total_amount;case 719:creditVoucher[s].debitAmount=_context24.sent;_context24.next=722;return 0;case 722:creditVoucher[s].creditAmount=_context24.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context24.next=726;return creditVoucher[s].Voucheric;case 726:if(!_context24.sent){_context24.next=730;break;}_context24.t40=creditVoucher[s].Voucheric.id;_context24.next=731;break;case 730:_context24.t40='';case 731:creditVoucher[s].voucher_number=_context24.t40;_context24.next=734;return creditVoucher[s].Voucheric;case 734:if(!_context24.sent){_context24.next=738;break;}_context24.t41=creditVoucher[s].Voucheric.invoice_id<=9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].Voucheric.invoice_id):creditVoucher[s].Voucheric.invoice_id>9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].Voucheric.invoice_id):"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/").concat(creditVoucher[s].Voucheric.invoice_id);_context24.next=739;break;case 738:_context24.t41='';case 739:creditVoucher[s].invoice_id=_context24.t41;delete creditVoucher[s].Voucheric;_context24.next=743;return array.push(creditVoucher[s]);case 743:_context24.next=826;break;case 745:if(!ledger.dataValues.tax_key){_context24.next=794;break;}_context24.next=748;return'Sale Return';case 748:creditVoucher[s].voucher_type=_context24.sent;if(!creditVoucher[s].taxc){_context24.next=756;break;}_context24.next=752;return creditVoucher[s].taxc.CreditBuyer;case 752:creditVoucher[s].ledger=_context24.sent;delete creditVoucher[s].taxc.CreditBuyer;_context24.next=757;break;case 756:creditVoucher[s].ledger={};case 757:_context24.next=759;return creditVoucher[s].taxc;case 759:if(!_context24.sent){_context24.next=763;break;}_context24.t42=creditVoucher[s].taxc;_context24.next=764;break;case 763:_context24.t42={};case 764:creditVoucher[s].Voucher=_context24.t42;creditVoucher[s].type='debit';_context24.next=768;return creditVoucher[s].amount;case 768:creditVoucher[s].debitAmount=_context24.sent;_context24.next=771;return 0;case 771:creditVoucher[s].creditAmount=_context24.sent;creditVoucher[s].amount=creditVoucher[s].amount;_context24.next=775;return creditVoucher[s].taxc;case 775:if(!_context24.sent){_context24.next=779;break;}_context24.t43=creditVoucher[s].taxc.id;_context24.next=780;break;case 779:_context24.t43='';case 780:creditVoucher[s].voucher_number=_context24.t43;_context24.next=783;return creditVoucher[s].taxc;case 783:if(!_context24.sent){_context24.next=787;break;}_context24.t44=creditVoucher[s].taxc.invoice_id<=9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].taxc.invoice_id):creditVoucher[s].taxc.invoice_id>9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].taxc.invoice_id):"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/").concat(creditVoucher[s].taxc.invoice_id);_context24.next=788;break;case 787:_context24.t44='';case 788:creditVoucher[s].invoice_id=_context24.t44;delete creditVoucher[s].taxc;_context24.next=792;return array.push(creditVoucher[s]);case 792:_context24.next=826;break;case 794:_context24.next=796;return'Sale Return';case 796:creditVoucher[s].voucher_type=_context24.sent;_context24.next=799;return creditVoucher[s].CreditBuyer;case 799:creditVoucher[s].ledger=_context24.sent;_context24.next=802;return{};case 802:creditVoucher[s].Voucher=_context24.sent;creditVoucher[s].type='debit';_context24.next=806;return creditVoucher[s].total_amount;case 806:creditVoucher[s].debitAmount=_context24.sent;_context24.next=809;return 0;case 809:creditVoucher[s].creditAmount=_context24.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context24.next=813;return creditVoucher[s].id;case 813:creditVoucher[s].voucher_number=_context24.sent;_context24.next=816;return creditVoucher[s].invoice_id;case 816:_context24.t45=_context24.sent;if(!(_context24.t45<=9)){_context24.next=821;break;}_context24.t46="".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/00").concat(creditVoucher[s].invoice_id);_context24.next=822;break;case 821:_context24.t46=creditVoucher[s].invoice_id>9?"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/0").concat(creditVoucher[s].invoice_id):"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/").concat(creditVoucher[s].invoice_id);case 822:creditVoucher[s].invoice_id=_context24.t46;delete creditVoucher[s].CreditBuyer;_context24.next=826;return array.push(creditVoucher[s]);case 826:s++;_context24.next=695;break;case 829:if(!(debitVoucher&&debitVoucher.length>0)){_context24.next=965;break;}s=0;case 831:if(!(s<debitVoucher.length)){_context24.next=965;break;}if(!ledger.dataValues.sale_key){_context24.next=881;break;}_context24.next=835;return'Purchase Return';case 835:debitVoucher[s].voucher_type=_context24.sent;if(!debitVoucher[s].Voucherid){_context24.next=843;break;}_context24.next=839;return debitVoucher[s].Voucherid.DebitBuyer;case 839:debitVoucher[s].ledger=_context24.sent;delete debitVoucher[s].Voucherid.DebitBuyer;_context24.next=844;break;case 843:debitVoucher[s].ledger={};case 844:_context24.next=846;return debitVoucher[s].Voucherid;case 846:if(!_context24.sent){_context24.next=850;break;}_context24.t47=debitVoucher[s].Voucherid;_context24.next=851;break;case 850:_context24.t47={};case 851:debitVoucher[s].Voucher=_context24.t47;debitVoucher[s].type='Credit';_context24.next=855;return 0;case 855:debitVoucher[s].debitAmount=_context24.sent;_context24.next=858;return debitVoucher[s].total_amount;case 858:debitVoucher[s].creditAmount=_context24.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context24.next=862;return debitVoucher[s].Voucherid;case 862:if(!_context24.sent){_context24.next=866;break;}_context24.t48=debitVoucher[s].Voucherid.id;_context24.next=867;break;case 866:_context24.t48='';case 867:debitVoucher[s].voucher_number=_context24.t48;_context24.next=870;return debitVoucher[s].Voucherid;case 870:if(!_context24.sent){_context24.next=874;break;}_context24.t49=debitVoucher[s].Voucherid.invoice_id<=9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].Voucherid.invoice_id):debitVoucher[s].Voucherid.invoice_id>9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].Voucherid.invoice_id):"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/").concat(debitVoucher[s].Voucherid.invoice_id);_context24.next=875;break;case 874:_context24.t49='';case 875:debitVoucher[s].invoice_id=_context24.t49;delete debitVoucher[s].Voucherid;_context24.next=879;return array.push(debitVoucher[s]);case 879:_context24.next=962;break;case 881:if(!ledger.dataValues.tax_key){_context24.next=930;break;}_context24.next=884;return'Purchase Return';case 884:debitVoucher[s].voucher_type=_context24.sent;if(!debitVoucher[s].taxd){_context24.next=892;break;}_context24.next=888;return debitVoucher[s].taxd.DebitBuyer;case 888:debitVoucher[s].ledger=_context24.sent;delete debitVoucher[s].taxd.DebitBuyer;_context24.next=893;break;case 892:debitVoucher[s].ledger={};case 893:_context24.next=895;return debitVoucher[s].taxd;case 895:if(!_context24.sent){_context24.next=899;break;}_context24.t50=debitVoucher[s].taxd;_context24.next=900;break;case 899:_context24.t50={};case 900:debitVoucher[s].Voucher=_context24.t50;debitVoucher[s].type='Credit';_context24.next=904;return 0;case 904:debitVoucher[s].debitAmount=_context24.sent;_context24.next=907;return debitVoucher[s].amount;case 907:debitVoucher[s].creditAmount=_context24.sent;debitVoucher[s].amount=debitVoucher[s].amount;_context24.next=911;return debitVoucher[s].taxd;case 911:if(!_context24.sent){_context24.next=915;break;}_context24.t51=debitVoucher[s].taxd.id;_context24.next=916;break;case 915:_context24.t51='';case 916:debitVoucher[s].voucher_number=_context24.t51;_context24.next=919;return debitVoucher[s].taxd;case 919:if(!_context24.sent){_context24.next=923;break;}_context24.t52=debitVoucher[s].taxd.invoice_id<=9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].taxd.invoice_id):debitVoucher[s].taxd.invoice_id>9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].taxd.invoice_id):"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/").concat(debitVoucher[s].taxd.invoice_id);_context24.next=924;break;case 923:_context24.t52='';case 924:debitVoucher[s].invoice_id=_context24.t52;delete debitVoucher[s].taxd;_context24.next=928;return array.push(debitVoucher[s]);case 928:_context24.next=962;break;case 930:_context24.next=932;return'Purchase Return';case 932:debitVoucher[s].voucher_type=_context24.sent;_context24.next=935;return debitVoucher[s].DebitBuyer;case 935:debitVoucher[s].ledger=_context24.sent;_context24.next=938;return{};case 938:debitVoucher[s].Voucher=_context24.sent;debitVoucher[s].type='Credit';_context24.next=942;return 0;case 942:debitVoucher[s].debitAmount=_context24.sent;_context24.next=945;return debitVoucher[s].total_amount;case 945:debitVoucher[s].creditAmount=_context24.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context24.next=949;return debitVoucher[s].id;case 949:debitVoucher[s].voucher_number=_context24.sent;_context24.next=952;return debitVoucher[s].invoice_id;case 952:_context24.t53=_context24.sent;if(!(_context24.t53<=9)){_context24.next=957;break;}_context24.t54="".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/00").concat(debitVoucher[s].invoice_id);_context24.next=958;break;case 957:_context24.t54=debitVoucher[s].invoice_id>9?"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/0").concat(debitVoucher[s].invoice_id):"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/").concat(debitVoucher[s].invoice_id);case 958:debitVoucher[s].invoice_id=_context24.t54;delete debitVoucher[s].DebitBuyer;_context24.next=962;return array.push(debitVoucher[s]);case 962:s++;_context24.next=831;break;case 965:if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context24.next=1020;break;}_salearray9=[];s=0;case 968:if(!(s<discountsaleVoucher.length)){_context24.next=1020;break;}_context24.next=971;return'sale';case 971:discountsaleVoucher[s].voucher_type=_context24.sent;_context24.next=974;return discountsaleVoucher[s].SalesDiscountLedger;case 974:discountsaleVoucher[s].ledger=_context24.sent;_context24.next=977;return{};case 977:discountsaleVoucher[s].Voucher=_context24.sent;discountsaleVoucher[s].type=discountsaleVoucher[s].discount&&Number(discountsaleVoucher[s].discount)>0?'Credit':'Debit';_context24.next=981;return discountsaleVoucher[s].discount;case 981:_context24.t55=_context24.sent;if(!_context24.t55){_context24.next=984;break;}_context24.t55=Number(discountsaleVoucher[s].discount)<0;case 984:if(!_context24.t55){_context24.next=988;break;}_context24.t56=-1*Number(discountsaleVoucher[s].discount);_context24.next=989;break;case 988:_context24.t56=0;case 989:discountsaleVoucher[s].debitAmount=_context24.t56;_context24.next=992;return discountsaleVoucher[s].discount;case 992:_context24.t57=_context24.sent;if(!_context24.t57){_context24.next=995;break;}_context24.t57=Number(discountsaleVoucher[s].discount)>0;case 995:if(!_context24.t57){_context24.next=999;break;}_context24.t58=Number(discountsaleVoucher[s].discount);_context24.next=1000;break;case 999:_context24.t58=0;case 1000:discountsaleVoucher[s].creditAmount=_context24.t58;discountsaleVoucher[s].amount=discountsaleVoucher[s].discount&&Number(discountsaleVoucher[s].discount)>0?Number(discountsaleVoucher[s].discount):Number(discountsaleVoucher[s].discount);_context24.next=1004;return discountsaleVoucher[s].id;case 1004:discountsaleVoucher[s].voucher_number=_context24.sent;_context24.next=1007;return discountsaleVoucher[s].invoice_id;case 1007:_context24.t59=_context24.sent;if(!(_context24.t59<=9)){_context24.next=1012;break;}_context24.t60="".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/00").concat(discountsaleVoucher[s].invoice_id);_context24.next=1013;break;case 1012:_context24.t60=discountsaleVoucher[s].invoice_id>9?"".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/0").concat(discountsaleVoucher[s].invoice_id):"".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/").concat(discountsaleVoucher[s].invoice_id);case 1013:discountsaleVoucher[s].invoice_id=_context24.t60;delete discountsaleVoucher[s].SalesDiscountLedger;_context24.next=1017;return array.push(discountsaleVoucher[s]);case 1017:s++;_context24.next=968;break;case 1020:if(!(discountpurchaseVoucher&&discountpurchaseVoucher.length>0)){_context24.next=1069;break;}_salearray10=[];s=0;case 1023:if(!(s<discountpurchaseVoucher.length)){_context24.next=1069;break;}_context24.next=1026;return'purchase';case 1026:discountpurchaseVoucher[s].voucher_type=_context24.sent;_context24.next=1029;return discountpurchaseVoucher[s].PurchaseDiscountLedger;case 1029:discountpurchaseVoucher[s].ledger=_context24.sent;_context24.next=1032;return{};case 1032:discountpurchaseVoucher[s].Voucher=_context24.sent;discountpurchaseVoucher[s].type=discountpurchaseVoucher[s].discount&&Number(discountpurchaseVoucher[s].discount)>0?'Debit':'Credit';_context24.next=1036;return discountpurchaseVoucher[s].discount;case 1036:_context24.t61=_context24.sent;if(!_context24.t61){_context24.next=1039;break;}_context24.t61=Number(discountpurchaseVoucher[s].discount)>0;case 1039:if(!_context24.t61){_context24.next=1043;break;}_context24.t62=Number(discountpurchaseVoucher[s].discount);_context24.next=1044;break;case 1043:_context24.t62=0;case 1044:discountpurchaseVoucher[s].debitAmount=_context24.t62;_context24.next=1047;return discountpurchaseVoucher[s].discount;case 1047:_context24.t63=_context24.sent;if(!_context24.t63){_context24.next=1050;break;}_context24.t63=Number(discountpurchaseVoucher[s].discount)<0;case 1050:if(!_context24.t63){_context24.next=1054;break;}_context24.t64=-1*Number(discountpurchaseVoucher[s].discount);_context24.next=1055;break;case 1054:_context24.t64=0;case 1055:discountpurchaseVoucher[s].creditAmount=_context24.t64;discountpurchaseVoucher[s].amount=discountpurchaseVoucher[s].discount&&Number(discountpurchaseVoucher[s].discount)>0?Number(discountpurchaseVoucher[s].discount):Number(discountpurchaseVoucher[s].discount);_context24.next=1059;return discountpurchaseVoucher[s].id;case 1059:discountpurchaseVoucher[s].voucher_number=_context24.sent;_context24.next=1062;return discountpurchaseVoucher[s].invoice_id;case 1062:discountpurchaseVoucher[s].invoice_id=_context24.sent;delete discountpurchaseVoucher[s].PurchaseDiscountLedger;_context24.next=1066;return array.push(discountpurchaseVoucher[s]);case 1066:s++;_context24.next=1023;break;case 1069:if(!(discountcreditVoucher&&discountcreditVoucher.length>0)){_context24.next=1127;break;}_salearray11=[];s=0;case 1072:if(!(s<discountcreditVoucher.length)){_context24.next=1127;break;}_context24.next=1075;return'sales return';case 1075:discountcreditVoucher[s].voucher_type=_context24.sent;_context24.next=1078;return discountcreditVoucher[s].CreditDiscountLedger;case 1078:discountcreditVoucher[s].ledger=_context24.sent;_context24.next=1081;return{};case 1081:discountcreditVoucher[s].Voucher=_context24.sent;discountcreditVoucher[s].type=discountcreditVoucher[s].discount&&Number(discountcreditVoucher[s].discount)>0?'Debit':'Credit';_context24.next=1085;return discountcreditVoucher[s].discount;case 1085:_context24.t65=_context24.sent;if(!_context24.t65){_context24.next=1088;break;}_context24.t65=Number(discountcreditVoucher[s].discount)>0;case 1088:if(!_context24.t65){_context24.next=1092;break;}_context24.t66=Number(discountcreditVoucher[s].discount);_context24.next=1093;break;case 1092:_context24.t66=0;case 1093:discountcreditVoucher[s].debitAmount=_context24.t66;_context24.next=1096;return discountcreditVoucher[s].discount;case 1096:_context24.t67=_context24.sent;if(!_context24.t67){_context24.next=1099;break;}_context24.t67=Number(discountcreditVoucher[s].discount)<0;case 1099:if(!_context24.t67){_context24.next=1103;break;}_context24.t68=-1*Number(discountcreditVoucher[s].discount);_context24.next=1104;break;case 1103:_context24.t68=0;case 1104:discountcreditVoucher[s].creditAmount=_context24.t68;discountcreditVoucher[s].amount=discountcreditVoucher[s].discount&&Number(discountcreditVoucher[s].discount)>0?Number(discountcreditVoucher[s].discount):Number(discountcreditVoucher[s].discount);_context24.next=1108;return discountcreditVoucher[s].invoice_id;case 1108:_context24.t69=_context24.sent;if(!(_context24.t69<=9)){_context24.next=1113;break;}_context24.t70="".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/00").concat(discountcreditVoucher[s].invoice_id);_context24.next=1114;break;case 1113:_context24.t70=discountcreditVoucher[s].invoice_id>9?"".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/0").concat(discountcreditVoucher[s].invoice_id):"".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/").concat(discountcreditVoucher[s].invoice_id);case 1114:discountcreditVoucher[s].invoice_id=_context24.t70;_context24.next=1117;return discountcreditVoucher[s].id;case 1117:discountcreditVoucher[s].voucher_number=_context24.sent;_context24.next=1120;return discountcreditVoucher[s].invoice_id;case 1120:discountcreditVoucher[s].invoice_id=_context24.sent;delete discountcreditVoucher[s].CreditDiscountLedger;_context24.next=1124;return array.push(discountcreditVoucher[s]);case 1124:s++;_context24.next=1072;break;case 1127:if(!(discountdebitVoucher&&discountdebitVoucher.length>0)){_context24.next=1182;break;}_salearray12=[];s=0;case 1130:if(!(s<discountdebitVoucher.length)){_context24.next=1182;break;}_context24.next=1133;return'purchase return';case 1133:discountdebitVoucher[s].voucher_type=_context24.sent;_context24.next=1136;return discountdebitVoucher[s].DebitDiscountLedger;case 1136:discountdebitVoucher[s].ledger=_context24.sent;_context24.next=1139;return{};case 1139:discountdebitVoucher[s].Voucher=_context24.sent;discountdebitVoucher[s].type=discountdebitVoucher[s].discount&&Number(discountdebitVoucher[s].discount)>0?'Credit':'debit';_context24.next=1143;return discountdebitVoucher[s].discount;case 1143:_context24.t71=_context24.sent;if(!_context24.t71){_context24.next=1146;break;}_context24.t71=Number(discountdebitVoucher[s].discount)<0;case 1146:if(!_context24.t71){_context24.next=1150;break;}_context24.t72=-1*Number(discountdebitVoucher[s].discount);_context24.next=1151;break;case 1150:_context24.t72=0;case 1151:discountdebitVoucher[s].debitAmount=_context24.t72;_context24.next=1154;return discountdebitVoucher[s].discount;case 1154:_context24.t73=_context24.sent;if(!_context24.t73){_context24.next=1157;break;}_context24.t73=Number(discountdebitVoucher[s].discount)>0;case 1157:if(!_context24.t73){_context24.next=1161;break;}_context24.t74=Number(discountdebitVoucher[s].discount);_context24.next=1162;break;case 1161:_context24.t74=0;case 1162:discountdebitVoucher[s].creditAmount=_context24.t74;discountdebitVoucher[s].amount=discountdebitVoucher[s].discount&&Number(discountdebitVoucher[s].discount)>0?Number(discountdebitVoucher[s].discount):Number(discountdebitVoucher[s].discount);_context24.next=1166;return discountdebitVoucher[s].id;case 1166:discountdebitVoucher[s].voucher_number=_context24.sent;_context24.next=1169;return discountdebitVoucher[s].invoice_id;case 1169:_context24.t75=_context24.sent;if(!(_context24.t75<=9)){_context24.next=1174;break;}_context24.t76="".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/00").concat(discountdebitVoucher[s].invoice_id);_context24.next=1175;break;case 1174:_context24.t76=discountdebitVoucher[s].invoice_id>9?"".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/0").concat(discountdebitVoucher[s].invoice_id):"".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/").concat(discountdebitVoucher[s].invoice_id);case 1175:discountdebitVoucher[s].invoice_id=_context24.t76;delete discountdebitVoucher[s].DebitDiscountLedger;_context24.next=1179;return array.push(discountdebitVoucher[s]);case 1179:s++;_context24.next=1130;break;case 1182:if(!(recieptVoucher&&recieptVoucher.length>0)){_context24.next=1227;break;}i=0;case 1184:if(!(i<recieptVoucher.length)){_context24.next=1227;break;}_context24.next=1187;return recieptVoucher[i].type;case 1187:_context24.t77=_context24.sent;if(!(_context24.t77==='debit')){_context24.next=1197;break;}_context24.next=1191;return recieptVoucher[i].total_amount;case 1191:recieptVoucher[i].debitAmount=_context24.sent;_context24.next=1194;return 0;case 1194:recieptVoucher[i].creditAmount=_context24.sent;_context24.next=1203;break;case 1197:_context24.next=1199;return 0;case 1199:recieptVoucher[i].debitAmount=_context24.sent;_context24.next=1202;return recieptVoucher[i].total_amount;case 1202:recieptVoucher[i].creditAmount=_context24.sent;case 1203:_context24.next=1205;return recieptVoucher[i].ReciptBuyer;case 1205:recieptVoucher[i].ledger=_context24.sent;delete recieptVoucher[i].ReciptBuyer;_context24.next=1209;return'reciept';case 1209:recieptVoucher[i].voucher_type=_context24.sent;_context24.next=1212;return recieptVoucher[i].id;case 1212:recieptVoucher[i].voucher_number=_context24.sent;_context24.next=1215;return recieptVoucher[i].invoice_id;case 1215:_context24.t78=_context24.sent;if(!(_context24.t78<=9)){_context24.next=1220;break;}_context24.t79="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context24.next=1221;break;case 1220:_context24.t79=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 1221:recieptVoucher[i].invoice_id=_context24.t79;_context24.next=1224;return array.push(recieptVoucher[i]);case 1224:i++;_context24.next=1184;break;case 1227:if(!(paymentVoucher&&paymentVoucher.length>0)){_context24.next=1272;break;}i=0;case 1229:if(!(i<paymentVoucher.length)){_context24.next=1272;break;}_context24.next=1232;return paymentVoucher[i].type;case 1232:_context24.t80=_context24.sent;if(!(_context24.t80==='debit')){_context24.next=1242;break;}_context24.next=1236;return paymentVoucher[i].total_amount;case 1236:paymentVoucher[i].debitAmount=_context24.sent;_context24.next=1239;return 0;case 1239:paymentVoucher[i].creditAmount=_context24.sent;_context24.next=1248;break;case 1242:_context24.next=1244;return 0;case 1244:paymentVoucher[i].debitAmount=_context24.sent;_context24.next=1247;return paymentVoucher[i].total_amount;case 1247:paymentVoucher[i].creditAmount=_context24.sent;case 1248:_context24.next=1250;return paymentVoucher[i].PaymentBuyer;case 1250:paymentVoucher[i].ledger=_context24.sent;delete paymentVoucher[i].PaymentBuyer;_context24.next=1254;return'payment';case 1254:paymentVoucher[i].voucher_type=_context24.sent;_context24.next=1257;return paymentVoucher[i].id;case 1257:paymentVoucher[i].voucher_number=_context24.sent;_context24.next=1260;return paymentVoucher[i].invoice_id;case 1260:_context24.t81=_context24.sent;if(!(_context24.t81<=9)){_context24.next=1265;break;}_context24.t82="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context24.next=1266;break;case 1265:_context24.t82=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 1266:paymentVoucher[i].invoice_id=_context24.t82;_context24.next=1269;return array.push(paymentVoucher[i]);case 1269:i++;_context24.next=1229;break;case 1272:if(!(reciverrecieptVoucher&&reciverrecieptVoucher.length>0)){_context24.next=1306;break;}i=0;case 1274:if(!(i<reciverrecieptVoucher.length)){_context24.next=1306;break;}_context24.next=1277;return reciverrecieptVoucher[i].total_amount;case 1277:reciverrecieptVoucher[i].debitAmount=_context24.sent;_context24.next=1280;return 0;case 1280:reciverrecieptVoucher[i].creditAmount=_context24.sent;_context24.next=1283;return reciverrecieptVoucher[i].ReciptReciver;case 1283:reciverrecieptVoucher[i].ledger=_context24.sent;delete reciverrecieptVoucher[i].ReciptReciver;_context24.next=1287;return'reciept reciver';case 1287:reciverrecieptVoucher[i].voucher_type=_context24.sent;_context24.next=1290;return reciverrecieptVoucher[i].id;case 1290:reciverrecieptVoucher[i].voucher_number=_context24.sent;_context24.next=1293;return reciverrecieptVoucher[i].invoice_id;case 1293:_context24.t83=_context24.sent;if(!(_context24.t83<=9)){_context24.next=1298;break;}_context24.t84="".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverrecieptVoucher[i].invoice_id);_context24.next=1299;break;case 1298:_context24.t84=reciverrecieptVoucher[i].invoice_id>9?"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverrecieptVoucher[i].invoice_id):"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/").concat(reciverrecieptVoucher[i].invoice_id);case 1299:reciverrecieptVoucher[i].invoice_id=_context24.t84;reciverrecieptVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context24.next=1303;return array.push(reciverrecieptVoucher[i]);case 1303:i++;_context24.next=1274;break;case 1306:if(!(reciverpaymentVoucher&&reciverpaymentVoucher.length>0)){_context24.next=1340;break;}i=0;case 1308:if(!(i<reciverpaymentVoucher.length)){_context24.next=1340;break;}_context24.next=1311;return 0;case 1311:reciverpaymentVoucher[i].debitAmount=_context24.sent;_context24.next=1314;return reciverpaymentVoucher[i].total_amount;case 1314:reciverpaymentVoucher[i].creditAmount=_context24.sent;_context24.next=1317;return reciverpaymentVoucher[i].PaymentReciver;case 1317:reciverpaymentVoucher[i].ledger=_context24.sent;delete reciverpaymentVoucher[i].PaymentReciver;_context24.next=1321;return'payment reciver';case 1321:reciverpaymentVoucher[i].voucher_type=_context24.sent;_context24.next=1324;return reciverpaymentVoucher[i].id;case 1324:reciverpaymentVoucher[i].voucher_number=_context24.sent;_context24.next=1327;return reciverpaymentVoucher[i].invoice_id;case 1327:_context24.t85=_context24.sent;if(!(_context24.t85<=9)){_context24.next=1332;break;}_context24.t86="".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverpaymentVoucher[i].invoice_id);_context24.next=1333;break;case 1332:_context24.t86=reciverpaymentVoucher[i].invoice_id>9?"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverpaymentVoucher[i].invoice_id):"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/").concat(reciverpaymentVoucher[i].invoice_id);case 1333:reciverpaymentVoucher[i].invoice_id=_context24.t86;reciverpaymentVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context24.next=1337;return array.push(reciverpaymentVoucher[i]);case 1337:i++;_context24.next=1308;break;case 1340:_context24.next=1342;return(0,_arraySort["default"])(array,'invoice_date');case 1342:mainArray=_context24.sent;//array.sort((a, b) => new Date(b.invoice_date) - new Date(a.invoice_date));
// return {mainArray:mainArray}
creditamount=0;debetamount=0;totalbalnce=0;_context24.next=1348;return mainArray.map(function(item){if(item.creditAmount){creditamount=creditamount+Number(item.creditAmount);}else if(item.debitAmount){debetamount=debetamount+Number(item.debitAmount);}});case 1348:totalbalnce=Number(Number(openingbalncecredit)+Number(creditamount))-Number(Number(debetamount)+Number(openingbalncedebit));return _context24.abrupt("return",totalbalnce);case 1352:_context24.next=1357;break;case 1354:_context24.prev=1354;_context24.t87=_context24["catch"](0);console.log("e",_context24.t87);// return {
//     statusCode: res.statusCode,
//     success: false,
//     error: e,
//     message: "Something went wrong!"
// }
case 1357:case"end":return _context24.stop();}},_callee22,null,[[0,1354]]);}));return _getAllLedgerVouchercurrent.apply(this,arguments);}exports.getAllLedgerVoucher=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data,res){var journalVoucher,saleVoucher,purchaseVoucher,creditVoucher,debitVoucher,recieptVoucher,paymentVoucher,discountsaleVoucher,discountdebitVoucher,discountpurchaseVoucher,discountcreditVoucher,reciverrecieptVoucher,reciverpaymentVoucher,ledger,_invoice_date23,_invoice_date24,response,calculation,olddata,findyear,responseold,calculationold,findProfitLedger,debitProfiltAmount,creditProfiltAmount,diffrence,openAmount1,findCompany,_invoice_date,_journalVoucher,responsedata,i,_invoice_date2,_invoice_date3,_invoice_date4,_invoice_date5,_invoice_date6,_invoice_date7,_invoice_date8,_invoice_date9,_invoice_date10,_invoice_date11,_invoice_date12,_invoice_date13,_invoice_date14,_invoice_date15,_invoice_date16,_invoice_date17,_invoice_date18,_invoice_date19,_invoice_date20,_invoice_date21,_invoice_date22,_invoice_date25,_invoice_date26,_invoice_date27,_invoice_date28,_invoice_date29,_invoice_date30,array,companyFind,totalcalculate_openingblance,salearray,s,findSales,_salearray,_salearray2,_salearray3,_salearray4,purchasearray,_findSales,mainArray,lastObj;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;reciverpaymentVoucher=[];_context.next=4;return _ledger["default"].findOne({where:{uid:data.ledger_id,company_id:data.company_id},include:[{model:_accountGroup["default"]}]});case 4:ledger=_context.sent;if(!(ledger&&ledger.dataValues.id)){_context.next=1511;break;}if(!(ledger.dataValues.account_group_id===_config["default"].profit_loss_id)){_context.next=99;break;}_context.next=9;return currentprofitLoss(data,res);case 9:response=_context.sent;console.log("response",response);_context.next=13;return profitCal(response.sheetdata?response.sheetdata:{});case 13:calculation=_context.sent;console.log("calculation",calculation);olddata=_objectSpread({},data);findyear=new Date(olddata.start_date).getFullYear();olddata.start_date="1900-04-01";olddata.end_date="".concat(Number(findyear),"-03-31");_context.next=21;return oldprofitLoss(olddata,res);case 21:responseold=_context.sent;_context.next=24;return profitCal(responseold.sheetdata?responseold.sheetdata:{});case 24:calculationold=_context.sent;console.log("calculationold",calculationold);_context.next=28;return _ledger["default"].findOne({where:{company_id:data.company_id,account_group_id:_config["default"].profit_loss_id}});case 28:findProfitLedger=_context.sent;debitProfiltAmount=0;creditProfiltAmount=0;diffrence=0;openAmount1=0;_context.next=35;return _company["default"].findOne({where:{uid:data.company_id}});case 35:findCompany=_context.sent;if(!findProfitLedger){_context.next=99;break;}_context.next=39;return(0,_ledger2.decreption)(findProfitLedger,'object',data.data.email);case 39:findProfitLedger=_context.sent;_context.next=42;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:findProfitLedger.dataValues.uid},{company_id:data.company_id},{invoice_date:(_invoice_date={},_defineProperty(_invoice_date,Op.gte,data.start_date),_defineProperty(_invoice_date,Op.lte,data.end_date),_invoice_date)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher',include:[{model:_ledger["default"],as:'Ledger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 42:_journalVoucher=_context.sent;if(findProfitLedger.dataValues.opening_balance=="credit"){if(new Date(findCompany.dataValues.bookstart_date).getFullYear()==new Date(data.start_date).getFullYear()){openAmount1=Number(calculationold.netProfite)+Number(findProfitLedger.dataValues.amount);creditProfiltAmount=Number(findProfitLedger.dataValues.amount);}else{// creditProfiltAmount = Number(calculationold.netProfite);
if(calculationold.netProfite<0){debitProfiltAmount=-1*Number(calculationold.netProfite);}else{creditProfiltAmount=Number(calculationold.netProfite);}}}else{if(new Date(findCompany.dataValues.bookstart_date).getFullYear()==new Date(data.start_date).getFullYear()){debitProfiltAmount=Number(findProfitLedger.dataValues.amount);}else{if(calculationold.netProfite<0){creditProfiltAmount=-1*Number(calculationold.netProfite);}else{debitProfiltAmount=Number(calculationold.netProfite);}}}console.log("creditProfiltAmount",creditProfiltAmount,debitProfiltAmount,calculationold.netProfite);responsedata=[{account_group_id:data.account_id,closeing_amount:Number(creditProfiltAmount)-Number(debitProfiltAmount),creditAmount:creditProfiltAmount,debitAmount:debitProfiltAmount,open:true,name:"Profit and Loss",open_amount:openAmount1>0?Number(openAmount1):Number(openAmount1),subAccount:{},sub_uid:""}// {
//     account_group_id: data.account_id,
//     closeing_amount: calculation.netProfite,
//     voucher_type:'',
//     ledger:{
//         name:"Profit and Loss",
//     },
//     invoice_date:'',
//     invoice_id:'',
//     creditAmount: Number(calculation.netProfite)>0?calculation.netProfite:0,
//     debitAmount:  Number(calculation.netProfite)<0?calculation.netProfite:0,
//     name: "Profit and Loss",
//     subAccount: {},
//     sub_uid: ""
// }
];if(!(_journalVoucher.length>0)){_context.next=97;break;}_context.next=49;return(0,_journalEntries.decreptionJournalEntries)(_journalVoucher,'array',data.data.email);case 49:_journalVoucher=_context.sent;i=0;case 51:if(!(i<_journalVoucher.length)){_context.next=97;break;}_context.next=54;return _journalVoucher[i].type;case 54:_context.t0=_context.sent;if(!(_context.t0==='debit')){_context.next=64;break;}_context.next=58;return _journalVoucher[i].amount;case 58:_journalVoucher[i].debitAmount=_context.sent;_context.next=61;return 0;case 61:_journalVoucher[i].creditAmount=_context.sent;_context.next=70;break;case 64:_context.next=66;return 0;case 66:_journalVoucher[i].debitAmount=_context.sent;_context.next=69;return _journalVoucher[i].amount;case 69:_journalVoucher[i].creditAmount=_context.sent;case 70:_context.next=72;return _journalVoucher[i].Voucher.invoice_date;case 72:_journalVoucher[i].invoice_date=_context.sent;_context.next=75;return'journal';case 75:_journalVoucher[i].voucher_type=_context.sent;_context.next=78;return _journalVoucher[i].Voucher.id;case 78:_journalVoucher[i].voucher_number=_context.sent;_context.next=81;return _journalVoucher[i].Voucher.invoice_id;case 81:_context.t1=_context.sent;if(!(_context.t1<=9)){_context.next=86;break;}_context.t2="".concat(_journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+_journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(_journalVoucher[i].Voucher.invoice_id);_context.next=87;break;case 86:_context.t2=_journalVoucher[i].Voucher.invoice_id>9?"".concat(_journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+_journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(_journalVoucher[i].Voucher.invoice_id):"".concat(_journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+_journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(_journalVoucher[i].Voucher.invoice_id);case 87:_journalVoucher[i].invoice_id=_context.t2;_context.next=90;return _journalVoucher[i].VoucherLedger;case 90:_journalVoucher[i].ledger=_context.sent;delete _journalVoucher[i].VoucherLedger;_context.next=94;return responsedata.push(_journalVoucher[i]);case 94:i++;_context.next=51;break;case 97:console.log("debitProfiltAmount",debitProfiltAmount,creditProfiltAmount,findProfitLedger.dataValues);return _context.abrupt("return",{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",JournalVoucher:responsedata,journalVoucherl:_journalVoucher});case 99:if(!ledger.dataValues.tax_key){_context.next=123;break;}_context.next=102;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:data.ledger_id},{type:'Sales'},{invoice_date:(_invoice_date2={},_defineProperty(_invoice_date2,Op.gte,data.start_date),_defineProperty(_invoice_date2,Op.lte,data.end_date),_invoice_date2)}]),include:[{model:_saleVoucher["default"],as:'tax',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 102:saleVoucher=_context.sent;_context.next=105;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:data.ledger_id},{type:'Purchase'},{invoice_date:(_invoice_date3={},_defineProperty(_invoice_date3,Op.gte,data.start_date),_defineProperty(_invoice_date3,Op.lte,data.end_date),_invoice_date3)}]),include:[{model:_purchaseVoucher["default"],as:'taxp',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 105:purchaseVoucher=_context.sent;_context.next=108;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:data.ledger_id},{type:'Debit'},{invoice_date:(_invoice_date4={},_defineProperty(_invoice_date4,Op.gte,data.start_date),_defineProperty(_invoice_date4,Op.lte,data.end_date),_invoice_date4)}]),include:[{model:_creditVoucher["default"],as:'taxc',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 108:creditVoucher=_context.sent;_context.next=111;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:data.ledger_id},{type:'Credit'},{invoice_date:(_invoice_date5={},_defineProperty(_invoice_date5,Op.gte,data.start_date),_defineProperty(_invoice_date5,Op.lte,data.end_date),_invoice_date5)}]),include:[{model:_debitVoucher["default"],as:'taxd',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 111:debitVoucher=_context.sent;_context.next=114;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:data.ledger_id},{company_id:data.company_id},{invoice_date:(_invoice_date6={},_defineProperty(_invoice_date6,Op.gte,data.start_date),_defineProperty(_invoice_date6,Op.lte,data.end_date),_invoice_date6)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 114:journalVoucher=_context.sent;_context.next=117;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:data.ledger_id},{invoice_date:(_invoice_date7={},_defineProperty(_invoice_date7,Op.gte,data.start_date),_defineProperty(_invoice_date7,Op.lte,data.end_date),_invoice_date7)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 117:recieptVoucher=_context.sent;_context.next=120;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:data.ledger_id},{invoice_date:(_invoice_date8={},_defineProperty(_invoice_date8,Op.gte,data.start_date),_defineProperty(_invoice_date8,Op.lte,data.end_date),_invoice_date8)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 120:paymentVoucher=_context.sent;_context.next=168;break;case 123:if(!ledger.dataValues.sale_key){_context.next=147;break;}_context.next=126;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:data.ledger_id},{type:'Sales'},{invoice_date:(_invoice_date9={},_defineProperty(_invoice_date9,Op.gte,data.start_date),_defineProperty(_invoice_date9,Op.lte,data.end_date),_invoice_date9)}]),include:[{model:_saleVoucher["default"],as:'Voucheris',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 126:saleVoucher=_context.sent;_context.next=129;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:data.ledger_id},{type:'Purchase'},{invoice_date:(_invoice_date10={},_defineProperty(_invoice_date10,Op.gte,data.start_date),_defineProperty(_invoice_date10,Op.lte,data.end_date),_invoice_date10)}]),include:[{model:_purchaseVoucher["default"],as:'Voucherip',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 129:purchaseVoucher=_context.sent;_context.next=132;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:data.ledger_id},{type:'Debit'},{invoice_date:(_invoice_date11={},_defineProperty(_invoice_date11,Op.gte,data.start_date),_defineProperty(_invoice_date11,Op.lte,data.end_date),_invoice_date11)}]),include:[{model:_creditVoucher["default"],as:'Voucheric',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 132:creditVoucher=_context.sent;_context.next=135;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:data.ledger_id},{type:'Credit'},{invoice_date:(_invoice_date12={},_defineProperty(_invoice_date12,Op.gte,data.start_date),_defineProperty(_invoice_date12,Op.lte,data.end_date),_invoice_date12)}]),include:[{model:_debitVoucher["default"],as:'Voucherid',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 135:debitVoucher=_context.sent;_context.next=138;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:data.ledger_id},{company_id:data.company_id},{invoice_date:(_invoice_date13={},_defineProperty(_invoice_date13,Op.gte,data.start_date),_defineProperty(_invoice_date13,Op.lte,data.end_date),_invoice_date13)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 138:journalVoucher=_context.sent;_context.next=141;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:data.ledger_id},{invoice_date:(_invoice_date14={},_defineProperty(_invoice_date14,Op.gte,data.start_date),_defineProperty(_invoice_date14,Op.lte,data.end_date),_invoice_date14)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 141:recieptVoucher=_context.sent;_context.next=144;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:data.ledger_id},{invoice_date:(_invoice_date15={},_defineProperty(_invoice_date15,Op.gte,data.start_date),_defineProperty(_invoice_date15,Op.lte,data.end_date),_invoice_date15)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 144:paymentVoucher=_context.sent;_context.next=168;break;case 147:_context.next=149;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:data.ledger_id},{company_id:data.company_id},{invoice_date:(_invoice_date16={},_defineProperty(_invoice_date16,Op.gte,data.start_date),_defineProperty(_invoice_date16,Op.lte,data.end_date),_invoice_date16)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 149:journalVoucher=_context.sent;_context.next=152;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:data.ledger_id},{invoice_date:(_invoice_date17={},_defineProperty(_invoice_date17,Op.gte,data.start_date),_defineProperty(_invoice_date17,Op.lte,data.end_date),_invoice_date17)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 152:saleVoucher=_context.sent;_context.next=155;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:data.ledger_id},{invoice_date:(_invoice_date18={},_defineProperty(_invoice_date18,Op.gte,data.start_date),_defineProperty(_invoice_date18,Op.lte,data.end_date),_invoice_date18)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 155:purchaseVoucher=_context.sent;_context.next=158;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:data.ledger_id},{invoice_date:(_invoice_date19={},_defineProperty(_invoice_date19,Op.gte,data.start_date),_defineProperty(_invoice_date19,Op.lte,data.end_date),_invoice_date19)}]),include:[{model:_ledger["default"],as:'CreditBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 158:creditVoucher=_context.sent;_context.next=161;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:data.ledger_id},{invoice_date:(_invoice_date20={},_defineProperty(_invoice_date20,Op.gte,data.start_date),_defineProperty(_invoice_date20,Op.lte,data.end_date),_invoice_date20)}]),include:[{model:_ledger["default"],as:'DebitBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 161:debitVoucher=_context.sent;_context.next=164;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:data.ledger_id},{invoice_date:(_invoice_date21={},_defineProperty(_invoice_date21,Op.gte,data.start_date),_defineProperty(_invoice_date21,Op.lte,data.end_date),_invoice_date21)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 164:recieptVoucher=_context.sent;_context.next=167;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:data.ledger_id},{invoice_date:(_invoice_date22={},_defineProperty(_invoice_date22,Op.gte,data.start_date),_defineProperty(_invoice_date22,Op.lte,data.end_date),_invoice_date22)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 167:paymentVoucher=_context.sent;case 168:_context.next=170;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:data.ledger_id},{invoice_date:(_invoice_date23={},_defineProperty(_invoice_date23,Op.gte,data.start_date),_defineProperty(_invoice_date23,Op.lte,data.end_date),_invoice_date23)}]),include:[{model:_ledger["default"],as:'ReciptReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 170:reciverrecieptVoucher=_context.sent;_context.next=173;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:data.ledger_id},{invoice_date:(_invoice_date24={},_defineProperty(_invoice_date24,Op.gte,data.start_date),_defineProperty(_invoice_date24,Op.lte,data.end_date),_invoice_date24)}]),include:[{model:_ledger["default"],as:'PaymentReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 173:reciverpaymentVoucher=_context.sent;_context.next=176;return(0,_ledger2.decreption)(ledger,'object',data.data.email);case 176:ledger=_context.sent;if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context.next=186;break;}_context.next=180;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{roundoff_ledger_id:data.ledger_id},{invoice_date:(_invoice_date25={},_defineProperty(_invoice_date25,Op.gte,data.start_date),_defineProperty(_invoice_date25,Op.lte,data.end_date),_invoice_date25)}]),include:[{model:_ledger["default"],as:'SalesRoundoffLedger'},{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 180:saleVoucher=_context.sent;_context.next=183;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{roundoff_ledger_id:data.ledger_id},{invoice_date:(_invoice_date26={},_defineProperty(_invoice_date26,Op.gte,data.start_date),_defineProperty(_invoice_date26,Op.lte,data.end_date),_invoice_date26)}]),include:[{model:_ledger["default"],as:'PurchaseRoundLedger'},{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 183:purchaseVoucher=_context.sent;_context.next=198;break;case 186:_context.next=188;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{discount_ledger:data.ledger_id},{invoice_date:(_invoice_date27={},_defineProperty(_invoice_date27,Op.gte,data.start_date),_defineProperty(_invoice_date27,Op.lte,data.end_date),_invoice_date27)}]),include:[{model:_ledger["default"],as:'SalesDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 188:discountsaleVoucher=_context.sent;_context.next=191;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{discount_ledger:data.ledger_id},{invoice_date:(_invoice_date28={},_defineProperty(_invoice_date28,Op.gte,data.start_date),_defineProperty(_invoice_date28,Op.lte,data.end_date),_invoice_date28)}]),include:[{model:_ledger["default"],as:'PurchaseDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 191:discountpurchaseVoucher=_context.sent;_context.next=194;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{discount_ledger:data.ledger_id},{invoice_date:(_invoice_date29={},_defineProperty(_invoice_date29,Op.gte,data.start_date),_defineProperty(_invoice_date29,Op.lte,data.end_date),_invoice_date29)}]),include:[{model:_ledger["default"],as:'CreditDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 194:discountcreditVoucher=_context.sent;_context.next=197;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{discount_ledger:data.ledger_id},{invoice_date:(_invoice_date30={},_defineProperty(_invoice_date30,Op.gte,data.start_date),_defineProperty(_invoice_date30,Op.lte,data.end_date),_invoice_date30)}]),include:[{model:_ledger["default"],as:'DebitDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 197:discountdebitVoucher=_context.sent;case 198:_context.next=200;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',data.data.email);case 200:journalVoucher=_context.sent;_context.next=203;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',data.data.email);case 203:recieptVoucher=_context.sent;_context.next=206;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',data.data.email);case 206:paymentVoucher=_context.sent;_context.next=209;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',data.data.email);case 209:saleVoucher=_context.sent;_context.next=212;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',data.data.email);case 212:purchaseVoucher=_context.sent;_context.next=215;return(0,_creditvoucher.decreptionCredit)(creditVoucher,'array',data.data.email);case 215:creditVoucher=_context.sent;_context.next=218;return(0,_debitvoucher.decreptionDebit)(debitVoucher,'array',data.data.email);case 218:debitVoucher=_context.sent;_context.next=221;return(0,_receiptvoucher.decreptionReceipt)(reciverrecieptVoucher,'array',data.data.email);case 221:reciverrecieptVoucher=_context.sent;_context.next=224;return(0,_paymentvoucher.decreptionPayment)(reciverpaymentVoucher,'array',data.data.email);case 224:reciverpaymentVoucher=_context.sent;if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context.next=229;break;}_context.next=228;return(0,_salesvoucher.decreptionSale)(discountsaleVoucher,'array',data.data.email);case 228:discountsaleVoucher=_context.sent;case 229:if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context.next=233;break;}_context.next=232;return(0,_purchasevoucher.decreptionPurchase)(discountpurchaseVoucher,'array',data.data.email);case 232:discountpurchaseVoucher=_context.sent;case 233:if(!(discountcreditVoucher&&discountcreditVoucher.length>0)){_context.next=237;break;}_context.next=236;return(0,_creditvoucher.decreptionCredit)(discountcreditVoucher,'array',data.data.email);case 236:discountcreditVoucher=_context.sent;case 237:if(!(discountdebitVoucher&&discountdebitVoucher.length>0)){_context.next=241;break;}_context.next=240;return(0,_debitvoucher.decreptionDebit)(discountdebitVoucher,'array',data.data.email);case 240:discountdebitVoucher=_context.sent;case 241:_context.next=243;return[];case 243:array=_context.sent;if(!(ledger&&ledger.dataValues.id)){_context.next=269;break;}if(!(ledger.dataValues.opening_balance==='Debit'||ledger.dataValues.opening_balance==='debit')){_context.next=254;break;}_context.next=248;return ledger.dataValues.amount;case 248:ledger.dataValues.debitAmount=_context.sent;_context.next=251;return 0;case 251:ledger.dataValues.creditAmount=_context.sent;_context.next=260;break;case 254:_context.next=256;return 0;case 256:ledger.dataValues.debitAmount=_context.sent;_context.next=259;return ledger.dataValues.amount;case 259:ledger.dataValues.creditAmount=_context.sent;case 260:_context.next=262;return true;case 262:ledger.dataValues.open=_context.sent;ledger.dataValues.voucher_type='';ledger.dataValues.voucher_number='';ledger.dataValues.invoice_id='';console.log("ledger.dataValues",ledger.dataValues);_context.next=269;return array.push(ledger.dataValues);case 269:_context.next=271;return _company["default"].findOne({where:{uid:data.company_id}});case 271:companyFind=_context.sent;totalcalculate_openingblance={};_context.next=275;return checkValid(ledger.dataValues.account_group_id);case 275:if(!_context.sent){_context.next=282;break;}_context.next=278;return getAllLedgerVouchercurrent(data.start_date,data.end_date,data.ledger_id,data.company_id,ledger.dataValues.creditAmount,ledger.dataValues.debitAmount,data.data.email);case 278:totalcalculate_openingblance=_context.sent;// return {totalcalculate_openingblance:totalcalculate_openingblance}
console.log("totalcalculate_openingblance",totalcalculate_openingblance);_context.next=286;break;case 282:_context.next=284;return getAllLedgerVoucherprivious(data.start_date,data.end_date,data.ledger_id,data.company_id,ledger.dataValues.creditAmount,ledger.dataValues.debitAmount,data.data.email);case 284:totalcalculate_openingblance=_context.sent;console.log("totalcalculate_openingblance privious",totalcalculate_openingblance);case 286:if(!(totalcalculate_openingblance<0)){_context.next=297;break;}_context.next=289;return-1;case 289:_context.t3=_context.sent;_context.t4=Number(totalcalculate_openingblance).toString();ledger.dataValues.debitAmount=_context.t3*_context.t4;_context.next=294;return 0;case 294:ledger.dataValues.creditAmount=_context.sent;_context.next=303;break;case 297:_context.next=299;return 0;case 299:ledger.dataValues.debitAmount=_context.sent;_context.next=302;return totalcalculate_openingblance.toString();case 302:ledger.dataValues.creditAmount=_context.sent;case 303:if(!(journalVoucher&&journalVoucher.length>0)){_context.next=351;break;}i=0;case 305:if(!(i<journalVoucher.length)){_context.next=351;break;}_context.next=308;return journalVoucher[i].type;case 308:_context.t5=_context.sent;if(!(_context.t5==='debit')){_context.next=318;break;}_context.next=312;return journalVoucher[i].amount;case 312:journalVoucher[i].debitAmount=_context.sent;_context.next=315;return 0;case 315:journalVoucher[i].creditAmount=_context.sent;_context.next=324;break;case 318:_context.next=320;return 0;case 320:journalVoucher[i].debitAmount=_context.sent;_context.next=323;return journalVoucher[i].amount;case 323:journalVoucher[i].creditAmount=_context.sent;case 324:_context.next=326;return journalVoucher[i].Voucher.invoice_date;case 326:journalVoucher[i].invoice_date=_context.sent;_context.next=329;return'journal';case 329:journalVoucher[i].voucher_type=_context.sent;_context.next=332;return journalVoucher[i].Voucher.id;case 332:journalVoucher[i].voucher_number=_context.sent;_context.next=335;return journalVoucher[i].Voucher.invoice_id;case 335:_context.t6=_context.sent;if(!(_context.t6<=9)){_context.next=340;break;}_context.t7="".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(journalVoucher[i].Voucher.invoice_id);_context.next=341;break;case 340:_context.t7=journalVoucher[i].Voucher.invoice_id>9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(journalVoucher[i].Voucher.invoice_id):"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(journalVoucher[i].Voucher.invoice_id);case 341:journalVoucher[i].invoice_id=_context.t7;_context.next=344;return journalVoucher[i].VoucherLedger;case 344:journalVoucher[i].ledger=_context.sent;delete journalVoucher[i].VoucherLedger;_context.next=348;return array.push(journalVoucher[i]);case 348:i++;_context.next=305;break;case 351:if(!(saleVoucher&&saleVoucher.length>0)){_context.next=595;break;}salearray=[];s=0;case 354:if(!(s<saleVoucher.length)){_context.next=595;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context.next=404;break;}if(!saleVoucher[s].roundoff_value){_context.next=402;break;}_context.next=359;return'sale';case 359:saleVoucher[s].voucher_type=_context.sent;_context.next=362;return saleVoucher[s].SalesLedger;case 362:saleVoucher[s].ledger=_context.sent;_context.next=365;return{};case 365:saleVoucher[s].Voucher=_context.sent;saleVoucher[s].type=saleVoucher[s].roundoff_type;_context.next=369;return saleVoucher[s].roundoff_type;case 369:_context.t8=_context.sent;if(!(_context.t8=="debit")){_context.next=374;break;}_context.t9=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context.next=375;break;case 374:_context.t9=0;case 375:saleVoucher[s].debitAmount=_context.t9;_context.next=378;return saleVoucher[s].roundoff_type;case 378:_context.t10=_context.sent;if(!(_context.t10=="credit")){_context.next=383;break;}_context.t11=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context.next=384;break;case 383:_context.t11=0;case 384:saleVoucher[s].creditAmount=_context.t11;saleVoucher[s].amount=saleVoucher[s].roundoff_value;_context.next=388;return saleVoucher[s].id;case 388:saleVoucher[s].voucher_number=_context.sent;_context.next=391;return saleVoucher[s].invoice_id;case 391:_context.t12=_context.sent;if(!(_context.t12<=9)){_context.next=396;break;}_context.t13="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context.next=397;break;case 396:_context.t13=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(ssaleVoucher[s].invoice_id);case 397:saleVoucher[s].invoice_id=_context.t13;delete saleVoucher[s].SalesLedger;if(!saleVoucher[s].amount){_context.next=402;break;}_context.next=402;return array.push(saleVoucher[s]);case 402:_context.next=592;break;case 404:if(!ledger.dataValues.sale_key){_context.next=511;break;}if(!(salearray.length>0)){_context.next=462;break;}_context.next=408;return salearray.find(function(it){return saleVoucher[s].Voucheris&&it.invoice_idold==saleVoucher[s].Voucheris.invoice_id;});case 408:findSales=_context.sent;if(!(findSales&&findSales.Voucher)){_context.next=412;break;}_context.next=460;break;case 412:_context.next=414;return'sale';case 414:saleVoucher[s].voucher_type=_context.sent;if(!saleVoucher[s].Voucheris){_context.next=422;break;}_context.next=418;return saleVoucher[s].Voucheris.SalesLedger;case 418:saleVoucher[s].ledger=_context.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context.next=423;break;case 422:saleVoucher[s].ledger={};case 423:_context.next=425;return saleVoucher[s].Voucheris;case 425:if(!_context.sent){_context.next=429;break;}_context.t14=saleVoucher[s].Voucheris;_context.next=430;break;case 429:_context.t14={};case 430:saleVoucher[s].Voucher=_context.t14;saleVoucher[s].type='credit';_context.next=434;return 0;case 434:saleVoucher[s].debitAmount=_context.sent;_context.next=437;return saleVoucher[s].total_amount;case 437:saleVoucher[s].creditAmount=_context.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context.next=441;return saleVoucher[s].Voucheris;case 441:if(!_context.sent){_context.next=445;break;}_context.t15=saleVoucher[s].Voucheris.id;_context.next=446;break;case 445:_context.t15='';case 446:saleVoucher[s].voucher_number=_context.t15;_context.next=449;return saleVoucher[s].Voucheris;case 449:if(!_context.sent){_context.next=453;break;}_context.t16=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context.next=454;break;case 453:_context.t16='';case 454:saleVoucher[s].invoice_id=_context.t16;delete saleVoucher[s].Voucheris;_context.next=458;return salearray.push(saleVoucher[s]);case 458:_context.next=460;return array.push(saleVoucher[s]);case 460:_context.next=509;break;case 462:_context.next=464;return'sale';case 464:saleVoucher[s].voucher_type=_context.sent;if(!saleVoucher[s].Voucheris){_context.next=472;break;}_context.next=468;return saleVoucher[s].Voucheris.SalesLedger;case 468:saleVoucher[s].ledger=_context.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context.next=473;break;case 472:saleVoucher[s].ledger={};case 473:_context.next=475;return saleVoucher[s].Voucheris;case 475:if(!_context.sent){_context.next=479;break;}_context.t17=saleVoucher[s].Voucheris;_context.next=480;break;case 479:_context.t17={};case 480:saleVoucher[s].Voucher=_context.t17;saleVoucher[s].type='credit';_context.next=484;return 0;case 484:saleVoucher[s].debitAmount=_context.sent;_context.next=487;return saleVoucher[s].total_amount;case 487:saleVoucher[s].creditAmount=_context.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context.next=491;return saleVoucher[s].Voucheris;case 491:if(!_context.sent){_context.next=495;break;}_context.t18=saleVoucher[s].Voucheris.id;_context.next=496;break;case 495:_context.t18='';case 496:saleVoucher[s].voucher_number=_context.t18;_context.next=499;return saleVoucher[s].Voucheris;case 499:if(!_context.sent){_context.next=503;break;}_context.t19=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context.next=504;break;case 503:_context.t19='';case 504:saleVoucher[s].invoice_id=_context.t19;_context.next=507;return salearray.push(saleVoucher[s]);case 507:_context.next=509;return array.push(saleVoucher[s]);case 509:_context.next=592;break;case 511:if(!ledger.dataValues.tax_key){_context.next=560;break;}_context.next=514;return'sale';case 514:saleVoucher[s].voucher_type=_context.sent;if(!saleVoucher[s].tax){_context.next=522;break;}_context.next=518;return saleVoucher[s].tax.SalesLedger;case 518:saleVoucher[s].ledger=_context.sent;delete saleVoucher[s].tax.SalesLedger;_context.next=523;break;case 522:saleVoucher[s].ledger={};case 523:_context.next=525;return saleVoucher[s].tax;case 525:if(!_context.sent){_context.next=529;break;}_context.t20=saleVoucher[s].tax;_context.next=530;break;case 529:_context.t20={};case 530:saleVoucher[s].Voucher=_context.t20;saleVoucher[s].type='credit';_context.next=534;return 0;case 534:saleVoucher[s].debitAmount=_context.sent;_context.next=537;return saleVoucher[s].amount;case 537:saleVoucher[s].creditAmount=_context.sent;saleVoucher[s].amount=saleVoucher[s].amount;_context.next=541;return saleVoucher[s].tax;case 541:if(!_context.sent){_context.next=545;break;}_context.t21=saleVoucher[s].tax.id;_context.next=546;break;case 545:_context.t21='';case 546:saleVoucher[s].voucher_number=_context.t21;_context.next=549;return saleVoucher[s].tax;case 549:if(!_context.sent){_context.next=553;break;}_context.t22=saleVoucher[s].tax.invoice_id<=9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].tax.invoice_id):saleVoucher[s].tax.invoice_id>9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].tax.invoice_id):"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/").concat(saleVoucher[s].tax.invoice_id);_context.next=554;break;case 553:_context.t22='';case 554:saleVoucher[s].invoice_id=_context.t22;delete saleVoucher[s].tax;_context.next=558;return array.push(saleVoucher[s]);case 558:_context.next=592;break;case 560:_context.next=562;return'sale';case 562:saleVoucher[s].voucher_type=_context.sent;_context.next=565;return saleVoucher[s].SalesLedger;case 565:saleVoucher[s].ledger=_context.sent;_context.next=568;return{};case 568:saleVoucher[s].Voucher=_context.sent;saleVoucher[s].type='debit';_context.next=572;return 0;case 572:saleVoucher[s].debitAmount=_context.sent;_context.next=575;return saleVoucher[s].total_amount;case 575:saleVoucher[s].creditAmount=_context.sent;saleVoucher[s].amount=saleVoucher[s].total_amount;_context.next=579;return saleVoucher[s].id;case 579:saleVoucher[s].voucher_number=_context.sent;_context.next=582;return saleVoucher[s].invoice_id;case 582:_context.t23=_context.sent;if(!(_context.t23<=9)){_context.next=587;break;}_context.t24="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context.next=588;break;case 587:_context.t24=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(saleVoucher[s].invoice_id);case 588:saleVoucher[s].invoice_id=_context.t24;delete saleVoucher[s].SalesLedger;_context.next=592;return array.push(saleVoucher[s]);case 592:s++;_context.next=354;break;case 595:if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context.next=651;break;}_salearray=[];s=0;case 598:if(!(s<discountsaleVoucher.length)){_context.next=651;break;}if(!discountsaleVoucher[s].discount){_context.next=648;break;}_context.next=602;return'sale';case 602:discountsaleVoucher[s].voucher_type=_context.sent;_context.next=605;return discountsaleVoucher[s].SalesDiscountLedger;case 605:discountsaleVoucher[s].ledger=_context.sent;_context.next=608;return{};case 608:discountsaleVoucher[s].Voucher=_context.sent;discountsaleVoucher[s].type=discountsaleVoucher[s].discount&&Number(discountsaleVoucher[s].discount)>0?'Credit':'Debit';_context.next=612;return discountsaleVoucher[s].discount;case 612:_context.t25=_context.sent;if(!_context.t25){_context.next=615;break;}_context.t25=Number(discountsaleVoucher[s].discount)<0;case 615:if(!_context.t25){_context.next=619;break;}_context.t26=-1*Number(discountsaleVoucher[s].discount);_context.next=620;break;case 619:_context.t26=0;case 620:discountsaleVoucher[s].debitAmount=_context.t26;_context.next=623;return discountsaleVoucher[s].discount;case 623:_context.t27=_context.sent;if(!_context.t27){_context.next=626;break;}_context.t27=Number(discountsaleVoucher[s].discount)>0;case 626:if(!_context.t27){_context.next=630;break;}_context.t28=Number(discountsaleVoucher[s].discount);_context.next=631;break;case 630:_context.t28=0;case 631:discountsaleVoucher[s].creditAmount=_context.t28;discountsaleVoucher[s].amount=discountsaleVoucher[s].discount&&Number(discountsaleVoucher[s].discount)>0?Number(discountsaleVoucher[s].discount):-1*Number(discountsaleVoucher[s].discount);_context.next=635;return discountsaleVoucher[s].id;case 635:discountsaleVoucher[s].voucher_number=_context.sent;_context.next=638;return discountsaleVoucher[s].invoice_id;case 638:_context.t29=_context.sent;if(!(_context.t29<=9)){_context.next=643;break;}_context.t30="".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/00").concat(discountsaleVoucher[s].invoice_id);_context.next=644;break;case 643:_context.t30=discountsaleVoucher[s].invoice_id>9?"".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/0").concat(discountsaleVoucher[s].invoice_id):"".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/").concat(discountsaleVoucher[s].invoice_id);case 644:discountsaleVoucher[s].invoice_id=_context.t30;delete discountsaleVoucher[s].SalesDiscountLedger;_context.next=648;return array.push(discountsaleVoucher[s]);case 648:s++;_context.next=598;break;case 651:if(!(discountpurchaseVoucher&&discountpurchaseVoucher.length>0)){_context.next=701;break;}_salearray2=[];s=0;case 654:if(!(s<discountpurchaseVoucher.length)){_context.next=701;break;}if(!discountpurchaseVoucher[s].discount){_context.next=698;break;}_context.next=658;return'purchase';case 658:discountpurchaseVoucher[s].voucher_type=_context.sent;_context.next=661;return discountpurchaseVoucher[s].PurchaseDiscountLedger;case 661:discountpurchaseVoucher[s].ledger=_context.sent;_context.next=664;return{};case 664:discountpurchaseVoucher[s].Voucher=_context.sent;discountpurchaseVoucher[s].type=discountpurchaseVoucher[s].discount&&Number(discountpurchaseVoucher[s].discount)>0?'Debit':'Credit';_context.next=668;return discountpurchaseVoucher[s].discount;case 668:_context.t31=_context.sent;if(!_context.t31){_context.next=671;break;}_context.t31=Number(discountpurchaseVoucher[s].discount)>0;case 671:if(!_context.t31){_context.next=675;break;}_context.t32=Number(discountpurchaseVoucher[s].discount);_context.next=676;break;case 675:_context.t32=0;case 676:discountpurchaseVoucher[s].debitAmount=_context.t32;_context.next=679;return discountpurchaseVoucher[s].discount;case 679:_context.t33=_context.sent;if(!_context.t33){_context.next=682;break;}_context.t33=Number(discountpurchaseVoucher[s].discount)<0;case 682:if(!_context.t33){_context.next=686;break;}_context.t34=-1*Number(discountpurchaseVoucher[s].discount);_context.next=687;break;case 686:_context.t34=0;case 687:discountpurchaseVoucher[s].creditAmount=_context.t34;discountpurchaseVoucher[s].amount=discountpurchaseVoucher[s].discount&&Number(discountpurchaseVoucher[s].discount)>0?Number(discountpurchaseVoucher[s].discount):Number(discountpurchaseVoucher[s].discount);_context.next=691;return discountpurchaseVoucher[s].id;case 691:discountpurchaseVoucher[s].voucher_number=_context.sent;_context.next=694;return discountpurchaseVoucher[s].invoice_id;case 694:discountpurchaseVoucher[s].invoice_id=_context.sent;delete discountpurchaseVoucher[s].PurchaseDiscountLedger;_context.next=698;return array.push(discountpurchaseVoucher[s]);case 698:s++;_context.next=654;break;case 701:if(!(discountcreditVoucher&&discountcreditVoucher.length>0)){_context.next=760;break;}_salearray3=[];s=0;case 704:if(!(s<discountcreditVoucher.length)){_context.next=760;break;}if(!discountcreditVoucher[s].discount){_context.next=757;break;}_context.next=708;return'sales return';case 708:discountcreditVoucher[s].voucher_type=_context.sent;_context.next=711;return discountcreditVoucher[s].CreditDiscountLedger;case 711:discountcreditVoucher[s].ledger=_context.sent;_context.next=714;return{};case 714:discountcreditVoucher[s].Voucher=_context.sent;discountcreditVoucher[s].type=discountcreditVoucher[s].discount&&Number(discountcreditVoucher[s].discount)>0?'Debit':'Credit';_context.next=718;return discountcreditVoucher[s].discount;case 718:_context.t35=_context.sent;if(!_context.t35){_context.next=721;break;}_context.t35=Number(discountcreditVoucher[s].discount)>0;case 721:if(!_context.t35){_context.next=725;break;}_context.t36=Number(discountcreditVoucher[s].discount);_context.next=726;break;case 725:_context.t36=0;case 726:discountcreditVoucher[s].debitAmount=_context.t36;_context.next=729;return discountcreditVoucher[s].discount;case 729:_context.t37=_context.sent;if(!_context.t37){_context.next=732;break;}_context.t37=Number(discountcreditVoucher[s].discount)<0;case 732:if(!_context.t37){_context.next=736;break;}_context.t38=-1*Number(discountcreditVoucher[s].discount);_context.next=737;break;case 736:_context.t38=0;case 737:discountcreditVoucher[s].creditAmount=_context.t38;discountcreditVoucher[s].amount=discountcreditVoucher[s].discount&&Number(discountcreditVoucher[s].discount)>0?Number(discountcreditVoucher[s].discount):Number(discountcreditVoucher[s].discount);_context.next=741;return discountcreditVoucher[s].invoice_id;case 741:_context.t39=_context.sent;if(!(_context.t39<=9)){_context.next=746;break;}_context.t40="".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/00").concat(discountcreditVoucher[s].invoice_id);_context.next=747;break;case 746:_context.t40=discountcreditVoucher[s].invoice_id>9?"".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/0").concat(discountcreditVoucher[s].invoice_id):"".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/").concat(discountcreditVoucher[s].invoice_id);case 747:discountcreditVoucher[s].invoice_id=_context.t40;_context.next=750;return discountcreditVoucher[s].id;case 750:discountcreditVoucher[s].voucher_number=_context.sent;_context.next=753;return discountcreditVoucher[s].invoice_id;case 753:discountcreditVoucher[s].invoice_id=_context.sent;delete discountcreditVoucher[s].CreditDiscountLedger;_context.next=757;return array.push(discountcreditVoucher[s]);case 757:s++;_context.next=704;break;case 760:if(!(discountdebitVoucher&&discountdebitVoucher.length>0)){_context.next=816;break;}_salearray4=[];s=0;case 763:if(!(s<discountdebitVoucher.length)){_context.next=816;break;}if(!discountdebitVoucher[s].discount){_context.next=813;break;}_context.next=767;return'purchase return';case 767:discountdebitVoucher[s].voucher_type=_context.sent;_context.next=770;return discountdebitVoucher[s].DebitDiscountLedger;case 770:discountdebitVoucher[s].ledger=_context.sent;_context.next=773;return{};case 773:discountdebitVoucher[s].Voucher=_context.sent;discountdebitVoucher[s].type=discountdebitVoucher[s].discount&&Number(discountdebitVoucher[s].discount)>0?'Credit':'debit';_context.next=777;return discountdebitVoucher[s].discount;case 777:_context.t41=_context.sent;if(!_context.t41){_context.next=780;break;}_context.t41=Number(discountdebitVoucher[s].discount)<0;case 780:if(!_context.t41){_context.next=784;break;}_context.t42=-1*Number(discountdebitVoucher[s].discount);_context.next=785;break;case 784:_context.t42=0;case 785:discountdebitVoucher[s].debitAmount=_context.t42;_context.next=788;return discountdebitVoucher[s].discount;case 788:_context.t43=_context.sent;if(!_context.t43){_context.next=791;break;}_context.t43=Number(discountdebitVoucher[s].discount)>0;case 791:if(!_context.t43){_context.next=795;break;}_context.t44=Number(discountdebitVoucher[s].discount);_context.next=796;break;case 795:_context.t44=0;case 796:discountdebitVoucher[s].creditAmount=_context.t44;discountdebitVoucher[s].amount=discountdebitVoucher[s].discount&&Number(discountdebitVoucher[s].discount)>0?Number(discountdebitVoucher[s].discount):Number(discountdebitVoucher[s].discount);_context.next=800;return discountdebitVoucher[s].id;case 800:discountdebitVoucher[s].voucher_number=_context.sent;_context.next=803;return discountdebitVoucher[s].invoice_id;case 803:_context.t45=_context.sent;if(!(_context.t45<=9)){_context.next=808;break;}_context.t46="".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/00").concat(discountdebitVoucher[s].invoice_id);_context.next=809;break;case 808:_context.t46=discountdebitVoucher[s].invoice_id>9?"".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/0").concat(discountdebitVoucher[s].invoice_id):"".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/").concat(discountdebitVoucher[s].invoice_id);case 809:discountdebitVoucher[s].invoice_id=_context.t46;delete discountdebitVoucher[s].DebitDiscountLedger;_context.next=813;return array.push(discountdebitVoucher[s]);case 813:s++;_context.next=763;break;case 816:if(!(purchaseVoucher&&purchaseVoucher.length>0)){_context.next=1069;break;}console.log("come purchaseVoucher");purchasearray=[];s=0;case 820:if(!(s<purchaseVoucher.length)){_context.next=1069;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context.next=869;break;}_context.next=824;return'purchase';case 824:purchaseVoucher[s].voucher_type=_context.sent;_context.next=827;return purchaseVoucher[s].PurchaseLedger;case 827:purchaseVoucher[s].ledger=_context.sent;_context.next=830;return{};case 830:purchaseVoucher[s].Voucher=_context.sent;purchaseVoucher[s].type=purchaseVoucher[s].roundoff_type;_context.next=834;return purchaseVoucher[s].roundoff_type;case 834:_context.t47=_context.sent;if(!(_context.t47=="debit")){_context.next=839;break;}_context.t48=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context.next=840;break;case 839:_context.t48=0;case 840:purchaseVoucher[s].debitAmount=_context.t48;_context.next=843;return purchaseVoucher[s].roundoff_type;case 843:_context.t49=_context.sent;if(!(_context.t49=="credit")){_context.next=848;break;}_context.t50=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context.next=849;break;case 848:_context.t50=0;case 849:purchaseVoucher[s].creditAmount=_context.t50;purchaseVoucher[s].amount=purchaseVoucher[s].roundoff_value;_context.next=853;return purchaseVoucher[s].id;case 853:purchaseVoucher[s].voucher_number=_context.sent;_context.next=856;return purchaseVoucher[s].invoice_id;case 856:_context.t51=_context.sent;if(!(_context.t51<=9)){_context.next=861;break;}_context.t52="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context.next=862;break;case 861:_context.t52=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 862:purchaseVoucher[s].invoice_id=_context.t52;delete purchaseVoucher[s].PurchaseLedger;// await array.push(purchaseVoucher[s]);
if(!purchaseVoucher[s].amount){_context.next=867;break;}_context.next=867;return array.push(purchaseVoucher[s]);case 867:_context.next=1066;break;case 869:if(!ledger.dataValues.sale_key){_context.next=985;break;}if(!(purchaseVoucher.length>0)){_context.next=931;break;}_context.next=873;return purchasearray.find(function(it){return purchaseVoucher[s].Voucherip&&it.invoice_idold==purchaseVoucher[s].Voucherip.invoice_id;});case 873:_findSales=_context.sent;if(!(_findSales&&_findSales.Voucher)){_context.next=877;break;}_context.next=929;break;case 877:_context.next=879;return'purchase';case 879:purchaseVoucher[s].voucher_type=_context.sent;if(!purchaseVoucher[s].Voucherip){_context.next=887;break;}_context.next=883;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 883:purchaseVoucher[s].ledger=_context.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context.next=888;break;case 887:purchaseVoucher[s].ledger={};case 888:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context.next=891;return purchaseVoucher[s].Voucherip;case 891:if(!_context.sent){_context.next=895;break;}_context.t53=purchaseVoucher[s].Voucherip;_context.next=896;break;case 895:_context.t53={};case 896:purchaseVoucher[s].Voucher=_context.t53;purchaseVoucher[s].type='debit';_context.next=900;return purchaseVoucher[s].total_amount;case 900:purchaseVoucher[s].debitAmount=_context.sent;_context.next=903;return 0;case 903:purchaseVoucher[s].creditAmount=_context.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context.next=907;return purchaseVoucher[s].Voucherip;case 907:if(!_context.sent){_context.next=911;break;}_context.t54=purchaseVoucher[s].Voucherip.id;_context.next=912;break;case 911:_context.t54='';case 912:purchaseVoucher[s].voucher_number=_context.t54;_context.next=915;return purchaseVoucher[s].Voucherip;case 915:_context.t55=_context.sent;if(!_context.t55){_context.next=918;break;}_context.t55=purchaseVoucher[s].Voucherip.invoice_id;case 918:if(!_context.t55){_context.next=922;break;}_context.t56=purchaseVoucher[s].Voucherip.invoice_id;_context.next=923;break;case 922:_context.t56='';case 923:purchaseVoucher[s].invoice_id=_context.t56;delete purchaseVoucher[s].Voucherip;_context.next=927;return purchasearray.push(purchaseVoucher[s]);case 927:_context.next=929;return array.push(purchaseVoucher[s]);case 929:_context.next=983;break;case 931:_context.next=933;return'purchase';case 933:purchaseVoucher[s].voucher_type=_context.sent;if(!purchaseVoucher[s].Voucherip){_context.next=941;break;}_context.next=937;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 937:purchaseVoucher[s].ledger=_context.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context.next=942;break;case 941:purchaseVoucher[s].ledger={};case 942:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context.next=945;return purchaseVoucher[s].Voucherip;case 945:if(!_context.sent){_context.next=949;break;}_context.t57=purchaseVoucher[s].Voucherip;_context.next=950;break;case 949:_context.t57={};case 950:purchaseVoucher[s].Voucher=_context.t57;purchaseVoucher[s].type='debit';_context.next=954;return purchaseVoucher[s].total_amount;case 954:purchaseVoucher[s].debitAmount=_context.sent;_context.next=957;return 0;case 957:purchaseVoucher[s].creditAmount=_context.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context.next=961;return purchaseVoucher[s].Voucherip;case 961:if(!_context.sent){_context.next=965;break;}_context.t58=purchaseVoucher[s].Voucherip.id;_context.next=966;break;case 965:_context.t58='';case 966:purchaseVoucher[s].voucher_number=_context.t58;_context.next=969;return purchaseVoucher[s].Voucherip;case 969:_context.t59=_context.sent;if(!_context.t59){_context.next=972;break;}_context.t59=purchaseVoucher[s].Voucherip.invoice_id;case 972:if(!_context.t59){_context.next=976;break;}_context.t60=purchaseVoucher[s].Voucherip.invoice_id;_context.next=977;break;case 976:_context.t60='';case 977:purchaseVoucher[s].invoice_id=_context.t60;delete purchaseVoucher[s].Voucherip;_context.next=981;return purchasearray.push(purchaseVoucher[s]);case 981:_context.next=983;return array.push(purchaseVoucher[s]);case 983:_context.next=1066;break;case 985:if(!ledger.dataValues.tax_key){_context.next=1034;break;}_context.next=988;return'purchase';case 988:purchaseVoucher[s].voucher_type=_context.sent;if(!purchaseVoucher[s].taxp){_context.next=996;break;}_context.next=992;return purchaseVoucher[s].taxp.PurchaseLedger;case 992:purchaseVoucher[s].ledger=_context.sent;delete purchaseVoucher[s].taxp.PurchaseLedger;_context.next=997;break;case 996:purchaseVoucher[s].ledger={};case 997:_context.next=999;return purchaseVoucher[s].taxp;case 999:if(!_context.sent){_context.next=1003;break;}_context.t61=purchaseVoucher[s].taxp;_context.next=1004;break;case 1003:_context.t61={};case 1004:purchaseVoucher[s].Voucher=_context.t61;purchaseVoucher[s].type='debit';_context.next=1008;return purchaseVoucher[s].amount;case 1008:purchaseVoucher[s].debitAmount=_context.sent;_context.next=1011;return 0;case 1011:purchaseVoucher[s].creditAmount=_context.sent;purchaseVoucher[s].amount=purchaseVoucher[s].amount;_context.next=1015;return purchaseVoucher[s].taxp;case 1015:if(!_context.sent){_context.next=1019;break;}_context.t62=purchaseVoucher[s].taxp.id;_context.next=1020;break;case 1019:_context.t62='';case 1020:purchaseVoucher[s].voucher_number=_context.t62;_context.next=1023;return purchaseVoucher[s].taxp;case 1023:if(!_context.sent){_context.next=1027;break;}_context.t63=purchaseVoucher[s].taxp.invoice_id<=9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):purchaseVoucher[s].taxp.invoice_id>9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id);_context.next=1028;break;case 1027:_context.t63='';case 1028:purchaseVoucher[s].invoice_id=_context.t63;delete purchaseVoucher[s].tax;_context.next=1032;return array.push(purchaseVoucher[s]);case 1032:_context.next=1066;break;case 1034:_context.next=1036;return'purchase';case 1036:purchaseVoucher[s].voucher_type=_context.sent;_context.next=1039;return purchaseVoucher[s].PurchaseLedger;case 1039:purchaseVoucher[s].ledger=_context.sent;_context.next=1042;return{};case 1042:purchaseVoucher[s].Voucher=_context.sent;purchaseVoucher[s].type='credit';_context.next=1046;return purchaseVoucher[s].total_amount;case 1046:purchaseVoucher[s].debitAmount=_context.sent;_context.next=1049;return 0;case 1049:purchaseVoucher[s].creditAmount=_context.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context.next=1053;return purchaseVoucher[s].id;case 1053:purchaseVoucher[s].voucher_number=_context.sent;_context.next=1056;return purchaseVoucher[s].invoice_id;case 1056:_context.t64=_context.sent;if(!(_context.t64<=9)){_context.next=1061;break;}_context.t65="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context.next=1062;break;case 1061:_context.t65=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 1062:purchaseVoucher[s].invoice_id=_context.t65;delete purchaseVoucher[s].PurchaseLedger;_context.next=1066;return array.push(purchaseVoucher[s]);case 1066:s++;_context.next=820;break;case 1069:if(!(creditVoucher&&creditVoucher.length>0)){_context.next=1205;break;}s=0;case 1071:if(!(s<creditVoucher.length)){_context.next=1205;break;}if(!ledger.dataValues.sale_key){_context.next=1121;break;}_context.next=1075;return'Sale Return';case 1075:creditVoucher[s].voucher_type=_context.sent;if(!creditVoucher[s].Voucheric){_context.next=1083;break;}_context.next=1079;return creditVoucher[s].Voucheric.CreditBuyer;case 1079:creditVoucher[s].ledger=_context.sent;delete creditVoucher[s].Voucheric.CreditBuyer;_context.next=1084;break;case 1083:creditVoucher[s].ledger={};case 1084:_context.next=1086;return creditVoucher[s].Voucheric;case 1086:if(!_context.sent){_context.next=1090;break;}_context.t66=creditVoucher[s].Voucheric;_context.next=1091;break;case 1090:_context.t66={};case 1091:creditVoucher[s].Voucher=_context.t66;creditVoucher[s].type='debit';_context.next=1095;return creditVoucher[s].total_amount;case 1095:creditVoucher[s].debitAmount=_context.sent;_context.next=1098;return 0;case 1098:creditVoucher[s].creditAmount=_context.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context.next=1102;return creditVoucher[s].Voucheric;case 1102:if(!_context.sent){_context.next=1106;break;}_context.t67=creditVoucher[s].Voucheric.id;_context.next=1107;break;case 1106:_context.t67='';case 1107:creditVoucher[s].voucher_number=_context.t67;_context.next=1110;return creditVoucher[s].Voucheric;case 1110:if(!_context.sent){_context.next=1114;break;}_context.t68=creditVoucher[s].Voucheric.invoice_id<=9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].Voucheric.invoice_id):creditVoucher[s].Voucheric.invoice_id>9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].Voucheric.invoice_id):"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/").concat(creditVoucher[s].Voucheric.invoice_id);_context.next=1115;break;case 1114:_context.t68='';case 1115:creditVoucher[s].invoice_id=_context.t68;delete creditVoucher[s].Voucheric;_context.next=1119;return array.push(creditVoucher[s]);case 1119:_context.next=1202;break;case 1121:if(!ledger.dataValues.tax_key){_context.next=1170;break;}_context.next=1124;return'Sale Return';case 1124:creditVoucher[s].voucher_type=_context.sent;if(!creditVoucher[s].taxc){_context.next=1132;break;}_context.next=1128;return creditVoucher[s].taxc.CreditBuyer;case 1128:creditVoucher[s].ledger=_context.sent;delete creditVoucher[s].taxc.CreditBuyer;_context.next=1133;break;case 1132:creditVoucher[s].ledger={};case 1133:_context.next=1135;return creditVoucher[s].taxc;case 1135:if(!_context.sent){_context.next=1139;break;}_context.t69=creditVoucher[s].taxc;_context.next=1140;break;case 1139:_context.t69={};case 1140:creditVoucher[s].Voucher=_context.t69;creditVoucher[s].type='debit';_context.next=1144;return creditVoucher[s].amount;case 1144:creditVoucher[s].debitAmount=_context.sent;_context.next=1147;return 0;case 1147:creditVoucher[s].creditAmount=_context.sent;creditVoucher[s].amount=creditVoucher[s].amount;_context.next=1151;return creditVoucher[s].taxc;case 1151:if(!_context.sent){_context.next=1155;break;}_context.t70=creditVoucher[s].taxc.id;_context.next=1156;break;case 1155:_context.t70='';case 1156:creditVoucher[s].voucher_number=_context.t70;_context.next=1159;return creditVoucher[s].taxc;case 1159:if(!_context.sent){_context.next=1163;break;}_context.t71=creditVoucher[s].taxc.invoice_id<=9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].taxc.invoice_id):creditVoucher[s].taxc.invoice_id>9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].taxc.invoice_id):"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/").concat(creditVoucher[s].taxc.invoice_id);_context.next=1164;break;case 1163:_context.t71='';case 1164:creditVoucher[s].invoice_id=_context.t71;delete creditVoucher[s].taxc;_context.next=1168;return array.push(creditVoucher[s]);case 1168:_context.next=1202;break;case 1170:_context.next=1172;return'Sale Return';case 1172:creditVoucher[s].voucher_type=_context.sent;_context.next=1175;return creditVoucher[s].CreditBuyer;case 1175:creditVoucher[s].ledger=_context.sent;_context.next=1178;return{};case 1178:creditVoucher[s].Voucher=_context.sent;creditVoucher[s].type='credit';_context.next=1182;return creditVoucher[s].total_amount;case 1182:creditVoucher[s].debitAmount=_context.sent;_context.next=1185;return 0;case 1185:creditVoucher[s].creditAmount=_context.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context.next=1189;return creditVoucher[s].id;case 1189:creditVoucher[s].voucher_number=_context.sent;_context.next=1192;return creditVoucher[s].invoice_id;case 1192:_context.t72=_context.sent;if(!(_context.t72<=9)){_context.next=1197;break;}_context.t73="".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/00").concat(creditVoucher[s].invoice_id);_context.next=1198;break;case 1197:_context.t73=creditVoucher[s].invoice_id>9?"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/0").concat(creditVoucher[s].invoice_id):"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/").concat(creditVoucher[s].invoice_id);case 1198:creditVoucher[s].invoice_id=_context.t73;delete creditVoucher[s].CreditBuyer;_context.next=1202;return array.push(creditVoucher[s]);case 1202:s++;_context.next=1071;break;case 1205:if(!(debitVoucher&&debitVoucher.length>0)){_context.next=1341;break;}s=0;case 1207:if(!(s<debitVoucher.length)){_context.next=1341;break;}if(!ledger.dataValues.sale_key){_context.next=1257;break;}_context.next=1211;return'Purchase Return';case 1211:debitVoucher[s].voucher_type=_context.sent;if(!debitVoucher[s].Voucherid){_context.next=1219;break;}_context.next=1215;return debitVoucher[s].Voucherid.DebitBuyer;case 1215:debitVoucher[s].ledger=_context.sent;delete debitVoucher[s].Voucherid.DebitBuyer;_context.next=1220;break;case 1219:debitVoucher[s].ledger={};case 1220:_context.next=1222;return debitVoucher[s].Voucherid;case 1222:if(!_context.sent){_context.next=1226;break;}_context.t74=debitVoucher[s].Voucherid;_context.next=1227;break;case 1226:_context.t74={};case 1227:debitVoucher[s].Voucher=_context.t74;debitVoucher[s].type='Credit';_context.next=1231;return 0;case 1231:debitVoucher[s].debitAmount=_context.sent;_context.next=1234;return debitVoucher[s].total_amount;case 1234:debitVoucher[s].creditAmount=_context.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context.next=1238;return debitVoucher[s].Voucherid;case 1238:if(!_context.sent){_context.next=1242;break;}_context.t75=debitVoucher[s].Voucherid.id;_context.next=1243;break;case 1242:_context.t75='';case 1243:debitVoucher[s].voucher_number=_context.t75;_context.next=1246;return debitVoucher[s].Voucherid;case 1246:if(!_context.sent){_context.next=1250;break;}_context.t76=debitVoucher[s].Voucherid.invoice_id<=9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].Voucherid.invoice_id):debitVoucher[s].Voucherid.invoice_id>9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].Voucherid.invoice_id):"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/").concat(debitVoucher[s].Voucherid.invoice_id);_context.next=1251;break;case 1250:_context.t76='';case 1251:debitVoucher[s].invoice_id=_context.t76;delete debitVoucher[s].Voucherid;_context.next=1255;return array.push(debitVoucher[s]);case 1255:_context.next=1338;break;case 1257:if(!ledger.dataValues.tax_key){_context.next=1306;break;}_context.next=1260;return'Purchase Return';case 1260:debitVoucher[s].voucher_type=_context.sent;if(!debitVoucher[s].taxd){_context.next=1268;break;}_context.next=1264;return debitVoucher[s].taxd.DebitBuyer;case 1264:debitVoucher[s].ledger=_context.sent;delete debitVoucher[s].taxd.DebitBuyer;_context.next=1269;break;case 1268:debitVoucher[s].ledger={};case 1269:_context.next=1271;return debitVoucher[s].taxd;case 1271:if(!_context.sent){_context.next=1275;break;}_context.t77=debitVoucher[s].taxd;_context.next=1276;break;case 1275:_context.t77={};case 1276:debitVoucher[s].Voucher=_context.t77;debitVoucher[s].type='Credit';_context.next=1280;return 0;case 1280:debitVoucher[s].debitAmount=_context.sent;_context.next=1283;return debitVoucher[s].amount;case 1283:debitVoucher[s].creditAmount=_context.sent;debitVoucher[s].amount=debitVoucher[s].amount;_context.next=1287;return debitVoucher[s].taxd;case 1287:if(!_context.sent){_context.next=1291;break;}_context.t78=debitVoucher[s].taxd.id;_context.next=1292;break;case 1291:_context.t78='';case 1292:debitVoucher[s].voucher_number=_context.t78;_context.next=1295;return debitVoucher[s].taxd;case 1295:if(!_context.sent){_context.next=1299;break;}_context.t79=debitVoucher[s].taxd.invoice_id<=9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].taxd.invoice_id):debitVoucher[s].taxd.invoice_id>9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].taxd.invoice_id):"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/").concat(debitVoucher[s].taxd.invoice_id);_context.next=1300;break;case 1299:_context.t79='';case 1300:debitVoucher[s].invoice_id=_context.t79;delete debitVoucher[s].taxd;_context.next=1304;return array.push(debitVoucher[s]);case 1304:_context.next=1338;break;case 1306:_context.next=1308;return'Purchase Return';case 1308:debitVoucher[s].voucher_type=_context.sent;_context.next=1311;return debitVoucher[s].DebitBuyer;case 1311:debitVoucher[s].ledger=_context.sent;_context.next=1314;return{};case 1314:debitVoucher[s].Voucher=_context.sent;debitVoucher[s].type='debit';_context.next=1318;return 0;case 1318:debitVoucher[s].debitAmount=_context.sent;_context.next=1321;return debitVoucher[s].total_amount;case 1321:debitVoucher[s].creditAmount=_context.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context.next=1325;return debitVoucher[s].id;case 1325:debitVoucher[s].voucher_number=_context.sent;_context.next=1328;return debitVoucher[s].invoice_id;case 1328:_context.t80=_context.sent;if(!(_context.t80<=9)){_context.next=1333;break;}_context.t81="".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/00").concat(debitVoucher[s].invoice_id);_context.next=1334;break;case 1333:_context.t81=debitVoucher[s].invoice_id>9?"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/0").concat(debitVoucher[s].invoice_id):"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/").concat(debitVoucher[s].invoice_id);case 1334:debitVoucher[s].invoice_id=_context.t81;delete debitVoucher[s].DebitBuyer;_context.next=1338;return array.push(debitVoucher[s]);case 1338:s++;_context.next=1207;break;case 1341:if(!(recieptVoucher&&recieptVoucher.length>0)){_context.next=1386;break;}i=0;case 1343:if(!(i<recieptVoucher.length)){_context.next=1386;break;}_context.next=1346;return recieptVoucher[i].type;case 1346:_context.t82=_context.sent;if(!(_context.t82==='debit')){_context.next=1356;break;}_context.next=1350;return recieptVoucher[i].total_amount;case 1350:recieptVoucher[i].debitAmount=_context.sent;_context.next=1353;return 0;case 1353:recieptVoucher[i].creditAmount=_context.sent;_context.next=1362;break;case 1356:_context.next=1358;return 0;case 1358:recieptVoucher[i].debitAmount=_context.sent;_context.next=1361;return recieptVoucher[i].total_amount;case 1361:recieptVoucher[i].creditAmount=_context.sent;case 1362:_context.next=1364;return recieptVoucher[i].ReciptBuyer;case 1364:recieptVoucher[i].ledger=_context.sent;delete recieptVoucher[i].ReciptBuyer;_context.next=1368;return'reciept';case 1368:recieptVoucher[i].voucher_type=_context.sent;_context.next=1371;return recieptVoucher[i].id;case 1371:recieptVoucher[i].voucher_number=_context.sent;_context.next=1374;return recieptVoucher[i].invoice_id;case 1374:_context.t83=_context.sent;if(!(_context.t83<=9)){_context.next=1379;break;}_context.t84="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context.next=1380;break;case 1379:_context.t84=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 1380:recieptVoucher[i].invoice_id=_context.t84;_context.next=1383;return array.push(recieptVoucher[i]);case 1383:i++;_context.next=1343;break;case 1386:if(!(paymentVoucher&&paymentVoucher.length>0)){_context.next=1431;break;}i=0;case 1388:if(!(i<paymentVoucher.length)){_context.next=1431;break;}_context.next=1391;return paymentVoucher[i].type;case 1391:_context.t85=_context.sent;if(!(_context.t85==='debit')){_context.next=1401;break;}_context.next=1395;return paymentVoucher[i].total_amount;case 1395:paymentVoucher[i].debitAmount=_context.sent;_context.next=1398;return 0;case 1398:paymentVoucher[i].creditAmount=_context.sent;_context.next=1407;break;case 1401:_context.next=1403;return 0;case 1403:paymentVoucher[i].debitAmount=_context.sent;_context.next=1406;return paymentVoucher[i].total_amount;case 1406:paymentVoucher[i].creditAmount=_context.sent;case 1407:_context.next=1409;return paymentVoucher[i].PaymentBuyer;case 1409:paymentVoucher[i].ledger=_context.sent;delete paymentVoucher[i].PaymentBuyer;_context.next=1413;return'payment';case 1413:paymentVoucher[i].voucher_type=_context.sent;_context.next=1416;return paymentVoucher[i].id;case 1416:paymentVoucher[i].voucher_number=_context.sent;_context.next=1419;return paymentVoucher[i].invoice_id;case 1419:_context.t86=_context.sent;if(!(_context.t86<=9)){_context.next=1424;break;}_context.t87="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context.next=1425;break;case 1424:_context.t87=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 1425:paymentVoucher[i].invoice_id=_context.t87;_context.next=1428;return array.push(paymentVoucher[i]);case 1428:i++;_context.next=1388;break;case 1431:if(!(reciverrecieptVoucher&&reciverrecieptVoucher.length>0)){_context.next=1465;break;}i=0;case 1433:if(!(i<reciverrecieptVoucher.length)){_context.next=1465;break;}_context.next=1436;return reciverrecieptVoucher[i].total_amount;case 1436:reciverrecieptVoucher[i].debitAmount=_context.sent;_context.next=1439;return 0;case 1439:reciverrecieptVoucher[i].creditAmount=_context.sent;_context.next=1442;return reciverrecieptVoucher[i].ReciptReciver;case 1442:reciverrecieptVoucher[i].ledger=_context.sent;delete reciverrecieptVoucher[i].ReciptReciver;_context.next=1446;return'reciept reciver';case 1446:reciverrecieptVoucher[i].voucher_type=_context.sent;_context.next=1449;return reciverrecieptVoucher[i].id;case 1449:reciverrecieptVoucher[i].voucher_number=_context.sent;_context.next=1452;return reciverrecieptVoucher[i].invoice_id;case 1452:_context.t88=_context.sent;if(!(_context.t88<=9)){_context.next=1457;break;}_context.t89="".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverrecieptVoucher[i].invoice_id);_context.next=1458;break;case 1457:_context.t89=reciverrecieptVoucher[i].invoice_id>9?"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverrecieptVoucher[i].invoice_id):"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/").concat(reciverrecieptVoucher[i].invoice_id);case 1458:reciverrecieptVoucher[i].invoice_id=_context.t89;reciverrecieptVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context.next=1462;return array.push(reciverrecieptVoucher[i]);case 1462:i++;_context.next=1433;break;case 1465:if(!(reciverpaymentVoucher&&reciverpaymentVoucher.length>0)){_context.next=1499;break;}i=0;case 1467:if(!(i<reciverpaymentVoucher.length)){_context.next=1499;break;}_context.next=1470;return 0;case 1470:reciverpaymentVoucher[i].debitAmount=_context.sent;_context.next=1473;return reciverpaymentVoucher[i].total_amount;case 1473:reciverpaymentVoucher[i].creditAmount=_context.sent;_context.next=1476;return reciverpaymentVoucher[i].PaymentReciver;case 1476:reciverpaymentVoucher[i].ledger=_context.sent;delete reciverpaymentVoucher[i].PaymentReciver;_context.next=1480;return'payment reciver';case 1480:reciverpaymentVoucher[i].voucher_type=_context.sent;_context.next=1483;return reciverpaymentVoucher[i].id;case 1483:reciverpaymentVoucher[i].voucher_number=_context.sent;_context.next=1486;return reciverpaymentVoucher[i].invoice_id;case 1486:_context.t90=_context.sent;if(!(_context.t90<=9)){_context.next=1491;break;}_context.t91="".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverpaymentVoucher[i].invoice_id);_context.next=1492;break;case 1491:_context.t91=reciverpaymentVoucher[i].invoice_id>9?"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverpaymentVoucher[i].invoice_id):"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/").concat(reciverpaymentVoucher[i].invoice_id);case 1492:reciverpaymentVoucher[i].invoice_id=_context.t91;reciverpaymentVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context.next=1496;return array.push(reciverpaymentVoucher[i]);case 1496:i++;_context.next=1467;break;case 1499:_context.next=1501;return(0,_arraySort["default"])(array,'invoice_date');case 1501:mainArray=_context.sent;_context.next=1504;return mainArray[mainArray.length-1];case 1504:lastObj=_context.sent;_context.next=1507;return mainArray.pop(mainArray.length-1);case 1507:mainArray.unshift(lastObj);return _context.abrupt("return",{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",JournalVoucher:mainArray});case 1511:return _context.abrupt("return",{statusCode:res.statusCode,success:false,message:"No date Found!"});case 1512:_context.next=1518;break;case 1514:_context.prev=1514;_context.t92=_context["catch"](0);console.log("errr",_context.t92);return _context.abrupt("return",{statusCode:res.statusCode,success:false,error:_context.t92,message:"Something went wrong!"});case 1518:case"end":return _context.stop();}},_callee,null,[[0,1514]]);}));return function(_x33,_x34){return _ref.apply(this,arguments);};}();exports.getAllCashVoucher=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(data,res){var recieptVoucher,paymentVoucher,purchaseVoucher,saleVoucher,journalVoucher,ledger,_invoice_date31,_invoice_date32,_invoice_date33,_invoice_date34,_invoice_date35,getOldBlance,array,i,mainArray,lastObj;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;journalVoucher=[];_context2.next=4;return _ledger["default"].findOne({where:{uid:data.ledger_id,company_id:data.company_id}});case 4:ledger=_context2.sent;if(!(ledger&&ledger.dataValues.id)){_context2.next=270;break;}_context2.next=8;return(0,_oldBalance.CashOldBlance)(data);case 8:getOldBlance=_context2.sent;_context2.next=11;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:data.ledger_id},{invoice_date:(_invoice_date31={},_defineProperty(_invoice_date31,Op.gte,data.start_date),_defineProperty(_invoice_date31,Op.lte,data.end_date),_invoice_date31)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 11:recieptVoucher=_context2.sent;_context2.next=14;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:data.ledger_id},{invoice_date:(_invoice_date32={},_defineProperty(_invoice_date32,Op.gte,data.start_date),_defineProperty(_invoice_date32,Op.lte,data.end_date),_invoice_date32)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 14:paymentVoucher=_context2.sent;_context2.next=17;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:data.ledger_id},{invoice_date:(_invoice_date33={},_defineProperty(_invoice_date33,Op.gte,data.start_date),_defineProperty(_invoice_date33,Op.lte,data.end_date),_invoice_date33)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 17:saleVoucher=_context2.sent;_context2.next=20;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:data.ledger_id},{invoice_date:(_invoice_date34={},_defineProperty(_invoice_date34,Op.gte,data.start_date),_defineProperty(_invoice_date34,Op.lte,data.end_date),_invoice_date34)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 20:purchaseVoucher=_context2.sent;_context2.next=23;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:data.ledger_id},{company_id:data.company_id},{invoice_date:(_invoice_date35={},_defineProperty(_invoice_date35,Op.gte,data.start_date),_defineProperty(_invoice_date35,Op.lte,data.end_date),_invoice_date35)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 23:journalVoucher=_context2.sent;_context2.next=26;return(0,_ledger2.decreption)(ledger,'object',data.data.email);case 26:ledger=_context2.sent;if(!(!ledger.dataValues.tax_key&&!ledger.dataValues.sale_key)){_context2.next=43;break;}_context2.next=30;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',data.data.email);case 30:recieptVoucher=_context2.sent;_context2.next=33;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',data.data.email);case 33:paymentVoucher=_context2.sent;_context2.next=36;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',data.data.email);case 36:purchaseVoucher=_context2.sent;_context2.next=39;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',data.data.email);case 39:saleVoucher=_context2.sent;_context2.next=42;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',data.data.email);case 42:journalVoucher=_context2.sent;case 43:_context2.next=45;return[];case 45:array=_context2.sent;if(!(ledger&&ledger.dataValues.id)){_context2.next=74;break;}if(!(ledger.dataValues.opening_balance=='Debit'||ledger.dataValues.opening_balance=='debit')){_context2.next=58;break;}_context2.next=50;return Number(ledger.dataValues.amount);case 50:_context2.t0=_context2.sent;_context2.t1=Number(getOldBlance.debit);ledger.dataValues.debitAmount=_context2.t0+_context2.t1;_context2.next=55;return 0;case 55:ledger.dataValues.creditAmount=_context2.sent;_context2.next=66;break;case 58:_context2.next=60;return 0;case 60:ledger.dataValues.debitAmount=_context2.sent;_context2.next=63;return Number(ledger.dataValues.amount);case 63:_context2.t2=_context2.sent;_context2.t3=Number(getOldBlance.credit);ledger.dataValues.creditAmount=_context2.t2+_context2.t3;case 66:_context2.next=68;return true;case 68:ledger.dataValues.open=_context2.sent;ledger.dataValues.voucher_type='';ledger.dataValues.voucher_number='';ledger.dataValues.invoice_id='';_context2.next=74;return array.push(ledger.dataValues);case 74:if(!recieptVoucher){_context2.next=119;break;}i=0;case 76:if(!(i<recieptVoucher.length)){_context2.next=119;break;}_context2.next=79;return recieptVoucher[i].type;case 79:_context2.t4=_context2.sent;if(!(_context2.t4==='debit')){_context2.next=89;break;}_context2.next=83;return 0;case 83:recieptVoucher[i].debitAmount=_context2.sent;_context2.next=86;return recieptVoucher[i].total_amount;case 86:recieptVoucher[i].creditAmount=_context2.sent;_context2.next=95;break;case 89:_context2.next=91;return recieptVoucher[i].total_amount;case 91:recieptVoucher[i].debitAmount=_context2.sent;_context2.next=94;return 0;case 94:recieptVoucher[i].creditAmount=_context2.sent;case 95:_context2.next=97;return recieptVoucher[i].ReciptBuyer;case 97:recieptVoucher[i].ledger=_context2.sent;delete recieptVoucher[i].ReciptBuyer;_context2.next=101;return'reciept';case 101:recieptVoucher[i].voucher_type=_context2.sent;_context2.next=104;return recieptVoucher[i].id;case 104:recieptVoucher[i].voucher_number=_context2.sent;_context2.next=107;return recieptVoucher[i].invoice_id;case 107:_context2.t5=_context2.sent;if(!(_context2.t5<=9)){_context2.next=112;break;}_context2.t6="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context2.next=113;break;case 112:_context2.t6=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 113:recieptVoucher[i].invoice_id=_context2.t6;_context2.next=116;return array.push(recieptVoucher[i]);case 116:i++;_context2.next=76;break;case 119:if(!paymentVoucher){_context2.next=164;break;}i=0;case 121:if(!(i<paymentVoucher.length)){_context2.next=164;break;}_context2.next=124;return paymentVoucher[i].type;case 124:_context2.t7=_context2.sent;if(!(_context2.t7==='debit')){_context2.next=134;break;}_context2.next=128;return 0;case 128:paymentVoucher[i].debitAmount=_context2.sent;_context2.next=131;return paymentVoucher[i].total_amount;case 131:paymentVoucher[i].creditAmount=_context2.sent;_context2.next=140;break;case 134:_context2.next=136;return paymentVoucher[i].total_amount;case 136:paymentVoucher[i].debitAmount=_context2.sent;_context2.next=139;return 0;case 139:paymentVoucher[i].creditAmount=_context2.sent;case 140:_context2.next=142;return paymentVoucher[i].PaymentBuyer;case 142:paymentVoucher[i].ledger=_context2.sent;delete paymentVoucher[i].PaymentBuyer;_context2.next=146;return'payment';case 146:paymentVoucher[i].voucher_type=_context2.sent;_context2.next=149;return paymentVoucher[i].id;case 149:paymentVoucher[i].voucher_number=_context2.sent;_context2.next=152;return paymentVoucher[i].invoice_id;case 152:_context2.t8=_context2.sent;if(!(_context2.t8<=9)){_context2.next=157;break;}_context2.t9="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context2.next=158;break;case 157:_context2.t9=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 158:paymentVoucher[i].invoice_id=_context2.t9;_context2.next=161;return array.push(paymentVoucher[i]);case 161:i++;_context2.next=121;break;case 164:if(!purchaseVoucher){_context2.next=191;break;}i=0;case 166:if(!(i<purchaseVoucher.length)){_context2.next=191;break;}_context2.next=169;return 0;case 169:purchaseVoucher[i].debitAmount=_context2.sent;_context2.next=172;return purchaseVoucher[i].total_amount;case 172:purchaseVoucher[i].creditAmount=_context2.sent;_context2.next=175;return purchaseVoucher[i].PurchaseLedger;case 175:purchaseVoucher[i].ledger=_context2.sent;delete purchaseVoucher[i].PurchaseLedger;_context2.next=179;return'purchase';case 179:purchaseVoucher[i].voucher_type=_context2.sent;_context2.next=182;return purchaseVoucher[i].id;case 182:purchaseVoucher[i].voucher_number=_context2.sent;_context2.next=185;return"".concat(purchaseVoucher[i].current_year.toString().substr(-2)+"-"+purchaseVoucher[i].end_year.toString().substr(-2),"/").concat(purchaseVoucher[i].invoice_id);case 185:purchaseVoucher[i].invoice_id=_context2.sent;_context2.next=188;return array.push(purchaseVoucher[i]);case 188:i++;_context2.next=166;break;case 191:if(!saleVoucher){_context2.next=222;break;}i=0;case 193:if(!(i<saleVoucher.length)){_context2.next=222;break;}_context2.next=196;return saleVoucher[i].total_amount;case 196:saleVoucher[i].debitAmount=_context2.sent;saleVoucher[i].creditAmount=0;_context2.next=200;return saleVoucher[i].SalesLedger;case 200:saleVoucher[i].ledger=_context2.sent;delete saleVoucher[i].SalesLedger;_context2.next=204;return'sale';case 204:saleVoucher[i].voucher_type=_context2.sent;_context2.next=207;return saleVoucher[i].id;case 207:saleVoucher[i].voucher_number=_context2.sent;_context2.next=210;return saleVoucher[i].invoice_id;case 210:_context2.t10=_context2.sent;if(!(_context2.t10<=9)){_context2.next=215;break;}_context2.t11="".concat(saleVoucher[i].current_year.toString().substr(-2)+"-"+saleVoucher[i].end_year.toString().substr(-2),"/00").concat(saleVoucher[i].invoice_id);_context2.next=216;break;case 215:_context2.t11=saleVoucher[i].invoice_id>9?"".concat(saleVoucher[i].current_year.toString().substr(-2)+"-"+saleVoucher[i].end_year.toString().substr(-2),"/0").concat(saleVoucher[i].invoice_id):"".concat(saleVoucher[i].current_year.toString().substr(-2)+"-"+saleVoucher[i].end_year.toString().substr(-2),"/").concat(saleVoucher[i].invoice_id);case 216:saleVoucher[i].invoice_id=_context2.t11;_context2.next=219;return array.push(saleVoucher[i]);case 219:i++;_context2.next=193;break;case 222:if(!journalVoucher){_context2.next=258;break;}i=0;case 224:if(!(i<journalVoucher.length)){_context2.next=258;break;}_context2.next=227;return journalVoucher[i].type;case 227:_context2.t13=_context2.sent;_context2.t12=_context2.t13=='debit';if(_context2.t12){_context2.next=234;break;}_context2.next=232;return journalVoucher[i].type;case 232:_context2.t14=_context2.sent;_context2.t12=_context2.t14=='Debit';case 234:if(!_context2.t12){_context2.next=243;break;}_context2.next=237;return journalVoucher[i].amount;case 237:journalVoucher[i].debitAmount=_context2.sent;_context2.next=240;return 0;case 240:journalVoucher[i].creditAmount=_context2.sent;_context2.next=249;break;case 243:_context2.next=245;return 0;case 245:journalVoucher[i].debitAmount=_context2.sent;_context2.next=248;return journalVoucher[i].amount;case 248:journalVoucher[i].creditAmount=_context2.sent;case 249:journalVoucher[i].voucher_number=journalVoucher[i].Voucher.id;journalVoucher[i].invoice_id=journalVoucher[i].Voucher.invoice_id<=9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(journalVoucher[i].Voucher.invoice_id):journalVoucher[i].Voucher.invoice_id>9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(journalVoucher[i].Voucher.invoice_id):"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(journalVoucher[i].invoice_id);// journalVoucher[i].debitAmount = journalVoucher[i].type=="debit"?journalVoucher[i].amount:0;
// journalVoucher[i].creditAmount = journalVoucher[i].type=="credit"?journalVoucher[i].amount:0;
journalVoucher[i].ledger=journalVoucher[i].VoucherLedger;delete journalVoucher[i].VoucherLedger;journalVoucher[i].voucher_type='jounrnal';array.push(journalVoucher[i]);case 255:i++;_context2.next=224;break;case 258:_context2.next=260;return(0,_arraySort["default"])(array,'invoice_date');case 260:mainArray=_context2.sent;_context2.next=263;return mainArray[mainArray.length-1];case 263:lastObj=_context2.sent;_context2.next=266;return mainArray.pop(mainArray.length-1);case 266:mainArray.unshift(lastObj);return _context2.abrupt("return",{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",JournalVoucher:mainArray,getOldBlance:getOldBlance});case 270:return _context2.abrupt("return",{statusCode:res.statusCode,success:false,message:"No date Found!"});case 271:_context2.next=276;break;case 273:_context2.prev=273;_context2.t15=_context2["catch"](0);return _context2.abrupt("return",{statusCode:res.statusCode,success:false,error:_context2.t15,message:"Something went wrong!"});case 276:case"end":return _context2.stop();}},_callee2,null,[[0,273]]);}));return function(_x35,_x36){return _ref2.apply(this,arguments);};}();exports.getAllBankVoucher=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(data,res){var recieptVoucher,paymentVoucher,saleVoucher,purchaseVoucher,journalVoucher,ledger,_invoice_date36,_invoice_date37,_invoice_date38,_invoice_date39,_invoice_date40,oldBalance,array,i,mainArray,lastObj;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;journalVoucher=[];_context3.next=4;return _ledger["default"].findOne({where:{uid:data.ledger_id,company_id:data.company_id}});case 4:ledger=_context3.sent;if(!(ledger&&ledger.dataValues.id)){_context3.next=272;break;}_context3.next=8;return(0,_oldBalance.BankOldBlance)(data);case 8:oldBalance=_context3.sent;_context3.next=11;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:data.ledger_id},{invoice_date:(_invoice_date36={},_defineProperty(_invoice_date36,Op.gte,data.start_date),_defineProperty(_invoice_date36,Op.lte,data.end_date),_invoice_date36)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 11:recieptVoucher=_context3.sent;_context3.next=14;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:data.ledger_id},{invoice_date:(_invoice_date37={},_defineProperty(_invoice_date37,Op.gte,data.start_date),_defineProperty(_invoice_date37,Op.lte,data.end_date),_invoice_date37)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 14:paymentVoucher=_context3.sent;_context3.next=17;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:data.ledger_id},{invoice_date:(_invoice_date38={},_defineProperty(_invoice_date38,Op.gte,data.start_date),_defineProperty(_invoice_date38,Op.lte,data.end_date),_invoice_date38)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 17:saleVoucher=_context3.sent;_context3.next=20;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:data.ledger_id},{invoice_date:(_invoice_date39={},_defineProperty(_invoice_date39,Op.gte,data.start_date),_defineProperty(_invoice_date39,Op.lte,data.end_date),_invoice_date39)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 20:purchaseVoucher=_context3.sent;_context3.next=23;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:data.ledger_id},{company_id:data.company_id},{invoice_date:(_invoice_date40={},_defineProperty(_invoice_date40,Op.gte,data.start_date),_defineProperty(_invoice_date40,Op.lte,data.end_date),_invoice_date40)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 23:journalVoucher=_context3.sent;_context3.next=26;return(0,_ledger2.decreption)(ledger,'object',data.data.email);case 26:ledger=_context3.sent;if(!(!ledger.dataValues.tax_key&&!ledger.dataValues.sale_key)){_context3.next=43;break;}_context3.next=30;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',data.data.email);case 30:recieptVoucher=_context3.sent;_context3.next=33;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',data.data.email);case 33:paymentVoucher=_context3.sent;_context3.next=36;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',data.data.email);case 36:purchaseVoucher=_context3.sent;_context3.next=39;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',data.data.email);case 39:saleVoucher=_context3.sent;_context3.next=42;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',data.data.email);case 42:journalVoucher=_context3.sent;case 43:_context3.next=45;return[];case 45:array=_context3.sent;if(!(ledger&&ledger.dataValues.id)){_context3.next=74;break;}if(!(ledger.dataValues.opening_balance==='Debit'||ledger.dataValues.opening_balance==='debit')){_context3.next=58;break;}_context3.next=50;return Number(ledger.dataValues.amount);case 50:_context3.t0=_context3.sent;_context3.t1=Number(oldBalance.debit);ledger.dataValues.debitAmount=_context3.t0+_context3.t1;_context3.next=55;return 0;case 55:ledger.dataValues.creditAmount=_context3.sent;_context3.next=66;break;case 58:_context3.next=60;return 0;case 60:ledger.dataValues.debitAmount=_context3.sent;_context3.next=63;return Number(ledger.dataValues.amount);case 63:_context3.t2=_context3.sent;_context3.t3=Number(oldBalance.credit);ledger.dataValues.creditAmount=_context3.t2+_context3.t3;case 66:_context3.next=68;return true;case 68:ledger.dataValues.open=_context3.sent;ledger.dataValues.voucher_type='';ledger.dataValues.voucher_number='';ledger.dataValues.invoice_id='';_context3.next=74;return array.push(ledger.dataValues);case 74:if(!recieptVoucher){_context3.next=119;break;}i=0;case 76:if(!(i<recieptVoucher.length)){_context3.next=119;break;}_context3.next=79;return recieptVoucher[i].type;case 79:_context3.t4=_context3.sent;if(!(_context3.t4==='debit')){_context3.next=89;break;}_context3.next=83;return 0;case 83:recieptVoucher[i].debitAmount=_context3.sent;_context3.next=86;return recieptVoucher[i].total_amount;case 86:recieptVoucher[i].creditAmount=_context3.sent;_context3.next=95;break;case 89:_context3.next=91;return recieptVoucher[i].total_amount;case 91:recieptVoucher[i].debitAmount=_context3.sent;_context3.next=94;return 0;case 94:recieptVoucher[i].creditAmount=_context3.sent;case 95:_context3.next=97;return recieptVoucher[i].ReciptBuyer;case 97:recieptVoucher[i].ledger=_context3.sent;delete recieptVoucher[i].ReciptBuyer;_context3.next=101;return'reciept';case 101:recieptVoucher[i].voucher_type=_context3.sent;_context3.next=104;return recieptVoucher[i].id;case 104:recieptVoucher[i].voucher_number=_context3.sent;_context3.next=107;return recieptVoucher[i].invoice_id;case 107:_context3.t5=_context3.sent;if(!(_context3.t5<=9)){_context3.next=112;break;}_context3.t6="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context3.next=113;break;case 112:_context3.t6=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 113:recieptVoucher[i].invoice_id=_context3.t6;_context3.next=116;return array.push(recieptVoucher[i]);case 116:i++;_context3.next=76;break;case 119:if(!paymentVoucher){_context3.next=164;break;}i=0;case 121:if(!(i<paymentVoucher.length)){_context3.next=164;break;}_context3.next=124;return paymentVoucher[i].type;case 124:_context3.t7=_context3.sent;if(!(_context3.t7==='debit')){_context3.next=134;break;}_context3.next=128;return 0;case 128:paymentVoucher[i].debitAmount=_context3.sent;_context3.next=131;return paymentVoucher[i].total_amount;case 131:paymentVoucher[i].creditAmount=_context3.sent;_context3.next=140;break;case 134:_context3.next=136;return paymentVoucher[i].total_amount;case 136:paymentVoucher[i].debitAmount=_context3.sent;_context3.next=139;return 0;case 139:paymentVoucher[i].creditAmount=_context3.sent;case 140:_context3.next=142;return paymentVoucher[i].PaymentBuyer;case 142:paymentVoucher[i].ledger=_context3.sent;delete paymentVoucher[i].PaymentBuyer;_context3.next=146;return'payment';case 146:paymentVoucher[i].voucher_type=_context3.sent;_context3.next=149;return paymentVoucher[i].id;case 149:paymentVoucher[i].voucher_number=_context3.sent;_context3.next=152;return paymentVoucher[i].invoice_id;case 152:_context3.t8=_context3.sent;if(!(_context3.t8<=9)){_context3.next=157;break;}_context3.t9="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context3.next=158;break;case 157:_context3.t9=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 158:paymentVoucher[i].invoice_id=_context3.t9;_context3.next=161;return array.push(paymentVoucher[i]);case 161:i++;_context3.next=121;break;case 164:if(!purchaseVoucher){_context3.next=191;break;}i=0;case 166:if(!(i<purchaseVoucher.length)){_context3.next=191;break;}_context3.next=169;return 0;case 169:purchaseVoucher[i].debitAmount=_context3.sent;_context3.next=172;return purchaseVoucher[i].total_amount;case 172:purchaseVoucher[i].creditAmount=_context3.sent;_context3.next=175;return purchaseVoucher[i].PurchaseLedger;case 175:purchaseVoucher[i].ledger=_context3.sent;delete purchaseVoucher[i].PurchaseLedger;_context3.next=179;return'purchase';case 179:purchaseVoucher[i].voucher_type=_context3.sent;_context3.next=182;return purchaseVoucher[i].id;case 182:purchaseVoucher[i].voucher_number=_context3.sent;_context3.next=185;return"".concat(purchaseVoucher[i].current_year.toString().substr(-2)+"-"+purchaseVoucher[i].end_year.toString().substr(-2),"/").concat(purchaseVoucher[i].invoice_id);case 185:purchaseVoucher[i].invoice_id=_context3.sent;_context3.next=188;return array.push(purchaseVoucher[i]);case 188:i++;_context3.next=166;break;case 191:if(!saleVoucher){_context3.next=222;break;}i=0;case 193:if(!(i<saleVoucher.length)){_context3.next=222;break;}_context3.next=196;return saleVoucher[i].total_amount;case 196:saleVoucher[i].debitAmount=_context3.sent;saleVoucher[i].creditAmount=0;_context3.next=200;return saleVoucher[i].SalesLedger;case 200:saleVoucher[i].ledger=_context3.sent;delete saleVoucher[i].SalesLedger;_context3.next=204;return'sale';case 204:saleVoucher[i].voucher_type=_context3.sent;_context3.next=207;return saleVoucher[i].id;case 207:saleVoucher[i].voucher_number=_context3.sent;_context3.next=210;return saleVoucher[i].invoice_id;case 210:_context3.t10=_context3.sent;if(!(_context3.t10<=9)){_context3.next=215;break;}_context3.t11="".concat(saleVoucher[i].current_year.toString().substr(-2)+"-"+saleVoucher[i].end_year.toString().substr(-2),"/00").concat(saleVoucher[i].invoice_id);_context3.next=216;break;case 215:_context3.t11=saleVoucher[i].invoice_id>9?"".concat(saleVoucher[i].current_year.toString().substr(-2)+"-"+saleVoucher[i].end_year.toString().substr(-2),"/0").concat(saleVoucher[i].invoice_id):"".concat(saleVoucher[i].current_year.toString().substr(-2)+"-"+saleVoucher[i].end_year.toString().substr(-2),"/").concat(saleVoucher[i].invoice_id);case 216:saleVoucher[i].invoice_id=_context3.t11;_context3.next=219;return array.push(saleVoucher[i]);case 219:i++;_context3.next=193;break;case 222:if(!journalVoucher){_context3.next=260;break;}i=0;case 224:if(!(i<journalVoucher.length)){_context3.next=260;break;}_context3.next=227;return journalVoucher[i].type;case 227:_context3.t13=_context3.sent;_context3.t12=_context3.t13=='debit';if(_context3.t12){_context3.next=234;break;}_context3.next=232;return journalVoucher[i].type;case 232:_context3.t14=_context3.sent;_context3.t12=_context3.t14=='Debit';case 234:if(!_context3.t12){_context3.next=243;break;}_context3.next=237;return journalVoucher[i].amount;case 237:journalVoucher[i].debitAmount=_context3.sent;_context3.next=240;return 0;case 240:journalVoucher[i].creditAmount=_context3.sent;_context3.next=249;break;case 243:_context3.next=245;return 0;case 245:journalVoucher[i].debitAmount=_context3.sent;_context3.next=248;return journalVoucher[i].amount;case 248:journalVoucher[i].creditAmount=_context3.sent;case 249:journalVoucher[i].voucher_number=journalVoucher[i].Voucher.id;journalVoucher[i].invoice_id=journalVoucher[i].Voucher.invoice_id<=9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(journalVoucher[i].Voucher.invoice_id):journalVoucher[i].Voucher.invoice_id>9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(journalVoucher[i].Voucher.invoice_id):"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(journalVoucher[i].invoice_id);journalVoucher[i].debitAmount=journalVoucher[i].type=="debit"?journalVoucher[i].amount:0;journalVoucher[i].creditAmount=journalVoucher[i].type=="credit"?journalVoucher[i].amount:0;journalVoucher[i].ledger=journalVoucher[i].VoucherLedger;delete journalVoucher[i].VoucherLedger;journalVoucher[i].voucher_type='jounrnal';array.push(journalVoucher[i]);case 257:i++;_context3.next=224;break;case 260:_context3.next=262;return(0,_arraySort["default"])(array,'invoice_date');case 262:mainArray=_context3.sent;_context3.next=265;return mainArray[mainArray.length-1];case 265:lastObj=_context3.sent;_context3.next=268;return mainArray.pop(mainArray.length-1);case 268:mainArray.unshift(lastObj);return _context3.abrupt("return",{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",JournalVoucher:mainArray,purchaseVoucher:purchaseVoucher,saleVoucher:saleVoucher,oldBalance:oldBalance// journalVoucher:journalVoucher
});case 272:return _context3.abrupt("return",{statusCode:res.statusCode,success:false,message:"No date Found!"});case 273:_context3.next=278;break;case 275:_context3.prev=275;_context3.t15=_context3["catch"](0);return _context3.abrupt("return",{statusCode:res.statusCode,success:false,error:_context3.t15,message:"Something went wrong!"});case 278:case"end":return _context3.stop();}},_callee3,null,[[0,275]]);}));return function(_x37,_x38){return _ref3.apply(this,arguments);};}();exports.getSalesRegisterVoucher=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(data,res){var uids,ledger,_invoice_date41,items,itemlist,array,head,_loop,i,_ret;return _regeneratorRuntime().wrap(function _callee5$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:_context6.prev=0;uids=[];_context6.next=4;return _ledger["default"].findAll({where:{company_id:data.company_id}}).map(function(node){return node.get({plain:true});});case 4:ledger=_context6.sent;_context6.next=7;return(0,_ledger2.decreption)(ledger,"array",data.data.email);case 7:ledger=_context6.sent;_context6.next=10;return ledger.map(function(item){if(item.name&&item.name.match("Sale ")){uids.push(item.uid);}else console.log("else");});case 10:if(!(uids.length>0)){_context6.next=40;break;}_context6.next=13;return _voucherInteries["default"].findAll({where:{ledger_id:_defineProperty({},Op["in"],uids)},include:[{model:_saleVoucher["default"],required:true,as:'Vouchers',where:{invoice_date:(_invoice_date41={},_defineProperty(_invoice_date41,Op.gte,data.start_date),_defineProperty(_invoice_date41,Op.lte,data.end_date),_invoice_date41)},include:[{model:_ledger["default"],required:false,as:'SalesLedger'},{model:_itemInteries["default"],required:false,where:{type:'Sales'}},{model:_taxInteries["default"],required:false,where:{type:'Sales'}}]},{model:_ledger["default"]}]}).map(function(node){return node.get({plain:true});});case 13:items=_context6.sent;_context6.next=16;return(0,_salesvoucher.decreptionSale)(items,'array',data.data.email);case 16:items=_context6.sent;itemlist=items;_context6.next=20;return[];case 20:array=_context6.sent;_context6.next=23;return[];case 23:head=_context6.sent;if(!(items&&items.length>0)){_context6.next=37;break;}_loop=/*#__PURE__*/_regeneratorRuntime().mark(function _loop(i){var data,find,mainArray,obj;return _regeneratorRuntime().wrap(function _loop$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.next=2;return{voucherInteries:[]};case 2:data=_context5.sent;if(!items[i].Vouchers){_context5.next=41;break;}_context5.next=6;return items[i].Vouchers.invoice_id;case 6:_context5.t0=_context5.sent;if(!(_context5.t0<=9)){_context5.next=11;break;}_context5.t1="".concat(items[i].Vouchers.current_year.toString().substr(-2)+"-"+items[i].Vouchers.end_year.toString().substr(-2),"/00").concat(items[i].Vouchers.invoice_id);_context5.next=12;break;case 11:_context5.t1=items[i].Vouchers.invoice_id>9?"".concat(items[i].Vouchers.current_year.toString().substr(-2)+"-"+items[i].Vouchers.end_year.toString().substr(-2),"/0").concat(items[i].Vouchers.invoice_id):"".concat(items[i].Vouchers.current_year.toString().substr(-2)+"-"+items[i].Vouchers.end_year.toString().substr(-2),"/").concat(items[i].Vouchers.invoice_id);case 12:items[i].Vouchers.invoice_id=_context5.t1;_context5.next=15;return array.find(function(el){return el.invoice_id===items[i].Vouchers.invoice_id;});case 15:find=_context5.sent;_context5.next=18;return find;case 18:if(!_context5.sent){_context5.next=25;break;}_context5.next=21;return find.voucherInteries.push(items[i]);case 21:_context5.next=23;return find.voucherInteries.map(function(ele){if(ele.Vouchers){delete ele.Vouchers;}});case 23:_context5.next=41;break;case 25:_context5.next=27;return[];case 27:items[i].Vouchers.voucherInteries=_context5.sent;_context5.next=30;return items[i].Vouchers.SalesLedger;case 30:items[i].Vouchers.Buyer=_context5.sent;delete items[i].Vouchers.SalesLedger;_context5.next=34;return items[i].Vouchers;case 34:data=_context5.sent;_context5.next=37;return data.invoice_id;case 37:data.invoice_id=_context5.sent;data.voucherInteries.push(items[i]);delete data.voucherInteries[0].Vouchers;array.push(data);case 41:if(!(i==items.length-1)){_context5.next=51;break;}_context5.next=44;return array.forEach(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(data){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return data.voucherInteries.forEach(function(h){if(data.is_local==='yes'){var name1=h.type+' (LOCAL) SGST '+Number(h.ledger.sale_key)/2;var check=head.find(function(c){return c.name===name1;});if(check){}else{head.push({name:h.type+' (LOCAL) SGST '+Number(h.ledger.sale_key)/2,key:Number(h.ledger.sale_key)/2,flag:'local'},{name:h.type+' (LOCAL) CGST '+Number(h.ledger.sale_key)/2,key:Number(h.ledger.sale_key)/2,flag:'local'});}}else{var name=h.type+' (INTERSTATE) '+h.ledger.sale_key;var _check=head.find(function(c){return c.name===name;});if(_check){}else{head.push({name:h.type+' (INTERSTATE) '+h.ledger.sale_key,key:h.ledger.sale_key,flag:'outer'});}}});case 2:case"end":return _context4.stop();}},_callee4);}));return function(_x41){return _ref5.apply(this,arguments);};}());case 44:_context5.next=46;return(0,_arraySort["default"])(array,'invoice_date');case 46:mainArray=_context5.sent;_context5.next=49;return{data:mainArray,head:head,items:itemlist,array:array};case 49:obj=_context5.sent;return _context5.abrupt("return",{v:{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",Voucher:obj}});case 51:case"end":return _context5.stop();}},_loop);});i=0;case 27:if(!(i<items.length)){_context6.next=35;break;}return _context6.delegateYield(_loop(i),"t0",29);case 29:_ret=_context6.t0;if(!(_typeof(_ret)==="object")){_context6.next=32;break;}return _context6.abrupt("return",_ret.v);case 32:i++;_context6.next=27;break;case 35:_context6.next=38;break;case 37:return _context6.abrupt("return",{statusCode:res.statusCode,success:false,message:"No date Found!"});case 38:_context6.next=41;break;case 40:return _context6.abrupt("return",{statusCode:res.statusCode,success:false,message:"No date Found!"});case 41:_context6.next=46;break;case 43:_context6.prev=43;_context6.t1=_context6["catch"](0);return _context6.abrupt("return",{statusCode:res.statusCode,success:false,error:_context6.t1,message:"Something went wrong!"});case 46:case"end":return _context6.stop();}},_callee5,null,[[0,43]]);}));return function(_x39,_x40){return _ref4.apply(this,arguments);};}();exports.getPurchaseRegisterVoucher=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(data,res){var uids,ledger,_invoice_date42,items,array,head,_loop2,i,mainArray,obj;return _regeneratorRuntime().wrap(function _callee7$(_context9){while(1)switch(_context9.prev=_context9.next){case 0:_context9.prev=0;uids=[];_context9.next=4;return _ledger["default"].findAll({where:{company_id:data.company_id// name: { [Op.like]: "%purchase-%" }
}});case 4:ledger=_context9.sent;_context9.next=7;return(0,_ledger2.decreption)(ledger,"array",data.data.email);case 7:ledger=_context9.sent;_context9.next=10;return ledger.map(function(item){if(item.name&&item.name.match("Purchase ")){uids.push(item.uid);}});case 10:if(!(uids.length>0)){_context9.next=45;break;}_context9.next=13;return _voucherInteries["default"].findAll({where:{ledger_id:_defineProperty({},Op["in"],uids)},include:[{model:_purchaseVoucher["default"],as:'Voucherp',where:{invoice_date:(_invoice_date42={},_defineProperty(_invoice_date42,Op.gte,data.start_date),_defineProperty(_invoice_date42,Op.lte,data.end_date),_invoice_date42)},include:[{model:_ledger["default"],as:'PurchaseLedger'},{model:_itemInteries["default"],required:false,where:{type:'Purchase'}},{model:_taxInteries["default"],required:false,where:{type:'Purchase'},include:[{model:_ledger["default"]}]}]},{model:_ledger["default"]//,as:'VoucherLedger'
}]}).map(function(node){return node.get({plain:true});});case 13:items=_context9.sent;_context9.next=16;return(0,_purchasevoucher.decreptionPurchase)(items,'array',data.data.email);case 16:items=_context9.sent;_context9.next=19;return[];case 19:array=_context9.sent;_context9.next=22;return[];case 22:head=_context9.sent;if(!(items&&items.length>0)){_context9.next=42;break;}_loop2=/*#__PURE__*/_regeneratorRuntime().mark(function _loop2(i){var data,find;return _regeneratorRuntime().wrap(function _loop2$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:_context8.next=2;return{voucherInteries:[]};case 2:data=_context8.sent;_context8.next=5;return"".concat(items[i].Voucherp.current_year.toString().substr(-2)+"-"+items[i].Voucherp.end_year.toString().substr(-2),"/").concat(items[i].Voucherp.invoice_id);case 5:items[i].Voucherp.invoice_id=_context8.sent;_context8.next=8;return array.find(function(el){return el.invoice_id===items[i].Voucherp.invoice_id;});case 8:find=_context8.sent;_context8.next=11;return find;case 11:if(!_context8.sent){_context8.next=18;break;}_context8.next=14;return find.voucherInteries.push(items[i]);case 14:_context8.next=16;return find.voucherInteries.map(function(ele){if(ele.Voucherp){delete ele.Voucherp;}});case 16:_context8.next=34;break;case 18:_context8.next=20;return[];case 20:items[i].Voucherp.voucherInteries=_context8.sent;_context8.next=23;return items[i].Voucherp.PurchaseLedger;case 23:items[i].Voucherp.Buyer=_context8.sent;delete items[i].Voucherp.PurchaseLedger;_context8.next=27;return items[i].Voucherp;case 27:data=_context8.sent;_context8.next=30;return data.invoice_id;case 30:data.invoice_id=_context8.sent;data.voucherInteries.push(items[i]);delete data.voucherInteries[0].Voucherp;array.push(data);case 34:case"end":return _context8.stop();}},_loop2);});i=0;case 26:if(!(i<items.length)){_context9.next=31;break;}return _context9.delegateYield(_loop2(i),"t0",28);case 28:i++;_context9.next=26;break;case 31:_context9.next=33;return array.forEach(/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(data){return _regeneratorRuntime().wrap(function _callee6$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_context7.next=2;return data.voucherInteries.forEach(function(h){if(data.is_local==='yes'){var name1=h.type+' (LOCAL) SGST '+Number(h.ledger.sale_key)/2;// let name2 = h.type+' (LOCAL) CGST '+Number(h.ledger.sale_key)/2;
var check=head.find(function(c){return c.name===name1;});if(check){}else{head.push({name:h.type+' (LOCAL) SGST '+Number(h.ledger.sale_key)/2,key:Number(h.ledger.sale_key)/2,flag:'local'},{name:h.type+' (LOCAL) CGST '+Number(h.ledger.sale_key)/2,key:Number(h.ledger.sale_key)/2,flag:'local'});}}else{var name=h.type+' (INTERSTATE) '+h.ledger.sale_key;var _check2=head.find(function(c){return c.name===name;});if(_check2){}else{head.push({name:h.type+' (INTERSTATE) '+h.ledger.sale_key,key:h.ledger.sale_key,flag:'outer'});}}});case 2:case"end":return _context7.stop();}},_callee6);}));return function(_x44){return _ref7.apply(this,arguments);};}());case 33:_context9.next=35;return(0,_arraySort["default"])(array,'invoice_date');case 35:mainArray=_context9.sent;_context9.next=38;return{data:mainArray,head:head};case 38:obj=_context9.sent;return _context9.abrupt("return",{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",Voucher:obj});case 42:return _context9.abrupt("return",{statusCode:res.statusCode,success:false,message:"No date Found!"});case 43:_context9.next=46;break;case 45:return _context9.abrupt("return",{statusCode:res.statusCode,success:false,message:"No date Found!"});case 46:_context9.next=52;break;case 48:_context9.prev=48;_context9.t1=_context9["catch"](0);console.log(_context9.t1);return _context9.abrupt("return",{statusCode:res.statusCode,success:false,error:_context9.t1,message:"Something went wrong!"});case 52:case"end":return _context9.stop();}},_callee7,null,[[0,48]]);}));return function(_x42,_x43){return _ref6.apply(this,arguments);};}();exports.getdayBookVoucher=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(data,res){var _invoice_date43,_invoice_date44,_invoice_date45,_invoice_date46,_invoice_date47,_invoice_date48,_invoice_date49,journalVoucher,saleVoucher,purchaseVoucher,creditVoucher,debitVoucher,recieptVoucher,paymentVoucher,array,i,s,mainArray;return _regeneratorRuntime().wrap(function _callee8$(_context10){while(1)switch(_context10.prev=_context10.next){case 0:_context10.prev=0;paymentVoucher=[];_context10.next=4;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{// invoice_date: data.start_date
invoice_date:(_invoice_date43={},_defineProperty(_invoice_date43,Op.gte,data.start_date),_defineProperty(_invoice_date43,Op.lte,data.end_date),_invoice_date43)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher2["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 4:journalVoucher=_context10.sent;_context10.next=7;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{invoice_date:(_invoice_date44={},_defineProperty(_invoice_date44,Op.gte,data.start_date),_defineProperty(_invoice_date44,Op.lte,data.end_date),_invoice_date44)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 7:saleVoucher=_context10.sent;_context10.next=10;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{invoice_date:(_invoice_date45={},_defineProperty(_invoice_date45,Op.gte,data.start_date),_defineProperty(_invoice_date45,Op.lte,data.end_date),_invoice_date45)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 10:purchaseVoucher=_context10.sent;_context10.next=13;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{invoice_date:(_invoice_date46={},_defineProperty(_invoice_date46,Op.gte,data.start_date),_defineProperty(_invoice_date46,Op.lte,data.end_date),_invoice_date46)}]),include:[{model:_ledger["default"],as:'CreditBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 13:creditVoucher=_context10.sent;_context10.next=16;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{invoice_date:(_invoice_date47={},_defineProperty(_invoice_date47,Op.gte,data.start_date),_defineProperty(_invoice_date47,Op.lte,data.end_date),_invoice_date47)}]),include:[{model:_ledger["default"],as:'DebitBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 16:debitVoucher=_context10.sent;_context10.next=19;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{invoice_date:(_invoice_date48={},_defineProperty(_invoice_date48,Op.gte,data.start_date),_defineProperty(_invoice_date48,Op.lte,data.end_date),_invoice_date48)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 19:recieptVoucher=_context10.sent;_context10.next=22;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{invoice_date:(_invoice_date49={},_defineProperty(_invoice_date49,Op.gte,data.start_date),_defineProperty(_invoice_date49,Op.lte,data.end_date),_invoice_date49)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 22:paymentVoucher=_context10.sent;_context10.next=25;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',data.data.email);case 25:journalVoucher=_context10.sent;_context10.next=28;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',data.data.email);case 28:recieptVoucher=_context10.sent;_context10.next=31;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',data.data.email);case 31:paymentVoucher=_context10.sent;_context10.next=34;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',data.data.email);case 34:saleVoucher=_context10.sent;_context10.next=37;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',data.data.email);case 37:purchaseVoucher=_context10.sent;_context10.next=40;return(0,_creditvoucher.decreptionCredit)(creditVoucher,'array',data.data.email);case 40:creditVoucher=_context10.sent;_context10.next=43;return(0,_debitvoucher.decreptionDebit)(debitVoucher,'array',data.data.email);case 43:debitVoucher=_context10.sent;_context10.next=46;return[];case 46:array=_context10.sent;if(!(journalVoucher&&journalVoucher.length>0)){_context10.next=101;break;}i=0;case 49:if(!(i<journalVoucher.length)){_context10.next=101;break;}_context10.next=52;return journalVoucher[i].type;case 52:_context10.t0=_context10.sent;if(!(_context10.t0==='debit')){_context10.next=62;break;}_context10.next=56;return journalVoucher[i].amount;case 56:journalVoucher[i].debitAmount=_context10.sent;_context10.next=59;return 0;case 59:journalVoucher[i].creditAmount=_context10.sent;_context10.next=68;break;case 62:_context10.next=64;return 0;case 64:journalVoucher[i].debitAmount=_context10.sent;_context10.next=67;return journalVoucher[i].amount;case 67:journalVoucher[i].creditAmount=_context10.sent;case 68:_context10.next=70;return journalVoucher[i].VoucherLedger;case 70:journalVoucher[i].ledger=_context10.sent;_context10.next=73;return'journal';case 73:journalVoucher[i].voucher_type=_context10.sent;if(!journalVoucher[i].Voucher){_context10.next=92;break;}_context10.next=77;return journalVoucher[i].Voucher.invoice_date;case 77:journalVoucher[i].invoice_date=_context10.sent;_context10.next=80;return journalVoucher[i].Voucher.id;case 80:journalVoucher[i].voucher_number=_context10.sent;_context10.next=83;return journalVoucher[i].Voucher.invoice_id;case 83:_context10.t1=_context10.sent;if(!(_context10.t1<=9)){_context10.next=88;break;}_context10.t2="".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(journalVoucher[i].Voucher.invoice_id);_context10.next=89;break;case 88:_context10.t2=journalVoucher[i].Voucher.invoice_id>9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(journalVoucher[i].Voucher.invoice_id):"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(journalVoucher[i].Voucher.invoice_id);case 89:journalVoucher[i].invoice_id=_context10.t2;_context10.next=95;break;case 92:journalVoucher[i].invoice_date='';journalVoucher[i].voucher_number='';journalVoucher[i].invoice_id='';case 95:delete journalVoucher[i].VoucherLedger;_context10.next=98;return array.push(journalVoucher[i]);case 98:i++;_context10.next=49;break;case 101:if(!(saleVoucher&&saleVoucher.length>0)){_context10.next=139;break;}s=0;case 103:if(!(s<saleVoucher.length)){_context10.next=139;break;}_context10.next=106;return'sale';case 106:saleVoucher[s].voucher_type=_context10.sent;_context10.next=109;return saleVoucher[s].SalesLedger;case 109:saleVoucher[s].ledger=_context10.sent;_context10.next=112;return{};case 112:saleVoucher[s].Voucher=_context10.sent;saleVoucher[s].type='debit';_context10.next=116;return saleVoucher[s].total_amount;case 116:saleVoucher[s].debitAmount=_context10.sent;_context10.next=119;return 0;case 119:saleVoucher[s].creditAmount=_context10.sent;saleVoucher[s].amount=saleVoucher[s].total_amount;_context10.next=123;return saleVoucher[s].id;case 123:saleVoucher[s].voucher_number=_context10.sent;_context10.next=126;return saleVoucher[s].invoice_id;case 126:_context10.t3=_context10.sent;if(!(_context10.t3<=9)){_context10.next=131;break;}_context10.t4="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context10.next=132;break;case 131:_context10.t4=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(saleVoucher[s].invoice_id);case 132:saleVoucher[s].invoice_id=_context10.t4;delete saleVoucher[s].SalesLedger;_context10.next=136;return array.push(saleVoucher[s]);case 136:s++;_context10.next=103;break;case 139:if(!(purchaseVoucher&&purchaseVoucher.length>0)){_context10.next=177;break;}s=0;case 141:if(!(s<purchaseVoucher.length)){_context10.next=177;break;}_context10.next=144;return'purchase';case 144:purchaseVoucher[s].voucher_type=_context10.sent;_context10.next=147;return purchaseVoucher[s].PurchaseLedger;case 147:purchaseVoucher[s].ledger=_context10.sent;_context10.next=150;return{};case 150:purchaseVoucher[s].Voucher=_context10.sent;purchaseVoucher[s].type='Credit';_context10.next=154;return 0;case 154:purchaseVoucher[s].debitAmount=_context10.sent;_context10.next=157;return purchaseVoucher[s].total_amount;case 157:purchaseVoucher[s].creditAmount=_context10.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context10.next=161;return purchaseVoucher[s].id;case 161:purchaseVoucher[s].voucher_number=_context10.sent;_context10.next=164;return purchaseVoucher[s].invoice_id;case 164:_context10.t5=_context10.sent;if(!(_context10.t5<=9)){_context10.next=169;break;}_context10.t6="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/00").concat(purchaseVoucher[s].invoice_id);_context10.next=170;break;case 169:_context10.t6=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/0").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 170:purchaseVoucher[s].invoice_id=_context10.t6;delete purchaseVoucher[s].PurchaseLedger;_context10.next=174;return array.push(purchaseVoucher[s]);case 174:s++;_context10.next=141;break;case 177:if(!creditVoucher){_context10.next=215;break;}s=0;case 179:if(!(s<creditVoucher.length)){_context10.next=215;break;}_context10.next=182;return'Credit note';case 182:creditVoucher[s].voucher_type=_context10.sent;_context10.next=185;return creditVoucher[s].CreditBuyer;case 185:creditVoucher[s].ledger=_context10.sent;_context10.next=188;return{};case 188:creditVoucher[s].Voucher=_context10.sent;creditVoucher[s].type='debit';_context10.next=192;return creditVoucher[s].total_amount;case 192:creditVoucher[s].debitAmount=_context10.sent;_context10.next=195;return 0;case 195:creditVoucher[s].creditAmount=_context10.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context10.next=199;return creditVoucher[s].id;case 199:creditVoucher[s].voucher_number=_context10.sent;_context10.next=202;return creditVoucher[s].invoice_id;case 202:_context10.t7=_context10.sent;if(!(_context10.t7<=9)){_context10.next=207;break;}_context10.t8="".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/00").concat(creditVoucher[s].invoice_id);_context10.next=208;break;case 207:_context10.t8=creditVoucher[s].invoice_id>9?"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/0").concat(creditVoucher[s].invoice_id):"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/").concat(creditVoucher[s].invoice_id);case 208:creditVoucher[s].invoice_id=_context10.t8;delete creditVoucher[s].CreditBuyer;_context10.next=212;return array.push(creditVoucher[s]);case 212:s++;_context10.next=179;break;case 215:if(!debitVoucher){_context10.next=253;break;}s=0;case 217:if(!(s<debitVoucher.length)){_context10.next=253;break;}_context10.next=220;return'Debit note';case 220:debitVoucher[s].voucher_type=_context10.sent;_context10.next=223;return debitVoucher[s].DebitBuyer;case 223:debitVoucher[s].ledger=_context10.sent;_context10.next=226;return{};case 226:debitVoucher[s].Voucher=_context10.sent;debitVoucher[s].type='Credit';_context10.next=230;return 0;case 230:debitVoucher[s].debitAmount=_context10.sent;_context10.next=233;return debitVoucher[s].total_amount;case 233:debitVoucher[s].creditAmount=_context10.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context10.next=237;return debitVoucher[s].id;case 237:debitVoucher[s].voucher_number=_context10.sent;_context10.next=240;return debitVoucher[s].invoice_id;case 240:_context10.t9=_context10.sent;if(!(_context10.t9<=9)){_context10.next=245;break;}_context10.t10="".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/00").concat(debitVoucher[s].invoice_id);_context10.next=246;break;case 245:_context10.t10=debitVoucher[s].invoice_id>9?"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/0").concat(debitVoucher[s].invoice_id):"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/").concat(debitVoucher[s].invoice_id);case 246:debitVoucher[s].invoice_id=_context10.t10;delete debitVoucher[s].DebitBuyer;_context10.next=250;return array.push(debitVoucher[s]);case 250:s++;_context10.next=217;break;case 253:if(!recieptVoucher){_context10.next=298;break;}i=0;case 255:if(!(i<recieptVoucher.length)){_context10.next=298;break;}_context10.next=258;return recieptVoucher[i].type;case 258:_context10.t11=_context10.sent;if(!(_context10.t11==='debit')){_context10.next=268;break;}_context10.next=262;return recieptVoucher[i].total_amount;case 262:recieptVoucher[i].debitAmount=_context10.sent;_context10.next=265;return 0;case 265:recieptVoucher[i].creditAmount=_context10.sent;_context10.next=274;break;case 268:_context10.next=270;return 0;case 270:recieptVoucher[i].debitAmount=_context10.sent;_context10.next=273;return recieptVoucher[i].total_amount;case 273:recieptVoucher[i].creditAmount=_context10.sent;case 274:_context10.next=276;return recieptVoucher[i].ReciptBuyer;case 276:recieptVoucher[i].ledger=_context10.sent;delete recieptVoucher[i].ReciptBuyer;_context10.next=280;return'reciept';case 280:recieptVoucher[i].voucher_type=_context10.sent;_context10.next=283;return recieptVoucher[i].id;case 283:recieptVoucher[i].voucher_number=_context10.sent;_context10.next=286;return recieptVoucher[i].invoice_id;case 286:_context10.t12=_context10.sent;if(!(_context10.t12<=9)){_context10.next=291;break;}_context10.t13="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context10.next=292;break;case 291:_context10.t13=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 292:recieptVoucher[i].invoice_id=_context10.t13;_context10.next=295;return array.push(recieptVoucher[i]);case 295:i++;_context10.next=255;break;case 298:if(!paymentVoucher){_context10.next=343;break;}i=0;case 300:if(!(i<paymentVoucher.length)){_context10.next=343;break;}_context10.next=303;return paymentVoucher[i].type;case 303:_context10.t14=_context10.sent;if(!(_context10.t14==='debit')){_context10.next=313;break;}_context10.next=307;return paymentVoucher[i].total_amount;case 307:paymentVoucher[i].debitAmount=_context10.sent;_context10.next=310;return 0;case 310:paymentVoucher[i].creditAmount=_context10.sent;_context10.next=319;break;case 313:_context10.next=315;return 0;case 315:paymentVoucher[i].debitAmount=_context10.sent;_context10.next=318;return paymentVoucher[i].total_amount;case 318:paymentVoucher[i].creditAmount=_context10.sent;case 319:_context10.next=321;return paymentVoucher[i].PaymentBuyer;case 321:paymentVoucher[i].ledger=_context10.sent;delete paymentVoucher[i].PaymentBuyer;_context10.next=325;return'payment';case 325:paymentVoucher[i].voucher_type=_context10.sent;_context10.next=328;return paymentVoucher[i].id;case 328:paymentVoucher[i].voucher_number=_context10.sent;_context10.next=331;return paymentVoucher[i].invoice_id;case 331:_context10.t15=_context10.sent;if(!(_context10.t15<=9)){_context10.next=336;break;}_context10.t16="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context10.next=337;break;case 336:_context10.t16=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 337:paymentVoucher[i].invoice_id=_context10.t16;_context10.next=340;return array.push(paymentVoucher[i]);case 340:i++;_context10.next=300;break;case 343:if(!(array.length>0)){_context10.next=350;break;}_context10.next=346;return(0,_arraySort["default"])(array,'invoice_date');case 346:mainArray=_context10.sent;return _context10.abrupt("return",{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",JournalVoucher:mainArray,journal:journalVoucher,sales:saleVoucher,purchase:purchaseVoucher,credit:creditVoucher,debit:debitVoucher,payment:paymentVoucher,reciept:recieptVoucher});case 350:return _context10.abrupt("return",{statusCode:res.statusCode,success:false,message:"voucher not found!",JournalVoucher:[]});case 351:_context10.next=356;break;case 353:_context10.prev=353;_context10.t17=_context10["catch"](0);return _context10.abrupt("return",{statusCode:res.statusCode,success:false,error:_context10.t17,message:"Something went wrong!"});case 356:case"end":return _context10.stop();}},_callee8,null,[[0,353]]);}));return function(_x45,_x46){return _ref8.apply(this,arguments);};}();exports.getJournalRegisterVoucher=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(data,res){var _invoice_date50,_invoice_date51,items,array,other,i;return _regeneratorRuntime().wrap(function _callee9$(_context11){while(1)switch(_context11.prev=_context11.next){case 0:_context11.prev=0;_context11.next=3;return _journalVoucher2["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{invoice_date:(_invoice_date50={},_defineProperty(_invoice_date50,Op.gte,data.start_date),_defineProperty(_invoice_date50,Op.lte,data.end_date),_invoice_date50)}]),include:[{model:_ledger["default"],as:'Ledger'},{model:_company["default"],attributes:['company_name','uid','gst_number','terms','financial_year','cin_number','company_pan_number']},{model:_purpose["default"]},{model:_journalInteries["default"],where:_defineProperty({},Op.and,[{company_id:data.company_id},{invoice_date:(_invoice_date51={},_defineProperty(_invoice_date51,Op.gte,data.start_date),_defineProperty(_invoice_date51,Op.lte,data.end_date),_invoice_date51)}]),required:true,include:[{model:_ledger["default"],as:'VoucherLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 3:items=_context11.sent;_context11.next=6;return(0,_journalvoucher.decreptionJournal)(items,'array',data.data.email);case 6:items=_context11.sent;_context11.next=9;return[];case 9:array=_context11.sent;other=items;if(!(items&&items.length>0)){_context11.next=24;break;}i=0;case 13:if(!(i<items.length)){_context11.next=22;break;}if(items[i].journal_entries){items[i].journal_entries.forEach(function(el,index){if(index===0){if(el.type==='debit'){el.debitAmount=el.amount;el.creditAmount=0;}else{el.debitAmount=0;el.creditAmount=el.amount;}el.total_amount=items[i].total_amount;el.invoice_id=items[i]&&Number(items[i].invoice_id)<9?"".concat(items[i].current_year.toString().substr(-2)+"-"+items[i].end_year.toString().substr(-2),"/00").concat(items[i].invoice_id):Number(items[i].invoice_id)>9?"".concat(items[i].current_year.toString().substr(-2)+"-"+items[i].end_year.toString().substr(-2),"/").concat(items[i].invoice_id):"".concat(items[i].current_year.toString().substr(-2)+"-"+items[i].end_year.toString().substr(-2),"/").concat(items[i].invoice_id);;el.invoice_date=items[i].invoice_date;el.purpose_voucher=items[i].purpose_voucher;el.journal_voucher_id=items[i].uid;array.push(el);}else{if(el.type==='debit'){el.debitAmount=el.amount;el.creditAmount=0;}else{el.debitAmount=0;el.creditAmount=el.amount;}el.total_amount='';el.invoice_id='';el.invoice_date='';el.purpose_voucher='';el.journal_voucher_id=items[i].uid;array.push(el);}});}if(items[i].item_stock_voucher_entries){items[i].item_stock_voucher_entries.forEach(function(el,index){if(index===0){if(el.type=='debit'||el.type=='Debit'){el.debitAmount=el.price;el.creditAmount=0;}else{el.debitAmount=0;el.creditAmount=el.price;}el.VoucherLedger=items[i].Ledger;el.total_amount=items[i].total_amount;el.invoice_id=items[i].invoice_id<=9?"".concat(items[i].current_year.toString().substr(-2)+"-"+items[i].end_year.toString().substr(-2),"/00").concat(items[i].invoice_id):items[i].invoice_id>9?"".concat(items[i].current_year.toString().substr(-2)+"-"+items[i].end_year.toString().substr(-2),"/0").concat(items[i].invoice_id):"".concat(items[i].current_year.toString().substr(-2)+"-"+items[i].end_year.toString().substr(-2),"/").concat(items[i].invoice_id);;el.invoice_date=items[i].invoice_date;el.purpose_voucher=items[i].purpose_voucher;el.journal_voucher_id=items[i].uid;array.push(el);}else{if(el.type=='debit'||el.type=='Debit'){el.debitAmount=el.price;el.creditAmount=0;}else{el.debitAmount=0;el.creditAmount=el.price;}el.VoucherLedger=items[i].Ledger;el.total_amount='';el.invoice_id='';el.invoice_date='';el.purpose_voucher='';el.journal_voucher_id=items[i].uid;array.push(el);}});};if(!(i==items.length-1)){_context11.next=19;break;}return _context11.abrupt("return",{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",Voucher:array,item:other});case 19:i++;_context11.next=13;break;case 22:_context11.next=25;break;case 24:return _context11.abrupt("return",{statusCode:res.statusCode,success:false,message:"voucher not found!",Voucher:[]});case 25:_context11.next=30;break;case 27:_context11.prev=27;_context11.t0=_context11["catch"](0);return _context11.abrupt("return",{statusCode:res.statusCode,success:false,error:_context11.t0,message:"Something went wrong!"});case 30:case"end":return _context11.stop();}},_callee9,null,[[0,27]]);}));return function(_x47,_x48){return _ref9.apply(this,arguments);};}();function getAllGroupVouchercurrent(_x49,_x50,_x51,_x52,_x53){return _getAllGroupVouchercurrent.apply(this,arguments);}function _getAllGroupVouchercurrent(){_getAllGroupVouchercurrent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee24(start_date,end_date,accountId,company_id,email){var findCompany,_invoice_date129,_invoice_date130,_invoice_date131,_invoice_date132,_invoice_date133,_invoice_date134,_invoice_date135,_invoice_date136,_invoice_date137,_invoice_date138,_invoice_date139,_invoice_date140,_invoice_date141,_invoice_date142,_invoice_date143,_invoice_date144,_invoice_date145,_invoice_date146,compaanyinfo,currentyear,ledger,totalbalnce,creditbalnce,debitbalnce;return _regeneratorRuntime().wrap(function _callee24$(_context26){while(1)switch(_context26.prev=_context26.next){case 0:_context26.prev=0;_context26.next=3;return _company["default"].findOne({where:{uid:company_id}});case 3:findCompany=_context26.sent;if(!(findCompany&&findCompany.dataValues)){_context26.next=35;break;}compaanyinfo=findCompany.dataValues;_context26.next=8;return new Date(start_date).getFullYear();case 8:currentyear=_context26.sent;_context26.next=11;return start_date;case 11:end_date=_context26.sent;_context26.next=14;return"".concat(currentyear,"-04-01");case 14:start_date=_context26.sent;// if(new Date(compaanyinfo.bookstart_date).getFullYear()==new Date(start_date).getFullYear()){
//     start_date = compaanyinfo.bookstart_date;
// }
console.log(end_date,"end_date",start_date,accountId);_context26.next=18;return _ledger["default"].findAll({where:_defineProperty({},Op.and,[{account_group_id:accountId},{company_id:company_id}]),attributes:['id','uid','name','amount','opening_balance'],include:[{model:_accountGroup["default"]},{model:_subAccountGroup["default"]},{model:_journalInteries["default"],where:{invoice_date:(_invoice_date129={},_defineProperty(_invoice_date129,Op.gte,start_date),_defineProperty(_invoice_date129,Op.lt,end_date),_invoice_date129)},required:false,attributes:['id','uid','type','invoice_date','amount','journa_voucher_id'],include:[{model:_journalVoucher2["default"],required:false,attributes:['id','uid','total_amount','invoice_id','invoice_date'],as:'Voucher'}]},{model:_recieptVoucher["default"],as:'Buyer',where:{invoice_date:(_invoice_date130={},_defineProperty(_invoice_date130,Op.gte,start_date),_defineProperty(_invoice_date130,Op.lt,end_date),_invoice_date130)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PBuyer',required:false,where:{invoice_date:(_invoice_date131={},_defineProperty(_invoice_date131,Op.gte,start_date),_defineProperty(_invoice_date131,Op.lt,end_date),_invoice_date131)},attributes:['id','uid','total_amount','type','receive_type']},{model:_recieptVoucher["default"],as:'RBuyer',where:{invoice_date:(_invoice_date132={},_defineProperty(_invoice_date132,Op.gte,start_date),_defineProperty(_invoice_date132,Op.lt,end_date),_invoice_date132)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PRBuyer',required:false,where:{invoice_date:(_invoice_date133={},_defineProperty(_invoice_date133,Op.gte,start_date),_defineProperty(_invoice_date133,Op.lt,end_date),_invoice_date133)},attributes:['id','uid','total_amount','type','receive_type']},{model:_saleVoucher["default"],where:{invoice_date:(_invoice_date134={},_defineProperty(_invoice_date134,Op.gte,start_date),_defineProperty(_invoice_date134,Op.lt,end_date),_invoice_date134)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],where:{invoice_date:(_invoice_date135={},_defineProperty(_invoice_date135,Op.gte,start_date),_defineProperty(_invoice_date135,Op.lt,end_date),_invoice_date135)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_saleVoucher["default"],as:"roundsales",where:{invoice_date:(_invoice_date136={},_defineProperty(_invoice_date136,Op.gte,start_date),_defineProperty(_invoice_date136,Op.lt,end_date),_invoice_date136)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"roundpurchase",where:{invoice_date:(_invoice_date137={},_defineProperty(_invoice_date137,Op.gte,start_date),_defineProperty(_invoice_date137,Op.lt,end_date),_invoice_date137)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_creditVoucher["default"],where:{invoice_date:(_invoice_date138={},_defineProperty(_invoice_date138,Op.gte,start_date),_defineProperty(_invoice_date138,Op.lt,end_date),_invoice_date138)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Debit'}}]},{model:_debitVoucher["default"],where:{invoice_date:(_invoice_date139={},_defineProperty(_invoice_date139,Op.gte,start_date),_defineProperty(_invoice_date139,Op.lt,end_date),_invoice_date139)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Credit'}}]},{model:_itemInteries["default"],required:false,where:{invoice_date:(_invoice_date140={},_defineProperty(_invoice_date140,Op.gte,start_date),_defineProperty(_invoice_date140,Op.lt,end_date),_invoice_date140)},include:[{model:_saleVoucher["default"],as:"ItemVouchers",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_purchaseVoucher["default"],as:"ItemVoucherp",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_debitVoucher["default"],as:"ItemVoucherd",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_creditVoucher["default"],as:"ItemVoucherc",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']}]},{model:_voucherInteries["default"],as:'vocher_entries',required:false,where:{invoice_date:(_invoice_date141={},_defineProperty(_invoice_date141,Op.gte,start_date),_defineProperty(_invoice_date141,Op.lt,end_date),_invoice_date141)},attributes:['id','uid','amount','type','ledger_id']},{model:_taxInteries["default"],as:'tax_entries',required:false,where:{invoice_date:(_invoice_date142={},_defineProperty(_invoice_date142,Op.gte,start_date),_defineProperty(_invoice_date142,Op.lt,end_date),_invoice_date142)},attributes:['id','uid','amount','type','tax_ledger_id']},{model:_saleVoucher["default"],as:"discountsales",where:{invoice_date:(_invoice_date143={},_defineProperty(_invoice_date143,Op.gte,start_date),_defineProperty(_invoice_date143,Op.lt,end_date),_invoice_date143)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"discountPurchases",where:{invoice_date:(_invoice_date144={},_defineProperty(_invoice_date144,Op.gte,start_date),_defineProperty(_invoice_date144,Op.lt,end_date),_invoice_date144)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_creditVoucher["default"],as:"discountCredit",where:{invoice_date:(_invoice_date145={},_defineProperty(_invoice_date145,Op.gte,start_date),_defineProperty(_invoice_date145,Op.lt,end_date),_invoice_date145)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_debitVoucher["default"],as:"discountDebit",where:{invoice_date:(_invoice_date146={},_defineProperty(_invoice_date146,Op.gte,start_date),_defineProperty(_invoice_date146,Op.lt,end_date),_invoice_date146)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]}]}).map(function(node){return node.get({plain:true});});case 18:ledger=_context26.sent;_context26.next=21;return(0,_voucherReport.decreptionReport)(ledger,'array',email);case 21:ledger=_context26.sent;if(!(ledger.length>0)){_context26.next=32;break;}totalbalnce=0;creditbalnce=0;debitbalnce=0;_context26.next=28;return ledger.map(/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee23(item){return _regeneratorRuntime().wrap(function _callee23$(_context25){while(1)switch(_context25.prev=_context25.next){case 0:item.open_amount=item.amount?item.opening_balance=='debit'?-1*Number(item.amount):item.amount:0;item.open_type=item.opening_balance;item.name=item.name;item.subAccount=item.sub_account_group?item.sub_account_group:{};item.accounttype=item.account_group&&item.account_group.type=="dr"?'debit':'credit';item.open_amount=item.amount?Number(item.amount):item.amount;delete item.amount;delete item.opening_balance;delete item.sub_account_group;delete item.account_group;item.invoice_id='';item.voucher_type='';item.debitAmount=0;item.creditAmount=0;if(item.journal_entries.length>0){item.journal_entries.forEach(function(journal){if(journal.type==='debit'){item.debitAmount=Number(journal.amount)+Number(item.debitAmount);}else{item.creditAmount=Number(journal.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.Buyer.length>0){item.Buyer.forEach(function(reciept){if(reciept.type==='debit'){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(reciept.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.PBuyer.length>0){item.PBuyer.forEach(function(payment){if(payment.type==='debit'){item.debitAmount=Number(payment.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.RBuyer.length>0){item.RBuyer.forEach(function(reciept){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));});}if(item.PRBuyer.length>0){item.PRBuyer.forEach(function(payment){item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.sales_vouchers&&item.sales_vouchers.length>0){item.sales_vouchers.forEach(function(sale){item.debitAmount=Number(sale.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.purchase_vouchers.length>0){item.purchase_vouchers.forEach(function(purchase){item.creditAmount=Number(purchase.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.roundsales&&item.roundsales.length>0){item.roundsales.forEach(function(sale){if(sale.roundoff_ledger_id){if(sale.roundoff_type=="debit"||sale.roundoff_type=="Debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.roundpurchase.length>0){item.roundpurchase.forEach(function(purchase){if(purchase.roundoff_ledger_id){if(purchase.roundoff_type=="debit"||purchase.roundoff_type=="Debit"){item.debitAmount=Number(-1*item.debitAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.credit_vouchers.length>0){item.credit_vouchers.forEach(function(credit){item.debitAmount=Number(credit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.debit_vouchers.length>0){item.debit_vouchers.forEach(function(debit){item.debitAmount=Number(debit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.item_entries.length>0){item.item_entries.forEach(function(voucher){if(voucher.ItemVouchers){item.invoice_date=voucher.ItemVouchers.invoice_date;item.invoice_id=voucher.ItemVouchers.invoice_id<=9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/00").concat(voucher.ItemVouchers.invoice_id):voucher.ItemVouchers.invoice_id>9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/0").concat(voucher.ItemVouchers.invoice_id):"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/").concat(voucher.ItemVouchers.invoice_id);item.voucher_type='sale';}if(voucher.ItemVoucherc){item.invoice_date=voucher.ItemVoucherc.invoice_date;item.invoice_id=voucher.ItemVoucherc.invoice_id<=9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherc.invoice_id):voucher.ItemVoucherc.invoice_id>9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherc.invoice_id):"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherc.invoice_id);item.voucher_type='credit';}if(voucher.ItemVoucherd){item.invoice_date=voucher.ItemVoucherd.invoice_date;item.invoice_id=voucher.ItemVoucherd.invoice_id<=9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherd.invoice_id):voucher.ItemVoucherd.invoice_id>9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherd.invoice_id):"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherd.invoice_id);item.voucher_type='debit';}if(voucher.ItemVoucherp){item.invoice_date=voucher.ItemVoucherp.invoice_date;item.invoice_id=voucher.ItemVoucherp.invoice_id;item.voucher_type='purchase';}if(voucher.type==="Sales"||voucher.type==="sales"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}else if(voucher.type==="Purchase"||voucher.type==="purchase"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Debit"||voucher.type==="Debit"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Credit"||voucher.type==="Credit"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.vocher_entries.length>0){
//     item.vocher_entries.forEach(voucher=>{
//         if(voucher.type==="Sales" || voucher.type==="sales"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Purchase" || voucher.type==="purchase"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Debit" || voucher.type==="Debit"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.debitAmount);
//         }else if(voucher.type==="Credit" || voucher.type==="Credit"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount))+Number(item.open_amount);
//     })
// }
if(item.tax_entries.length>0){item.tax_entries.forEach(function(tax){if(tax.type==="Sales"||tax.type==="sales"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}else if(tax.type==="Purchase"||tax.type==="purchase"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Debit"||tax.type==="debit"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Credit"||tax.type==="credit"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.discountsales && item.discountsales.length>0){
//     item.discountsales.forEach(sale=>{
//         item.debitAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.creditAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountPurchases && item.discountPurchases.length>0){
//     item.discountPurchases.forEach(sale=>{
//         item.creditAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.debitAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountCredit && item.discountCredit.length>0){
//     item.discountCredit.forEach(sale=>{
//         item.debitAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.creditAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountDebit && item.discountDebit.length>0){
//     item.discountDebit.forEach(sale=>{
//         item.creditAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.debitAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
if(item.roundsales&&item.roundsales.length<0||item.roundpurchase.length<0){if(item.discountsales&&item.discountsales.length>0){item.discountsales.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountPurchases&&item.discountPurchases.length>0){item.discountPurchases.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountCredit&&item.discountCredit.length>0){item.discountCredit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountDebit&&item.discountDebit.length>0){item.discountDebit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}}if(item.open_type==="debit"){item.closeing_amount=Number(item.closeing_amount)-Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='debit';item.accounttype=item.closeing_type;}if(item.open_type==="credit"){item.closeing_amount=Number(item.closeing_amount)+Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='credit';item.accounttype=item.closeing_type;}delete item.journal_entries;delete item.reciept_vouchers;delete item.payment_vouchers;delete item.sales_vouchers;delete item.purchase_vouchers;delete item.credit_vouchers;delete item.debit_vouchers;delete item.item_entries;delete item.vocher_entries;delete item.tax_entries;delete item.Buyer;delete item.PBuyer;delete item.PRBuyer;delete item.RBuyer;delete item.roundsales;delete item.roundpurchase;delete item.discountsales;delete item.discountPurchases;delete item.discountCredit;delete item.discountDebit;// if(item.open_type=="debit"){
//     item.debitAmount = Number(item.debitAmount)+Number(item.open_amount)
// }else{
//     item.creditAmount = Number(item.creditAmount)+Number(item.open_amount)
// }
totalbalnce=Number(totalbalnce)+Number(Number(item.creditAmount))-Number(Number(item.debitAmount));creditbalnce=Number(creditbalnce)+Number(item.creditAmount);debitbalnce=Number(debitbalnce)+Number(item.debitAmount);case 53:case"end":return _context25.stop();}},_callee23);}));return function(_x62){return _ref13.apply(this,arguments);};}());case 28:// return ledger
console.log({totalbalnce:totalbalnce,creditbalnce:creditbalnce,debitbalnce:debitbalnce});return _context26.abrupt("return",{totalbalnce:totalbalnce,creditbalnce:creditbalnce,debitbalnce:debitbalnce});case 32:return _context26.abrupt("return",{totalbalnce:0,creditbalnce:0,debitbalnce:0});case 33:_context26.next=36;break;case 35:return _context26.abrupt("return",{totalbalnce:0,creditbalnce:0,debitbalnce:0});case 36:_context26.next=41;break;case 38:_context26.prev=38;_context26.t0=_context26["catch"](0);console.log("err",_context26.t0);case 41:case"end":return _context26.stop();}},_callee24,null,[[0,38]]);}));return _getAllGroupVouchercurrent.apply(this,arguments);}function getAllGroupVoucherprivious(_x54,_x55,_x56,_x57,_x58){return _getAllGroupVoucherprivious.apply(this,arguments);}function _getAllGroupVoucherprivious(){_getAllGroupVoucherprivious=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee26(start_date,end_date,accountId,company_id,email){var ledger,totalbalnce,creditbalnce,debitbalnce;return _regeneratorRuntime().wrap(function _callee26$(_context28){while(1)switch(_context28.prev=_context28.next){case 0:_context28.prev=0;_context28.next=3;return _ledger["default"].findAll({where:_defineProperty({},Op.and,[{account_group_id:accountId},{company_id:company_id}]),attributes:['id','uid','name','amount','opening_balance'],include:[{model:_accountGroup["default"]},{model:_subAccountGroup["default"]},{model:_journalInteries["default"],where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','type','invoice_date','amount','journa_voucher_id'],include:[{model:_journalVoucher2["default"],required:false,attributes:['id','uid','total_amount','invoice_id','invoice_date'],as:'Voucher'}]},{model:_recieptVoucher["default"],as:'Buyer',where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PBuyer',required:false,where:{invoice_date:_defineProperty({},Op.lt,start_date)},attributes:['id','uid','total_amount','type','receive_type']},{model:_recieptVoucher["default"],as:'RBuyer',where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PRBuyer',required:false,where:{invoice_date:_defineProperty({},Op.lt,start_date)},attributes:['id','uid','total_amount','type','receive_type']},{model:_saleVoucher["default"],where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_saleVoucher["default"],as:"roundsales",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"roundpurchase",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_creditVoucher["default"],where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Debit'}}]},{model:_debitVoucher["default"],where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Credit'}}]},{model:_itemInteries["default"],required:false,where:{invoice_date:_defineProperty({},Op.lt,start_date)},include:[{model:_saleVoucher["default"],as:"ItemVouchers",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_purchaseVoucher["default"],as:"ItemVoucherp",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_debitVoucher["default"],as:"ItemVoucherd",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_creditVoucher["default"],as:"ItemVoucherc",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']}]},{model:_voucherInteries["default"],as:'vocher_entries',required:false,where:{invoice_date:_defineProperty({},Op.lt,start_date)},attributes:['id','uid','amount','type','ledger_id']},{model:_taxInteries["default"],as:'tax_entries',required:false,where:{invoice_date:_defineProperty({},Op.lt,start_date)},attributes:['id','uid','amount','type','tax_ledger_id']},{model:_saleVoucher["default"],as:"discountsales",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"discountPurchases",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_creditVoucher["default"],as:"discountCredit",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_debitVoucher["default"],as:"discountDebit",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]}]}).map(function(node){return node.get({plain:true});});case 3:ledger=_context28.sent;_context28.next=6;return(0,_voucherReport.decreptionReport)(ledger,'array',email);case 6:ledger=_context28.sent;if(!(ledger.length>0)){_context28.next=16;break;}totalbalnce=0;creditbalnce=0;debitbalnce=0;_context28.next=13;return ledger.map(/*#__PURE__*/function(){var _ref14=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee25(item){return _regeneratorRuntime().wrap(function _callee25$(_context27){while(1)switch(_context27.prev=_context27.next){case 0:item.open_amount=item.amount?item.opening_balance=='debit'?-1*Number(item.amount):item.amount:0;item.open_type=item.opening_balance;item.name=item.name;item.subAccount=item.sub_account_group?item.sub_account_group:{};item.account=item.account_group?item.account_group:{};item.accounttype=item.account_group&&item.account_group.type=="dr"?'debit':'credit';item.open_amount=item.amount?Number(item.amount):item.amount;delete item.amount;delete item.opening_balance;delete item.sub_account_group;delete item.account_group;item.invoice_id='';item.voucher_type='';item.debitAmount=0;item.creditAmount=0;if(item.journal_entries.length>0){item.journal_entries.forEach(function(journal){if(journal.type==='debit'){item.debitAmount=Number(journal.amount)+Number(item.debitAmount);}else{item.creditAmount=Number(journal.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.Buyer.length>0){item.Buyer.forEach(function(reciept){if(reciept.type==='debit'){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(reciept.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.PBuyer.length>0){item.PBuyer.forEach(function(payment){if(payment.type==='debit'){item.debitAmount=Number(payment.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.RBuyer.length>0){item.RBuyer.forEach(function(reciept){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));});}if(item.PRBuyer.length>0){item.PRBuyer.forEach(function(payment){item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.sales_vouchers&&item.sales_vouchers.length>0){item.sales_vouchers.forEach(function(sale){item.debitAmount=Number(sale.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.purchase_vouchers.length>0){item.purchase_vouchers.forEach(function(purchase){item.creditAmount=Number(purchase.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.roundsales&&item.roundsales.length>0){item.roundsales.forEach(function(sale){if(sale.roundoff_ledger_id){if(sale.roundoff_type=="debit"||sale.roundoff_type=="Debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.roundpurchase.length>0){item.roundpurchase.forEach(function(purchase){if(purchase.roundoff_ledger_id){if(purchase.roundoff_type=="debit"||purchase.roundoff_type=="Debit"){item.debitAmount=Number(-1*item.debitAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.credit_vouchers.length>0){item.credit_vouchers.forEach(function(credit){item.debitAmount=Number(credit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.debit_vouchers.length>0){item.debit_vouchers.forEach(function(debit){item.debitAmount=Number(debit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.item_entries.length>0){item.item_entries.forEach(function(voucher){if(voucher.ItemVouchers){item.invoice_date=voucher.ItemVouchers.invoice_date;item.invoice_id=voucher.ItemVouchers.invoice_id<=9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/00").concat(voucher.ItemVouchers.invoice_id):voucher.ItemVouchers.invoice_id>9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/0").concat(voucher.ItemVouchers.invoice_id):"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/").concat(voucher.ItemVouchers.invoice_id);item.voucher_type='sale';}if(voucher.ItemVoucherc){item.invoice_date=voucher.ItemVoucherc.invoice_date;item.invoice_id=voucher.ItemVoucherc.invoice_id<=9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherc.invoice_id):voucher.ItemVoucherc.invoice_id>9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherc.invoice_id):"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherc.invoice_id);item.voucher_type='credit';}if(voucher.ItemVoucherd){item.invoice_date=voucher.ItemVoucherd.invoice_date;item.invoice_id=voucher.ItemVoucherd.invoice_id<=9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherd.invoice_id):voucher.ItemVoucherd.invoice_id>9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherd.invoice_id):"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherd.invoice_id);item.voucher_type='debit';}if(voucher.ItemVoucherp){item.invoice_date=voucher.ItemVoucherp.invoice_date;item.invoice_id=voucher.ItemVoucherp.invoice_id;item.voucher_type='purchase';}if(voucher.type==="Sales"||voucher.type==="sales"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}else if(voucher.type==="Purchase"||voucher.type==="purchase"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Debit"||voucher.type==="Debit"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Credit"||voucher.type==="Credit"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.vocher_entries.length>0){
//     item.vocher_entries.forEach(voucher=>{
//         if(voucher.type==="Sales" || voucher.type==="sales"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Purchase" || voucher.type==="purchase"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Debit" || voucher.type==="Debit"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.debitAmount);
//         }else if(voucher.type==="Credit" || voucher.type==="Credit"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount))+Number(item.open_amount);
//     })
// }
if(item.tax_entries.length>0){item.tax_entries.forEach(function(tax){if(tax.type==="Sales"||tax.type==="sales"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}else if(tax.type==="Purchase"||tax.type==="purchase"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Debit"||tax.type==="debit"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Credit"||tax.type==="credit"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.roundsales&&item.roundsales.length<0||item.roundpurchase.length<0){if(item.discountsales&&item.discountsales.length>0){item.discountsales.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountPurchases&&item.discountPurchases.length>0){item.discountPurchases.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountCredit&&item.discountCredit.length>0){item.discountCredit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountDebit&&item.discountDebit.length>0){item.discountDebit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}}if(item.open_type==="debit"){item.closeing_amount=Number(item.closeing_amount)-Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='debit';item.accounttype=item.closeing_type;}if(item.open_type==="credit"){item.closeing_amount=Number(item.closeing_amount)+Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='credit';item.accounttype=item.closeing_type;}delete item.journal_entries;delete item.reciept_vouchers;delete item.payment_vouchers;delete item.sales_vouchers;delete item.purchase_vouchers;delete item.credit_vouchers;delete item.debit_vouchers;delete item.item_entries;delete item.vocher_entries;delete item.tax_entries;delete item.Buyer;delete item.PBuyer;delete item.PRBuyer;delete item.RBuyer;totalbalnce=Number(totalbalnce)+Number(Number(item.creditAmount))-Number(Number(item.debitAmount));creditbalnce=Number(creditbalnce)+Number(item.creditAmount);debitbalnce=Number(debitbalnce)+Number(item.debitAmount);case 48:case"end":return _context27.stop();}},_callee25);}));return function(_x63){return _ref14.apply(this,arguments);};}());case 13:return _context28.abrupt("return",{totalbalnce:totalbalnce,creditbalnce:creditbalnce,debitbalnce:debitbalnce});case 16:return _context28.abrupt("return",0);case 17:_context28.next=22;break;case 19:_context28.prev=19;_context28.t0=_context28["catch"](0);console.log("e",_context28.t0);case 22:case"end":return _context28.stop();}},_callee26,null,[[0,19]]);}));return _getAllGroupVoucherprivious.apply(this,arguments);}exports.getgroupVoucher=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee11(data,res){var Mainarray,query,_ref11,response,calculation,olddata,findyear,findProfitLedger,responseold,calculationold,debitProfiltAmount,creditProfiltAmount,openAmount1,diffrence,_invoice_date52,journalVoucher,findCompany,startdate,sign,oldAmount,closeamount,responsedata,openingStock,closeingStock,_responsedata,_invoice_date53,_invoice_date54,_invoice_date55,_invoice_date56,_invoice_date57,_invoice_date58,_invoice_date59,_invoice_date60,_invoice_date61,_invoice_date62,_invoice_date63,_invoice_date64,_invoice_date65,_invoice_date66,_invoice_date67,_invoice_date68,_invoice_date69,_invoice_date70,ledger,totalcalculate_openingblance,returngroup,sb,opendebittatal,opencredittatal,credittatal,debittatal,closingdebittatal,closingcredittatal,findLedgerType,_findCompany;return _regeneratorRuntime().wrap(function _callee11$(_context13){while(1)switch(_context13.prev=_context13.next){case 0:_context13.prev=0;_context13.next=3;return[];case 3:Mainarray=_context13.sent;if(!data.account_id){_context13.next=8;break;}_context13.next=7;return{account_group_id:data.account_id};case 7:query=_context13.sent;case 8:if(!data.sub_account_id){_context13.next=12;break;}_context13.next=11;return{sub_account_group_id:data.sub_account_id};case 11:query=_context13.sent;case 12:if(!(data.account_id==_config["default"].profit_loss_id)){_context13.next=62;break;}_context13.next=15;return currentprofitLoss(data,res);case 15:response=_context13.sent;_context13.next=18;return profitCal(response.sheetdata?response.sheetdata:{});case 18:calculation=_context13.sent;olddata=_objectSpread({},data);findyear=new Date(olddata.start_date).getFullYear();olddata.start_date="1900-04-01";olddata.end_date="".concat(Number(findyear),"-03-31");// console.log("data old", olddata)
_context13.next=25;return _ledger["default"].findOne({where:{company_id:data.company_id,account_group_id:_config["default"].profit_loss_id}});case 25:findProfitLedger=_context13.sent;_context13.next=28;return(0,_ledger2.decreption)(findProfitLedger,'object',data.data.email);case 28:findProfitLedger=_context13.sent;_context13.next=31;return oldprofitLoss(olddata,res);case 31:responseold=_context13.sent;_context13.next=34;return profitCal(responseold.sheetdata?responseold.sheetdata:{});case 34:calculationold=_context13.sent;debitProfiltAmount=0;creditProfiltAmount=0;openAmount1=0;diffrence=0;if(!findProfitLedger){_context13.next=53;break;}_context13.next=42;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:findProfitLedger.dataValues.uid},{company_id:data.company_id},{invoice_date:(_invoice_date52={},_defineProperty(_invoice_date52,Op.gte,data.start_date),_defineProperty(_invoice_date52,Op.lte,data.end_date),_invoice_date52)}]),order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 42:journalVoucher=_context13.sent;if(!(journalVoucher.length>0)){_context13.next=48;break;}_context13.next=46;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',data.data.email);case 46:journalVoucher=_context13.sent;journalVoucher.map(function(item){if(item.type=="debit"){debitProfiltAmount=Number(debitProfiltAmount)+Number(item.amount);}else{creditProfiltAmount=Number(creditProfiltAmount)+Number(item.amount);}});// return {journalVoucher}
case 48:_context13.next=50;return _company["default"].findOne({where:{uid:data.company_id}});case 50:findCompany=_context13.sent;if(findCompany&&findCompany.dataValues&&findCompany.dataValues.id){console.log("new Date(findCompany.dataValues.bookstart_date)",new Date(findCompany.dataValues.bookstart_date),new Date(new Date(new Date(data.start_date).getDate()).setDate(new Date(data.start_date).getDate()-1)));if(new Date(findCompany.dataValues.bookstart_date).getFullYear()==new Date(data.start_date).getFullYear()){startdate=new Date(new Date(new Date(data.start_date).getDate()).setDate(new Date(data.start_date).getDate()-1));if(new Date(findCompany.dataValues.bookstart_date).getTime()>new Date(startdate).getTime()){console.log("calculationold.netProfite = 0; if");calculationold.netProfite=0;}else{console.log("calculationold.netProfite = 0; else");//
}}else{if(new Date(findCompany.dataValues.bookstart_date).getTime()>new Date(data.start_date).getTime()){console.log("calculationold.netProfite = 01; if");calculationold.netProfite=0;}else{console.log("calculationold.netProfite = 01; else");// calculationold.netProfite = 0;
}}}// calculationold.netProfite =  Number(calculationold.netProfite)- Number(calculationold.openAmount);
if(findProfitLedger.dataValues.opening_balance=="credit"){if(Number(creditProfiltAmount)>Number(debitProfiltAmount)){diffrence=Number(creditProfiltAmount)-Number(debitProfiltAmount);}else{diffrence=Number(debitProfiltAmount)-Number(creditProfiltAmount);}// openAmount1 = Number(calculationold.netProfite)+Number(findProfitLedger.dataValues.amount);
if(new Date(findCompany.dataValues.bookstart_date).getFullYear()==new Date(data.start_date).getFullYear()){openAmount1=Number(calculationold.netProfite)+Number(findProfitLedger.dataValues.amount);}else{sign=Number(calculationold.netProfite)<0?'-':"+";openAmount1=Number(calculationold.netProfite);//(Number(calculationold.netProfite)<0?-1*Number(calculationold.netProfite):Number(calculationold.netProfite))+Number(findProfitLedger.dataValues.amount);
// openAmount1 = sign+openAmount1; 
}calculationold.netProfite=Number(calculationold.netProfite)+Number(Number(findProfitLedger.dataValues.amount)-Number(diffrence));calculation.netProfite=Number(calculation.netProfite)+Number(Number(findProfitLedger.dataValues.amount)-Number(diffrence));}else{if(Number(creditProfiltAmount)>Number(debitProfiltAmount)){diffrence=Number(creditProfiltAmount)-Number(debitProfiltAmount);}else{diffrence=Number(debitProfiltAmount)-Number(creditProfiltAmount);}// openAmount1 = Number(calculationold.netProfite)+Number(findProfitLedger.dataValues.amount);
if(new Date(findCompany.dataValues.bookstart_date).getFullYear()==new Date(data.start_date).getFullYear()){openAmount1=Number(calculationold.netProfite)+Number(findProfitLedger.dataValues.amount);}else{openAmount1=Number(calculationold.netProfite);}calculationold.netProfite=-1*Number(Number(calculationold.netProfite)+Number(Number(findProfitLedger.dataValues.amount)+Number(diffrence)));calculation.netProfite=-1*Number(Number(calculation.netProfite)+Number(Number(findProfitLedger.dataValues.amount)+Number(diffrence)));}case 53:console.log("calculationold",calculationold);console.log("calculation",calculation);oldAmount=Number(Number(openAmount1)>=0?Number(openAmount1):-1*Number(openAmount1));console.log("oldAmount",oldAmount,debitProfiltAmount,creditProfiltAmount);closeamount=Number(oldAmount)+Number(Number(creditProfiltAmount)-Number(Number(debitProfiltAmount)));responsedata=[{account_group_id:data.account_id,closeing_amount:closeamount,//calculation.netProfite>0?Number(calculation.netProfite): -1*Number(calculation.netProfite),
accounttype:Number(closeamount)>0?'credit':'debit',creditAmount:creditProfiltAmount,debitAmount:debitProfiltAmount,ishead:true,ismain:true,name:"Profit and Loss",open_amount:openAmount1>0?Number(openAmount1):-1*Number(openAmount1),open_type:openAmount1>0?'credit':'debit',// accounttype : 'debit',
subAccount:{},sub_uid:""},(_ref11={account_group_id:data.account_id,// closeing_amount: calculation.netProfite>0?Number(calculation.netProfite): -1*Number(calculation.netProfite),
// accounttype:Number(calculation.netProfite)>0?'credit':'debit',
accounttype:Number(closeamount)>0?'credit':'debit',creditAmount:creditProfiltAmount,voucher_type:'',account:{name:"Profit and Loss"},invoice_date:'',invoice_id:''},_defineProperty(_ref11,"creditAmount",0),_defineProperty(_ref11,"debitAmount",0),_defineProperty(_ref11,"open_amount",openAmount1>0?Number(openAmount1):-1*Number(openAmount1)),_defineProperty(_ref11,"open_type",calculationold.netProfite>0?'credit':'debit'),_defineProperty(_ref11,"name","Profit and Loss"),_defineProperty(_ref11,"subAccount",{}),_defineProperty(_ref11,"sub_uid",""),_ref11)];return _context13.abrupt("return",{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",JournalVoucher:responsedata});case 62:if(!(data.account_id===_config["default"].stockinhand_id)){_context13.next=77;break;}_context13.next=65;return getopeingbalanceStockcalculation(data,res);case 65:openingStock=_context13.sent;//await getopeingbalancecalculation(data, res);
console.log(openingStock,"openingStock");_context13.next=69;return getcloasingbalanceStockcalculation(data,openingStock,res);case 69:closeingStock=_context13.sent;//getcloasingbalancecalculation(data, res);
if(closeingStock==0){closeingStock=openingStock;}console.log("openingStock",openingStock);console.log("closeingStock",closeingStock);_responsedata=[{account_group_id:data.account_id,accounttype:Number(closeingStock)<0?'credit':'debit',closeing_amount:Number(closeingStock)<0?-1*Number(closeingStock):closeingStock,creditAmount:0,debitAmount:0,ishead:true,ismain:true,name:"Opening Stock",open_amount:Number(openingStock)<0?-1*Number(openingStock):openingStock,open_type:Number(openingStock)<0?'credit':'debit',subAccount:{},sub_uid:""},{account_group_id:data.account_id,accounttype:Number(closeingStock)<0?'credit':'debit',open_amount:Number(openingStock)<0?-1*Number(openingStock):openingStock,closeing_amount:Number(closeingStock)<0?-1*Number(closeingStock):closeingStock,voucher_type:'',account:{name:"Opening Stock"},invoice_date:'',invoice_id:'',creditAmount:0,debitAmount:0,open_type:Number(openingStock)<0?'credit':'debit',name:"Opening Stock",subAccount:{},sub_uid:""}];return _context13.abrupt("return",{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",JournalVoucher:_responsedata});case 77:_context13.next=79;return _ledger["default"].findAll({where:_defineProperty({},Op.and,[query,{company_id:data.company_id}]),attributes:['id','uid','name','amount','opening_balance','account_group_id','sub_account_group_id'],include:[{model:_accountGroup["default"]},{model:_subAccountGroup["default"]},{model:_journalInteries["default"],where:{invoice_date:(_invoice_date53={},_defineProperty(_invoice_date53,Op.gte,data.start_date),_defineProperty(_invoice_date53,Op.lte,data.end_date),_invoice_date53)},required:false,attributes:['id','uid','type','invoice_date','amount','journa_voucher_id'],include:[{model:_journalVoucher2["default"],required:false,attributes:['id','uid','total_amount','invoice_id','invoice_date'],as:'Voucher'}]},{model:_recieptVoucher["default"],as:'Buyer',where:{invoice_date:(_invoice_date54={},_defineProperty(_invoice_date54,Op.gte,data.start_date),_defineProperty(_invoice_date54,Op.lte,data.end_date),_invoice_date54)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PBuyer',required:false,where:{invoice_date:(_invoice_date55={},_defineProperty(_invoice_date55,Op.gte,data.start_date),_defineProperty(_invoice_date55,Op.lte,data.end_date),_invoice_date55)},attributes:['id','uid','total_amount','type','receive_type']},{model:_recieptVoucher["default"],as:'RBuyer',where:{invoice_date:(_invoice_date56={},_defineProperty(_invoice_date56,Op.gte,data.start_date),_defineProperty(_invoice_date56,Op.lte,data.end_date),_invoice_date56)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PRBuyer',required:false,where:{invoice_date:(_invoice_date57={},_defineProperty(_invoice_date57,Op.gte,data.start_date),_defineProperty(_invoice_date57,Op.lte,data.end_date),_invoice_date57)},attributes:['id','uid','total_amount','type','receive_type']},{model:_saleVoucher["default"],where:{invoice_date:(_invoice_date58={},_defineProperty(_invoice_date58,Op.gte,data.start_date),_defineProperty(_invoice_date58,Op.lte,data.end_date),_invoice_date58)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],where:{invoice_date:(_invoice_date59={},_defineProperty(_invoice_date59,Op.gte,data.start_date),_defineProperty(_invoice_date59,Op.lte,data.end_date),_invoice_date59)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_saleVoucher["default"],as:"roundsales",where:{invoice_date:(_invoice_date60={},_defineProperty(_invoice_date60,Op.gte,data.start_date),_defineProperty(_invoice_date60,Op.lte,data.end_date),_invoice_date60)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"roundpurchase",where:{invoice_date:(_invoice_date61={},_defineProperty(_invoice_date61,Op.gte,data.start_date),_defineProperty(_invoice_date61,Op.lte,data.end_date),_invoice_date61)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_creditVoucher["default"],where:{invoice_date:(_invoice_date62={},_defineProperty(_invoice_date62,Op.gte,data.start_date),_defineProperty(_invoice_date62,Op.lte,data.end_date),_invoice_date62)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Debit'}}]},{model:_debitVoucher["default"],where:{invoice_date:(_invoice_date63={},_defineProperty(_invoice_date63,Op.gte,data.start_date),_defineProperty(_invoice_date63,Op.lte,data.end_date),_invoice_date63)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Credit'}}]},{model:_itemInteries["default"],required:false,where:{invoice_date:(_invoice_date64={},_defineProperty(_invoice_date64,Op.gte,data.start_date),_defineProperty(_invoice_date64,Op.lte,data.end_date),_invoice_date64)},include:[{model:_saleVoucher["default"],as:"ItemVouchers",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_purchaseVoucher["default"],as:"ItemVoucherp",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_debitVoucher["default"],as:"ItemVoucherd",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_creditVoucher["default"],as:"ItemVoucherc",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']}]},{model:_voucherInteries["default"],as:'vocher_entries',required:false,where:{invoice_date:(_invoice_date65={},_defineProperty(_invoice_date65,Op.gte,data.start_date),_defineProperty(_invoice_date65,Op.lte,data.end_date),_invoice_date65)},attributes:['id','uid','amount','type','ledger_id']},{model:_taxInteries["default"],as:'tax_entries',required:false,where:{invoice_date:(_invoice_date66={},_defineProperty(_invoice_date66,Op.gte,data.start_date),_defineProperty(_invoice_date66,Op.lte,data.end_date),_invoice_date66)},attributes:['id','uid','amount','type','tax_ledger_id']},{model:_saleVoucher["default"],as:"discountsales",where:{invoice_date:(_invoice_date67={},_defineProperty(_invoice_date67,Op.gte,data.start_date),_defineProperty(_invoice_date67,Op.lte,data.end_date),_invoice_date67)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"discountPurchases",where:{invoice_date:(_invoice_date68={},_defineProperty(_invoice_date68,Op.gte,data.start_date),_defineProperty(_invoice_date68,Op.lte,data.end_date),_invoice_date68)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_creditVoucher["default"],as:"discountCredit",where:{invoice_date:(_invoice_date69={},_defineProperty(_invoice_date69,Op.gte,data.start_date),_defineProperty(_invoice_date69,Op.lte,data.end_date),_invoice_date69)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_debitVoucher["default"],as:"discountDebit",where:{invoice_date:(_invoice_date70={},_defineProperty(_invoice_date70,Op.gte,data.start_date),_defineProperty(_invoice_date70,Op.lte,data.end_date),_invoice_date70)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]}]}).map(function(node){return node.get({plain:true});});case 79:ledger=_context13.sent;_context13.next=82;return(0,_voucherReport.decreptionReport)(ledger,'array',data.data.email);case 82:ledger=_context13.sent;if(!(ledger.length>0)){_context13.next=151;break;}_context13.next=86;return{creditbalnce:0,debitbalnce:0,totalbalnce:0};case 86:totalcalculate_openingblance=_context13.sent;_context13.next=89;return ledger.map(/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10(item){return _regeneratorRuntime().wrap(function _callee10$(_context12){while(1)switch(_context12.prev=_context12.next){case 0:item.closeing_amount=0;item.open_type=item.opening_balance;item.name=item.name;item.subAccount=item.sub_account_group?item.sub_account_group:{};item.account=item.account_group?item.account_group:{};item.accounttype=item.account_group&&item.account_group.type=="dr"?'debit':'credit';item.open_amount=item.amount?Number(item.amount):item.amount;delete item.amount;delete item.opening_balance;delete item.sub_account_group;delete item.account_group;item.invoice_id='';item.voucher_type='';item.debitAmount=0;item.creditAmount=0;item.closeing_type='';if(item.journal_entries.length>0){item.journal_entries.forEach(function(journal){if(journal.type==='debit'){item.debitAmount=Number(journal.amount)+Number(item.debitAmount);}else{item.creditAmount=Number(journal.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.Buyer.length>0){item.Buyer.forEach(function(reciept){if(reciept.type==='debit'){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(reciept.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.PBuyer.length>0){item.PBuyer.forEach(function(payment){if(payment.type==='debit'){item.debitAmount=Number(payment.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.RBuyer.length>0){item.RBuyer.forEach(function(reciept){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));});}if(item.PRBuyer.length>0){item.PRBuyer.forEach(function(payment){item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.roundsales&&item.roundsales.length>0){item.roundsales.forEach(function(sale){if(sale.roundoff_ledger_id){if(sale.roundoff_type=="debit"||sale.roundoff_type=="Debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.roundpurchase.length>0){item.roundpurchase.forEach(function(purchase){if(purchase.roundoff_ledger_id){if(purchase.roundoff_type=="debit"||purchase.roundoff_type=="Debit"){item.debitAmount=Number(-1*item.debitAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.sales_vouchers&&item.sales_vouchers.length>0){item.sales_vouchers.forEach(function(sale){item.debitAmount=Number(sale.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.purchase_vouchers.length>0){item.purchase_vouchers.forEach(function(purchase){item.creditAmount=Number(purchase.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.credit_vouchers.length>0){item.credit_vouchers.forEach(function(credit){item.debitAmount=Number(credit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.debit_vouchers.length>0){item.debit_vouchers.forEach(function(debit){item.debitAmount=Number(debit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.item_entries.length>0){item.item_entries.forEach(function(voucher){if(voucher.ItemVouchers){item.invoice_date=voucher.ItemVouchers.invoice_date;item.invoice_id=voucher.ItemVouchers.invoice_id<=9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/00").concat(voucher.ItemVouchers.invoice_id):voucher.ItemVouchers.invoice_id>9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/0").concat(voucher.ItemVouchers.invoice_id):"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/").concat(voucher.ItemVouchers.invoice_id);item.voucher_type='sale';}if(voucher.ItemVoucherc){item.invoice_date=voucher.ItemVoucherc.invoice_date;item.invoice_id=voucher.ItemVoucherc.invoice_id<=9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherc.invoice_id):voucher.ItemVoucherc.invoice_id>9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherc.invoice_id):"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherc.invoice_id);item.voucher_type='credit';}if(voucher.ItemVoucherd){item.invoice_date=voucher.ItemVoucherd.invoice_date;item.invoice_id=voucher.ItemVoucherd.invoice_id<=9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherd.invoice_id):voucher.ItemVoucherd.invoice_id>9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherd.invoice_id):"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherd.invoice_id);item.voucher_type='debit';}if(voucher.ItemVoucherp){item.invoice_date=voucher.ItemVoucherp.invoice_date;item.invoice_id=voucher.ItemVoucherp.invoice_id;item.voucher_type='purchase';}if(voucher.type==="Sales"||voucher.type==="sales"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}else if(voucher.type==="Purchase"||voucher.type==="purchase"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Debit"||voucher.type==="Debit"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Credit"||voucher.type==="Credit"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.vocher_entries.length>0){
//     item.vocher_entries.forEach(voucher=>{
//         if(voucher.type==="Sales" || voucher.type==="sales"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Purchase" || voucher.type==="purchase"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Debit" || voucher.type==="Debit"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.debitAmount);
//         }else if(voucher.type==="Credit" || voucher.type==="Credit"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount))+Number(item.open_amount);
//     })
// }
if(item.tax_entries.length>0){item.tax_entries.forEach(function(tax){if(tax.type==="Sales"||tax.type==="sales"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}else if(tax.type==="Purchase"||tax.type==="purchase"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Debit"||tax.type==="debit"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Credit"||tax.type==="credit"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.discountsales && item.discountsales.length>0){
//     item.discountsales.forEach(sale=>{
//         item.debitAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.creditAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountPurchases && item.discountPurchases.length>0){
//     item.discountPurchases.forEach(sale=>{
//         item.creditAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.debitAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountCredit && item.discountCredit.length>0){
//     item.discountCredit.forEach(sale=>{
//         item.debitAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.creditAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountDebit && item.discountDebit.length>0){
//     item.discountDebit.forEach(sale=>{
//         item.creditAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.debitAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
if(item.roundsales&&item.roundsales.length<0||item.roundpurchase.length<0){if(item.discountsales&&item.discountsales.length>0){item.discountsales.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountPurchases&&item.discountPurchases.length>0){item.discountPurchases.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountCredit&&item.discountCredit.length>0){item.discountCredit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountDebit&&item.discountDebit.length>0){item.discountDebit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}}// if(item.open_type=="debit"){
//     item.debitAmount = Number(item.debitAmount)+ item.open_amount;
// }
// if(item.open_type=="credit"){
//     item.creditAmount = Number(item.creditAmount)+ item.open_amount;
// }
if(item.open_type==="debit"){item.closeing_amount=Number(item.closeing_amount)-Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='debit';item.accounttype=item.closeing_type;}if(item.open_type==="credit"){item.closeing_amount=Number(item.closeing_amount)+Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='credit';item.accounttype=item.closeing_type;}delete item.journal_entries;delete item.reciept_vouchers;delete item.payment_vouchers;delete item.sales_vouchers;delete item.purchase_vouchers;delete item.credit_vouchers;delete item.debit_vouchers;delete item.item_entries;delete item.vocher_entries;delete item.tax_entries;delete item.Buyer;delete item.PBuyer;delete item.PRBuyer;delete item.RBuyer;case 46:case"end":return _context12.stop();}},_callee10);}));return function(_x61){return _ref12.apply(this,arguments);};}());case 89:_context13.next=91;return groupFuncation(ledger);case 91:returngroup=_context13.sent;// return {returngroup:returngroup}
sb=[];if(!returngroup){_context13.next=96;break;}_context13.next=96;return Object.keys(returngroup).map(function(item){if(item==="MainGroup"){if(returngroup[item].length>0){var a={name:returngroup[item][0].account.name,ledger_id:returngroup[item][0].uid,open_amount:0,closeing_amount:0,closeing_type:'',sub_uid:'',account_group_id:'',subAccount:{},accounttype:'',debitAmount:0,creditAmount:0,ishead:true,ismain:true,issub:false};var b=[];returngroup[item].map(function(element){if(element.open_type=="credit"){a.open_amount=Number(a.open_amount)+Number(element.open_amount?element.open_amount:0);}else{a.open_amount=Number(a.open_amount)-Number(element.open_amount?element.open_amount:0);if(a.open_amount<0){// a.open_amount = -1*Number(a.open_amount)
a.open_type="debit";}}a.subAccount={};a.closeing_amount=Number(a.closeing_amount?a.closeing_amount:0)+Number(element.closeing_amount?element.closeing_amount:0);a.debitAmount=Number(a.debitAmount)+Number(element.debitAmount?element.debitAmount:0);a.creditAmount=Number(a.creditAmount)+Number(element.creditAmount?element.creditAmount:0);a.account_group_id=element.account_group_id;// element.open_amount = 0;  
if(element.open_type=="credit"){if(element.open_type==element.accounttype){if(Number(Number(element.creditAmount)+Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)+Number(Number(element.open_amount)))){element.accounttype='debit';}}else{if(Number(Number(element.creditAmount)-Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)-Number(Number(element.open_amount)))){element.accounttype='debit';}}}else{if(element.open_type==element.accounttype){if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}else{if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}}// a.closeing_amount = Number(element.closeing_amount?element.closeing_amount:0)+Number(Number(b.length>0?b[b.length-1].closeing_amount:0));
b.push(element);});if(Number(a.creditAmount)>Number(a.debitAmount)){a.accounttype='credit';a.closeing_amount=Number(a.creditAmount)-Number(a.debitAmount);}else if(Number(a.debitAmount)>Number(a.creditAmount)){a.accounttype='debit';a.closeing_amount=Number(a.debitAmount)-Number(a.creditAmount);}b.unshift(a);Mainarray=Mainarray.concat(b);}}else{var _a={name:returngroup[item][0].name,ledger_id:returngroup[item][0].uid,open_amount:0,closeing_amount:0,closeing_type:'',sub_uid:'',account_group_id:'',subAccount:{},accounttype:'debit',debitAmount:0,creditAmount:0,ishead:false,ismain:false,issub:true};var _b=[];returngroup[item].map(function(element){if(element.open_type=="credit"){_a.open_amount=Number(_a.open_amount)+Number(element.open_amount?element.open_amount:0);}else{_a.open_amount=Number(_a.open_amount)-Number(element.open_amount?element.open_amount:0);if(_a.open_amount<0){// a.open_amount = -1*Number(a.open_amount)
_a.open_type="debit";}}_a.subAccount={};_a.closeing_amount=Number(_a.closeing_amount?_a.closeing_amount:0)+Number(element.closeing_amount?element.closeing_amount:0);_a.debitAmount=Number(_a.debitAmount)+Number(element.debitAmount?element.debitAmount:0);_a.creditAmount=Number(_a.creditAmount)+Number(element.creditAmount?element.creditAmount:0);_a.account_group_id=element.account_group_id;if(element.open_type=="credit"){if(element.open_type==element.accounttype){if(Number(Number(element.creditAmount)+Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)+Number(Number(element.open_amount)))){element.accounttype='debit';}}else{if(Number(Number(element.creditAmount)-Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)-Number(Number(element.open_amount)))){element.accounttype='debit';}}}else{if(element.open_type==element.accounttype){if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}else{if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}}// a.closeing_amount = Number(element.closeing_amount?element.closeing_amount:0)+Number(Number(b.length>0?b[b.length-1].closeing_amount:0));
sb.push(element);});if(Number(_a.creditAmount)>Number(_a.debitAmount)){_a.accounttype='credit';_a.closeing_amount=Number(_a.creditAmount)-Number(_a.debitAmount);}else if(Number(_a.debitAmount)>Number(_a.creditAmount)){_a.accounttype='debit';_a.closeing_amount=Number(_a.debitAmount)-Number(_a.creditAmount);}sb.unshift(_a);// Mainarray = Mainarray.concat(b);
}});case 96:if(!(Mainarray.length>0)){_context13.next=148;break;}opendebittatal=0;opencredittatal=0;credittatal=0;debittatal=0;closingdebittatal=0;closingcredittatal=0;// Mainarray = await arraySort(Mainarray, 'name')
_context13.next=105;return sb.length;case 105:_context13.t0=_context13.sent;if(!(_context13.t0>0)){_context13.next=110;break;}_context13.next=109;return Mainarray.concat(sb);case 109:Mainarray=_context13.sent;case 110:_context13.next=112;return Mainarray.map(function(item){if(item.ishead&&item.ismain&&!item.issub){}else if(!item.ishead&&!item.ismain&&item.issub){// console.log("item.issub", item.issub)
}else{debittatal=Number(debittatal)+Number(item.debitAmount);credittatal=Number(credittatal)+Number(item.creditAmount);if(item.open_type=="debit"){opendebittatal=Number(opendebittatal)+Number(item.open_amount);}else{opencredittatal=Number(opencredittatal)+Number(item.open_amount);}if(item.accounttype=="debit"){closingdebittatal=Number(closingdebittatal)+Number(item.closeing_amount);}else{closingcredittatal=Number(closingcredittatal)+Number(item.closeing_amount);}}});case 112:_context13.next=114;return _ledger["default"].findOne({where:{uid:Mainarray[0].ledger_id}});case 114:findLedgerType=_context13.sent;_context13.next=117;return _company["default"].findOne({where:{uid:data.company_id}});case 117:_findCompany=_context13.sent;_context13.next=120;return(0,_ledger2.decreption)(findLedgerType,'object',data.data.email);case 120:findLedgerType=_context13.sent;if(Number(opencredittatal)>Number(opendebittatal)){Mainarray[0].open_type=Number(opendebittatal)==0?findLedgerType.opening_balance:'credit';Mainarray[0].open_amount=Number(opencredittatal)-Number(opendebittatal);Mainarray[0].closeing_amount=Number(Mainarray[0].creditAmount)+Number(Number(opencredittatal)-Number(opendebittatal));}else{Mainarray[0].open_type=Number(opencredittatal)==0?findLedgerType.opening_balance:'debit';Mainarray[0].open_amount=Number(opendebittatal)-Number(opencredittatal);Mainarray[0].closeing_amount=Number(Mainarray[0].debitAmount)+Number(Number(opendebittatal)-Number(opencredittatal));}if(Number(closingcredittatal)>Number(closingdebittatal)){Mainarray[0].accounttype='credit';Mainarray[0].closeing_amount=Number(closingcredittatal)-Number(closingdebittatal);}else{Mainarray[0].accounttype='debit';Mainarray[0].closeing_amount=Number(closingdebittatal)-Number(closingcredittatal);}_context13.next=125;return checkValid(Mainarray[0].account_group_id);case 125:if(!_context13.sent){_context13.next=136;break;}_context13.next=128;return getAllGroupVouchercurrent(data.start_date,data.end_date,Mainarray[0].account_group_id,data.company_id,data.data.email);case 128:totalcalculate_openingblance=_context13.sent;if(totalcalculate_openingblance.totalbalnce!=0){if(totalcalculate_openingblance.totalbalnce<0){Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)-Number(Mainarray[0].open_amount);}else{Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)+Number(Mainarray[0].open_amount);}}else{Mainarray[0].closeing_amount=Number(Mainarray[0].closeing_amount)+Number(totalcalculate_openingblance.totalbalnce?totalcalculate_openingblance.totalbalnce:0);}// Mainarray[0].closeing_amount = Number(Mainarray[0].closeing_amount)+Number(totalcalculate_openingblance.totalbalnce?totalcalculate_openingblance.totalbalnce:0);
Mainarray[0].creditAmount=Number(Mainarray[0].creditAmount)+Number(totalcalculate_openingblance.creditbalnce?totalcalculate_openingblance.creditbalnce:0);Mainarray[0].debitAmount=Number(Mainarray[0].debitAmount)+Number(totalcalculate_openingblance.debitbalnce?totalcalculate_openingblance.debitbalnce:0);if(Mainarray[0].accounttype=='debit'){if(Mainarray[0].closeing_amount<0){Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}}if(Mainarray[0].accounttype=='credit'){if(Mainarray[0].closeing_amount<0){Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}}_context13.next=145;break;case 136:_context13.next=138;return getAllGroupVoucherprivious(data.start_date,data.end_date,Mainarray[0].account_group_id,data.company_id,data.data.email);case 138:totalcalculate_openingblance=_context13.sent;console.log("totalcalculate_openingblance",totalcalculate_openingblance);if(totalcalculate_openingblance.totalbalnce!=0){if(totalcalculate_openingblance.totalbalnce<0){// if(Mainarray[0].open_type=="debit"){
// Mainarray[0].closeing_amount  = Number(totalcalculate_openingblance.totalbalnce)-Number(Mainarray[0].open_amount);
// }
if(Mainarray[0].open_type=="debit"){Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)-Number(Mainarray[0].open_amount);if(Number(Mainarray[0].closeing_amount)<0){Mainarray[0].accounttype="debit";Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}else{Mainarray[0].accounttype="credit";}}else{Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)+Number(Mainarray[0].open_amount);if(Number(Mainarray[0].closeing_amount)<0){Mainarray[0].accounttype="debit";Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}else{Mainarray[0].accounttype="credit";}}}else{if(Mainarray[0].open_type=="debit"){Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)-Number(Mainarray[0].open_amount);if(Number(Mainarray[0].closeing_amount)<0){Mainarray[0].accounttype="debit";Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}else{Mainarray[0].accounttype="credit";}}else{Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)+Number(Mainarray[0].open_amount);if(Number(Mainarray[0].closeing_amount)<0){Mainarray[0].accounttype="debit";Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}else{Mainarray[0].accounttype="credit";}}// Mainarray[0].closeing_amount  = Number(totalcalculate_openingblance.totalbalnce)+Number(Mainarray[0].open_amount);
}}else{Mainarray[0].closeing_amount=Number(Mainarray[0].closeing_amount)+Number(totalcalculate_openingblance.totalbalnce?totalcalculate_openingblance.totalbalnce:0);}// Mainarray[0].closeing_amount = Number(Mainarray[0].closeing_amount)+Number(totalcalculate_openingblance.totalbalnce?totalcalculate_openingblance.totalbalnce:0);
Mainarray[0].creditAmount=Number(Mainarray[0].creditAmount)+Number(totalcalculate_openingblance.creditbalnce?totalcalculate_openingblance.creditbalnce:0);Mainarray[0].debitAmount=Number(Mainarray[0].debitAmount)+Number(totalcalculate_openingblance.debitbalnce?totalcalculate_openingblance.debitbalnce:0);if(Mainarray[0].accounttype=='debit'){if(Mainarray[0].closeing_amount<0){Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}}if(Mainarray[0].accounttype=='credit'){if(Mainarray[0].closeing_amount<0){Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}}case 145:return _context13.abrupt("return",{statusCode:res.statusCode,success:true,message:"voucher fetch Successfully",JournalVoucher:Mainarray});case 148:return _context13.abrupt("return",{statusCode:res.statusCode,success:false,message:"No date Found!"});case 149:_context13.next=152;break;case 151:return _context13.abrupt("return",{statusCode:res.statusCode,success:false,message:"No date Found!"});case 152:_context13.next=158;break;case 154:_context13.prev=154;_context13.t1=_context13["catch"](0);console.log(_context13.t1,"err");return _context13.abrupt("return",{statusCode:res.statusCode,success:false,error:_context13.t1.message,message:"Something went wrong!"});case 158:case"end":return _context13.stop();}},_callee11,null,[[0,154]]);}));return function(_x59,_x60){return _ref10.apply(this,arguments);};}();