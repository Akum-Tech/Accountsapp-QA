"use strict";function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}var _journalVoucher=_interopRequireDefault(require("../models/journalVoucher"));var _journalInteries=_interopRequireDefault(require("../models/journalInteries"));var _company=_interopRequireDefault(require("../models/company"));var _saleVoucher=_interopRequireDefault(require("../models/saleVoucher"));var _purchaseVoucher=_interopRequireDefault(require("../models/purchaseVoucher"));var _creditVoucher=_interopRequireDefault(require("../models/creditVoucher"));var _debitVoucher=_interopRequireDefault(require("../models/debitVoucher"));var _taxInteries=_interopRequireDefault(require("../models/taxInteries"));var _voucherInteries=_interopRequireDefault(require("../models/voucherInteries"));var _itemInteries=_interopRequireDefault(require("../models/itemInteries"));var _accountGroup=_interopRequireDefault(require("../models/accountGroup"));var _recieptVoucher=_interopRequireDefault(require("../models/recieptVoucher"));var _paymentVoucher=_interopRequireDefault(require("../models/paymentVoucher"));var _subAccountGroup=_interopRequireDefault(require("../models/subAccountGroup"));var _ledger=_interopRequireDefault(require("../models/ledger"));var _sequelize=_interopRequireWildcard(require("sequelize"));var _arraySort=_interopRequireDefault(require("array-sort"));var _oldBalance=require("./oldBalance");var _voucherReport=require("../security/voucherReport");var _ledger2=require("../security/ledger");var _salesvoucher=require("../security/salesvoucher");var _paymentvoucher=require("../security/paymentvoucher");var _purchasevoucher=require("../security/purchasevoucher");var _receiptvoucher=require("../security/receiptvoucher");var _creditvoucher=require("../security/creditvoucher");var _debitvoucher=require("../security/debitvoucher");var _journalEntries=require("../security/journalEntries");var _itemEntries=require("../security/itemEntries");var _item_stock_voucher_entries=_interopRequireDefault(require("../models/item_stock_voucher_entries"));var _balanceGroup=_interopRequireDefault(require("../constant/balanceGroup"));var _groups=_interopRequireDefault(require("../constant/groups"));require("@babel/polyfill");var _items=_interopRequireDefault(require("../models/items"));function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{"default":obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj["default"]=obj;if(cache){cache.set(obj,newObj);}return newObj;}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1;}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err;}finally{try{if(!_n&&null!=_i["return"]&&(_r=_i["return"](),Object(_r)!==_r))return;}finally{if(_d)throw _e;}}return _arr;}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2;}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return exports;};var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value;},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}),obj[key];}try{define({},"");}catch(err){define=function define(obj,key,value){return obj[key]=value;};}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator;}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)};}catch(err){return{type:"throw",arg:err};}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,function(){return this;});var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach(function(method){define(prototype,method,function(arg){return this._invoke(method,arg);});});}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then(function(value){invoke("next",value,resolve,reject);},function(err){invoke("throw",err,resolve,reject);}):PromiseImpl.resolve(value).then(function(unwrapped){result.value=unwrapped,resolve(result);},function(error){return invoke("throw",error,resolve,reject);});}reject(record.arg);}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl(function(resolve,reject){invoke(method,arg,resolve,reject);});}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();}});}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult();}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult;}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg);}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done};}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg);}};}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(undefined===method)return context.delegate=null,"throw"===methodName&&delegate.iterator["return"]&&(context.method="return",context.arg=undefined,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=undefined),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel);}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry);}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record;}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0);}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=undefined,next.done=!0,next;};return next.next=next;}}return{next:doneResult};}function doneResult(){return{value:undefined,done:!0};}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name));},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun;},exports.awrap=function(arg){return{__await:arg};},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,function(){return this;}),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then(function(result){return result.done?result.value:iter.next();});},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,function(){return this;}),define(Gp,"toString",function(){return"[object Generator]";}),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next;}return next.done=!0,next;};},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=undefined);},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval;},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=undefined),!!caught;}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc);}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break;}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record);},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel;},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel;}},"catch":function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry);}return thrown;}}throw new Error("illegal catch attempt");},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName:resultName,nextLoc:nextLoc},"next"===this.method&&(this.arg=undefined),ContinueSentinel;}},exports;}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toPropertyKey(arg){var key=_toPrimitive(arg,"string");return _typeof(key)==="symbol"?key:String(key);}function _toPrimitive(input,hint){if(_typeof(input)!=="object"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||"default");if(_typeof(res)!=="object")return res;throw new TypeError("@@toPrimitive must return a primitive value.");}return(hint==="string"?String:Number)(input);}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{Promise.resolve(value).then(_next,_throw);}}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise(function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value);}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err);}_next(undefined);});};}var Op=_sequelize["default"].Op;function groupFuncation(_x){return _groupFuncation.apply(this,arguments);}function _groupFuncation(){_groupFuncation=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee12(array){return _regeneratorRuntime().wrap(function _callee12$(_context16){while(1)switch(_context16.prev=_context16.next){case 0:return _context16.abrupt("return",array.reduce(function(acc,obj){var key;if(obj.subAccount&&obj.subAccount.name){key=obj.subAccount.name;}else{key='MainGroup';}if(!acc[key]){acc[key]=[];}// Add object to list for given key's value
acc[key].push(obj);return acc;},{}));case 1:case"end":return _context16.stop();}},_callee12);}));return _groupFuncation.apply(this,arguments);}function checkValid(_x2){return _checkValid.apply(this,arguments);}function _checkValid(){_checkValid=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee13(id){var data;return _regeneratorRuntime().wrap(function _callee13$(_context17){while(1)switch(_context17.prev=_context17.next){case 0:data=_balanceGroup["default"].profitids.find(function(item){return item==id;});if(!data){_context17.next=5;break;}return _context17.abrupt("return",true);case 5:return _context17.abrupt("return",false);case 6:case"end":return _context17.stop();}},_callee13);}));return _checkValid.apply(this,arguments);}function getAllLedgerVoucherprivious(_x3,_x4,_x5,_x6,_x7,_x8,_x9){return _getAllLedgerVoucherprivious.apply(this,arguments);}function _getAllLedgerVoucherprivious(){_getAllLedgerVoucherprivious=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee14(start_date,end_date,ledger_id,company_id,openingbalncecredit,openingbalncedebit,email){var journalVoucher,saleVoucher,purchaseVoucher,creditVoucher,debitVoucher,recieptVoucher,paymentVoucher,discountsaleVoucher,discountdebitVoucher,discountpurchaseVoucher,discountcreditVoucher,reciverrecieptVoucher,reciverpaymentVoucher,ledger,array,i,salearray,s,findSales,purchasearray,_findSales3,_salearray,_salearray2,_salearray3,_salearray4,mainArray,creditamount,debetamount,totalbalnce;return _regeneratorRuntime().wrap(function _callee14$(_context18){while(1)switch(_context18.prev=_context18.next){case 0:_context18.prev=0;_context18.next=3;return _ledger["default"].findOne({where:{uid:ledger_id,company_id:company_id},include:[{model:_accountGroup["default"]}]});case 3:ledger=_context18.sent;if(!(ledger&&ledger.dataValues.id)){_context18.next=1341;break;}if(!ledger.dataValues.tax_key){_context18.next=29;break;}_context18.next=8;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Sales'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_saleVoucher["default"],as:'tax',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 8:saleVoucher=_context18.sent;_context18.next=11;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Purchase'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_purchaseVoucher["default"],as:'taxp',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 11:purchaseVoucher=_context18.sent;_context18.next=14;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Debit'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_creditVoucher["default"],as:'taxc',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 14:creditVoucher=_context18.sent;_context18.next=17;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Credit'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_debitVoucher["default"],as:'taxd',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 17:debitVoucher=_context18.sent;_context18.next=20;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 20:journalVoucher=_context18.sent;_context18.next=23;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 23:recieptVoucher=_context18.sent;_context18.next=26;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 26:paymentVoucher=_context18.sent;_context18.next=74;break;case 29:if(!ledger.dataValues.sale_key){_context18.next=53;break;}_context18.next=32;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Sales'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_saleVoucher["default"],as:'Voucheris',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 32:saleVoucher=_context18.sent;_context18.next=35;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Purchase'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_purchaseVoucher["default"],as:'Voucherip',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 35:purchaseVoucher=_context18.sent;_context18.next=38;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Debit'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_creditVoucher["default"],as:'Voucheric',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 38:creditVoucher=_context18.sent;_context18.next=41;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Credit'},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_debitVoucher["default"],as:'Voucherid',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 41:debitVoucher=_context18.sent;_context18.next=44;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 44:journalVoucher=_context18.sent;_context18.next=47;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 47:recieptVoucher=_context18.sent;_context18.next=50;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 50:paymentVoucher=_context18.sent;_context18.next=74;break;case 53:_context18.next=55;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 55:journalVoucher=_context18.sent;_context18.next=58;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 58:saleVoucher=_context18.sent;_context18.next=61;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 61:purchaseVoucher=_context18.sent;_context18.next=64;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'CreditBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 64:creditVoucher=_context18.sent;_context18.next=67;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'DebitBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 67:debitVoucher=_context18.sent;_context18.next=70;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 70:recieptVoucher=_context18.sent;_context18.next=73;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 73:paymentVoucher=_context18.sent;case 74:_context18.next=76;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'ReciptReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 76:reciverrecieptVoucher=_context18.sent;_context18.next=79;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PaymentReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 79:reciverpaymentVoucher=_context18.sent;_context18.next=82;return(0,_ledger2.decreption)(ledger,'object',email);case 82:ledger=_context18.sent;if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context18.next=92;break;}_context18.next=86;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{roundoff_ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'SalesRoundoffLedger'},{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 86:saleVoucher=_context18.sent;_context18.next=89;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{roundoff_ledger_id:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PurchaseRoundLedger'},{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 89:purchaseVoucher=_context18.sent;_context18.next=104;break;case 92:_context18.next=94;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'SalesDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 94:discountsaleVoucher=_context18.sent;_context18.next=97;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'PurchaseDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 97:discountpurchaseVoucher=_context18.sent;_context18.next=100;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'CreditDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 100:discountcreditVoucher=_context18.sent;_context18.next=103;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:_defineProperty({},Op.lt,start_date)}]),include:[{model:_ledger["default"],as:'DebitDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 103:discountdebitVoucher=_context18.sent;case 104:_context18.next=106;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',email);case 106:journalVoucher=_context18.sent;_context18.next=109;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',email);case 109:recieptVoucher=_context18.sent;_context18.next=112;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',email);case 112:paymentVoucher=_context18.sent;_context18.next=115;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',email);case 115:saleVoucher=_context18.sent;_context18.next=118;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',email);case 118:purchaseVoucher=_context18.sent;_context18.next=121;return(0,_creditvoucher.decreptionCredit)(creditVoucher,'array',email);case 121:creditVoucher=_context18.sent;_context18.next=124;return(0,_debitvoucher.decreptionDebit)(debitVoucher,'array',email);case 124:debitVoucher=_context18.sent;_context18.next=127;return(0,_receiptvoucher.decreptionReceipt)(reciverrecieptVoucher,'array',email);case 127:reciverrecieptVoucher=_context18.sent;_context18.next=130;return(0,_paymentvoucher.decreptionPayment)(reciverpaymentVoucher,'array',email);case 130:reciverpaymentVoucher=_context18.sent;_context18.next=133;return[];case 133:array=_context18.sent;if(!(journalVoucher&&journalVoucher.length>0)){_context18.next=188;break;}i=0;case 136:if(!(i<journalVoucher.length)){_context18.next=188;break;}_context18.next=139;return journalVoucher[i].type;case 139:_context18.t0=_context18.sent;if(!(_context18.t0==='debit')){_context18.next=149;break;}_context18.next=143;return journalVoucher[i].amount;case 143:journalVoucher[i].debitAmount=_context18.sent;_context18.next=146;return 0;case 146:journalVoucher[i].creditAmount=_context18.sent;_context18.next=155;break;case 149:_context18.next=151;return 0;case 151:journalVoucher[i].debitAmount=_context18.sent;_context18.next=154;return journalVoucher[i].amount;case 154:journalVoucher[i].creditAmount=_context18.sent;case 155:if(!journalVoucher[i].Voucher){_context18.next=173;break;}_context18.next=158;return journalVoucher[i].Voucher.invoice_date;case 158:journalVoucher[i].invoice_date=_context18.sent;_context18.next=161;return journalVoucher[i].Voucher.id;case 161:journalVoucher[i].voucher_number=_context18.sent;_context18.next=164;return journalVoucher[i].Voucher.invoice_id;case 164:_context18.t1=_context18.sent;if(!(_context18.t1<=9)){_context18.next=169;break;}_context18.t2="".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(journalVoucher[i].Voucher.invoice_id);_context18.next=170;break;case 169:_context18.t2=journalVoucher[i].Voucher.invoice_id>9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(journalVoucher[i].Voucher.invoice_id):"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(journalVoucher[i].Voucher.invoice_id);case 170:journalVoucher[i].invoice_id=_context18.t2;_context18.next=176;break;case 173:journalVoucher[i].invoice_date='';journalVoucher[i].voucher_number='';journalVoucher[i].invoice_id='';case 176:_context18.next=178;return'journal';case 178:journalVoucher[i].voucher_type=_context18.sent;_context18.next=181;return journalVoucher[i].VoucherLedger;case 181:journalVoucher[i].ledger=_context18.sent;delete journalVoucher[i].VoucherLedger;_context18.next=185;return array.push(journalVoucher[i]);case 185:i++;_context18.next=136;break;case 188:if(!(saleVoucher&&saleVoucher.length>0)){_context18.next=430;break;}salearray=[];s=0;case 191:if(!(s<saleVoucher.length)){_context18.next=430;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context18.next=239;break;}_context18.next=195;return'sale';case 195:saleVoucher[s].voucher_type=_context18.sent;_context18.next=198;return saleVoucher[s].RoundOff;case 198:saleVoucher[s].ledger=_context18.sent;_context18.next=201;return{};case 201:saleVoucher[s].Voucher=_context18.sent;saleVoucher[s].type=saleVoucher[s].roundoff_type;_context18.next=205;return saleVoucher[s].roundoff_type;case 205:_context18.t3=_context18.sent;if(!(_context18.t3=="debit")){_context18.next=210;break;}_context18.t4=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context18.next=211;break;case 210:_context18.t4=0;case 211:saleVoucher[s].debitAmount=_context18.t4;_context18.next=214;return saleVoucher[s].roundoff_type;case 214:_context18.t5=_context18.sent;if(!(_context18.t5=="credit")){_context18.next=219;break;}_context18.t6=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context18.next=220;break;case 219:_context18.t6=0;case 220:saleVoucher[s].creditAmount=_context18.t6;saleVoucher[s].amount=saleVoucher[s].roundoff_value;_context18.next=224;return saleVoucher[s].id;case 224:saleVoucher[s].voucher_number=_context18.sent;_context18.next=227;return saleVoucher[s].invoice_id;case 227:_context18.t7=_context18.sent;if(!(_context18.t7<=9)){_context18.next=232;break;}_context18.t8="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context18.next=233;break;case 232:_context18.t8=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(ssaleVoucher[s].invoice_id);case 233:saleVoucher[s].invoice_id=_context18.t8;delete saleVoucher[s].RoundOff;_context18.next=237;return array.push(saleVoucher[s]);case 237:_context18.next=427;break;case 239:if(!ledger.dataValues.sale_key){_context18.next=346;break;}if(!(salearray.length>0)){_context18.next=297;break;}_context18.next=243;return salearray.find(function(it){return saleVoucher[s].Voucheris&&it.invoice_idold==saleVoucher[s].Voucheris.invoice_id;});case 243:findSales=_context18.sent;if(!(findSales&&findSales.Voucher)){_context18.next=247;break;}_context18.next=295;break;case 247:_context18.next=249;return'sale';case 249:saleVoucher[s].voucher_type=_context18.sent;if(!saleVoucher[s].Voucheris){_context18.next=257;break;}_context18.next=253;return saleVoucher[s].Voucheris.SalesLedger;case 253:saleVoucher[s].ledger=_context18.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context18.next=258;break;case 257:saleVoucher[s].ledger={};case 258:_context18.next=260;return saleVoucher[s].Voucheris;case 260:if(!_context18.sent){_context18.next=264;break;}_context18.t9=saleVoucher[s].Voucheris;_context18.next=265;break;case 264:_context18.t9={};case 265:saleVoucher[s].Voucher=_context18.t9;saleVoucher[s].type='credit';_context18.next=269;return 0;case 269:saleVoucher[s].debitAmount=_context18.sent;_context18.next=272;return saleVoucher[s].total_amount;case 272:saleVoucher[s].creditAmount=_context18.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context18.next=276;return saleVoucher[s].Voucheris;case 276:if(!_context18.sent){_context18.next=280;break;}_context18.t10=saleVoucher[s].Voucheris.id;_context18.next=281;break;case 280:_context18.t10='';case 281:saleVoucher[s].voucher_number=_context18.t10;_context18.next=284;return saleVoucher[s].Voucheris;case 284:if(!_context18.sent){_context18.next=288;break;}_context18.t11=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context18.next=289;break;case 288:_context18.t11='';case 289:saleVoucher[s].invoice_id=_context18.t11;delete saleVoucher[s].Voucheris;_context18.next=293;return salearray.push(saleVoucher[s]);case 293:_context18.next=295;return array.push(saleVoucher[s]);case 295:_context18.next=344;break;case 297:_context18.next=299;return'sale';case 299:saleVoucher[s].voucher_type=_context18.sent;if(!saleVoucher[s].Voucheris){_context18.next=307;break;}_context18.next=303;return saleVoucher[s].Voucheris.SalesLedger;case 303:saleVoucher[s].ledger=_context18.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context18.next=308;break;case 307:saleVoucher[s].ledger={};case 308:_context18.next=310;return saleVoucher[s].Voucheris;case 310:if(!_context18.sent){_context18.next=314;break;}_context18.t12=saleVoucher[s].Voucheris;_context18.next=315;break;case 314:_context18.t12={};case 315:saleVoucher[s].Voucher=_context18.t12;saleVoucher[s].type='credit';_context18.next=319;return 0;case 319:saleVoucher[s].debitAmount=_context18.sent;_context18.next=322;return saleVoucher[s].total_amount;case 322:saleVoucher[s].creditAmount=_context18.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context18.next=326;return saleVoucher[s].Voucheris;case 326:if(!_context18.sent){_context18.next=330;break;}_context18.t13=saleVoucher[s].Voucheris.id;_context18.next=331;break;case 330:_context18.t13='';case 331:saleVoucher[s].voucher_number=_context18.t13;_context18.next=334;return saleVoucher[s].Voucheris;case 334:if(!_context18.sent){_context18.next=338;break;}_context18.t14=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context18.next=339;break;case 338:_context18.t14='';case 339:saleVoucher[s].invoice_id=_context18.t14;_context18.next=342;return salearray.push(saleVoucher[s]);case 342:_context18.next=344;return array.push(saleVoucher[s]);case 344:_context18.next=427;break;case 346:if(!ledger.dataValues.tax_key){_context18.next=395;break;}_context18.next=349;return'sale';case 349:saleVoucher[s].voucher_type=_context18.sent;if(!saleVoucher[s].tax){_context18.next=357;break;}_context18.next=353;return saleVoucher[s].tax.SalesLedger;case 353:saleVoucher[s].ledger=_context18.sent;delete saleVoucher[s].tax.SalesLedger;_context18.next=358;break;case 357:saleVoucher[s].ledger={};case 358:_context18.next=360;return saleVoucher[s].tax;case 360:if(!_context18.sent){_context18.next=364;break;}_context18.t15=saleVoucher[s].tax;_context18.next=365;break;case 364:_context18.t15={};case 365:saleVoucher[s].Voucher=_context18.t15;saleVoucher[s].type='credit';_context18.next=369;return 0;case 369:saleVoucher[s].debitAmount=_context18.sent;_context18.next=372;return saleVoucher[s].amount;case 372:saleVoucher[s].creditAmount=_context18.sent;saleVoucher[s].amount=saleVoucher[s].amount;_context18.next=376;return saleVoucher[s].tax;case 376:if(!_context18.sent){_context18.next=380;break;}_context18.t16=saleVoucher[s].tax.id;_context18.next=381;break;case 380:_context18.t16='';case 381:saleVoucher[s].voucher_number=_context18.t16;_context18.next=384;return saleVoucher[s].tax;case 384:if(!_context18.sent){_context18.next=388;break;}_context18.t17=saleVoucher[s].tax.invoice_id<=9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].tax.invoice_id):saleVoucher[s].tax.invoice_id>9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].tax.invoice_id):"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/").concat(saleVoucher[s].tax.invoice_id);_context18.next=389;break;case 388:_context18.t17='';case 389:saleVoucher[s].invoice_id=_context18.t17;delete saleVoucher[s].tax;_context18.next=393;return array.push(saleVoucher[s]);case 393:_context18.next=427;break;case 395:_context18.next=397;return'sale';case 397:saleVoucher[s].voucher_type=_context18.sent;_context18.next=400;return saleVoucher[s].SalesLedger;case 400:saleVoucher[s].ledger=_context18.sent;_context18.next=403;return{};case 403:saleVoucher[s].Voucher=_context18.sent;saleVoucher[s].type='debit';_context18.next=407;return 0;case 407:saleVoucher[s].debitAmount=_context18.sent;_context18.next=410;return saleVoucher[s].total_amount;case 410:saleVoucher[s].creditAmount=_context18.sent;saleVoucher[s].amount=saleVoucher[s].total_amount;_context18.next=414;return saleVoucher[s].id;case 414:saleVoucher[s].voucher_number=_context18.sent;_context18.next=417;return saleVoucher[s].invoice_id;case 417:_context18.t18=_context18.sent;if(!(_context18.t18<=9)){_context18.next=422;break;}_context18.t19="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context18.next=423;break;case 422:_context18.t19=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(saleVoucher[s].invoice_id);case 423:saleVoucher[s].invoice_id=_context18.t19;delete saleVoucher[s].SalesLedger;_context18.next=427;return array.push(saleVoucher[s]);case 427:s++;_context18.next=191;break;case 430:if(!(purchaseVoucher&&purchaseVoucher.length>0)){_context18.next=681;break;}purchasearray=[];s=0;case 433:if(!(s<purchaseVoucher.length)){_context18.next=681;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context18.next=481;break;}_context18.next=437;return'purchase';case 437:purchaseVoucher[s].voucher_type=_context18.sent;_context18.next=440;return purchaseVoucher[s].RoundOff;case 440:purchaseVoucher[s].ledger=_context18.sent;_context18.next=443;return{};case 443:purchaseVoucher[s].Voucher=_context18.sent;purchaseVoucher[s].type=purchaseVoucher[s].roundoff_type;_context18.next=447;return purchaseVoucher[s].roundoff_type;case 447:_context18.t20=_context18.sent;if(!(_context18.t20=="debit")){_context18.next=452;break;}_context18.t21=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context18.next=453;break;case 452:_context18.t21=0;case 453:purchaseVoucher[s].debitAmount=_context18.t21;_context18.next=456;return purchaseVoucher[s].roundoff_type;case 456:_context18.t22=_context18.sent;if(!(_context18.t22=="credit")){_context18.next=461;break;}_context18.t23=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context18.next=462;break;case 461:_context18.t23=0;case 462:purchaseVoucher[s].creditAmount=_context18.t23;purchaseVoucher[s].amount=purchaseVoucher[s].roundoff_value;_context18.next=466;return purchaseVoucher[s].id;case 466:purchaseVoucher[s].voucher_number=_context18.sent;_context18.next=469;return purchaseVoucher[s].invoice_id;case 469:_context18.t24=_context18.sent;if(!(_context18.t24<=9)){_context18.next=474;break;}_context18.t25="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context18.next=475;break;case 474:_context18.t25=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 475:purchaseVoucher[s].invoice_id=_context18.t25;delete purchaseVoucher[s].RoundOff;_context18.next=479;return array.push(purchaseVoucher[s]);case 479:_context18.next=678;break;case 481:if(!ledger.dataValues.sale_key){_context18.next=597;break;}if(!(purchaseVoucher.length>0)){_context18.next=543;break;}_context18.next=485;return purchasearray.find(function(it){return purchaseVoucher[s].Voucherip&&it.invoice_idold==purchaseVoucher[s].Voucherip.invoice_id;});case 485:_findSales3=_context18.sent;if(!(_findSales3&&_findSales3.Voucher)){_context18.next=489;break;}_context18.next=541;break;case 489:_context18.next=491;return'purchase';case 491:purchaseVoucher[s].voucher_type=_context18.sent;if(!purchaseVoucher[s].Voucherip){_context18.next=499;break;}_context18.next=495;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 495:purchaseVoucher[s].ledger=_context18.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context18.next=500;break;case 499:purchaseVoucher[s].ledger={};case 500:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context18.next=503;return purchaseVoucher[s].Voucherip;case 503:if(!_context18.sent){_context18.next=507;break;}_context18.t26=purchaseVoucher[s].Voucherip;_context18.next=508;break;case 507:_context18.t26={};case 508:purchaseVoucher[s].Voucher=_context18.t26;purchaseVoucher[s].type='debit';_context18.next=512;return purchaseVoucher[s].total_amount;case 512:purchaseVoucher[s].debitAmount=_context18.sent;_context18.next=515;return 0;case 515:purchaseVoucher[s].creditAmount=_context18.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context18.next=519;return purchaseVoucher[s].Voucherip;case 519:if(!_context18.sent){_context18.next=523;break;}_context18.t27=purchaseVoucher[s].Voucherip.id;_context18.next=524;break;case 523:_context18.t27='';case 524:purchaseVoucher[s].voucher_number=_context18.t27;_context18.next=527;return purchaseVoucher[s].Voucherip;case 527:_context18.t28=_context18.sent;if(!_context18.t28){_context18.next=530;break;}_context18.t28=purchaseVoucher[s].Voucherip.invoice_id;case 530:if(!_context18.t28){_context18.next=534;break;}_context18.t29=purchaseVoucher[s].Voucherip.invoice_id;_context18.next=535;break;case 534:_context18.t29='';case 535:purchaseVoucher[s].invoice_id=_context18.t29;delete purchaseVoucher[s].Voucherip;_context18.next=539;return purchasearray.push(purchaseVoucher[s]);case 539:_context18.next=541;return array.push(purchaseVoucher[s]);case 541:_context18.next=595;break;case 543:_context18.next=545;return'purchase';case 545:purchaseVoucher[s].voucher_type=_context18.sent;if(!purchaseVoucher[s].Voucherip){_context18.next=553;break;}_context18.next=549;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 549:purchaseVoucher[s].ledger=_context18.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context18.next=554;break;case 553:purchaseVoucher[s].ledger={};case 554:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context18.next=557;return purchaseVoucher[s].Voucherip;case 557:if(!_context18.sent){_context18.next=561;break;}_context18.t30=purchaseVoucher[s].Voucherip;_context18.next=562;break;case 561:_context18.t30={};case 562:purchaseVoucher[s].Voucher=_context18.t30;purchaseVoucher[s].type='debit';_context18.next=566;return purchaseVoucher[s].total_amount;case 566:purchaseVoucher[s].debitAmount=_context18.sent;_context18.next=569;return 0;case 569:purchaseVoucher[s].creditAmount=_context18.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context18.next=573;return purchaseVoucher[s].Voucherip;case 573:if(!_context18.sent){_context18.next=577;break;}_context18.t31=purchaseVoucher[s].Voucherip.id;_context18.next=578;break;case 577:_context18.t31='';case 578:purchaseVoucher[s].voucher_number=_context18.t31;_context18.next=581;return purchaseVoucher[s].Voucherip;case 581:_context18.t32=_context18.sent;if(!_context18.t32){_context18.next=584;break;}_context18.t32=purchaseVoucher[s].Voucherip.invoice_id;case 584:if(!_context18.t32){_context18.next=588;break;}_context18.t33=purchaseVoucher[s].Voucherip.invoice_id;_context18.next=589;break;case 588:_context18.t33='';case 589:purchaseVoucher[s].invoice_id=_context18.t33;delete purchaseVoucher[s].Voucherip;_context18.next=593;return purchasearray.push(purchaseVoucher[s]);case 593:_context18.next=595;return array.push(purchaseVoucher[s]);case 595:_context18.next=678;break;case 597:if(!ledger.dataValues.tax_key){_context18.next=646;break;}_context18.next=600;return'purchase';case 600:purchaseVoucher[s].voucher_type=_context18.sent;if(!purchaseVoucher[s].taxp){_context18.next=608;break;}_context18.next=604;return purchaseVoucher[s].taxp.PurchaseLedger;case 604:purchaseVoucher[s].ledger=_context18.sent;delete purchaseVoucher[s].taxp.PurchaseLedger;_context18.next=609;break;case 608:purchaseVoucher[s].ledger={};case 609:_context18.next=611;return purchaseVoucher[s].taxp;case 611:if(!_context18.sent){_context18.next=615;break;}_context18.t34=purchaseVoucher[s].taxp;_context18.next=616;break;case 615:_context18.t34={};case 616:purchaseVoucher[s].Voucher=_context18.t34;purchaseVoucher[s].type='debit';_context18.next=620;return purchaseVoucher[s].amount;case 620:purchaseVoucher[s].debitAmount=_context18.sent;_context18.next=623;return 0;case 623:purchaseVoucher[s].creditAmount=_context18.sent;purchaseVoucher[s].amount=purchaseVoucher[s].amount;_context18.next=627;return purchaseVoucher[s].taxp;case 627:if(!_context18.sent){_context18.next=631;break;}_context18.t35=purchaseVoucher[s].taxp.id;_context18.next=632;break;case 631:_context18.t35='';case 632:purchaseVoucher[s].voucher_number=_context18.t35;_context18.next=635;return purchaseVoucher[s].taxp;case 635:if(!_context18.sent){_context18.next=639;break;}_context18.t36=purchaseVoucher[s].taxp.invoice_id<=9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):purchaseVoucher[s].taxp.invoice_id>9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id);_context18.next=640;break;case 639:_context18.t36='';case 640:purchaseVoucher[s].invoice_id=_context18.t36;delete purchaseVoucher[s].tax;_context18.next=644;return array.push(purchaseVoucher[s]);case 644:_context18.next=678;break;case 646:_context18.next=648;return'purchase';case 648:purchaseVoucher[s].voucher_type=_context18.sent;_context18.next=651;return purchaseVoucher[s].PurchaseLedger;case 651:purchaseVoucher[s].ledger=_context18.sent;_context18.next=654;return{};case 654:purchaseVoucher[s].Voucher=_context18.sent;purchaseVoucher[s].type='credit';_context18.next=658;return purchaseVoucher[s].total_amount;case 658:purchaseVoucher[s].debitAmount=_context18.sent;_context18.next=661;return 0;case 661:purchaseVoucher[s].creditAmount=_context18.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context18.next=665;return purchaseVoucher[s].id;case 665:purchaseVoucher[s].voucher_number=_context18.sent;_context18.next=668;return purchaseVoucher[s].invoice_id;case 668:_context18.t37=_context18.sent;if(!(_context18.t37<=9)){_context18.next=673;break;}_context18.t38="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context18.next=674;break;case 673:_context18.t38=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 674:purchaseVoucher[s].invoice_id=_context18.t38;delete purchaseVoucher[s].PurchaseLedger;_context18.next=678;return array.push(purchaseVoucher[s]);case 678:s++;_context18.next=433;break;case 681:if(!(creditVoucher&&creditVoucher.length>0)){_context18.next=817;break;}s=0;case 683:if(!(s<creditVoucher.length)){_context18.next=817;break;}if(!ledger.dataValues.sale_key){_context18.next=733;break;}_context18.next=687;return'Sale Return';case 687:creditVoucher[s].voucher_type=_context18.sent;if(!creditVoucher[s].Voucheric){_context18.next=695;break;}_context18.next=691;return creditVoucher[s].Voucheric.CreditBuyer;case 691:creditVoucher[s].ledger=_context18.sent;delete creditVoucher[s].Voucheric.CreditBuyer;_context18.next=696;break;case 695:creditVoucher[s].ledger={};case 696:_context18.next=698;return creditVoucher[s].Voucheric;case 698:if(!_context18.sent){_context18.next=702;break;}_context18.t39=creditVoucher[s].Voucheric;_context18.next=703;break;case 702:_context18.t39={};case 703:creditVoucher[s].Voucher=_context18.t39;creditVoucher[s].type='debit';_context18.next=707;return creditVoucher[s].total_amount;case 707:creditVoucher[s].debitAmount=_context18.sent;_context18.next=710;return 0;case 710:creditVoucher[s].creditAmount=_context18.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context18.next=714;return creditVoucher[s].Voucheric;case 714:if(!_context18.sent){_context18.next=718;break;}_context18.t40=creditVoucher[s].Voucheric.id;_context18.next=719;break;case 718:_context18.t40='';case 719:creditVoucher[s].voucher_number=_context18.t40;_context18.next=722;return creditVoucher[s].Voucheric;case 722:if(!_context18.sent){_context18.next=726;break;}_context18.t41=creditVoucher[s].Voucheric.invoice_id<=9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].Voucheric.invoice_id):creditVoucher[s].Voucheric.invoice_id>9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].Voucheric.invoice_id):"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/").concat(creditVoucher[s].Voucheric.invoice_id);_context18.next=727;break;case 726:_context18.t41='';case 727:creditVoucher[s].invoice_id=_context18.t41;delete creditVoucher[s].Voucheric;_context18.next=731;return array.push(creditVoucher[s]);case 731:_context18.next=814;break;case 733:if(!ledger.dataValues.tax_key){_context18.next=782;break;}_context18.next=736;return'Sale Return';case 736:creditVoucher[s].voucher_type=_context18.sent;if(!creditVoucher[s].taxc){_context18.next=744;break;}_context18.next=740;return creditVoucher[s].taxc.CreditBuyer;case 740:creditVoucher[s].ledger=_context18.sent;delete creditVoucher[s].taxc.CreditBuyer;_context18.next=745;break;case 744:creditVoucher[s].ledger={};case 745:_context18.next=747;return creditVoucher[s].taxc;case 747:if(!_context18.sent){_context18.next=751;break;}_context18.t42=creditVoucher[s].taxc;_context18.next=752;break;case 751:_context18.t42={};case 752:creditVoucher[s].Voucher=_context18.t42;creditVoucher[s].type='debit';_context18.next=756;return creditVoucher[s].amount;case 756:creditVoucher[s].debitAmount=_context18.sent;_context18.next=759;return 0;case 759:creditVoucher[s].creditAmount=_context18.sent;creditVoucher[s].amount=creditVoucher[s].amount;_context18.next=763;return creditVoucher[s].taxc;case 763:if(!_context18.sent){_context18.next=767;break;}_context18.t43=creditVoucher[s].taxc.id;_context18.next=768;break;case 767:_context18.t43='';case 768:creditVoucher[s].voucher_number=_context18.t43;_context18.next=771;return creditVoucher[s].taxc;case 771:if(!_context18.sent){_context18.next=775;break;}_context18.t44=creditVoucher[s].taxc.invoice_id<=9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].taxc.invoice_id):creditVoucher[s].taxc.invoice_id>9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].taxc.invoice_id):"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/").concat(creditVoucher[s].taxc.invoice_id);_context18.next=776;break;case 775:_context18.t44='';case 776:creditVoucher[s].invoice_id=_context18.t44;delete creditVoucher[s].taxc;_context18.next=780;return array.push(creditVoucher[s]);case 780:_context18.next=814;break;case 782:_context18.next=784;return'Sale Return';case 784:creditVoucher[s].voucher_type=_context18.sent;_context18.next=787;return creditVoucher[s].CreditBuyer;case 787:creditVoucher[s].ledger=_context18.sent;_context18.next=790;return{};case 790:creditVoucher[s].Voucher=_context18.sent;creditVoucher[s].type='credit';_context18.next=794;return creditVoucher[s].total_amount;case 794:creditVoucher[s].debitAmount=_context18.sent;_context18.next=797;return 0;case 797:creditVoucher[s].creditAmount=_context18.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context18.next=801;return creditVoucher[s].id;case 801:creditVoucher[s].voucher_number=_context18.sent;_context18.next=804;return creditVoucher[s].invoice_id;case 804:_context18.t45=_context18.sent;if(!(_context18.t45<=9)){_context18.next=809;break;}_context18.t46="".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/00").concat(creditVoucher[s].invoice_id);_context18.next=810;break;case 809:_context18.t46=creditVoucher[s].invoice_id>9?"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/0").concat(creditVoucher[s].invoice_id):"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/").concat(creditVoucher[s].invoice_id);case 810:creditVoucher[s].invoice_id=_context18.t46;delete creditVoucher[s].CreditBuyer;_context18.next=814;return array.push(creditVoucher[s]);case 814:s++;_context18.next=683;break;case 817:if(!(debitVoucher&&debitVoucher.length>0)){_context18.next=953;break;}s=0;case 819:if(!(s<debitVoucher.length)){_context18.next=953;break;}if(!ledger.dataValues.sale_key){_context18.next=869;break;}_context18.next=823;return'Purchase Return';case 823:debitVoucher[s].voucher_type=_context18.sent;if(!debitVoucher[s].Voucherid){_context18.next=831;break;}_context18.next=827;return debitVoucher[s].Voucherid.DebitBuyer;case 827:debitVoucher[s].ledger=_context18.sent;delete debitVoucher[s].Voucherid.DebitBuyer;_context18.next=832;break;case 831:debitVoucher[s].ledger={};case 832:_context18.next=834;return debitVoucher[s].Voucherid;case 834:if(!_context18.sent){_context18.next=838;break;}_context18.t47=debitVoucher[s].Voucherid;_context18.next=839;break;case 838:_context18.t47={};case 839:debitVoucher[s].Voucher=_context18.t47;debitVoucher[s].type='Credit';_context18.next=843;return 0;case 843:debitVoucher[s].debitAmount=_context18.sent;_context18.next=846;return debitVoucher[s].total_amount;case 846:debitVoucher[s].creditAmount=_context18.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context18.next=850;return debitVoucher[s].Voucherid;case 850:if(!_context18.sent){_context18.next=854;break;}_context18.t48=debitVoucher[s].Voucherid.id;_context18.next=855;break;case 854:_context18.t48='';case 855:debitVoucher[s].voucher_number=_context18.t48;_context18.next=858;return debitVoucher[s].Voucherid;case 858:if(!_context18.sent){_context18.next=862;break;}_context18.t49=debitVoucher[s].Voucherid.invoice_id<=9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].Voucherid.invoice_id):debitVoucher[s].Voucherid.invoice_id>9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].Voucherid.invoice_id):"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/").concat(debitVoucher[s].Voucherid.invoice_id);_context18.next=863;break;case 862:_context18.t49='';case 863:debitVoucher[s].invoice_id=_context18.t49;delete debitVoucher[s].Voucherid;_context18.next=867;return array.push(debitVoucher[s]);case 867:_context18.next=950;break;case 869:if(!ledger.dataValues.tax_key){_context18.next=918;break;}_context18.next=872;return'Purchase Return';case 872:debitVoucher[s].voucher_type=_context18.sent;if(!debitVoucher[s].taxd){_context18.next=880;break;}_context18.next=876;return debitVoucher[s].taxd.DebitBuyer;case 876:debitVoucher[s].ledger=_context18.sent;delete debitVoucher[s].taxd.DebitBuyer;_context18.next=881;break;case 880:debitVoucher[s].ledger={};case 881:_context18.next=883;return debitVoucher[s].taxd;case 883:if(!_context18.sent){_context18.next=887;break;}_context18.t50=debitVoucher[s].taxd;_context18.next=888;break;case 887:_context18.t50={};case 888:debitVoucher[s].Voucher=_context18.t50;debitVoucher[s].type='Credit';_context18.next=892;return 0;case 892:debitVoucher[s].debitAmount=_context18.sent;_context18.next=895;return debitVoucher[s].amount;case 895:debitVoucher[s].creditAmount=_context18.sent;debitVoucher[s].amount=debitVoucher[s].amount;_context18.next=899;return debitVoucher[s].taxd;case 899:if(!_context18.sent){_context18.next=903;break;}_context18.t51=debitVoucher[s].taxd.id;_context18.next=904;break;case 903:_context18.t51='';case 904:debitVoucher[s].voucher_number=_context18.t51;_context18.next=907;return debitVoucher[s].taxd;case 907:if(!_context18.sent){_context18.next=911;break;}_context18.t52=debitVoucher[s].taxd.invoice_id<=9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].taxd.invoice_id):debitVoucher[s].taxd.invoice_id>9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].taxd.invoice_id):"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/").concat(debitVoucher[s].taxd.invoice_id);_context18.next=912;break;case 911:_context18.t52='';case 912:debitVoucher[s].invoice_id=_context18.t52;delete debitVoucher[s].taxd;_context18.next=916;return array.push(debitVoucher[s]);case 916:_context18.next=950;break;case 918:_context18.next=920;return'Purchase Return';case 920:debitVoucher[s].voucher_type=_context18.sent;_context18.next=923;return debitVoucher[s].DebitBuyer;case 923:debitVoucher[s].ledger=_context18.sent;_context18.next=926;return{};case 926:debitVoucher[s].Voucher=_context18.sent;debitVoucher[s].type='debit';_context18.next=930;return 0;case 930:debitVoucher[s].debitAmount=_context18.sent;_context18.next=933;return debitVoucher[s].total_amount;case 933:debitVoucher[s].creditAmount=_context18.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context18.next=937;return debitVoucher[s].id;case 937:debitVoucher[s].voucher_number=_context18.sent;_context18.next=940;return debitVoucher[s].invoice_id;case 940:_context18.t53=_context18.sent;if(!(_context18.t53<=9)){_context18.next=945;break;}_context18.t54="".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/00").concat(debitVoucher[s].invoice_id);_context18.next=946;break;case 945:_context18.t54=debitVoucher[s].invoice_id>9?"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/0").concat(debitVoucher[s].invoice_id):"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/").concat(debitVoucher[s].invoice_id);case 946:debitVoucher[s].invoice_id=_context18.t54;delete debitVoucher[s].DebitBuyer;_context18.next=950;return array.push(debitVoucher[s]);case 950:s++;_context18.next=819;break;case 953:if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context18.next=1008;break;}_salearray=[];s=0;case 956:if(!(s<discountsaleVoucher.length)){_context18.next=1008;break;}_context18.next=959;return'sale';case 959:discountsaleVoucher[s].voucher_type=_context18.sent;_context18.next=962;return discountsaleVoucher[s].SalesDiscountLedger;case 962:discountsaleVoucher[s].ledger=_context18.sent;_context18.next=965;return{};case 965:discountsaleVoucher[s].Voucher=_context18.sent;discountsaleVoucher[s].type=discountsaleVoucher[s].discount&&Number(discountsaleVoucher[s].discount)>0?'Credit':'Debit';_context18.next=969;return discountsaleVoucher[s].discount;case 969:_context18.t55=_context18.sent;if(!_context18.t55){_context18.next=972;break;}_context18.t55=Number(discountsaleVoucher[s].discount)<0;case 972:if(!_context18.t55){_context18.next=976;break;}_context18.t56=-1*Number(discountsaleVoucher[s].discount);_context18.next=977;break;case 976:_context18.t56=0;case 977:discountsaleVoucher[s].debitAmount=_context18.t56;_context18.next=980;return discountsaleVoucher[s].discount;case 980:_context18.t57=_context18.sent;if(!_context18.t57){_context18.next=983;break;}_context18.t57=Number(discountsaleVoucher[s].discount)>0;case 983:if(!_context18.t57){_context18.next=987;break;}_context18.t58=Number(discountsaleVoucher[s].discount);_context18.next=988;break;case 987:_context18.t58=0;case 988:discountsaleVoucher[s].creditAmount=_context18.t58;discountsaleVoucher[s].amount=discountsaleVoucher[s].discount&&Number(discountsaleVoucher[s].discount)>0?Number(discountsaleVoucher[s].discount):Number(discountsaleVoucher[s].discount);_context18.next=992;return discountsaleVoucher[s].id;case 992:discountsaleVoucher[s].voucher_number=_context18.sent;_context18.next=995;return discountsaleVoucher[s].invoice_id;case 995:_context18.t59=_context18.sent;if(!(_context18.t59<=9)){_context18.next=1000;break;}_context18.t60="".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/00").concat(discountsaleVoucher[s].invoice_id);_context18.next=1001;break;case 1000:_context18.t60=discountsaleVoucher[s].invoice_id>9?"".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/0").concat(discountsaleVoucher[s].invoice_id):"".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/").concat(discountsaleVoucher[s].invoice_id);case 1001:discountsaleVoucher[s].invoice_id=_context18.t60;delete discountsaleVoucher[s].SalesDiscountLedger;_context18.next=1005;return array.push(discountsaleVoucher[s]);case 1005:s++;_context18.next=956;break;case 1008:if(!(discountpurchaseVoucher&&discountpurchaseVoucher.length>0)){_context18.next=1057;break;}_salearray2=[];s=0;case 1011:if(!(s<discountpurchaseVoucher.length)){_context18.next=1057;break;}_context18.next=1014;return'purchase';case 1014:discountpurchaseVoucher[s].voucher_type=_context18.sent;_context18.next=1017;return discountpurchaseVoucher[s].PurchaseDiscountLedger;case 1017:discountpurchaseVoucher[s].ledger=_context18.sent;_context18.next=1020;return{};case 1020:discountpurchaseVoucher[s].Voucher=_context18.sent;discountpurchaseVoucher[s].type=discountpurchaseVoucher[s].discount&&Number(discountpurchaseVoucher[s].discount)>0?'Debit':'Credit';_context18.next=1024;return discountpurchaseVoucher[s].discount;case 1024:_context18.t61=_context18.sent;if(!_context18.t61){_context18.next=1027;break;}_context18.t61=Number(discountpurchaseVoucher[s].discount)>0;case 1027:if(!_context18.t61){_context18.next=1031;break;}_context18.t62=Number(discountpurchaseVoucher[s].discount);_context18.next=1032;break;case 1031:_context18.t62=0;case 1032:discountpurchaseVoucher[s].debitAmount=_context18.t62;_context18.next=1035;return discountpurchaseVoucher[s].discount;case 1035:_context18.t63=_context18.sent;if(!_context18.t63){_context18.next=1038;break;}_context18.t63=Number(discountpurchaseVoucher[s].discount)<0;case 1038:if(!_context18.t63){_context18.next=1042;break;}_context18.t64=-1*Number(discountpurchaseVoucher[s].discount);_context18.next=1043;break;case 1042:_context18.t64=0;case 1043:discountpurchaseVoucher[s].creditAmount=_context18.t64;discountpurchaseVoucher[s].amount=discountpurchaseVoucher[s].discount&&Number(discountpurchaseVoucher[s].discount)>0?Number(discountpurchaseVoucher[s].discount):Number(discountpurchaseVoucher[s].discount);_context18.next=1047;return discountpurchaseVoucher[s].id;case 1047:discountpurchaseVoucher[s].voucher_number=_context18.sent;_context18.next=1050;return discountpurchaseVoucher[s].invoice_id;case 1050:discountpurchaseVoucher[s].invoice_id=_context18.sent;delete discountpurchaseVoucher[s].PurchaseDiscountLedger;_context18.next=1054;return array.push(discountpurchaseVoucher[s]);case 1054:s++;_context18.next=1011;break;case 1057:if(!(discountcreditVoucher&&discountcreditVoucher.length>0)){_context18.next=1115;break;}_salearray3=[];s=0;case 1060:if(!(s<discountcreditVoucher.length)){_context18.next=1115;break;}_context18.next=1063;return'sales return';case 1063:discountcreditVoucher[s].voucher_type=_context18.sent;_context18.next=1066;return discountcreditVoucher[s].CreditDiscountLedger;case 1066:discountcreditVoucher[s].ledger=_context18.sent;_context18.next=1069;return{};case 1069:discountcreditVoucher[s].Voucher=_context18.sent;discountcreditVoucher[s].type=discountcreditVoucher[s].discount&&Number(discountcreditVoucher[s].discount)>0?'Debit':'Credit';_context18.next=1073;return discountcreditVoucher[s].discount;case 1073:_context18.t65=_context18.sent;if(!_context18.t65){_context18.next=1076;break;}_context18.t65=Number(discountcreditVoucher[s].discount)>0;case 1076:if(!_context18.t65){_context18.next=1080;break;}_context18.t66=Number(discountcreditVoucher[s].discount);_context18.next=1081;break;case 1080:_context18.t66=0;case 1081:discountcreditVoucher[s].debitAmount=_context18.t66;_context18.next=1084;return discountcreditVoucher[s].discount;case 1084:_context18.t67=_context18.sent;if(!_context18.t67){_context18.next=1087;break;}_context18.t67=Number(discountcreditVoucher[s].discount)<0;case 1087:if(!_context18.t67){_context18.next=1091;break;}_context18.t68=-1*Number(discountcreditVoucher[s].discount);_context18.next=1092;break;case 1091:_context18.t68=0;case 1092:discountcreditVoucher[s].creditAmount=_context18.t68;discountcreditVoucher[s].amount=discountcreditVoucher[s].discount&&Number(discountcreditVoucher[s].discount)>0?Number(discountcreditVoucher[s].discount):Number(discountcreditVoucher[s].discount);_context18.next=1096;return discountcreditVoucher[s].invoice_id;case 1096:_context18.t69=_context18.sent;if(!(_context18.t69<=9)){_context18.next=1101;break;}_context18.t70="".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/00").concat(discountcreditVoucher[s].invoice_id);_context18.next=1102;break;case 1101:_context18.t70=discountcreditVoucher[s].invoice_id>9?"".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/0").concat(discountcreditVoucher[s].invoice_id):"".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/").concat(discountcreditVoucher[s].invoice_id);case 1102:discountcreditVoucher[s].invoice_id=_context18.t70;_context18.next=1105;return discountcreditVoucher[s].id;case 1105:discountcreditVoucher[s].voucher_number=_context18.sent;_context18.next=1108;return discountcreditVoucher[s].invoice_id;case 1108:discountcreditVoucher[s].invoice_id=_context18.sent;delete discountcreditVoucher[s].CreditDiscountLedger;_context18.next=1112;return array.push(discountcreditVoucher[s]);case 1112:s++;_context18.next=1060;break;case 1115:if(!(discountdebitVoucher&&discountdebitVoucher.length>0)){_context18.next=1170;break;}_salearray4=[];s=0;case 1118:if(!(s<discountdebitVoucher.length)){_context18.next=1170;break;}_context18.next=1121;return'purchase return';case 1121:discountdebitVoucher[s].voucher_type=_context18.sent;_context18.next=1124;return discountdebitVoucher[s].DebitDiscountLedger;case 1124:discountdebitVoucher[s].ledger=_context18.sent;_context18.next=1127;return{};case 1127:discountdebitVoucher[s].Voucher=_context18.sent;discountdebitVoucher[s].type=discountdebitVoucher[s].discount&&Number(discountdebitVoucher[s].discount)>0?'Credit':'debit';_context18.next=1131;return discountdebitVoucher[s].discount;case 1131:_context18.t71=_context18.sent;if(!_context18.t71){_context18.next=1134;break;}_context18.t71=Number(discountdebitVoucher[s].discount)<0;case 1134:if(!_context18.t71){_context18.next=1138;break;}_context18.t72=-1*Number(discountdebitVoucher[s].discount);_context18.next=1139;break;case 1138:_context18.t72=0;case 1139:discountdebitVoucher[s].debitAmount=_context18.t72;_context18.next=1142;return discountdebitVoucher[s].discount;case 1142:_context18.t73=_context18.sent;if(!_context18.t73){_context18.next=1145;break;}_context18.t73=Number(discountdebitVoucher[s].discount)>0;case 1145:if(!_context18.t73){_context18.next=1149;break;}_context18.t74=Number(discountdebitVoucher[s].discount);_context18.next=1150;break;case 1149:_context18.t74=0;case 1150:discountdebitVoucher[s].creditAmount=_context18.t74;discountdebitVoucher[s].amount=discountdebitVoucher[s].discount&&Number(discountdebitVoucher[s].discount)>0?Number(discountdebitVoucher[s].discount):Number(discountdebitVoucher[s].discount);_context18.next=1154;return discountdebitVoucher[s].id;case 1154:discountdebitVoucher[s].voucher_number=_context18.sent;_context18.next=1157;return discountdebitVoucher[s].invoice_id;case 1157:_context18.t75=_context18.sent;if(!(_context18.t75<=9)){_context18.next=1162;break;}_context18.t76="".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/00").concat(discountdebitVoucher[s].invoice_id);_context18.next=1163;break;case 1162:_context18.t76=discountdebitVoucher[s].invoice_id>9?"".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/0").concat(discountdebitVoucher[s].invoice_id):"".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/").concat(discountdebitVoucher[s].invoice_id);case 1163:discountdebitVoucher[s].invoice_id=_context18.t76;delete discountdebitVoucher[s].DebitDiscountLedger;_context18.next=1167;return array.push(discountdebitVoucher[s]);case 1167:s++;_context18.next=1118;break;case 1170:if(!(recieptVoucher&&recieptVoucher.length>0)){_context18.next=1215;break;}i=0;case 1172:if(!(i<recieptVoucher.length)){_context18.next=1215;break;}_context18.next=1175;return recieptVoucher[i].type;case 1175:_context18.t77=_context18.sent;if(!(_context18.t77==='debit')){_context18.next=1185;break;}_context18.next=1179;return recieptVoucher[i].total_amount;case 1179:recieptVoucher[i].debitAmount=_context18.sent;_context18.next=1182;return 0;case 1182:recieptVoucher[i].creditAmount=_context18.sent;_context18.next=1191;break;case 1185:_context18.next=1187;return 0;case 1187:recieptVoucher[i].debitAmount=_context18.sent;_context18.next=1190;return recieptVoucher[i].total_amount;case 1190:recieptVoucher[i].creditAmount=_context18.sent;case 1191:_context18.next=1193;return recieptVoucher[i].ReciptBuyer;case 1193:recieptVoucher[i].ledger=_context18.sent;delete recieptVoucher[i].ReciptBuyer;_context18.next=1197;return'reciept';case 1197:recieptVoucher[i].voucher_type=_context18.sent;_context18.next=1200;return recieptVoucher[i].id;case 1200:recieptVoucher[i].voucher_number=_context18.sent;_context18.next=1203;return recieptVoucher[i].invoice_id;case 1203:_context18.t78=_context18.sent;if(!(_context18.t78<=9)){_context18.next=1208;break;}_context18.t79="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context18.next=1209;break;case 1208:_context18.t79=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 1209:recieptVoucher[i].invoice_id=_context18.t79;_context18.next=1212;return array.push(recieptVoucher[i]);case 1212:i++;_context18.next=1172;break;case 1215:if(!(paymentVoucher&&paymentVoucher.length>0)){_context18.next=1260;break;}i=0;case 1217:if(!(i<paymentVoucher.length)){_context18.next=1260;break;}_context18.next=1220;return paymentVoucher[i].type;case 1220:_context18.t80=_context18.sent;if(!(_context18.t80==='debit')){_context18.next=1230;break;}_context18.next=1224;return paymentVoucher[i].total_amount;case 1224:paymentVoucher[i].debitAmount=_context18.sent;_context18.next=1227;return 0;case 1227:paymentVoucher[i].creditAmount=_context18.sent;_context18.next=1236;break;case 1230:_context18.next=1232;return 0;case 1232:paymentVoucher[i].debitAmount=_context18.sent;_context18.next=1235;return paymentVoucher[i].total_amount;case 1235:paymentVoucher[i].creditAmount=_context18.sent;case 1236:_context18.next=1238;return paymentVoucher[i].PaymentBuyer;case 1238:paymentVoucher[i].ledger=_context18.sent;delete paymentVoucher[i].PaymentBuyer;_context18.next=1242;return'payment';case 1242:paymentVoucher[i].voucher_type=_context18.sent;_context18.next=1245;return paymentVoucher[i].id;case 1245:paymentVoucher[i].voucher_number=_context18.sent;_context18.next=1248;return paymentVoucher[i].invoice_id;case 1248:_context18.t81=_context18.sent;if(!(_context18.t81<=9)){_context18.next=1253;break;}_context18.t82="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context18.next=1254;break;case 1253:_context18.t82=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 1254:paymentVoucher[i].invoice_id=_context18.t82;_context18.next=1257;return array.push(paymentVoucher[i]);case 1257:i++;_context18.next=1217;break;case 1260:if(!(reciverrecieptVoucher&&reciverrecieptVoucher.length>0)){_context18.next=1294;break;}i=0;case 1262:if(!(i<reciverrecieptVoucher.length)){_context18.next=1294;break;}_context18.next=1265;return reciverrecieptVoucher[i].total_amount;case 1265:reciverrecieptVoucher[i].debitAmount=_context18.sent;_context18.next=1268;return 0;case 1268:reciverrecieptVoucher[i].creditAmount=_context18.sent;_context18.next=1271;return reciverrecieptVoucher[i].ReciptReciver;case 1271:reciverrecieptVoucher[i].ledger=_context18.sent;delete reciverrecieptVoucher[i].ReciptReciver;_context18.next=1275;return'reciept reciver';case 1275:reciverrecieptVoucher[i].voucher_type=_context18.sent;_context18.next=1278;return reciverrecieptVoucher[i].id;case 1278:reciverrecieptVoucher[i].voucher_number=_context18.sent;_context18.next=1281;return reciverrecieptVoucher[i].invoice_id;case 1281:_context18.t83=_context18.sent;if(!(_context18.t83<=9)){_context18.next=1286;break;}_context18.t84="".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverrecieptVoucher[i].invoice_id);_context18.next=1287;break;case 1286:_context18.t84=reciverrecieptVoucher[i].invoice_id>9?"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverrecieptVoucher[i].invoice_id):"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/").concat(reciverrecieptVoucher[i].invoice_id);case 1287:reciverrecieptVoucher[i].invoice_id=_context18.t84;reciverrecieptVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context18.next=1291;return array.push(reciverrecieptVoucher[i]);case 1291:i++;_context18.next=1262;break;case 1294:if(!(reciverpaymentVoucher&&reciverpaymentVoucher.length>0)){_context18.next=1328;break;}i=0;case 1296:if(!(i<reciverpaymentVoucher.length)){_context18.next=1328;break;}_context18.next=1299;return 0;case 1299:reciverpaymentVoucher[i].debitAmount=_context18.sent;_context18.next=1302;return reciverpaymentVoucher[i].total_amount;case 1302:reciverpaymentVoucher[i].creditAmount=_context18.sent;_context18.next=1305;return reciverpaymentVoucher[i].PaymentReciver;case 1305:reciverpaymentVoucher[i].ledger=_context18.sent;delete reciverpaymentVoucher[i].PaymentReciver;_context18.next=1309;return'payment reciver';case 1309:reciverpaymentVoucher[i].voucher_type=_context18.sent;_context18.next=1312;return reciverpaymentVoucher[i].id;case 1312:reciverpaymentVoucher[i].voucher_number=_context18.sent;_context18.next=1315;return reciverpaymentVoucher[i].invoice_id;case 1315:_context18.t85=_context18.sent;if(!(_context18.t85<=9)){_context18.next=1320;break;}_context18.t86="".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverpaymentVoucher[i].invoice_id);_context18.next=1321;break;case 1320:_context18.t86=reciverpaymentVoucher[i].invoice_id>9?"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverpaymentVoucher[i].invoice_id):"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/").concat(reciverpaymentVoucher[i].invoice_id);case 1321:reciverpaymentVoucher[i].invoice_id=_context18.t86;reciverpaymentVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context18.next=1325;return array.push(reciverpaymentVoucher[i]);case 1325:i++;_context18.next=1296;break;case 1328:_context18.next=1330;return(0,_arraySort["default"])(array,'invoice_date');case 1330:mainArray=_context18.sent;//array.sort((a, b) => new Date(b.invoice_date) - new Date(a.invoice_date));
creditamount=0;debetamount=0;totalbalnce=0;_context18.next=1336;return mainArray.map(function(item){console.log("item",item);if(item.creditAmount){creditamount=creditamount+Number(item.creditAmount);}else if(item.debitAmount){debetamount=debetamount+Number(item.debitAmount);}});case 1336:console.log("openingbalncedebit",openingbalncedebit,debetamount,creditamount,openingbalncecredit);totalbalnce=Number(openingbalncedebit)+Number(debetamount)-(Number(creditamount)+Number(openingbalncecredit));return _context18.abrupt("return",totalbalnce);case 1341:_context18.next=1347;break;case 1343:_context18.prev=1343;_context18.t87=_context18["catch"](0);console.log("getAllLedgerVoucherprivious",_context18.t87);return _context18.abrupt("return",0);case 1347:case"end":return _context18.stop();}},_callee14,null,[[0,1343]]);}));return _getAllLedgerVoucherprivious.apply(this,arguments);}function getAllLedgerVouchercurrent(_x10,_x11,_x12,_x13,_x14,_x15,_x16){return _getAllLedgerVouchercurrent.apply(this,arguments);}function _getAllLedgerVouchercurrent(){_getAllLedgerVouchercurrent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee15(start_date,end_date,ledger_id,company_id,openingbalncecredit,openingbalncedebit,email){var currentyear,journalVoucher,saleVoucher,purchaseVoucher,creditVoucher,debitVoucher,recieptVoucher,paymentVoucher,discountsaleVoucher,discountdebitVoucher,discountpurchaseVoucher,discountcreditVoucher,reciverrecieptVoucher,reciverpaymentVoucher,ledger,_invoice_date155,_invoice_date156,_invoice_date130,_invoice_date131,_invoice_date132,_invoice_date133,_invoice_date134,_invoice_date135,_invoice_date136,_invoice_date137,_invoice_date138,_invoice_date139,_invoice_date140,_invoice_date141,_invoice_date142,_invoice_date143,_invoice_date144,_invoice_date145,_invoice_date146,_invoice_date147,_invoice_date148,_invoice_date149,_invoice_date150,_invoice_date151,_invoice_date152,_invoice_date153,_invoice_date154,_invoice_date157,_invoice_date158,_invoice_date159,_invoice_date160,_invoice_date161,_invoice_date162,array,i,salearray,s,findSales,purchasearray,_findSales4,_salearray5,_salearray6,_salearray7,_salearray8,mainArray,creditamount,debetamount,totalbalnce;return _regeneratorRuntime().wrap(function _callee15$(_context19){while(1)switch(_context19.prev=_context19.next){case 0:_context19.prev=0;currentyear=new Date(start_date).getFullYear();end_date=start_date;start_date="".concat(currentyear,"-04-01");// console.log("start_date", new Date(start_date))
reciverpaymentVoucher=[];_context19.next=7;return _ledger["default"].findOne({where:{uid:ledger_id,company_id:company_id},include:[{model:_accountGroup["default"]}]});case 7:ledger=_context19.sent;if(!(ledger&&ledger.dataValues.id)){_context19.next=1372;break;}if(!ledger.dataValues.tax_key){_context19.next=33;break;}_context19.next=12;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Sales'},{invoice_date:(_invoice_date130={},_defineProperty(_invoice_date130,Op.gte,start_date),_defineProperty(_invoice_date130,Op.lt,end_date),_invoice_date130)}]),include:[{model:_saleVoucher["default"],as:'tax',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 12:saleVoucher=_context19.sent;_context19.next=15;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Purchase'},{invoice_date:(_invoice_date131={},_defineProperty(_invoice_date131,Op.gte,start_date),_defineProperty(_invoice_date131,Op.lt,end_date),_invoice_date131)}]),include:[{model:_purchaseVoucher["default"],as:'taxp',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 15:purchaseVoucher=_context19.sent;_context19.next=18;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Debit'},{invoice_date:(_invoice_date132={},_defineProperty(_invoice_date132,Op.gte,start_date),_defineProperty(_invoice_date132,Op.lt,end_date),_invoice_date132)}]),include:[{model:_creditVoucher["default"],as:'taxc',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 18:creditVoucher=_context19.sent;_context19.next=21;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledger_id},{type:'Credit'},{invoice_date:(_invoice_date133={},_defineProperty(_invoice_date133,Op.gte,start_date),_defineProperty(_invoice_date133,Op.lt,end_date),_invoice_date133)}]),include:[{model:_debitVoucher["default"],as:'taxd',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 21:debitVoucher=_context19.sent;_context19.next=24;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:(_invoice_date134={},_defineProperty(_invoice_date134,Op.gte,start_date),_defineProperty(_invoice_date134,Op.lt,end_date),_invoice_date134)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 24:journalVoucher=_context19.sent;_context19.next=27;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date135={},_defineProperty(_invoice_date135,Op.gte,start_date),_defineProperty(_invoice_date135,Op.lt,end_date),_invoice_date135)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 27:recieptVoucher=_context19.sent;_context19.next=30;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date136={},_defineProperty(_invoice_date136,Op.gte,start_date),_defineProperty(_invoice_date136,Op.lt,end_date),_invoice_date136)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 30:paymentVoucher=_context19.sent;_context19.next=90;break;case 33:if(!ledger.dataValues.sale_key){_context19.next=57;break;}_context19.next=36;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Sales'},{invoice_date:(_invoice_date137={},_defineProperty(_invoice_date137,Op.gte,start_date),_defineProperty(_invoice_date137,Op.lt,end_date),_invoice_date137)}]),include:[{model:_saleVoucher["default"],as:'Voucheris',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 36:saleVoucher=_context19.sent;_context19.next=39;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Purchase'},{invoice_date:(_invoice_date138={},_defineProperty(_invoice_date138,Op.gte,start_date),_defineProperty(_invoice_date138,Op.lt,end_date),_invoice_date138)}]),include:[{model:_purchaseVoucher["default"],as:'Voucherip',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 39:purchaseVoucher=_context19.sent;_context19.next=42;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Debit'},{invoice_date:(_invoice_date139={},_defineProperty(_invoice_date139,Op.gte,start_date),_defineProperty(_invoice_date139,Op.lt,end_date),_invoice_date139)}]),include:[{model:_creditVoucher["default"],as:'Voucheric',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 42:creditVoucher=_context19.sent;_context19.next=45;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{type:'Credit'},{invoice_date:(_invoice_date140={},_defineProperty(_invoice_date140,Op.gte,start_date),_defineProperty(_invoice_date140,Op.lt,end_date),_invoice_date140)}]),include:[{model:_debitVoucher["default"],as:'Voucherid',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 45:debitVoucher=_context19.sent;_context19.next=48;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:(_invoice_date141={},_defineProperty(_invoice_date141,Op.gte,start_date),_defineProperty(_invoice_date141,Op.lt,end_date),_invoice_date141)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 48:journalVoucher=_context19.sent;_context19.next=51;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date142={},_defineProperty(_invoice_date142,Op.gte,start_date),_defineProperty(_invoice_date142,Op.lt,end_date),_invoice_date142)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 51:recieptVoucher=_context19.sent;_context19.next=54;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date143={},_defineProperty(_invoice_date143,Op.gte,start_date),_defineProperty(_invoice_date143,Op.lt,end_date),_invoice_date143)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 54:paymentVoucher=_context19.sent;_context19.next=90;break;case 57:_context19.next=59;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledger_id},{company_id:company_id},{invoice_date:(_invoice_date144={},_defineProperty(_invoice_date144,Op.gte,start_date),_defineProperty(_invoice_date144,Op.lte,end_date),_invoice_date144)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 59:journalVoucher=_context19.sent;_context19.next=62;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:(_invoice_date145={},_defineProperty(_invoice_date145,Op.gte,start_date),_defineProperty(_invoice_date145,Op.lt,end_date),_invoice_date145)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 62:saleVoucher=_context19.sent;_context19.next=65;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:(_invoice_date146={},_defineProperty(_invoice_date146,Op.gte,start_date),_defineProperty(_invoice_date146,Op.lt,end_date),_invoice_date146)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 65:purchaseVoucher=_context19.sent;_context19.next=68;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:(_invoice_date147={},_defineProperty(_invoice_date147,Op.gte,start_date),_defineProperty(_invoice_date147,Op.lt,end_date),_invoice_date147)}]),include:[{model:_ledger["default"],as:'CreditBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 68:creditVoucher=_context19.sent;_context19.next=71;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{buyer_ledger_id:ledger_id},{invoice_date:(_invoice_date148={},_defineProperty(_invoice_date148,Op.gte,start_date),_defineProperty(_invoice_date148,Op.lt,end_date),_invoice_date148)}]),include:[{model:_ledger["default"],as:'DebitBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 71:debitVoucher=_context19.sent;_context19.next=74;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date149={},_defineProperty(_invoice_date149,Op.gte,start_date),_defineProperty(_invoice_date149,Op.lt,end_date),_invoice_date149)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 74:recieptVoucher=_context19.sent;_context19.next=77;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date150={},_defineProperty(_invoice_date150,Op.gte,start_date),_defineProperty(_invoice_date150,Op.lt,end_date),_invoice_date150)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 77:paymentVoucher=_context19.sent;_context19.next=80;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date151={},_defineProperty(_invoice_date151,Op.gte,start_date),_defineProperty(_invoice_date151,Op.lt,end_date),_invoice_date151)}]),include:[{model:_ledger["default"],as:'SalesDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 80:discountsaleVoucher=_context19.sent;_context19.next=83;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date152={},_defineProperty(_invoice_date152,Op.gte,start_date),_defineProperty(_invoice_date152,Op.lt,end_date),_invoice_date152)}]),include:[{model:_ledger["default"],as:'PurchaseDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 83:discountpurchaseVoucher=_context19.sent;_context19.next=86;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date153={},_defineProperty(_invoice_date153,Op.gte,start_date),_defineProperty(_invoice_date153,Op.lt,end_date),_invoice_date153)}]),include:[{model:_ledger["default"],as:'CreditDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 86:discountcreditVoucher=_context19.sent;_context19.next=89;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date154={},_defineProperty(_invoice_date154,Op.gte,start_date),_defineProperty(_invoice_date154,Op.lt,end_date),_invoice_date154)}]),include:[{model:_ledger["default"],as:'DebitDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 89:discountdebitVoucher=_context19.sent;case 90:_context19.next=92;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date155={},_defineProperty(_invoice_date155,Op.gte,start_date),_defineProperty(_invoice_date155,Op.lte,end_date),_invoice_date155)}]),include:[{model:_ledger["default"],as:'ReciptReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 92:reciverrecieptVoucher=_context19.sent;_context19.next=95;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{ledger_id:ledger_id},{invoice_date:(_invoice_date156={},_defineProperty(_invoice_date156,Op.gte,start_date),_defineProperty(_invoice_date156,Op.lte,end_date),_invoice_date156)}]),include:[{model:_ledger["default"],as:'PaymentReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 95:reciverpaymentVoucher=_context19.sent;_context19.next=98;return(0,_ledger2.decreption)(ledger,'object',email);case 98:ledger=_context19.sent;if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context19.next=108;break;}_context19.next=102;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{roundoff_ledger_id:ledger_id},{invoice_date:(_invoice_date157={},_defineProperty(_invoice_date157,Op.gte,start_date),_defineProperty(_invoice_date157,Op.lte,end_date),_invoice_date157)}]),include:[{model:_ledger["default"],as:'SalesRoundoffLedger'},{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 102:saleVoucher=_context19.sent;_context19.next=105;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{roundoff_ledger_id:ledger_id},{invoice_date:(_invoice_date158={},_defineProperty(_invoice_date158,Op.gte,start_date),_defineProperty(_invoice_date158,Op.lte,end_date),_invoice_date158)}]),include:[{model:_ledger["default"],as:'PurchaseRoundLedger'},{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 105:purchaseVoucher=_context19.sent;_context19.next=120;break;case 108:_context19.next=110;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date159={},_defineProperty(_invoice_date159,Op.gte,start_date),_defineProperty(_invoice_date159,Op.lte,end_date),_invoice_date159)}]),include:[{model:_ledger["default"],as:'SalesDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 110:discountsaleVoucher=_context19.sent;_context19.next=113;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date160={},_defineProperty(_invoice_date160,Op.gte,start_date),_defineProperty(_invoice_date160,Op.lte,end_date),_invoice_date160)}]),include:[{model:_ledger["default"],as:'PurchaseDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 113:discountpurchaseVoucher=_context19.sent;_context19.next=116;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date161={},_defineProperty(_invoice_date161,Op.gte,start_date),_defineProperty(_invoice_date161,Op.lte,end_date),_invoice_date161)}]),include:[{model:_ledger["default"],as:'CreditDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 116:discountcreditVoucher=_context19.sent;_context19.next=119;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:company_id},{discount_ledger:ledger_id},{invoice_date:(_invoice_date162={},_defineProperty(_invoice_date162,Op.gte,start_date),_defineProperty(_invoice_date162,Op.lte,end_date),_invoice_date162)}]),include:[{model:_ledger["default"],as:'DebitDiscountLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 119:discountdebitVoucher=_context19.sent;case 120:_context19.next=122;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',email);case 122:journalVoucher=_context19.sent;_context19.next=125;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',email);case 125:recieptVoucher=_context19.sent;_context19.next=128;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',email);case 128:paymentVoucher=_context19.sent;_context19.next=131;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',email);case 131:saleVoucher=_context19.sent;_context19.next=134;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',email);case 134:purchaseVoucher=_context19.sent;_context19.next=137;return(0,_creditvoucher.decreptionCredit)(creditVoucher,'array',email);case 137:creditVoucher=_context19.sent;_context19.next=140;return(0,_debitvoucher.decreptionDebit)(debitVoucher,'array',email);case 140:debitVoucher=_context19.sent;_context19.next=143;return(0,_receiptvoucher.decreptionReceipt)(reciverrecieptVoucher,'array',email);case 143:reciverrecieptVoucher=_context19.sent;_context19.next=146;return(0,_paymentvoucher.decreptionPayment)(reciverpaymentVoucher,'array',email);case 146:reciverpaymentVoucher=_context19.sent;if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context19.next=151;break;}_context19.next=150;return(0,_salesvoucher.decreptionSale)(discountsaleVoucher,'array',email);case 150:discountsaleVoucher=_context19.sent;case 151:if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context19.next=155;break;}_context19.next=154;return(0,_purchasevoucher.decreptionPurchase)(discountpurchaseVoucher,'array',email);case 154:discountpurchaseVoucher=_context19.sent;case 155:if(!(discountcreditVoucher&&discountcreditVoucher.length>0)){_context19.next=159;break;}_context19.next=158;return(0,_creditvoucher.decreptionCredit)(discountcreditVoucher,'array',email);case 158:discountcreditVoucher=_context19.sent;case 159:if(!(discountdebitVoucher&&discountdebitVoucher.length>0)){_context19.next=163;break;}_context19.next=162;return(0,_debitvoucher.decreptionDebit)(discountdebitVoucher,'array',email);case 162:discountdebitVoucher=_context19.sent;case 163:_context19.next=165;return[];case 165:array=_context19.sent;if(!(journalVoucher&&journalVoucher.length>0)){_context19.next=220;break;}i=0;case 168:if(!(i<journalVoucher.length)){_context19.next=220;break;}_context19.next=171;return journalVoucher[i].type;case 171:_context19.t0=_context19.sent;if(!(_context19.t0==='debit')){_context19.next=181;break;}_context19.next=175;return journalVoucher[i].amount;case 175:journalVoucher[i].debitAmount=_context19.sent;_context19.next=178;return 0;case 178:journalVoucher[i].creditAmount=_context19.sent;_context19.next=187;break;case 181:_context19.next=183;return 0;case 183:journalVoucher[i].debitAmount=_context19.sent;_context19.next=186;return journalVoucher[i].amount;case 186:journalVoucher[i].creditAmount=_context19.sent;case 187:if(!journalVoucher[i].Voucher){_context19.next=205;break;}_context19.next=190;return journalVoucher[i].Voucher.invoice_date;case 190:journalVoucher[i].invoice_date=_context19.sent;_context19.next=193;return journalVoucher[i].Voucher.id;case 193:journalVoucher[i].voucher_number=_context19.sent;_context19.next=196;return journalVoucher[i].Voucher.invoice_id;case 196:_context19.t1=_context19.sent;if(!(_context19.t1<=9)){_context19.next=201;break;}_context19.t2="".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(journalVoucher[i].Voucher.invoice_id);_context19.next=202;break;case 201:_context19.t2=journalVoucher[i].Voucher.invoice_id>9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(journalVoucher[i].Voucher.invoice_id):"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(journalVoucher[i].Voucher.invoice_id);case 202:journalVoucher[i].invoice_id=_context19.t2;_context19.next=208;break;case 205:journalVoucher[i].invoice_date='';journalVoucher[i].voucher_number='';journalVoucher[i].invoice_id='';case 208:_context19.next=210;return'journal';case 210:journalVoucher[i].voucher_type=_context19.sent;_context19.next=213;return journalVoucher[i].VoucherLedger;case 213:journalVoucher[i].ledger=_context19.sent;delete journalVoucher[i].VoucherLedger;_context19.next=217;return array.push(journalVoucher[i]);case 217:i++;_context19.next=168;break;case 220:if(!(saleVoucher&&saleVoucher.length>0)){_context19.next=462;break;}salearray=[];s=0;case 223:if(!(s<saleVoucher.length)){_context19.next=462;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context19.next=271;break;}_context19.next=227;return'sale';case 227:saleVoucher[s].voucher_type=_context19.sent;_context19.next=230;return saleVoucher[s].RoundOff;case 230:saleVoucher[s].ledger=_context19.sent;_context19.next=233;return{};case 233:saleVoucher[s].Voucher=_context19.sent;saleVoucher[s].type=saleVoucher[s].roundoff_type;_context19.next=237;return saleVoucher[s].roundoff_type;case 237:_context19.t3=_context19.sent;if(!(_context19.t3=="debit")){_context19.next=242;break;}_context19.t4=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context19.next=243;break;case 242:_context19.t4=0;case 243:saleVoucher[s].debitAmount=_context19.t4;_context19.next=246;return saleVoucher[s].roundoff_type;case 246:_context19.t5=_context19.sent;if(!(_context19.t5=="credit")){_context19.next=251;break;}_context19.t6=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context19.next=252;break;case 251:_context19.t6=0;case 252:saleVoucher[s].creditAmount=_context19.t6;saleVoucher[s].amount=saleVoucher[s].roundoff_value;_context19.next=256;return saleVoucher[s].id;case 256:saleVoucher[s].voucher_number=_context19.sent;_context19.next=259;return saleVoucher[s].invoice_id;case 259:_context19.t7=_context19.sent;if(!(_context19.t7<=9)){_context19.next=264;break;}_context19.t8="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context19.next=265;break;case 264:_context19.t8=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(ssaleVoucher[s].invoice_id);case 265:saleVoucher[s].invoice_id=_context19.t8;delete saleVoucher[s].RoundOff;_context19.next=269;return array.push(saleVoucher[s]);case 269:_context19.next=459;break;case 271:if(!ledger.dataValues.sale_key){_context19.next=378;break;}if(!(salearray.length>0)){_context19.next=329;break;}_context19.next=275;return salearray.find(function(it){return saleVoucher[s].Voucheris&&it.invoice_idold==saleVoucher[s].Voucheris.invoice_id;});case 275:findSales=_context19.sent;if(!(findSales&&findSales.Voucher)){_context19.next=279;break;}_context19.next=327;break;case 279:_context19.next=281;return'sale';case 281:saleVoucher[s].voucher_type=_context19.sent;if(!saleVoucher[s].Voucheris){_context19.next=289;break;}_context19.next=285;return saleVoucher[s].Voucheris.SalesLedger;case 285:saleVoucher[s].ledger=_context19.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context19.next=290;break;case 289:saleVoucher[s].ledger={};case 290:_context19.next=292;return saleVoucher[s].Voucheris;case 292:if(!_context19.sent){_context19.next=296;break;}_context19.t9=saleVoucher[s].Voucheris;_context19.next=297;break;case 296:_context19.t9={};case 297:saleVoucher[s].Voucher=_context19.t9;saleVoucher[s].type='credit';_context19.next=301;return 0;case 301:saleVoucher[s].debitAmount=_context19.sent;_context19.next=304;return saleVoucher[s].total_amount;case 304:saleVoucher[s].creditAmount=_context19.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context19.next=308;return saleVoucher[s].Voucheris;case 308:if(!_context19.sent){_context19.next=312;break;}_context19.t10=saleVoucher[s].Voucheris.id;_context19.next=313;break;case 312:_context19.t10='';case 313:saleVoucher[s].voucher_number=_context19.t10;_context19.next=316;return saleVoucher[s].Voucheris;case 316:if(!_context19.sent){_context19.next=320;break;}_context19.t11=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context19.next=321;break;case 320:_context19.t11='';case 321:saleVoucher[s].invoice_id=_context19.t11;delete saleVoucher[s].Voucheris;_context19.next=325;return salearray.push(saleVoucher[s]);case 325:_context19.next=327;return array.push(saleVoucher[s]);case 327:_context19.next=376;break;case 329:_context19.next=331;return'sale';case 331:saleVoucher[s].voucher_type=_context19.sent;if(!saleVoucher[s].Voucheris){_context19.next=339;break;}_context19.next=335;return saleVoucher[s].Voucheris.SalesLedger;case 335:saleVoucher[s].ledger=_context19.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context19.next=340;break;case 339:saleVoucher[s].ledger={};case 340:_context19.next=342;return saleVoucher[s].Voucheris;case 342:if(!_context19.sent){_context19.next=346;break;}_context19.t12=saleVoucher[s].Voucheris;_context19.next=347;break;case 346:_context19.t12={};case 347:saleVoucher[s].Voucher=_context19.t12;saleVoucher[s].type='credit';_context19.next=351;return 0;case 351:saleVoucher[s].debitAmount=_context19.sent;_context19.next=354;return saleVoucher[s].total_amount;case 354:saleVoucher[s].creditAmount=_context19.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context19.next=358;return saleVoucher[s].Voucheris;case 358:if(!_context19.sent){_context19.next=362;break;}_context19.t13=saleVoucher[s].Voucheris.id;_context19.next=363;break;case 362:_context19.t13='';case 363:saleVoucher[s].voucher_number=_context19.t13;_context19.next=366;return saleVoucher[s].Voucheris;case 366:if(!_context19.sent){_context19.next=370;break;}_context19.t14=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context19.next=371;break;case 370:_context19.t14='';case 371:saleVoucher[s].invoice_id=_context19.t14;_context19.next=374;return salearray.push(saleVoucher[s]);case 374:_context19.next=376;return array.push(saleVoucher[s]);case 376:_context19.next=459;break;case 378:if(!ledger.dataValues.tax_key){_context19.next=427;break;}_context19.next=381;return'sale';case 381:saleVoucher[s].voucher_type=_context19.sent;if(!saleVoucher[s].tax){_context19.next=389;break;}_context19.next=385;return saleVoucher[s].tax.SalesLedger;case 385:saleVoucher[s].ledger=_context19.sent;delete saleVoucher[s].tax.SalesLedger;_context19.next=390;break;case 389:saleVoucher[s].ledger={};case 390:_context19.next=392;return saleVoucher[s].tax;case 392:if(!_context19.sent){_context19.next=396;break;}_context19.t15=saleVoucher[s].tax;_context19.next=397;break;case 396:_context19.t15={};case 397:saleVoucher[s].Voucher=_context19.t15;saleVoucher[s].type='credit';_context19.next=401;return 0;case 401:saleVoucher[s].debitAmount=_context19.sent;_context19.next=404;return saleVoucher[s].amount;case 404:saleVoucher[s].creditAmount=_context19.sent;saleVoucher[s].amount=saleVoucher[s].amount;_context19.next=408;return saleVoucher[s].tax;case 408:if(!_context19.sent){_context19.next=412;break;}_context19.t16=saleVoucher[s].tax.id;_context19.next=413;break;case 412:_context19.t16='';case 413:saleVoucher[s].voucher_number=_context19.t16;_context19.next=416;return saleVoucher[s].tax;case 416:if(!_context19.sent){_context19.next=420;break;}_context19.t17=saleVoucher[s].tax.invoice_id<=9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].tax.invoice_id):saleVoucher[s].tax.invoice_id>9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].tax.invoice_id):"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/").concat(saleVoucher[s].tax.invoice_id);_context19.next=421;break;case 420:_context19.t17='';case 421:saleVoucher[s].invoice_id=_context19.t17;delete saleVoucher[s].tax;_context19.next=425;return array.push(saleVoucher[s]);case 425:_context19.next=459;break;case 427:_context19.next=429;return'sale';case 429:saleVoucher[s].voucher_type=_context19.sent;_context19.next=432;return saleVoucher[s].SalesLedger;case 432:saleVoucher[s].ledger=_context19.sent;_context19.next=435;return{};case 435:saleVoucher[s].Voucher=_context19.sent;saleVoucher[s].type='debit';_context19.next=439;return 0;case 439:saleVoucher[s].debitAmount=_context19.sent;_context19.next=442;return saleVoucher[s].total_amount;case 442:saleVoucher[s].creditAmount=_context19.sent;saleVoucher[s].amount=saleVoucher[s].total_amount;_context19.next=446;return saleVoucher[s].id;case 446:saleVoucher[s].voucher_number=_context19.sent;_context19.next=449;return saleVoucher[s].invoice_id;case 449:_context19.t18=_context19.sent;if(!(_context19.t18<=9)){_context19.next=454;break;}_context19.t19="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context19.next=455;break;case 454:_context19.t19=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(saleVoucher[s].invoice_id);case 455:saleVoucher[s].invoice_id=_context19.t19;delete saleVoucher[s].SalesLedger;_context19.next=459;return array.push(saleVoucher[s]);case 459:s++;_context19.next=223;break;case 462:if(!(purchaseVoucher&&purchaseVoucher.length>0)){_context19.next=713;break;}purchasearray=[];s=0;case 465:if(!(s<purchaseVoucher.length)){_context19.next=713;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context19.next=513;break;}_context19.next=469;return'purchase';case 469:purchaseVoucher[s].voucher_type=_context19.sent;_context19.next=472;return purchaseVoucher[s].RoundOff;case 472:purchaseVoucher[s].ledger=_context19.sent;_context19.next=475;return{};case 475:purchaseVoucher[s].Voucher=_context19.sent;purchaseVoucher[s].type=purchaseVoucher[s].roundoff_type;_context19.next=479;return purchaseVoucher[s].roundoff_type;case 479:_context19.t20=_context19.sent;if(!(_context19.t20=="debit")){_context19.next=484;break;}_context19.t21=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context19.next=485;break;case 484:_context19.t21=0;case 485:purchaseVoucher[s].debitAmount=_context19.t21;_context19.next=488;return purchaseVoucher[s].roundoff_type;case 488:_context19.t22=_context19.sent;if(!(_context19.t22=="credit")){_context19.next=493;break;}_context19.t23=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context19.next=494;break;case 493:_context19.t23=0;case 494:purchaseVoucher[s].creditAmount=_context19.t23;purchaseVoucher[s].amount=purchaseVoucher[s].roundoff_value;_context19.next=498;return purchaseVoucher[s].id;case 498:purchaseVoucher[s].voucher_number=_context19.sent;_context19.next=501;return purchaseVoucher[s].invoice_id;case 501:_context19.t24=_context19.sent;if(!(_context19.t24<=9)){_context19.next=506;break;}_context19.t25="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context19.next=507;break;case 506:_context19.t25=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 507:purchaseVoucher[s].invoice_id=_context19.t25;delete purchaseVoucher[s].RoundOff;_context19.next=511;return array.push(purchaseVoucher[s]);case 511:_context19.next=710;break;case 513:if(!ledger.dataValues.sale_key){_context19.next=629;break;}if(!(purchaseVoucher.length>0)){_context19.next=575;break;}_context19.next=517;return purchasearray.find(function(it){return purchaseVoucher[s].Voucherip&&it.invoice_idold==purchaseVoucher[s].Voucherip.invoice_id;});case 517:_findSales4=_context19.sent;if(!(_findSales4&&_findSales4.Voucher)){_context19.next=521;break;}_context19.next=573;break;case 521:_context19.next=523;return'purchase';case 523:purchaseVoucher[s].voucher_type=_context19.sent;if(!purchaseVoucher[s].Voucherip){_context19.next=531;break;}_context19.next=527;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 527:purchaseVoucher[s].ledger=_context19.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context19.next=532;break;case 531:purchaseVoucher[s].ledger={};case 532:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context19.next=535;return purchaseVoucher[s].Voucherip;case 535:if(!_context19.sent){_context19.next=539;break;}_context19.t26=purchaseVoucher[s].Voucherip;_context19.next=540;break;case 539:_context19.t26={};case 540:purchaseVoucher[s].Voucher=_context19.t26;purchaseVoucher[s].type='debit';_context19.next=544;return purchaseVoucher[s].total_amount;case 544:purchaseVoucher[s].debitAmount=_context19.sent;_context19.next=547;return 0;case 547:purchaseVoucher[s].creditAmount=_context19.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context19.next=551;return purchaseVoucher[s].Voucherip;case 551:if(!_context19.sent){_context19.next=555;break;}_context19.t27=purchaseVoucher[s].Voucherip.id;_context19.next=556;break;case 555:_context19.t27='';case 556:purchaseVoucher[s].voucher_number=_context19.t27;_context19.next=559;return purchaseVoucher[s].Voucherip;case 559:_context19.t28=_context19.sent;if(!_context19.t28){_context19.next=562;break;}_context19.t28=purchaseVoucher[s].Voucherip.invoice_id;case 562:if(!_context19.t28){_context19.next=566;break;}_context19.t29=purchaseVoucher[s].Voucherip.invoice_id;_context19.next=567;break;case 566:_context19.t29='';case 567:purchaseVoucher[s].invoice_id=_context19.t29;delete purchaseVoucher[s].Voucherip;_context19.next=571;return purchasearray.push(purchaseVoucher[s]);case 571:_context19.next=573;return array.push(purchaseVoucher[s]);case 573:_context19.next=627;break;case 575:_context19.next=577;return'purchase';case 577:purchaseVoucher[s].voucher_type=_context19.sent;if(!purchaseVoucher[s].Voucherip){_context19.next=585;break;}_context19.next=581;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 581:purchaseVoucher[s].ledger=_context19.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context19.next=586;break;case 585:purchaseVoucher[s].ledger={};case 586:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context19.next=589;return purchaseVoucher[s].Voucherip;case 589:if(!_context19.sent){_context19.next=593;break;}_context19.t30=purchaseVoucher[s].Voucherip;_context19.next=594;break;case 593:_context19.t30={};case 594:purchaseVoucher[s].Voucher=_context19.t30;purchaseVoucher[s].type='debit';_context19.next=598;return purchaseVoucher[s].total_amount;case 598:purchaseVoucher[s].debitAmount=_context19.sent;_context19.next=601;return 0;case 601:purchaseVoucher[s].creditAmount=_context19.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context19.next=605;return purchaseVoucher[s].Voucherip;case 605:if(!_context19.sent){_context19.next=609;break;}_context19.t31=purchaseVoucher[s].Voucherip.id;_context19.next=610;break;case 609:_context19.t31='';case 610:purchaseVoucher[s].voucher_number=_context19.t31;_context19.next=613;return purchaseVoucher[s].Voucherip;case 613:_context19.t32=_context19.sent;if(!_context19.t32){_context19.next=616;break;}_context19.t32=purchaseVoucher[s].Voucherip.invoice_id;case 616:if(!_context19.t32){_context19.next=620;break;}_context19.t33=purchaseVoucher[s].Voucherip.invoice_id;_context19.next=621;break;case 620:_context19.t33='';case 621:purchaseVoucher[s].invoice_id=_context19.t33;delete purchaseVoucher[s].Voucherip;_context19.next=625;return purchasearray.push(purchaseVoucher[s]);case 625:_context19.next=627;return array.push(purchaseVoucher[s]);case 627:_context19.next=710;break;case 629:if(!ledger.dataValues.tax_key){_context19.next=678;break;}_context19.next=632;return'purchase';case 632:purchaseVoucher[s].voucher_type=_context19.sent;if(!purchaseVoucher[s].taxp){_context19.next=640;break;}_context19.next=636;return purchaseVoucher[s].taxp.PurchaseLedger;case 636:purchaseVoucher[s].ledger=_context19.sent;delete purchaseVoucher[s].taxp.PurchaseLedger;_context19.next=641;break;case 640:purchaseVoucher[s].ledger={};case 641:_context19.next=643;return purchaseVoucher[s].taxp;case 643:if(!_context19.sent){_context19.next=647;break;}_context19.t34=purchaseVoucher[s].taxp;_context19.next=648;break;case 647:_context19.t34={};case 648:purchaseVoucher[s].Voucher=_context19.t34;purchaseVoucher[s].type='debit';_context19.next=652;return purchaseVoucher[s].amount;case 652:purchaseVoucher[s].debitAmount=_context19.sent;_context19.next=655;return 0;case 655:purchaseVoucher[s].creditAmount=_context19.sent;purchaseVoucher[s].amount=purchaseVoucher[s].amount;_context19.next=659;return purchaseVoucher[s].taxp;case 659:if(!_context19.sent){_context19.next=663;break;}_context19.t35=purchaseVoucher[s].taxp.id;_context19.next=664;break;case 663:_context19.t35='';case 664:purchaseVoucher[s].voucher_number=_context19.t35;_context19.next=667;return purchaseVoucher[s].taxp;case 667:if(!_context19.sent){_context19.next=671;break;}_context19.t36=purchaseVoucher[s].taxp.invoice_id<=9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):purchaseVoucher[s].taxp.invoice_id>9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id);_context19.next=672;break;case 671:_context19.t36='';case 672:purchaseVoucher[s].invoice_id=_context19.t36;delete purchaseVoucher[s].tax;_context19.next=676;return array.push(purchaseVoucher[s]);case 676:_context19.next=710;break;case 678:_context19.next=680;return'purchase';case 680:purchaseVoucher[s].voucher_type=_context19.sent;_context19.next=683;return purchaseVoucher[s].PurchaseLedger;case 683:purchaseVoucher[s].ledger=_context19.sent;_context19.next=686;return{};case 686:purchaseVoucher[s].Voucher=_context19.sent;purchaseVoucher[s].type='credit';_context19.next=690;return purchaseVoucher[s].total_amount;case 690:purchaseVoucher[s].debitAmount=_context19.sent;_context19.next=693;return 0;case 693:purchaseVoucher[s].creditAmount=_context19.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context19.next=697;return purchaseVoucher[s].id;case 697:purchaseVoucher[s].voucher_number=_context19.sent;_context19.next=700;return purchaseVoucher[s].invoice_id;case 700:_context19.t37=_context19.sent;if(!(_context19.t37<=9)){_context19.next=705;break;}_context19.t38="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context19.next=706;break;case 705:_context19.t38=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 706:purchaseVoucher[s].invoice_id=_context19.t38;delete purchaseVoucher[s].PurchaseLedger;_context19.next=710;return array.push(purchaseVoucher[s]);case 710:s++;_context19.next=465;break;case 713:if(!(creditVoucher&&creditVoucher.length>0)){_context19.next=849;break;}s=0;case 715:if(!(s<creditVoucher.length)){_context19.next=849;break;}if(!ledger.dataValues.sale_key){_context19.next=765;break;}_context19.next=719;return'Sale Return';case 719:creditVoucher[s].voucher_type=_context19.sent;if(!creditVoucher[s].Voucheric){_context19.next=727;break;}_context19.next=723;return creditVoucher[s].Voucheric.CreditBuyer;case 723:creditVoucher[s].ledger=_context19.sent;delete creditVoucher[s].Voucheric.CreditBuyer;_context19.next=728;break;case 727:creditVoucher[s].ledger={};case 728:_context19.next=730;return creditVoucher[s].Voucheric;case 730:if(!_context19.sent){_context19.next=734;break;}_context19.t39=creditVoucher[s].Voucheric;_context19.next=735;break;case 734:_context19.t39={};case 735:creditVoucher[s].Voucher=_context19.t39;creditVoucher[s].type='debit';_context19.next=739;return creditVoucher[s].total_amount;case 739:creditVoucher[s].debitAmount=_context19.sent;_context19.next=742;return 0;case 742:creditVoucher[s].creditAmount=_context19.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context19.next=746;return creditVoucher[s].Voucheric;case 746:if(!_context19.sent){_context19.next=750;break;}_context19.t40=creditVoucher[s].Voucheric.id;_context19.next=751;break;case 750:_context19.t40='';case 751:creditVoucher[s].voucher_number=_context19.t40;_context19.next=754;return creditVoucher[s].Voucheric;case 754:if(!_context19.sent){_context19.next=758;break;}_context19.t41=creditVoucher[s].Voucheric.invoice_id<=9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].Voucheric.invoice_id):creditVoucher[s].Voucheric.invoice_id>9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].Voucheric.invoice_id):"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/").concat(creditVoucher[s].Voucheric.invoice_id);_context19.next=759;break;case 758:_context19.t41='';case 759:creditVoucher[s].invoice_id=_context19.t41;delete creditVoucher[s].Voucheric;_context19.next=763;return array.push(creditVoucher[s]);case 763:_context19.next=846;break;case 765:if(!ledger.dataValues.tax_key){_context19.next=814;break;}_context19.next=768;return'Sale Return';case 768:creditVoucher[s].voucher_type=_context19.sent;if(!creditVoucher[s].taxc){_context19.next=776;break;}_context19.next=772;return creditVoucher[s].taxc.CreditBuyer;case 772:creditVoucher[s].ledger=_context19.sent;delete creditVoucher[s].taxc.CreditBuyer;_context19.next=777;break;case 776:creditVoucher[s].ledger={};case 777:_context19.next=779;return creditVoucher[s].taxc;case 779:if(!_context19.sent){_context19.next=783;break;}_context19.t42=creditVoucher[s].taxc;_context19.next=784;break;case 783:_context19.t42={};case 784:creditVoucher[s].Voucher=_context19.t42;creditVoucher[s].type='debit';_context19.next=788;return creditVoucher[s].amount;case 788:creditVoucher[s].debitAmount=_context19.sent;_context19.next=791;return 0;case 791:creditVoucher[s].creditAmount=_context19.sent;creditVoucher[s].amount=creditVoucher[s].amount;_context19.next=795;return creditVoucher[s].taxc;case 795:if(!_context19.sent){_context19.next=799;break;}_context19.t43=creditVoucher[s].taxc.id;_context19.next=800;break;case 799:_context19.t43='';case 800:creditVoucher[s].voucher_number=_context19.t43;_context19.next=803;return creditVoucher[s].taxc;case 803:if(!_context19.sent){_context19.next=807;break;}_context19.t44=creditVoucher[s].taxc.invoice_id<=9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].taxc.invoice_id):creditVoucher[s].taxc.invoice_id>9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].taxc.invoice_id):"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/").concat(creditVoucher[s].taxc.invoice_id);_context19.next=808;break;case 807:_context19.t44='';case 808:creditVoucher[s].invoice_id=_context19.t44;delete creditVoucher[s].taxc;_context19.next=812;return array.push(creditVoucher[s]);case 812:_context19.next=846;break;case 814:_context19.next=816;return'Sale Return';case 816:creditVoucher[s].voucher_type=_context19.sent;_context19.next=819;return creditVoucher[s].CreditBuyer;case 819:creditVoucher[s].ledger=_context19.sent;_context19.next=822;return{};case 822:creditVoucher[s].Voucher=_context19.sent;creditVoucher[s].type='credit';_context19.next=826;return creditVoucher[s].total_amount;case 826:creditVoucher[s].debitAmount=_context19.sent;_context19.next=829;return 0;case 829:creditVoucher[s].creditAmount=_context19.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context19.next=833;return creditVoucher[s].id;case 833:creditVoucher[s].voucher_number=_context19.sent;_context19.next=836;return creditVoucher[s].invoice_id;case 836:_context19.t45=_context19.sent;if(!(_context19.t45<=9)){_context19.next=841;break;}_context19.t46="".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/00").concat(creditVoucher[s].invoice_id);_context19.next=842;break;case 841:_context19.t46=creditVoucher[s].invoice_id>9?"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/0").concat(creditVoucher[s].invoice_id):"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/").concat(creditVoucher[s].invoice_id);case 842:creditVoucher[s].invoice_id=_context19.t46;delete creditVoucher[s].CreditBuyer;_context19.next=846;return array.push(creditVoucher[s]);case 846:s++;_context19.next=715;break;case 849:if(!(debitVoucher&&debitVoucher.length>0)){_context19.next=985;break;}s=0;case 851:if(!(s<debitVoucher.length)){_context19.next=985;break;}if(!ledger.dataValues.sale_key){_context19.next=901;break;}_context19.next=855;return'Purchase Return';case 855:debitVoucher[s].voucher_type=_context19.sent;if(!debitVoucher[s].Voucherid){_context19.next=863;break;}_context19.next=859;return debitVoucher[s].Voucherid.DebitBuyer;case 859:debitVoucher[s].ledger=_context19.sent;delete debitVoucher[s].Voucherid.DebitBuyer;_context19.next=864;break;case 863:debitVoucher[s].ledger={};case 864:_context19.next=866;return debitVoucher[s].Voucherid;case 866:if(!_context19.sent){_context19.next=870;break;}_context19.t47=debitVoucher[s].Voucherid;_context19.next=871;break;case 870:_context19.t47={};case 871:debitVoucher[s].Voucher=_context19.t47;debitVoucher[s].type='Credit';_context19.next=875;return 0;case 875:debitVoucher[s].debitAmount=_context19.sent;_context19.next=878;return debitVoucher[s].total_amount;case 878:debitVoucher[s].creditAmount=_context19.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context19.next=882;return debitVoucher[s].Voucherid;case 882:if(!_context19.sent){_context19.next=886;break;}_context19.t48=debitVoucher[s].Voucherid.id;_context19.next=887;break;case 886:_context19.t48='';case 887:debitVoucher[s].voucher_number=_context19.t48;_context19.next=890;return debitVoucher[s].Voucherid;case 890:if(!_context19.sent){_context19.next=894;break;}_context19.t49=debitVoucher[s].Voucherid.invoice_id<=9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].Voucherid.invoice_id):debitVoucher[s].Voucherid.invoice_id>9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].Voucherid.invoice_id):"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/").concat(debitVoucher[s].Voucherid.invoice_id);_context19.next=895;break;case 894:_context19.t49='';case 895:debitVoucher[s].invoice_id=_context19.t49;delete debitVoucher[s].Voucherid;_context19.next=899;return array.push(debitVoucher[s]);case 899:_context19.next=982;break;case 901:if(!ledger.dataValues.tax_key){_context19.next=950;break;}_context19.next=904;return'Purchase Return';case 904:debitVoucher[s].voucher_type=_context19.sent;if(!debitVoucher[s].taxd){_context19.next=912;break;}_context19.next=908;return debitVoucher[s].taxd.DebitBuyer;case 908:debitVoucher[s].ledger=_context19.sent;delete debitVoucher[s].taxd.DebitBuyer;_context19.next=913;break;case 912:debitVoucher[s].ledger={};case 913:_context19.next=915;return debitVoucher[s].taxd;case 915:if(!_context19.sent){_context19.next=919;break;}_context19.t50=debitVoucher[s].taxd;_context19.next=920;break;case 919:_context19.t50={};case 920:debitVoucher[s].Voucher=_context19.t50;debitVoucher[s].type='Credit';_context19.next=924;return 0;case 924:debitVoucher[s].debitAmount=_context19.sent;_context19.next=927;return debitVoucher[s].amount;case 927:debitVoucher[s].creditAmount=_context19.sent;debitVoucher[s].amount=debitVoucher[s].amount;_context19.next=931;return debitVoucher[s].taxd;case 931:if(!_context19.sent){_context19.next=935;break;}_context19.t51=debitVoucher[s].taxd.id;_context19.next=936;break;case 935:_context19.t51='';case 936:debitVoucher[s].voucher_number=_context19.t51;_context19.next=939;return debitVoucher[s].taxd;case 939:if(!_context19.sent){_context19.next=943;break;}_context19.t52=debitVoucher[s].taxd.invoice_id<=9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].taxd.invoice_id):debitVoucher[s].taxd.invoice_id>9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].taxd.invoice_id):"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/").concat(debitVoucher[s].taxd.invoice_id);_context19.next=944;break;case 943:_context19.t52='';case 944:debitVoucher[s].invoice_id=_context19.t52;delete debitVoucher[s].taxd;_context19.next=948;return array.push(debitVoucher[s]);case 948:_context19.next=982;break;case 950:_context19.next=952;return'Purchase Return';case 952:debitVoucher[s].voucher_type=_context19.sent;_context19.next=955;return debitVoucher[s].DebitBuyer;case 955:debitVoucher[s].ledger=_context19.sent;_context19.next=958;return{};case 958:debitVoucher[s].Voucher=_context19.sent;debitVoucher[s].type='debit';_context19.next=962;return 0;case 962:debitVoucher[s].debitAmount=_context19.sent;_context19.next=965;return debitVoucher[s].total_amount;case 965:debitVoucher[s].creditAmount=_context19.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context19.next=969;return debitVoucher[s].id;case 969:debitVoucher[s].voucher_number=_context19.sent;_context19.next=972;return debitVoucher[s].invoice_id;case 972:_context19.t53=_context19.sent;if(!(_context19.t53<=9)){_context19.next=977;break;}_context19.t54="".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/00").concat(debitVoucher[s].invoice_id);_context19.next=978;break;case 977:_context19.t54=debitVoucher[s].invoice_id>9?"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/0").concat(debitVoucher[s].invoice_id):"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/").concat(debitVoucher[s].invoice_id);case 978:debitVoucher[s].invoice_id=_context19.t54;delete debitVoucher[s].DebitBuyer;_context19.next=982;return array.push(debitVoucher[s]);case 982:s++;_context19.next=851;break;case 985:if(!(discountsaleVoucher&&discountsaleVoucher.length>0)){_context19.next=1040;break;}_salearray5=[];s=0;case 988:if(!(s<discountsaleVoucher.length)){_context19.next=1040;break;}_context19.next=991;return'sale';case 991:discountsaleVoucher[s].voucher_type=_context19.sent;_context19.next=994;return discountsaleVoucher[s].SalesDiscountLedger;case 994:discountsaleVoucher[s].ledger=_context19.sent;_context19.next=997;return{};case 997:discountsaleVoucher[s].Voucher=_context19.sent;discountsaleVoucher[s].type=discountsaleVoucher[s].discount&&Number(discountsaleVoucher[s].discount)>0?'Credit':'Debit';_context19.next=1001;return discountsaleVoucher[s].discount;case 1001:_context19.t55=_context19.sent;if(!_context19.t55){_context19.next=1004;break;}_context19.t55=Number(discountsaleVoucher[s].discount)<0;case 1004:if(!_context19.t55){_context19.next=1008;break;}_context19.t56=-1*Number(discountsaleVoucher[s].discount);_context19.next=1009;break;case 1008:_context19.t56=0;case 1009:discountsaleVoucher[s].debitAmount=_context19.t56;_context19.next=1012;return discountsaleVoucher[s].discount;case 1012:_context19.t57=_context19.sent;if(!_context19.t57){_context19.next=1015;break;}_context19.t57=Number(discountsaleVoucher[s].discount)>0;case 1015:if(!_context19.t57){_context19.next=1019;break;}_context19.t58=Number(discountsaleVoucher[s].discount);_context19.next=1020;break;case 1019:_context19.t58=0;case 1020:discountsaleVoucher[s].creditAmount=_context19.t58;discountsaleVoucher[s].amount=discountsaleVoucher[s].discount&&Number(discountsaleVoucher[s].discount)>0?Number(discountsaleVoucher[s].discount):Number(discountsaleVoucher[s].discount);_context19.next=1024;return discountsaleVoucher[s].id;case 1024:discountsaleVoucher[s].voucher_number=_context19.sent;_context19.next=1027;return discountsaleVoucher[s].invoice_id;case 1027:_context19.t59=_context19.sent;if(!(_context19.t59<=9)){_context19.next=1032;break;}_context19.t60="".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/00").concat(discountsaleVoucher[s].invoice_id);_context19.next=1033;break;case 1032:_context19.t60=discountsaleVoucher[s].invoice_id>9?"".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/0").concat(discountsaleVoucher[s].invoice_id):"".concat(discountsaleVoucher[s].current_year.toString().substr(-2)+"-"+discountsaleVoucher[s].end_year.toString().substr(-2),"/").concat(discountsaleVoucher[s].invoice_id);case 1033:discountsaleVoucher[s].invoice_id=_context19.t60;delete discountsaleVoucher[s].SalesDiscountLedger;_context19.next=1037;return array.push(discountsaleVoucher[s]);case 1037:s++;_context19.next=988;break;case 1040:if(!(discountpurchaseVoucher&&discountpurchaseVoucher.length>0)){_context19.next=1089;break;}_salearray6=[];s=0;case 1043:if(!(s<discountpurchaseVoucher.length)){_context19.next=1089;break;}_context19.next=1046;return'purchase';case 1046:discountpurchaseVoucher[s].voucher_type=_context19.sent;_context19.next=1049;return discountpurchaseVoucher[s].PurchaseDiscountLedger;case 1049:discountpurchaseVoucher[s].ledger=_context19.sent;_context19.next=1052;return{};case 1052:discountpurchaseVoucher[s].Voucher=_context19.sent;discountpurchaseVoucher[s].type=discountpurchaseVoucher[s].discount&&Number(discountpurchaseVoucher[s].discount)>0?'Debit':'Credit';_context19.next=1056;return discountpurchaseVoucher[s].discount;case 1056:_context19.t61=_context19.sent;if(!_context19.t61){_context19.next=1059;break;}_context19.t61=Number(discountpurchaseVoucher[s].discount)>0;case 1059:if(!_context19.t61){_context19.next=1063;break;}_context19.t62=Number(discountpurchaseVoucher[s].discount);_context19.next=1064;break;case 1063:_context19.t62=0;case 1064:discountpurchaseVoucher[s].debitAmount=_context19.t62;_context19.next=1067;return discountpurchaseVoucher[s].discount;case 1067:_context19.t63=_context19.sent;if(!_context19.t63){_context19.next=1070;break;}_context19.t63=Number(discountpurchaseVoucher[s].discount)<0;case 1070:if(!_context19.t63){_context19.next=1074;break;}_context19.t64=-1*Number(discountpurchaseVoucher[s].discount);_context19.next=1075;break;case 1074:_context19.t64=0;case 1075:discountpurchaseVoucher[s].creditAmount=_context19.t64;discountpurchaseVoucher[s].amount=discountpurchaseVoucher[s].discount&&Number(discountpurchaseVoucher[s].discount)>0?Number(discountpurchaseVoucher[s].discount):Number(discountpurchaseVoucher[s].discount);_context19.next=1079;return discountpurchaseVoucher[s].id;case 1079:discountpurchaseVoucher[s].voucher_number=_context19.sent;_context19.next=1082;return discountpurchaseVoucher[s].invoice_id;case 1082:discountpurchaseVoucher[s].invoice_id=_context19.sent;delete discountpurchaseVoucher[s].PurchaseDiscountLedger;_context19.next=1086;return array.push(discountpurchaseVoucher[s]);case 1086:s++;_context19.next=1043;break;case 1089:if(!(discountcreditVoucher&&discountcreditVoucher.length>0)){_context19.next=1147;break;}_salearray7=[];s=0;case 1092:if(!(s<discountcreditVoucher.length)){_context19.next=1147;break;}_context19.next=1095;return'sales return';case 1095:discountcreditVoucher[s].voucher_type=_context19.sent;_context19.next=1098;return discountcreditVoucher[s].CreditDiscountLedger;case 1098:discountcreditVoucher[s].ledger=_context19.sent;_context19.next=1101;return{};case 1101:discountcreditVoucher[s].Voucher=_context19.sent;discountcreditVoucher[s].type=discountcreditVoucher[s].discount&&Number(discountcreditVoucher[s].discount)>0?'Debit':'Credit';_context19.next=1105;return discountcreditVoucher[s].discount;case 1105:_context19.t65=_context19.sent;if(!_context19.t65){_context19.next=1108;break;}_context19.t65=Number(discountcreditVoucher[s].discount)>0;case 1108:if(!_context19.t65){_context19.next=1112;break;}_context19.t66=Number(discountcreditVoucher[s].discount);_context19.next=1113;break;case 1112:_context19.t66=0;case 1113:discountcreditVoucher[s].debitAmount=_context19.t66;_context19.next=1116;return discountcreditVoucher[s].discount;case 1116:_context19.t67=_context19.sent;if(!_context19.t67){_context19.next=1119;break;}_context19.t67=Number(discountcreditVoucher[s].discount)<0;case 1119:if(!_context19.t67){_context19.next=1123;break;}_context19.t68=-1*Number(discountcreditVoucher[s].discount);_context19.next=1124;break;case 1123:_context19.t68=0;case 1124:discountcreditVoucher[s].creditAmount=_context19.t68;discountcreditVoucher[s].amount=discountcreditVoucher[s].discount&&Number(discountcreditVoucher[s].discount)>0?Number(discountcreditVoucher[s].discount):Number(discountcreditVoucher[s].discount);_context19.next=1128;return discountcreditVoucher[s].invoice_id;case 1128:_context19.t69=_context19.sent;if(!(_context19.t69<=9)){_context19.next=1133;break;}_context19.t70="".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/00").concat(discountcreditVoucher[s].invoice_id);_context19.next=1134;break;case 1133:_context19.t70=discountcreditVoucher[s].invoice_id>9?"".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/0").concat(discountcreditVoucher[s].invoice_id):"".concat(discountcreditVoucher[s].current_year.toString().substr(-2)+"-"+discountcreditVoucher[s].end_year.toString().substr(-2),"/").concat(discountcreditVoucher[s].invoice_id);case 1134:discountcreditVoucher[s].invoice_id=_context19.t70;_context19.next=1137;return discountcreditVoucher[s].id;case 1137:discountcreditVoucher[s].voucher_number=_context19.sent;_context19.next=1140;return discountcreditVoucher[s].invoice_id;case 1140:discountcreditVoucher[s].invoice_id=_context19.sent;delete discountcreditVoucher[s].CreditDiscountLedger;_context19.next=1144;return array.push(discountcreditVoucher[s]);case 1144:s++;_context19.next=1092;break;case 1147:if(!(discountdebitVoucher&&discountdebitVoucher.length>0)){_context19.next=1202;break;}_salearray8=[];s=0;case 1150:if(!(s<discountdebitVoucher.length)){_context19.next=1202;break;}_context19.next=1153;return'purchase return';case 1153:discountdebitVoucher[s].voucher_type=_context19.sent;_context19.next=1156;return discountdebitVoucher[s].DebitDiscountLedger;case 1156:discountdebitVoucher[s].ledger=_context19.sent;_context19.next=1159;return{};case 1159:discountdebitVoucher[s].Voucher=_context19.sent;discountdebitVoucher[s].type=discountdebitVoucher[s].discount&&Number(discountdebitVoucher[s].discount)>0?'Credit':'debit';_context19.next=1163;return discountdebitVoucher[s].discount;case 1163:_context19.t71=_context19.sent;if(!_context19.t71){_context19.next=1166;break;}_context19.t71=Number(discountdebitVoucher[s].discount)<0;case 1166:if(!_context19.t71){_context19.next=1170;break;}_context19.t72=-1*Number(discountdebitVoucher[s].discount);_context19.next=1171;break;case 1170:_context19.t72=0;case 1171:discountdebitVoucher[s].debitAmount=_context19.t72;_context19.next=1174;return discountdebitVoucher[s].discount;case 1174:_context19.t73=_context19.sent;if(!_context19.t73){_context19.next=1177;break;}_context19.t73=Number(discountdebitVoucher[s].discount)>0;case 1177:if(!_context19.t73){_context19.next=1181;break;}_context19.t74=Number(discountdebitVoucher[s].discount);_context19.next=1182;break;case 1181:_context19.t74=0;case 1182:discountdebitVoucher[s].creditAmount=_context19.t74;discountdebitVoucher[s].amount=discountdebitVoucher[s].discount&&Number(discountdebitVoucher[s].discount)>0?Number(discountdebitVoucher[s].discount):Number(discountdebitVoucher[s].discount);_context19.next=1186;return discountdebitVoucher[s].id;case 1186:discountdebitVoucher[s].voucher_number=_context19.sent;_context19.next=1189;return discountdebitVoucher[s].invoice_id;case 1189:_context19.t75=_context19.sent;if(!(_context19.t75<=9)){_context19.next=1194;break;}_context19.t76="".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/00").concat(discountdebitVoucher[s].invoice_id);_context19.next=1195;break;case 1194:_context19.t76=discountdebitVoucher[s].invoice_id>9?"".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/0").concat(discountdebitVoucher[s].invoice_id):"".concat(discountdebitVoucher[s].current_year.toString().substr(-2)+"-"+discountdebitVoucher[s].end_year.toString().substr(-2),"/").concat(discountdebitVoucher[s].invoice_id);case 1195:discountdebitVoucher[s].invoice_id=_context19.t76;delete discountdebitVoucher[s].DebitDiscountLedger;_context19.next=1199;return array.push(discountdebitVoucher[s]);case 1199:s++;_context19.next=1150;break;case 1202:if(!(recieptVoucher&&recieptVoucher.length>0)){_context19.next=1247;break;}i=0;case 1204:if(!(i<recieptVoucher.length)){_context19.next=1247;break;}_context19.next=1207;return recieptVoucher[i].type;case 1207:_context19.t77=_context19.sent;if(!(_context19.t77==='debit')){_context19.next=1217;break;}_context19.next=1211;return recieptVoucher[i].total_amount;case 1211:recieptVoucher[i].debitAmount=_context19.sent;_context19.next=1214;return 0;case 1214:recieptVoucher[i].creditAmount=_context19.sent;_context19.next=1223;break;case 1217:_context19.next=1219;return 0;case 1219:recieptVoucher[i].debitAmount=_context19.sent;_context19.next=1222;return recieptVoucher[i].total_amount;case 1222:recieptVoucher[i].creditAmount=_context19.sent;case 1223:_context19.next=1225;return recieptVoucher[i].ReciptBuyer;case 1225:recieptVoucher[i].ledger=_context19.sent;delete recieptVoucher[i].ReciptBuyer;_context19.next=1229;return'reciept';case 1229:recieptVoucher[i].voucher_type=_context19.sent;_context19.next=1232;return recieptVoucher[i].id;case 1232:recieptVoucher[i].voucher_number=_context19.sent;_context19.next=1235;return recieptVoucher[i].invoice_id;case 1235:_context19.t78=_context19.sent;if(!(_context19.t78<=9)){_context19.next=1240;break;}_context19.t79="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context19.next=1241;break;case 1240:_context19.t79=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 1241:recieptVoucher[i].invoice_id=_context19.t79;_context19.next=1244;return array.push(recieptVoucher[i]);case 1244:i++;_context19.next=1204;break;case 1247:if(!(paymentVoucher&&paymentVoucher.length>0)){_context19.next=1292;break;}i=0;case 1249:if(!(i<paymentVoucher.length)){_context19.next=1292;break;}_context19.next=1252;return paymentVoucher[i].type;case 1252:_context19.t80=_context19.sent;if(!(_context19.t80==='debit')){_context19.next=1262;break;}_context19.next=1256;return paymentVoucher[i].total_amount;case 1256:paymentVoucher[i].debitAmount=_context19.sent;_context19.next=1259;return 0;case 1259:paymentVoucher[i].creditAmount=_context19.sent;_context19.next=1268;break;case 1262:_context19.next=1264;return 0;case 1264:paymentVoucher[i].debitAmount=_context19.sent;_context19.next=1267;return paymentVoucher[i].total_amount;case 1267:paymentVoucher[i].creditAmount=_context19.sent;case 1268:_context19.next=1270;return paymentVoucher[i].PaymentBuyer;case 1270:paymentVoucher[i].ledger=_context19.sent;delete paymentVoucher[i].PaymentBuyer;_context19.next=1274;return'payment';case 1274:paymentVoucher[i].voucher_type=_context19.sent;_context19.next=1277;return paymentVoucher[i].id;case 1277:paymentVoucher[i].voucher_number=_context19.sent;_context19.next=1280;return paymentVoucher[i].invoice_id;case 1280:_context19.t81=_context19.sent;if(!(_context19.t81<=9)){_context19.next=1285;break;}_context19.t82="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context19.next=1286;break;case 1285:_context19.t82=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 1286:paymentVoucher[i].invoice_id=_context19.t82;_context19.next=1289;return array.push(paymentVoucher[i]);case 1289:i++;_context19.next=1249;break;case 1292:if(!(reciverrecieptVoucher&&reciverrecieptVoucher.length>0)){_context19.next=1326;break;}i=0;case 1294:if(!(i<reciverrecieptVoucher.length)){_context19.next=1326;break;}_context19.next=1297;return reciverrecieptVoucher[i].total_amount;case 1297:reciverrecieptVoucher[i].debitAmount=_context19.sent;_context19.next=1300;return 0;case 1300:reciverrecieptVoucher[i].creditAmount=_context19.sent;_context19.next=1303;return reciverrecieptVoucher[i].ReciptReciver;case 1303:reciverrecieptVoucher[i].ledger=_context19.sent;delete reciverrecieptVoucher[i].ReciptReciver;_context19.next=1307;return'reciept reciver';case 1307:reciverrecieptVoucher[i].voucher_type=_context19.sent;_context19.next=1310;return reciverrecieptVoucher[i].id;case 1310:reciverrecieptVoucher[i].voucher_number=_context19.sent;_context19.next=1313;return reciverrecieptVoucher[i].invoice_id;case 1313:_context19.t83=_context19.sent;if(!(_context19.t83<=9)){_context19.next=1318;break;}_context19.t84="".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverrecieptVoucher[i].invoice_id);_context19.next=1319;break;case 1318:_context19.t84=reciverrecieptVoucher[i].invoice_id>9?"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverrecieptVoucher[i].invoice_id):"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/").concat(reciverrecieptVoucher[i].invoice_id);case 1319:reciverrecieptVoucher[i].invoice_id=_context19.t84;reciverrecieptVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context19.next=1323;return array.push(reciverrecieptVoucher[i]);case 1323:i++;_context19.next=1294;break;case 1326:if(!(reciverpaymentVoucher&&reciverpaymentVoucher.length>0)){_context19.next=1360;break;}i=0;case 1328:if(!(i<reciverpaymentVoucher.length)){_context19.next=1360;break;}_context19.next=1331;return 0;case 1331:reciverpaymentVoucher[i].debitAmount=_context19.sent;_context19.next=1334;return reciverpaymentVoucher[i].total_amount;case 1334:reciverpaymentVoucher[i].creditAmount=_context19.sent;_context19.next=1337;return reciverpaymentVoucher[i].PaymentReciver;case 1337:reciverpaymentVoucher[i].ledger=_context19.sent;delete reciverpaymentVoucher[i].PaymentReciver;_context19.next=1341;return'payment reciver';case 1341:reciverpaymentVoucher[i].voucher_type=_context19.sent;_context19.next=1344;return reciverpaymentVoucher[i].id;case 1344:reciverpaymentVoucher[i].voucher_number=_context19.sent;_context19.next=1347;return reciverpaymentVoucher[i].invoice_id;case 1347:_context19.t85=_context19.sent;if(!(_context19.t85<=9)){_context19.next=1352;break;}_context19.t86="".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverpaymentVoucher[i].invoice_id);_context19.next=1353;break;case 1352:_context19.t86=reciverpaymentVoucher[i].invoice_id>9?"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverpaymentVoucher[i].invoice_id):"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/").concat(reciverpaymentVoucher[i].invoice_id);case 1353:reciverpaymentVoucher[i].invoice_id=_context19.t86;reciverpaymentVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context19.next=1357;return array.push(reciverpaymentVoucher[i]);case 1357:i++;_context19.next=1328;break;case 1360:_context19.next=1362;return(0,_arraySort["default"])(array,'invoice_date');case 1362:mainArray=_context19.sent;//array.sort((a, b) => new Date(b.invoice_date) - new Date(a.invoice_date));
// return {mainArray:mainArray}
creditamount=0;debetamount=0;totalbalnce=0;_context19.next=1368;return mainArray.map(function(item){if(item.creditAmount){creditamount=creditamount+Number(item.creditAmount);}else if(item.debitAmount){debetamount=debetamount+Number(item.debitAmount);}});case 1368:totalbalnce=Number(Number(openingbalncecredit)+Number(creditamount))-Number(Number(debetamount)+Number(openingbalncedebit));return _context19.abrupt("return",totalbalnce);case 1372:_context19.next=1378;break;case 1374:_context19.prev=1374;_context19.t87=_context19["catch"](0);console.log("getAllLedgerVouchercurrent",_context19.t87);return _context19.abrupt("return",0);case 1378:case"end":return _context19.stop();}},_callee15,null,[[0,1374]]);}));return _getAllLedgerVouchercurrent.apply(this,arguments);}function getAllGroupVouchercurrent(_x17,_x18,_x19,_x20,_x21){return _getAllGroupVouchercurrent.apply(this,arguments);}function _getAllGroupVouchercurrent(){_getAllGroupVouchercurrent=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee17(start_date,end_date,accountId,company_id,email){var findCompany,_invoice_date163,_invoice_date164,_invoice_date165,_invoice_date166,_invoice_date167,_invoice_date168,_invoice_date169,_invoice_date170,_invoice_date171,_invoice_date172,_invoice_date173,_invoice_date174,_invoice_date175,_invoice_date176,_invoice_date177,_invoice_date178,_invoice_date179,_invoice_date180,compaanyinfo,currentyear,ledger,totalbalnce,creditbalnce,debitbalnce;return _regeneratorRuntime().wrap(function _callee17$(_context21){while(1)switch(_context21.prev=_context21.next){case 0:_context21.prev=0;_context21.next=3;return _company["default"].findOne({where:{uid:company_id}});case 3:findCompany=_context21.sent;if(!(findCompany&&findCompany.dataValues)){_context21.next=33;break;}compaanyinfo=findCompany.dataValues;_context21.next=8;return new Date(start_date).getFullYear();case 8:currentyear=_context21.sent;_context21.next=11;return start_date;case 11:end_date=_context21.sent;_context21.next=14;return"".concat(currentyear,"-04-01");case 14:start_date=_context21.sent;_context21.next=17;return _ledger["default"].findAll({where:_defineProperty({},Op.and,[{account_group_id:accountId},{company_id:company_id}]),attributes:['id','uid','name','amount','opening_balance'],include:[{model:_accountGroup["default"]},{model:_subAccountGroup["default"]},{model:_journalInteries["default"],where:{invoice_date:(_invoice_date163={},_defineProperty(_invoice_date163,Op.gte,start_date),_defineProperty(_invoice_date163,Op.lt,end_date),_invoice_date163)},required:false,attributes:['id','uid','type','invoice_date','amount','journa_voucher_id'],include:[{model:_journalVoucher["default"],required:false,attributes:['id','uid','total_amount','invoice_id','invoice_date'],as:'Voucher'}]},{model:_recieptVoucher["default"],as:'Buyer',where:{invoice_date:(_invoice_date164={},_defineProperty(_invoice_date164,Op.gte,start_date),_defineProperty(_invoice_date164,Op.lt,end_date),_invoice_date164)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PBuyer',required:false,where:{invoice_date:(_invoice_date165={},_defineProperty(_invoice_date165,Op.gte,start_date),_defineProperty(_invoice_date165,Op.lt,end_date),_invoice_date165)},attributes:['id','uid','total_amount','type','receive_type']},{model:_recieptVoucher["default"],as:'RBuyer',where:{invoice_date:(_invoice_date166={},_defineProperty(_invoice_date166,Op.gte,start_date),_defineProperty(_invoice_date166,Op.lt,end_date),_invoice_date166)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PRBuyer',required:false,where:{invoice_date:(_invoice_date167={},_defineProperty(_invoice_date167,Op.gte,start_date),_defineProperty(_invoice_date167,Op.lt,end_date),_invoice_date167)},attributes:['id','uid','total_amount','type','receive_type']},{model:_saleVoucher["default"],where:{invoice_date:(_invoice_date168={},_defineProperty(_invoice_date168,Op.gte,start_date),_defineProperty(_invoice_date168,Op.lt,end_date),_invoice_date168)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],where:{invoice_date:(_invoice_date169={},_defineProperty(_invoice_date169,Op.gte,start_date),_defineProperty(_invoice_date169,Op.lt,end_date),_invoice_date169)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_saleVoucher["default"],as:"roundsales",where:{invoice_date:(_invoice_date170={},_defineProperty(_invoice_date170,Op.gte,start_date),_defineProperty(_invoice_date170,Op.lt,end_date),_invoice_date170)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"roundpurchase",where:{invoice_date:(_invoice_date171={},_defineProperty(_invoice_date171,Op.gte,start_date),_defineProperty(_invoice_date171,Op.lt,end_date),_invoice_date171)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_creditVoucher["default"],where:{invoice_date:(_invoice_date172={},_defineProperty(_invoice_date172,Op.gte,start_date),_defineProperty(_invoice_date172,Op.lt,end_date),_invoice_date172)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Debit'}}]},{model:_debitVoucher["default"],where:{invoice_date:(_invoice_date173={},_defineProperty(_invoice_date173,Op.gte,start_date),_defineProperty(_invoice_date173,Op.lt,end_date),_invoice_date173)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Credit'}}]},{model:_itemInteries["default"],required:false,where:{invoice_date:(_invoice_date174={},_defineProperty(_invoice_date174,Op.gte,start_date),_defineProperty(_invoice_date174,Op.lt,end_date),_invoice_date174)},include:[{model:_saleVoucher["default"],as:"ItemVouchers",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_purchaseVoucher["default"],as:"ItemVoucherp",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_debitVoucher["default"],as:"ItemVoucherd",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_creditVoucher["default"],as:"ItemVoucherc",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']}]},{model:_voucherInteries["default"],as:'vocher_entries',required:false,where:{invoice_date:(_invoice_date175={},_defineProperty(_invoice_date175,Op.gte,start_date),_defineProperty(_invoice_date175,Op.lt,end_date),_invoice_date175)},attributes:['id','uid','amount','type','ledger_id']},{model:_taxInteries["default"],as:'tax_entries',required:false,where:{invoice_date:(_invoice_date176={},_defineProperty(_invoice_date176,Op.gte,start_date),_defineProperty(_invoice_date176,Op.lt,end_date),_invoice_date176)},attributes:['id','uid','amount','type','tax_ledger_id']},{model:_saleVoucher["default"],as:"discountsales",where:{invoice_date:(_invoice_date177={},_defineProperty(_invoice_date177,Op.gte,start_date),_defineProperty(_invoice_date177,Op.lt,end_date),_invoice_date177)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"discountPurchases",where:{invoice_date:(_invoice_date178={},_defineProperty(_invoice_date178,Op.gte,start_date),_defineProperty(_invoice_date178,Op.lt,end_date),_invoice_date178)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_creditVoucher["default"],as:"discountCredit",where:{invoice_date:(_invoice_date179={},_defineProperty(_invoice_date179,Op.gte,start_date),_defineProperty(_invoice_date179,Op.lt,end_date),_invoice_date179)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_debitVoucher["default"],as:"discountDebit",where:{invoice_date:(_invoice_date180={},_defineProperty(_invoice_date180,Op.gte,start_date),_defineProperty(_invoice_date180,Op.lt,end_date),_invoice_date180)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]}]}).map(function(node){return node.get({plain:true});});case 17:ledger=_context21.sent;_context21.next=20;return(0,_voucherReport.decreptionReport)(ledger,'array',email);case 20:ledger=_context21.sent;if(!(ledger.length>0)){_context21.next=30;break;}totalbalnce=0;creditbalnce=0;debitbalnce=0;_context21.next=27;return ledger.map(/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee16(item){return _regeneratorRuntime().wrap(function _callee16$(_context20){while(1)switch(_context20.prev=_context20.next){case 0:item.open_amount=item.amount?item.opening_balance=='debit'?-1*Number(item.amount):item.amount:0;item.open_type=item.opening_balance;item.name=item.name;item.subAccount=item.sub_account_group?item.sub_account_group:{};item.accounttype=item.account_group&&item.account_group.type=="dr"?'debit':'credit';item.open_amount=item.amount?Number(item.amount):item.amount;delete item.amount;delete item.opening_balance;delete item.sub_account_group;delete item.account_group;item.invoice_id='';item.voucher_type='';item.debitAmount=0;item.creditAmount=0;if(item.journal_entries.length>0){item.journal_entries.forEach(function(journal){if(journal.type==='debit'){item.debitAmount=Number(journal.amount)+Number(item.debitAmount);}else{item.creditAmount=Number(journal.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.Buyer.length>0){item.Buyer.forEach(function(reciept){if(reciept.type==='debit'){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(reciept.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.PBuyer.length>0){item.PBuyer.forEach(function(payment){if(payment.type==='debit'){item.debitAmount=Number(payment.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.RBuyer.length>0){item.RBuyer.forEach(function(reciept){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));});}if(item.PRBuyer.length>0){item.PRBuyer.forEach(function(payment){item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.sales_vouchers&&item.sales_vouchers.length>0){item.sales_vouchers.forEach(function(sale){item.debitAmount=Number(sale.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.purchase_vouchers.length>0){item.purchase_vouchers.forEach(function(purchase){item.creditAmount=Number(purchase.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.roundsales&&item.roundsales.length>0){item.roundsales.forEach(function(sale){if(sale.roundoff_ledger_id){if(sale.roundoff_type=="debit"||sale.roundoff_type=="Debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.roundpurchase.length>0){item.roundpurchase.forEach(function(purchase){if(purchase.roundoff_ledger_id){if(purchase.roundoff_type=="debit"||purchase.roundoff_type=="Debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.credit_vouchers.length>0){item.credit_vouchers.forEach(function(credit){item.debitAmount=Number(credit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.debit_vouchers.length>0){item.debit_vouchers.forEach(function(debit){item.debitAmount=Number(debit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.item_entries.length>0){item.item_entries.forEach(function(voucher){if(voucher.ItemVouchers){item.invoice_date=voucher.ItemVouchers.invoice_date;item.invoice_id=voucher.ItemVouchers.invoice_id<=9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/00").concat(voucher.ItemVouchers.invoice_id):voucher.ItemVouchers.invoice_id>9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/0").concat(voucher.ItemVouchers.invoice_id):"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/").concat(voucher.ItemVouchers.invoice_id);item.voucher_type='sale';}if(voucher.ItemVoucherc){item.invoice_date=voucher.ItemVoucherc.invoice_date;item.invoice_id=voucher.ItemVoucherc.invoice_id<=9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherc.invoice_id):voucher.ItemVoucherc.invoice_id>9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherc.invoice_id):"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherc.invoice_id);item.voucher_type='credit';}if(voucher.ItemVoucherd){item.invoice_date=voucher.ItemVoucherd.invoice_date;item.invoice_id=voucher.ItemVoucherd.invoice_id<=9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherd.invoice_id):voucher.ItemVoucherd.invoice_id>9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherd.invoice_id):"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherd.invoice_id);item.voucher_type='debit';}if(voucher.ItemVoucherp){item.invoice_date=voucher.ItemVoucherp.invoice_date;item.invoice_id=voucher.ItemVoucherp.invoice_id;item.voucher_type='purchase';}if(voucher.type==="Sales"||voucher.type==="sales"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}else if(voucher.type==="Purchase"||voucher.type==="purchase"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Debit"||voucher.type==="Debit"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Credit"||voucher.type==="Credit"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.vocher_entries.length>0){
//     item.vocher_entries.forEach(voucher=>{
//         if(voucher.type==="Sales" || voucher.type==="sales"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Purchase" || voucher.type==="purchase"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Debit" || voucher.type==="Debit"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.debitAmount);
//         }else if(voucher.type==="Credit" || voucher.type==="Credit"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount))+Number(item.open_amount);
//     })
// }
if(item.tax_entries.length>0){item.tax_entries.forEach(function(tax){if(tax.type==="Sales"||tax.type==="sales"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}else if(tax.type==="Purchase"||tax.type==="purchase"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Debit"||tax.type==="debit"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Credit"||tax.type==="credit"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.discountsales && item.discountsales.length>0){
//     item.discountsales.forEach(sale=>{
//         item.debitAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.creditAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountPurchases && item.discountPurchases.length>0){
//     item.discountPurchases.forEach(sale=>{
//         item.creditAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.debitAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountCredit && item.discountCredit.length>0){
//     item.discountCredit.forEach(sale=>{
//         item.debitAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.creditAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountDebit && item.discountDebit.length>0){
//     item.discountDebit.forEach(sale=>{
//         item.creditAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.debitAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
if(item.roundsales&&item.roundsales.length<0||item.roundpurchase.length<0){if(item.discountsales&&item.discountsales.length>0){item.discountsales.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountPurchases&&item.discountPurchases.length>0){item.discountPurchases.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountCredit&&item.discountCredit.length>0){item.discountCredit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountDebit&&item.discountDebit.length>0){item.discountDebit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}}if(item.open_type==="debit"){item.closeing_amount=Number(item.closeing_amount)-Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='debit';item.accounttype=item.closeing_type;}if(item.open_type==="credit"){item.closeing_amount=Number(item.closeing_amount)+Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='credit';item.accounttype=item.closeing_type;}delete item.journal_entries;delete item.reciept_vouchers;delete item.payment_vouchers;delete item.sales_vouchers;delete item.purchase_vouchers;delete item.credit_vouchers;delete item.debit_vouchers;delete item.item_entries;delete item.vocher_entries;delete item.tax_entries;delete item.Buyer;delete item.PBuyer;delete item.PRBuyer;delete item.RBuyer;totalbalnce=Number(totalbalnce)+Number(Number(item.creditAmount))-Number(Number(item.debitAmount));creditbalnce=Number(creditbalnce)+Number(item.creditAmount);debitbalnce=Number(debitbalnce)+Number(item.debitAmount);case 47:case"end":return _context20.stop();}},_callee16);}));return function(_x63){return _ref13.apply(this,arguments);};}());case 27:return _context21.abrupt("return",{totalbalnce:totalbalnce,creditbalnce:creditbalnce,debitbalnce:debitbalnce});case 30:return _context21.abrupt("return",{totalbalnce:0,creditbalnce:0,debitbalnce:0});case 31:_context21.next=34;break;case 33:return _context21.abrupt("return",{totalbalnce:0,creditbalnce:0,debitbalnce:0});case 34:_context21.next=40;break;case 36:_context21.prev=36;_context21.t0=_context21["catch"](0);console.log("getAllGroupVouchercurrent",_context21.t0);return _context21.abrupt("return",{totalbalnce:0,creditbalnce:0,debitbalnce:0});case 40:case"end":return _context21.stop();}},_callee17,null,[[0,36]]);}));return _getAllGroupVouchercurrent.apply(this,arguments);}function getAllGroupVoucherprivious(_x22,_x23,_x24,_x25,_x26){return _getAllGroupVoucherprivious.apply(this,arguments);}function _getAllGroupVoucherprivious(){_getAllGroupVoucherprivious=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee19(start_date,end_date,accountId,company_id,email){var ledger,totalbalnce,creditbalnce,debitbalnce;return _regeneratorRuntime().wrap(function _callee19$(_context23){while(1)switch(_context23.prev=_context23.next){case 0:_context23.prev=0;_context23.next=3;return _ledger["default"].findAll({where:_defineProperty({},Op.and,[{account_group_id:accountId},{company_id:company_id}]),attributes:['id','uid','name','amount','opening_balance'],include:[{model:_accountGroup["default"]},{model:_subAccountGroup["default"]},{model:_journalInteries["default"],where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','type','invoice_date','amount','journa_voucher_id'],include:[{model:_journalVoucher["default"],required:false,attributes:['id','uid','total_amount','invoice_id','invoice_date'],as:'Voucher'}]},{model:_recieptVoucher["default"],as:'Buyer',where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PBuyer',required:false,where:{invoice_date:_defineProperty({},Op.lt,start_date)},attributes:['id','uid','total_amount','type','receive_type']},{model:_recieptVoucher["default"],as:'RBuyer',where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PRBuyer',required:false,where:{invoice_date:_defineProperty({},Op.lt,start_date)},attributes:['id','uid','total_amount','type','receive_type']},{model:_saleVoucher["default"],where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_saleVoucher["default"],as:"roundsales",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"roundpurchase",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_creditVoucher["default"],where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Debit'}}]},{model:_debitVoucher["default"],where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Credit'}}]},{model:_itemInteries["default"],required:false,where:{invoice_date:_defineProperty({},Op.lt,start_date)},include:[{model:_saleVoucher["default"],as:"ItemVouchers",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_purchaseVoucher["default"],as:"ItemVoucherp",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_debitVoucher["default"],as:"ItemVoucherd",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_creditVoucher["default"],as:"ItemVoucherc",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']}]},{model:_voucherInteries["default"],as:'vocher_entries',required:false,where:{invoice_date:_defineProperty({},Op.lt,start_date)},attributes:['id','uid','amount','type','ledger_id']},{model:_taxInteries["default"],as:'tax_entries',required:false,where:{invoice_date:_defineProperty({},Op.lt,start_date)},attributes:['id','uid','amount','type','tax_ledger_id']},{model:_saleVoucher["default"],as:"discountsales",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"discountPurchases",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_creditVoucher["default"],as:"discountCredit",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_debitVoucher["default"],as:"discountDebit",where:{invoice_date:_defineProperty({},Op.lt,start_date)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]}]}).map(function(node){return node.get({plain:true});});case 3:ledger=_context23.sent;_context23.next=6;return(0,_voucherReport.decreptionReport)(ledger,'array',email);case 6:ledger=_context23.sent;if(!(ledger.length>0)){_context23.next=16;break;}totalbalnce=0;creditbalnce=0;debitbalnce=0;_context23.next=13;return ledger.map(/*#__PURE__*/function(){var _ref14=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee18(item){return _regeneratorRuntime().wrap(function _callee18$(_context22){while(1)switch(_context22.prev=_context22.next){case 0:item.open_amount=item.amount?item.opening_balance=='debit'?-1*Number(item.amount):item.amount:0;item.open_type=item.opening_balance;item.name=item.name;item.subAccount=item.sub_account_group?item.sub_account_group:{};item.account=item.account_group?item.account_group:{};item.accounttype=item.account_group&&item.account_group.type=="dr"?'debit':'credit';item.open_amount=item.amount?Number(item.amount):item.amount;delete item.amount;delete item.opening_balance;delete item.sub_account_group;delete item.account_group;item.invoice_id='';item.voucher_type='';item.debitAmount=0;item.creditAmount=0;if(item.journal_entries.length>0){item.journal_entries.forEach(function(journal){if(journal.type==='debit'){item.debitAmount=Number(journal.amount)+Number(item.debitAmount);}else{item.creditAmount=Number(journal.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.Buyer.length>0){item.Buyer.forEach(function(reciept){if(reciept.type==='debit'){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(reciept.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.PBuyer.length>0){item.PBuyer.forEach(function(payment){if(payment.type==='debit'){item.debitAmount=Number(payment.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.RBuyer.length>0){item.RBuyer.forEach(function(reciept){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));});}if(item.PRBuyer.length>0){item.PRBuyer.forEach(function(payment){item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.sales_vouchers&&item.sales_vouchers.length>0){item.sales_vouchers.forEach(function(sale){item.debitAmount=Number(sale.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.purchase_vouchers.length>0){item.purchase_vouchers.forEach(function(purchase){item.creditAmount=Number(purchase.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.roundsales&&item.roundsales.length>0){item.roundsales.forEach(function(sale){if(sale.roundoff_ledger_id){if(sale.roundoff_type=="debit"||sale.roundoff_type=="Debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.roundpurchase.length>0){item.roundpurchase.forEach(function(purchase){if(purchase.roundoff_ledger_id){if(purchase.roundoff_type=="debit"||purchase.roundoff_type=="Debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.credit_vouchers.length>0){item.credit_vouchers.forEach(function(credit){item.debitAmount=Number(credit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.debit_vouchers.length>0){item.debit_vouchers.forEach(function(debit){item.debitAmount=Number(debit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.item_entries.length>0){item.item_entries.forEach(function(voucher){if(voucher.ItemVouchers){item.invoice_date=voucher.ItemVouchers.invoice_date;item.invoice_id=voucher.ItemVouchers.invoice_id<=9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/00").concat(voucher.ItemVouchers.invoice_id):voucher.ItemVouchers.invoice_id>9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/0").concat(voucher.ItemVouchers.invoice_id):"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/").concat(voucher.ItemVouchers.invoice_id);item.voucher_type='sale';}if(voucher.ItemVoucherc){item.invoice_date=voucher.ItemVoucherc.invoice_date;item.invoice_id=voucher.ItemVoucherc.invoice_id<=9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherc.invoice_id):voucher.ItemVoucherc.invoice_id>9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherc.invoice_id):"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherc.invoice_id);item.voucher_type='credit';}if(voucher.ItemVoucherd){item.invoice_date=voucher.ItemVoucherd.invoice_date;item.invoice_id=voucher.ItemVoucherd.invoice_id<=9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherd.invoice_id):voucher.ItemVoucherd.invoice_id>9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherd.invoice_id):"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherd.invoice_id);item.voucher_type='debit';}if(voucher.ItemVoucherp){item.invoice_date=voucher.ItemVoucherp.invoice_date;item.invoice_id=voucher.ItemVoucherp.invoice_id;item.voucher_type='purchase';}if(voucher.type==="Sales"||voucher.type==="sales"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}else if(voucher.type==="Purchase"||voucher.type==="purchase"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Debit"||voucher.type==="Debit"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Credit"||voucher.type==="Credit"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.vocher_entries.length>0){
//     item.vocher_entries.forEach(voucher=>{
//         if(voucher.type==="Sales" || voucher.type==="sales"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Purchase" || voucher.type==="purchase"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Debit" || voucher.type==="Debit"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.debitAmount);
//         }else if(voucher.type==="Credit" || voucher.type==="Credit"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount))+Number(item.open_amount);
//     })
// }
if(item.tax_entries.length>0){item.tax_entries.forEach(function(tax){if(tax.type==="Sales"||tax.type==="sales"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}else if(tax.type==="Purchase"||tax.type==="purchase"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Debit"||tax.type==="debit"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Credit"||tax.type==="credit"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.discountsales && item.discountsales.length>0){
//     item.discountsales.forEach(sale=>{
//         item.debitAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.creditAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountPurchases && item.discountPurchases.length>0){
//     item.discountPurchases.forEach(sale=>{
//         item.creditAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.debitAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountCredit && item.discountCredit.length>0){
//     item.discountCredit.forEach(sale=>{
//         item.debitAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.creditAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountDebit && item.discountDebit.length>0){
//     item.discountDebit.forEach(sale=>{
//         item.creditAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.debitAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
if(item.roundsales&&item.roundsales.length<0||item.roundpurchase.length<0){if(item.discountsales&&item.discountsales.length>0){item.discountsales.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountPurchases&&item.discountPurchases.length>0){item.discountPurchases.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountCredit&&item.discountCredit.length>0){item.discountCredit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountDebit&&item.discountDebit.length>0){item.discountDebit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}}if(item.open_type==="debit"){item.closeing_amount=Number(item.closeing_amount)-Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='debit';item.accounttype=item.closeing_type;}if(item.open_type==="credit"){item.closeing_amount=Number(item.closeing_amount)+Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='credit';item.accounttype=item.closeing_type;}delete item.journal_entries;delete item.reciept_vouchers;delete item.payment_vouchers;delete item.sales_vouchers;delete item.purchase_vouchers;delete item.credit_vouchers;delete item.debit_vouchers;delete item.item_entries;delete item.vocher_entries;delete item.tax_entries;delete item.Buyer;delete item.PBuyer;delete item.PRBuyer;delete item.RBuyer;totalbalnce=Number(totalbalnce)+Number(Number(item.creditAmount))-Number(Number(item.debitAmount));creditbalnce=Number(creditbalnce)+Number(item.creditAmount);debitbalnce=Number(debitbalnce)+Number(item.debitAmount);case 48:case"end":return _context22.stop();}},_callee18);}));return function(_x64){return _ref14.apply(this,arguments);};}());case 13:return _context23.abrupt("return",{totalbalnce:totalbalnce,creditbalnce:creditbalnce,debitbalnce:debitbalnce});case 16:return _context23.abrupt("return",0);case 17:_context23.next=23;break;case 19:_context23.prev=19;_context23.t0=_context23["catch"](0);console.log("getAllGroupVoucherprivious",_context23.t0);return _context23.abrupt("return",{totalbalnce:0,creditbalnce:0,debitbalnce:0});case 23:case"end":return _context23.stop();}},_callee19,null,[[0,19]]);}));return _getAllGroupVoucherprivious.apply(this,arguments);}function isCreditGroup(_x27){return _isCreditGroup.apply(this,arguments);}function _isCreditGroup(){_isCreditGroup=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee20(id){var data;return _regeneratorRuntime().wrap(function _callee20$(_context24){while(1)switch(_context24.prev=_context24.next){case 0:data=_groups["default"].creditids.find(function(item){return item==id;});if(!data){_context24.next=5;break;}return _context24.abrupt("return",true);case 5:return _context24.abrupt("return",false);case 6:case"end":return _context24.stop();}},_callee20);}));return _isCreditGroup.apply(this,arguments);}function calculationbank(_x28){return _calculationbank.apply(this,arguments);}function _calculationbank(){_calculationbank=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee21(array){var ledgerObj,balancesum,convernumber,credittotal,debittotal;return _regeneratorRuntime().wrap(function _callee21$(_context25){while(1)switch(_context25.prev=_context25.next){case 0:ledgerObj={};balancesum=0;convernumber=0;credittotal=0;debittotal=0;if(!(array.length>0)){_context25.next=23;break;}_context25.next=8;return isCreditGroup(array[0].account_group_id);case 8:if(!_context25.sent){_context25.next=15;break;}if(array[0].opening_balance=="credit"){array[0].creditAmount=array[0].amount;}else{array[0].debitAmount=array[0].amount;}_context25.next=12;return array.forEach(function(element){credittotal=Number(credittotal)+Number(element.creditAmount);debittotal=Number(debittotal)+Number(element.debitAmount);balancesum=Number(balancesum)+Number(Number(element.creditAmount<0?-1*Number(element.creditAmount):element.creditAmount)-Number(element.debitAmount<0?-1*Number(element.debitAmount):element.debitAmount));convernumber=Number(balancesum);});case 12:ledgerObj.amount=Number(credittotal)-Number(debittotal);//ledgerObj.amount =array[0].opening_balance =="credit" && Number(balancesum)<0 ? -1*Number(balancesum) : Number(balancesum)
_context25.next=19;break;case 15:if(array[0].opening_balance=="credit"){array[0].creditAmount=array[0].amount;}else{array[0].debitAmount=array[0].amount;}_context25.next=18;return array.forEach(function(element){credittotal=Number(credittotal)+Number(element.creditAmount);debittotal=Number(debittotal)+Number(element.debitAmount);balancesum=Number(balancesum)+Number(Number(element.debitAmount<0?-1*Number(element.debitAmount):element.debitAmount)-Number(element.creditAmount<0?-1*Number(element.creditAmount):element.creditAmount));convernumber=Number(balancesum);});case 18:ledgerObj.amount=Number(debittotal)-Number(credittotal);// ledgerObj.amount =array[0].opening_balance =="debit" && Number(balancesum)<0 ? -1*Number(balancesum) : Number(balancesum)
case 19:// Number(credittotal)-Number(debittotal):-1*Number(credittotal)-Number(debittotal):array[0].account_group_type=="credit"?Number(debittotal)-Number(credittotal):-1*Number(debittotal)-Number(credittotal);
// array[0].account_group_type == array[0].opening_balance ? convernumber>0?convernumber:-1*convernumber:  array[0].account_group_type=="credit"?convernumber>0? convernumber: -1*convernumber : convernumber>0? -1*convernumber: convernumber;
ledgerObj.name=array[0].name;// console.log("array[0].account_group_type ledgerObj", array[0].account_group_type , array[0].opening_balance  ,convernumber)
return _context25.abrupt("return",ledgerObj);case 23:return _context25.abrupt("return",[]);case 24:case"end":return _context25.stop();}},_callee21);}));return _calculationbank.apply(this,arguments);}function calculationGroup(_x29){return _calculationGroup.apply(this,arguments);}function _calculationGroup(){_calculationGroup=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee22(array){var ledgerObj,convernumber;return _regeneratorRuntime().wrap(function _callee22$(_context26){while(1)switch(_context26.prev=_context26.next){case 0:// return array;
ledgerObj={};// let balancesum = 0;
convernumber=0;if(!(array.length>0)){_context26.next=12;break;}_context26.next=5;return array.forEach(function(element){if(element.ishead&&element.ismain){// balancesum = Number(balancesum) + Number(Number(element.debitAmount) - Number(element.creditAmount));
convernumber=element.closeing_amount;}});case 5:ledgerObj.total_amount=convernumber;ledgerObj.name=array[0].name;ledgerObj.invoice_date=array[0].invoice_date;ledgerObj.ledger_id=array[0].ledger_id;return _context26.abrupt("return",ledgerObj);case 12:return _context26.abrupt("return",[]);case 13:case"end":return _context26.stop();}},_callee22);}));return _calculationGroup.apply(this,arguments);}function oldyearPriceItem(_x30,_x31){return _oldyearPriceItem.apply(this,arguments);}function _oldyearPriceItem(){_oldyearPriceItem=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee23(data,res){var itemEnteriesVoucher,stockitemEnteriesVoucher,mainArray,itemArray,group,itemgroup,oldPrice,_i10,_Object$entries10,_Object$entries10$_i,key,value,updatedata,availableKeys,_loop5,_i11,_Object$entries11;return _regeneratorRuntime().wrap(function _callee23$(_context28){while(1)switch(_context28.prev=_context28.next){case 0:_context28.prev=0;stockitemEnteriesVoucher=[];_context28.next=4;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[_defineProperty({},Op.or,[{type:'Purchase'},{type:'Debit'}]),{company_id:data.company_id},{invoice_date:_defineProperty({},Op.lt,data.start_date)}]),include:[{model:_items["default"],as:"itemone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 4:itemEnteriesVoucher=_context28.sent;_context28.next=7;return _item_stock_voucher_entries["default"].findAll({where:_defineProperty({},Op.and,[{type:'Debit'},{company_id:data.company_id},{invoice_date:_defineProperty({},Op.lt,data.start_date)}]),include:[{model:_items["default"],as:"itemsone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 7:stockitemEnteriesVoucher=_context28.sent;mainArray=[];_context28.next=11;return _items["default"].findAll({where:{company_id:data.company_id}});case 11:itemArray=_context28.sent;_context28.next=14;return(0,_itemEntries.decreptionItem)(itemArray,'array',data.data.email);case 14:itemArray=_context28.sent;_context28.next=17;return(0,_itemEntries.decreptionItem)(itemEnteriesVoucher,'array',data.data.email);case 17:itemEnteriesVoucher=_context28.sent;_context28.next=20;return(0,_itemEntries.decreptionItem)(stockitemEnteriesVoucher,'array',data.data.email);case 20:stockitemEnteriesVoucher=_context28.sent;// purchaseVoucher = await decreptionItem(purchaseVoucher, 'array', data.data.email);
// creditVoucher = await decreptionItem(creditVoucher, 'array', data.data.email);
// debitVoucher = await decreptionItem(debitVoucher, 'array', data.data.email);
// return {stockitemEnteriesVoucher:stockitemEnteriesVoucher, itemEnteriesVoucher:itemEnteriesVoucher}
if(itemEnteriesVoucher.length>0){itemEnteriesVoucher.map(function(item){mainArray.push(item);});}if(stockitemEnteriesVoucher.length>0){stockitemEnteriesVoucher.map(function(item){item.itemone=item.itemsone;delete item.itemsone;mainArray.push(item);});}group={};_context28.next=26;return itemArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});case 26:itemgroup=_context28.sent;if(mainArray.length>0){group=mainArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});}else{group=itemArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});}oldPrice={};_i10=0,_Object$entries10=Object.entries(group);case 30:if(!(_i10<_Object$entries10.length)){_context28.next=39;break;}_Object$entries10$_i=_slicedToArray(_Object$entries10[_i10],2),key=_Object$entries10$_i[0],value=_Object$entries10$_i[1];_context28.next=34;return(0,_arraySort["default"])(value,'updated_date');case 34:updatedata=_context28.sent;oldPrice[key]=Number(updatedata[updatedata.length-1].rate)?Number(updatedata[updatedata.length-1].rate):Number(updatedata[updatedata.length-1].price);case 36:_i10++;_context28.next=30;break;case 39:_context28.next=41;return Object.keys(oldPrice);case 41:availableKeys=_context28.sent;_loop5=/*#__PURE__*/_regeneratorRuntime().mark(function _loop5(){var _Object$entries11$_i,key,value,find,_updatedata2;return _regeneratorRuntime().wrap(function _loop5$(_context27){while(1)switch(_context27.prev=_context27.next){case 0:_Object$entries11$_i=_slicedToArray(_Object$entries11[_i11],2),key=_Object$entries11$_i[0],value=_Object$entries11$_i[1];find=availableKeys.find(function(k){return k==key;});if(find){_context27.next=7;break;}_context27.next=5;return(0,_arraySort["default"])(value,'updated_date');case 5:_updatedata2=_context27.sent;oldPrice[key]=Number(_updatedata2[_updatedata2.length-1].rate)?Number(_updatedata2[_updatedata2.length-1].rate):0;case 7:case"end":return _context27.stop();}},_loop5);});_i11=0,_Object$entries11=Object.entries(itemgroup);case 44:if(!(_i11<_Object$entries11.length)){_context28.next=49;break;}return _context28.delegateYield(_loop5(),"t0",46);case 46:_i11++;_context28.next=44;break;case 49:return _context28.abrupt("return",oldPrice);case 52:_context28.prev=52;_context28.t1=_context28["catch"](0);return _context28.abrupt("return",{statusCode:res.statusCode,success:false,error:_context28.t1,message:"Something went wrong!"});case 55:case"end":return _context28.stop();}},_callee23,null,[[0,52]]);}));return _oldyearPriceItem.apply(this,arguments);}exports.getbankACashAccountData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(ledgerid,accountgroupid,data,res){var recieptVoucher,paymentVoucher,saleVoucher,purchaseVoucher,ledger,_invoice_date,_invoice_date2,_invoice_date3,_invoice_date4,oldBalance,array,i,mainArray,lastObj,calData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;purchaseVoucher=[];_context.next=4;return _ledger["default"].findOne({where:{uid:ledgerid,company_id:data.company_id},include:[{model:_accountGroup["default"]}]});case 4:ledger=_context.sent;if(!(ledger&&ledger.dataValues.id)){_context.next=237;break;}ledgerid=ledgerid;_context.next=9;return(0,_oldBalance.BankOldBlance)(data);case 9:oldBalance=_context.sent;_context.next=12;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:ledgerid},{invoice_date:(_invoice_date={},_defineProperty(_invoice_date,Op.gte,data.start_date),_defineProperty(_invoice_date,Op.lte,data.end_date),_invoice_date)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 12:recieptVoucher=_context.sent;_context.next=15;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:ledgerid},{invoice_date:(_invoice_date2={},_defineProperty(_invoice_date2,Op.gte,data.start_date),_defineProperty(_invoice_date2,Op.lte,data.end_date),_invoice_date2)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 15:paymentVoucher=_context.sent;_context.next=18;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:ledgerid},{invoice_date:(_invoice_date3={},_defineProperty(_invoice_date3,Op.gte,data.start_date),_defineProperty(_invoice_date3,Op.lte,data.end_date),_invoice_date3)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 18:saleVoucher=_context.sent;_context.next=21;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:ledgerid},{invoice_date:(_invoice_date4={},_defineProperty(_invoice_date4,Op.gte,data.start_date),_defineProperty(_invoice_date4,Op.lte,data.end_date),_invoice_date4)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 21:purchaseVoucher=_context.sent;_context.next=24;return(0,_ledger2.decreption)(ledger,'object',data.data.email);case 24:ledger=_context.sent;if(!(!ledger.dataValues.tax_key&&!ledger.dataValues.sale_key)){_context.next=38;break;}_context.next=28;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',data.data.email);case 28:recieptVoucher=_context.sent;_context.next=31;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',data.data.email);case 31:paymentVoucher=_context.sent;_context.next=34;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',data.data.email);case 34:purchaseVoucher=_context.sent;_context.next=37;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',data.data.email);case 37:saleVoucher=_context.sent;case 38:_context.next=40;return[];case 40:array=_context.sent;if(!(ledger&&ledger.dataValues.id)){_context.next=70;break;}if(!(ledger.dataValues.opening_balance==='Debit'||ledger.dataValues.opening_balance==='debit')){_context.next=53;break;}_context.next=45;return Number(ledger.dataValues.amount);case 45:_context.t0=_context.sent;_context.t1=Number(oldBalance&&oldBalance.debit?oldBalance.debit:0);ledger.dataValues.debitAmount=_context.t0+_context.t1;_context.next=50;return 0;case 50:ledger.dataValues.creditAmount=_context.sent;_context.next=61;break;case 53:_context.next=55;return 0;case 55:ledger.dataValues.debitAmount=_context.sent;_context.next=58;return Number(ledger.dataValues.amount);case 58:_context.t2=_context.sent;_context.t3=Number(oldBalance&&oldBalance.credit?oldBalance.credit:0);ledger.dataValues.creditAmount=_context.t2+_context.t3;case 61:_context.next=63;return true;case 63:ledger.dataValues.open=_context.sent;ledger.dataValues.voucher_type='';ledger.dataValues.voucher_number='';ledger.dataValues.invoice_id='';ledger.dataValues.account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context.next=70;return array.push(ledger.dataValues);case 70:if(!recieptVoucher){_context.next=116;break;}i=0;case 72:if(!(i<recieptVoucher.length)){_context.next=116;break;}_context.next=75;return recieptVoucher[i].type;case 75:_context.t4=_context.sent;if(!(_context.t4==='debit')){_context.next=85;break;}_context.next=79;return 0;case 79:recieptVoucher[i].debitAmount=_context.sent;_context.next=82;return recieptVoucher[i].total_amount;case 82:recieptVoucher[i].creditAmount=_context.sent;_context.next=91;break;case 85:_context.next=87;return recieptVoucher[i].total_amount;case 87:recieptVoucher[i].debitAmount=_context.sent;_context.next=90;return 0;case 90:recieptVoucher[i].creditAmount=_context.sent;case 91:_context.next=93;return recieptVoucher[i].ReciptBuyer;case 93:recieptVoucher[i].ledger=_context.sent;delete recieptVoucher[i].ReciptBuyer;_context.next=97;return'reciept';case 97:recieptVoucher[i].voucher_type=_context.sent;_context.next=100;return recieptVoucher[i].id;case 100:recieptVoucher[i].voucher_number=_context.sent;_context.next=103;return recieptVoucher[i].invoice_id;case 103:_context.t5=_context.sent;if(!(_context.t5<=9)){_context.next=108;break;}_context.t6="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context.next=109;break;case 108:_context.t6=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 109:recieptVoucher[i].invoice_id=_context.t6;recieptVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context.next=113;return array.push(recieptVoucher[i]);case 113:i++;_context.next=72;break;case 116:if(!paymentVoucher){_context.next=162;break;}i=0;case 118:if(!(i<paymentVoucher.length)){_context.next=162;break;}_context.next=121;return paymentVoucher[i].type;case 121:_context.t7=_context.sent;if(!(_context.t7==='debit')){_context.next=131;break;}_context.next=125;return 0;case 125:paymentVoucher[i].debitAmount=_context.sent;_context.next=128;return paymentVoucher[i].total_amount;case 128:paymentVoucher[i].creditAmount=_context.sent;_context.next=137;break;case 131:_context.next=133;return paymentVoucher[i].total_amount;case 133:paymentVoucher[i].debitAmount=_context.sent;_context.next=136;return 0;case 136:paymentVoucher[i].creditAmount=_context.sent;case 137:_context.next=139;return paymentVoucher[i].PaymentBuyer;case 139:paymentVoucher[i].ledger=_context.sent;delete paymentVoucher[i].PaymentBuyer;_context.next=143;return'payment';case 143:paymentVoucher[i].voucher_type=_context.sent;_context.next=146;return paymentVoucher[i].id;case 146:paymentVoucher[i].voucher_number=_context.sent;_context.next=149;return paymentVoucher[i].invoice_id;case 149:_context.t8=_context.sent;if(!(_context.t8<=9)){_context.next=154;break;}_context.t9="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context.next=155;break;case 154:_context.t9=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 155:paymentVoucher[i].invoice_id=_context.t9;paymentVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context.next=159;return array.push(paymentVoucher[i]);case 159:i++;_context.next=118;break;case 162:if(!purchaseVoucher){_context.next=190;break;}i=0;case 164:if(!(i<purchaseVoucher.length)){_context.next=190;break;}_context.next=167;return 0;case 167:purchaseVoucher[i].debitAmount=_context.sent;_context.next=170;return purchaseVoucher[i].total_amount;case 170:purchaseVoucher[i].creditAmount=_context.sent;_context.next=173;return purchaseVoucher[i].PurchaseLedger;case 173:purchaseVoucher[i].ledger=_context.sent;delete purchaseVoucher[i].PurchaseLedger;_context.next=177;return'purchase';case 177:purchaseVoucher[i].voucher_type=_context.sent;_context.next=180;return purchaseVoucher[i].id;case 180:purchaseVoucher[i].voucher_number=_context.sent;_context.next=183;return"".concat(purchaseVoucher[i].current_year.toString().substr(-2)+"-"+purchaseVoucher[i].end_year.toString().substr(-2),"/").concat(purchaseVoucher[i].invoice_id);case 183:purchaseVoucher[i].invoice_id=_context.sent;purchaseVoucher[i].account_group_type='debit';_context.next=187;return array.push(purchaseVoucher[i]);case 187:i++;_context.next=164;break;case 190:if(!saleVoucher){_context.next=222;break;}i=0;case 192:if(!(i<saleVoucher.length)){_context.next=222;break;}_context.next=195;return saleVoucher[i].total_amount;case 195:saleVoucher[i].debitAmount=_context.sent;saleVoucher[i].creditAmount=0;_context.next=199;return saleVoucher[i].SalesLedger;case 199:saleVoucher[i].ledger=_context.sent;delete saleVoucher[i].SalesLedger;_context.next=203;return'sale';case 203:saleVoucher[i].voucher_type=_context.sent;_context.next=206;return saleVoucher[i].id;case 206:saleVoucher[i].voucher_number=_context.sent;_context.next=209;return saleVoucher[i].invoice_id;case 209:_context.t10=_context.sent;if(!(_context.t10<=9)){_context.next=214;break;}_context.t11="".concat(saleVoucher[i].current_year.toString().substr(-2)+"-"+saleVoucher[i].end_year.toString().substr(-2),"/00").concat(saleVoucher[i].invoice_id);_context.next=215;break;case 214:_context.t11=saleVoucher[i].invoice_id>9?"".concat(saleVoucher[i].current_year.toString().substr(-2)+"-"+saleVoucher[i].end_year.toString().substr(-2),"/0").concat(saleVoucher[i].invoice_id):"".concat(saleVoucher[i].current_year.toString().substr(-2)+"-"+saleVoucher[i].end_year.toString().substr(-2),"/").concat(saleVoucher[i].invoice_id);case 215:saleVoucher[i].invoice_id=_context.t11;saleVoucher[i].account_group_type='credit';_context.next=219;return array.push(saleVoucher[i]);case 219:i++;_context.next=192;break;case 222:_context.next=224;return(0,_arraySort["default"])(array,'invoice_date');case 224:mainArray=_context.sent;_context.next=227;return mainArray[mainArray.length-1];case 227:lastObj=_context.sent;_context.next=230;return mainArray.pop(mainArray.length-1);case 230:mainArray.unshift(lastObj);_context.next=233;return calculationbank(mainArray);case 233:calData=_context.sent;return _context.abrupt("return",calData);case 237:return _context.abrupt("return",[]);case 238:_context.next=243;break;case 240:_context.prev=240;_context.t12=_context["catch"](0);return _context.abrupt("return",{statusCode:res.statusCode,success:false,error:_context.t12,message:"Something went wrong!"});case 243:case"end":return _context.stop();}},_callee,null,[[0,240]]);}));return function(_x32,_x33,_x34,_x35){return _ref.apply(this,arguments);};}();exports.getRJPCalculationData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(ledgerid,accountgroupid,data,res){var journalVoucher,saleVoucher,purchaseVoucher,creditVoucher,debitVoucher,recieptVoucher,paymentVoucher,reciverrecieptVoucher,reciverpaymentVoucher,ledger,_invoice_date30,_invoice_date31,_invoice_date5,_invoice_date6,_invoice_date7,_invoice_date8,_invoice_date9,_invoice_date10,_invoice_date11,_invoice_date12,_invoice_date13,_invoice_date14,_invoice_date15,_invoice_date16,_invoice_date17,_invoice_date18,_invoice_date19,_invoice_date20,_invoice_date21,_invoice_date22,_invoice_date23,_invoice_date24,_invoice_date25,_invoice_date26,_invoice_date27,_invoice_date28,_invoice_date29,array,totalcalculate_openingblance,i,salearray,s,findSales,purchasearray,_findSales,mainArray,lastObj,calData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;reciverpaymentVoucher=[];_context2.next=4;return _ledger["default"].findOne({where:{uid:ledgerid||null,company_id:data.company_id},include:[{model:_accountGroup["default"]}]});case 4:ledger=_context2.sent;if(!(ledger&&ledger.dataValues.id)){_context2.next=1157;break;}if(!ledger.dataValues.tax_key){_context2.next=30;break;}_context2.next=9;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledgerid},{type:'Sales'},{invoice_date:(_invoice_date5={},_defineProperty(_invoice_date5,Op.gte,data.start_date),_defineProperty(_invoice_date5,Op.lte,data.end_date),_invoice_date5)}]),include:[{model:_saleVoucher["default"],where:{company_id:data.company_id,invoice_date:(_invoice_date6={},_defineProperty(_invoice_date6,Op.gte,data.start_date),_defineProperty(_invoice_date6,Op.lte,data.end_date),_invoice_date6)},as:'tax',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 9:saleVoucher=_context2.sent;_context2.next=12;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledgerid},{type:'Purchase'},{invoice_date:(_invoice_date7={},_defineProperty(_invoice_date7,Op.gte,data.start_date),_defineProperty(_invoice_date7,Op.lte,data.end_date),_invoice_date7)}]),include:[{model:_purchaseVoucher["default"],where:{company_id:data.company_id,invoice_date:(_invoice_date8={},_defineProperty(_invoice_date8,Op.gte,data.start_date),_defineProperty(_invoice_date8,Op.lte,data.end_date),_invoice_date8)},as:'taxp',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 12:purchaseVoucher=_context2.sent;_context2.next=15;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledgerid},{type:'Debit'},{invoice_date:(_invoice_date9={},_defineProperty(_invoice_date9,Op.gte,data.start_date),_defineProperty(_invoice_date9,Op.lte,data.end_date),_invoice_date9)}]),include:[{model:_creditVoucher["default"],required:true,where:{company_id:data.company_id,invoice_date:(_invoice_date10={},_defineProperty(_invoice_date10,Op.gte,data.start_date),_defineProperty(_invoice_date10,Op.lte,data.end_date),_invoice_date10)},as:'taxc',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 15:creditVoucher=_context2.sent;_context2.next=18;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledgerid},{type:'Credit'},{invoice_date:(_invoice_date11={},_defineProperty(_invoice_date11,Op.gte,data.start_date),_defineProperty(_invoice_date11,Op.lte,data.end_date),_invoice_date11)}]),include:[{model:_debitVoucher["default"],required:true,where:{company_id:data.company_id,invoice_date:(_invoice_date12={},_defineProperty(_invoice_date12,Op.gte,data.start_date),_defineProperty(_invoice_date12,Op.lte,data.end_date),_invoice_date12)},as:'taxd',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 18:debitVoucher=_context2.sent;_context2.next=21;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{company_id:data.company_id},{invoice_date:(_invoice_date13={},_defineProperty(_invoice_date13,Op.gte,data.start_date),_defineProperty(_invoice_date13,Op.lte,data.end_date),_invoice_date13)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 21:journalVoucher=_context2.sent;_context2.next=24;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date14={},_defineProperty(_invoice_date14,Op.gte,data.start_date),_defineProperty(_invoice_date14,Op.lte,data.end_date),_invoice_date14)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 24:recieptVoucher=_context2.sent;_context2.next=27;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date15={},_defineProperty(_invoice_date15,Op.gte,data.start_date),_defineProperty(_invoice_date15,Op.lte,data.end_date),_invoice_date15)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 27:paymentVoucher=_context2.sent;_context2.next=75;break;case 30:if(!ledger.dataValues.sale_key){_context2.next=54;break;}_context2.next=33;return _voucherInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{type:'Sales'},{invoice_date:(_invoice_date16={},_defineProperty(_invoice_date16,Op.gte,data.start_date),_defineProperty(_invoice_date16,Op.lte,data.end_date),_invoice_date16)}]),include:[{model:_saleVoucher["default"],as:'Vouchers',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 33:saleVoucher=_context2.sent;_context2.next=36;return _voucherInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{type:'Purchase'},{invoice_date:(_invoice_date17={},_defineProperty(_invoice_date17,Op.gte,data.start_date),_defineProperty(_invoice_date17,Op.lte,data.end_date),_invoice_date17)}]),include:[{model:_purchaseVoucher["default"],as:'Voucherp',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 36:purchaseVoucher=_context2.sent;_context2.next=39;return _voucherInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{type:'Debit'},{invoice_date:(_invoice_date18={},_defineProperty(_invoice_date18,Op.gte,data.start_date),_defineProperty(_invoice_date18,Op.lte,data.end_date),_invoice_date18)}]),include:[{model:_creditVoucher["default"],as:'Voucherc',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 39:creditVoucher=_context2.sent;_context2.next=42;return _voucherInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{type:'ow1kac6rc1y'},{invoice_date:(_invoice_date19={},_defineProperty(_invoice_date19,Op.gte,data.start_date),_defineProperty(_invoice_date19,Op.lte,data.end_date),_invoice_date19)}]),include:[{model:_debitVoucher["default"],as:'Voucherd',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 42:debitVoucher=_context2.sent;_context2.next=45;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{company_id:data.company_id},{invoice_date:(_invoice_date20={},_defineProperty(_invoice_date20,Op.gte,data.start_date),_defineProperty(_invoice_date20,Op.lte,data.end_date),_invoice_date20)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 45:journalVoucher=_context2.sent;_context2.next=48;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date21={},_defineProperty(_invoice_date21,Op.gte,data.start_date),_defineProperty(_invoice_date21,Op.lte,data.end_date),_invoice_date21)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 48:recieptVoucher=_context2.sent;_context2.next=51;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date22={},_defineProperty(_invoice_date22,Op.gte,data.start_date),_defineProperty(_invoice_date22,Op.lte,data.end_date),_invoice_date22)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 51:paymentVoucher=_context2.sent;_context2.next=75;break;case 54:_context2.next=56;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{company_id:data.company_id},{invoice_date:(_invoice_date23={},_defineProperty(_invoice_date23,Op.gte,data.start_date),_defineProperty(_invoice_date23,Op.lte,data.end_date),_invoice_date23)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 56:journalVoucher=_context2.sent;_context2.next=59;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:ledgerid},{invoice_date:(_invoice_date24={},_defineProperty(_invoice_date24,Op.gte,data.start_date),_defineProperty(_invoice_date24,Op.lte,data.end_date),_invoice_date24)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 59:saleVoucher=_context2.sent;_context2.next=62;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:ledgerid},{invoice_date:(_invoice_date25={},_defineProperty(_invoice_date25,Op.gte,data.start_date),_defineProperty(_invoice_date25,Op.lte,data.end_date),_invoice_date25)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 62:purchaseVoucher=_context2.sent;_context2.next=65;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:ledgerid},{invoice_date:(_invoice_date26={},_defineProperty(_invoice_date26,Op.gte,data.start_date),_defineProperty(_invoice_date26,Op.lte,data.end_date),_invoice_date26)}]),include:[{model:_ledger["default"],as:'CreditBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 65:creditVoucher=_context2.sent;_context2.next=68;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:ledgerid},{invoice_date:(_invoice_date27={},_defineProperty(_invoice_date27,Op.gte,data.start_date),_defineProperty(_invoice_date27,Op.lte,data.end_date),_invoice_date27)}]),include:[{model:_ledger["default"],as:'DebitBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 68:debitVoucher=_context2.sent;_context2.next=71;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date28={},_defineProperty(_invoice_date28,Op.gte,data.start_date),_defineProperty(_invoice_date28,Op.lte,data.end_date),_invoice_date28)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 71:recieptVoucher=_context2.sent;_context2.next=74;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date29={},_defineProperty(_invoice_date29,Op.gte,data.start_date),_defineProperty(_invoice_date29,Op.lte,data.end_date),_invoice_date29)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 74:paymentVoucher=_context2.sent;case 75:_context2.next=77;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:ledgerid},{invoice_date:(_invoice_date30={},_defineProperty(_invoice_date30,Op.gte,data.start_date),_defineProperty(_invoice_date30,Op.lte,data.end_date),_invoice_date30)}]),include:[{model:_ledger["default"],as:'ReciptReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 77:reciverrecieptVoucher=_context2.sent;_context2.next=80;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:ledgerid},{invoice_date:(_invoice_date31={},_defineProperty(_invoice_date31,Op.gte,data.start_date),_defineProperty(_invoice_date31,Op.lte,data.end_date),_invoice_date31)}]),include:[{model:_ledger["default"],as:'PaymentReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 80:reciverpaymentVoucher=_context2.sent;_context2.next=83;return(0,_ledger2.decreption)(ledger,'object',data.data.email);case 83:ledger=_context2.sent;_context2.next=86;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',data.data.email);case 86:journalVoucher=_context2.sent;_context2.next=89;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',data.data.email);case 89:recieptVoucher=_context2.sent;_context2.next=92;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',data.data.email);case 92:paymentVoucher=_context2.sent;_context2.next=95;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',data.data.email);case 95:saleVoucher=_context2.sent;_context2.next=98;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',data.data.email);case 98:purchaseVoucher=_context2.sent;_context2.next=101;return(0,_creditvoucher.decreptionCredit)(creditVoucher,'array',data.data.email);case 101:creditVoucher=_context2.sent;_context2.next=104;return(0,_debitvoucher.decreptionDebit)(debitVoucher,'array',data.data.email);case 104:debitVoucher=_context2.sent;_context2.next=107;return(0,_receiptvoucher.decreptionReceipt)(reciverrecieptVoucher,'array',data.data.email);case 107:reciverrecieptVoucher=_context2.sent;_context2.next=110;return(0,_paymentvoucher.decreptionPayment)(reciverpaymentVoucher,'array',data.data.email);case 110:reciverpaymentVoucher=_context2.sent;_context2.next=113;return[];case 113:array=_context2.sent;if(!(ledger&&ledger.dataValues.id)){_context2.next=140;break;}if(!(ledger.dataValues.opening_balance==='Debit'||ledger.dataValues.opening_balance==='debit')){_context2.next=124;break;}_context2.next=118;return ledger.dataValues.amount;case 118:ledger.dataValues.debitAmount=_context2.sent;_context2.next=121;return 0;case 121:ledger.dataValues.creditAmount=_context2.sent;_context2.next=130;break;case 124:_context2.next=126;return 0;case 126:ledger.dataValues.debitAmount=_context2.sent;_context2.next=129;return ledger.dataValues.amount;case 129:ledger.dataValues.creditAmount=_context2.sent;case 130:_context2.next=132;return true;case 132:ledger.dataValues.open=_context2.sent;ledger.dataValues.voucher_type='';ledger.dataValues.voucher_number='';ledger.dataValues.invoice_id='';ledger.dataValues.account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';ledger.dataValues.account_group_id=ledger.dataValues.account_group_id;_context2.next=140;return array.push(ledger.dataValues);case 140:totalcalculate_openingblance={};_context2.next=143;return checkValid(ledger.dataValues.account_group_id);case 143:if(!_context2.sent){_context2.next=149;break;}_context2.next=146;return getAllLedgerVouchercurrent(data.start_date,data.end_date,ledgerid,data.company_id,ledger.dataValues.creditAmount,ledger.dataValues.debitAmount,data.data.email);case 146:totalcalculate_openingblance=_context2.sent;_context2.next=152;break;case 149:_context2.next=151;return getAllLedgerVoucherprivious(data.start_date,data.end_date,ledgerid,data.company_id,ledger.dataValues.creditAmount,ledger.dataValues.debitAmount,data.data.email);case 151:totalcalculate_openingblance=_context2.sent;case 152:console.log("totalcalculate_openingblance",totalcalculate_openingblance);if(!(totalcalculate_openingblance>=0)){_context2.next=162;break;}_context2.next=156;return totalcalculate_openingblance.toString();case 156:ledger.dataValues.debitAmount=_context2.sent;_context2.next=159;return 0;case 159:ledger.dataValues.creditAmount=_context2.sent;_context2.next=168;break;case 162:_context2.next=164;return 0;case 164:ledger.dataValues.debitAmount=_context2.sent;_context2.next=167;return totalcalculate_openingblance.toString();case 167:ledger.dataValues.creditAmount=_context2.sent;case 168:if(!(journalVoucher&&journalVoucher.length>0)){_context2.next=217;break;}i=0;case 170:if(!(i<journalVoucher.length)){_context2.next=217;break;}_context2.next=173;return journalVoucher[i].type;case 173:_context2.t0=_context2.sent;if(!(_context2.t0==='debit')){_context2.next=183;break;}_context2.next=177;return journalVoucher[i].amount;case 177:journalVoucher[i].debitAmount=_context2.sent;_context2.next=180;return 0;case 180:journalVoucher[i].creditAmount=_context2.sent;_context2.next=189;break;case 183:_context2.next=185;return 0;case 185:journalVoucher[i].debitAmount=_context2.sent;_context2.next=188;return journalVoucher[i].amount;case 188:journalVoucher[i].creditAmount=_context2.sent;case 189:_context2.next=191;return journalVoucher[i].Voucher.invoice_date;case 191:journalVoucher[i].invoice_date=_context2.sent;_context2.next=194;return'journal';case 194:journalVoucher[i].voucher_type=_context2.sent;_context2.next=197;return journalVoucher[i].Voucher.id;case 197:journalVoucher[i].voucher_number=_context2.sent;_context2.next=200;return journalVoucher[i].Voucher.invoice_id;case 200:_context2.t1=_context2.sent;if(!(_context2.t1<=9)){_context2.next=205;break;}_context2.t2="".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(journalVoucher[i].Voucher.invoice_id);_context2.next=206;break;case 205:_context2.t2=journalVoucher[i].Voucher.invoice_id>9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(journalVoucher[i].Voucher.invoice_id):"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(journalVoucher[i].Voucher.invoice_id);case 206:journalVoucher[i].invoice_id=_context2.t2;journalVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context2.next=210;return journalVoucher[i].VoucherLedger;case 210:journalVoucher[i].ledger=_context2.sent;delete journalVoucher[i].VoucherLedger;_context2.next=214;return array.push(journalVoucher[i]);case 214:i++;_context2.next=170;break;case 217:if(!(saleVoucher&&saleVoucher.length>0)){_context2.next=459;break;}salearray=[];s=0;case 220:if(!(s<saleVoucher.length)){_context2.next=459;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context2.next=268;break;}_context2.next=224;return'sale';case 224:saleVoucher[s].voucher_type=_context2.sent;_context2.next=227;return saleVoucher[s].RoundOff;case 227:saleVoucher[s].ledger=_context2.sent;_context2.next=230;return{};case 230:saleVoucher[s].Voucher=_context2.sent;saleVoucher[s].type=saleVoucher[s].roundoff_type;_context2.next=234;return saleVoucher[s].roundoff_type;case 234:_context2.t3=_context2.sent;if(!(_context2.t3=="debit")){_context2.next=239;break;}_context2.t4=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context2.next=240;break;case 239:_context2.t4=0;case 240:saleVoucher[s].debitAmount=_context2.t4;_context2.next=243;return saleVoucher[s].roundoff_type;case 243:_context2.t5=_context2.sent;if(!(_context2.t5=="credit")){_context2.next=248;break;}_context2.t6=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context2.next=249;break;case 248:_context2.t6=0;case 249:saleVoucher[s].creditAmount=_context2.t6;saleVoucher[s].amount=saleVoucher[s].roundoff_value;_context2.next=253;return saleVoucher[s].id;case 253:saleVoucher[s].voucher_number=_context2.sent;_context2.next=256;return saleVoucher[s].invoice_id;case 256:_context2.t7=_context2.sent;if(!(_context2.t7<=9)){_context2.next=261;break;}_context2.t8="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context2.next=262;break;case 261:_context2.t8=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(ssaleVoucher[s].invoice_id);case 262:saleVoucher[s].invoice_id=_context2.t8;delete saleVoucher[s].RoundOff;_context2.next=266;return array.push(saleVoucher[s]);case 266:_context2.next=456;break;case 268:if(!ledger.dataValues.sale_key){_context2.next=375;break;}if(!(salearray.length>0)){_context2.next=326;break;}_context2.next=272;return salearray.find(function(it){return saleVoucher[s].Voucheris&&it.invoice_idold==saleVoucher[s].Voucheris.invoice_id;});case 272:findSales=_context2.sent;if(!(findSales&&findSales.Voucher)){_context2.next=276;break;}_context2.next=324;break;case 276:_context2.next=278;return'sale';case 278:saleVoucher[s].voucher_type=_context2.sent;if(!saleVoucher[s].Voucheris){_context2.next=286;break;}_context2.next=282;return saleVoucher[s].Voucheris.SalesLedger;case 282:saleVoucher[s].ledger=_context2.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context2.next=287;break;case 286:saleVoucher[s].ledger={};case 287:_context2.next=289;return saleVoucher[s].Voucheris;case 289:if(!_context2.sent){_context2.next=293;break;}_context2.t9=saleVoucher[s].Voucheris;_context2.next=294;break;case 293:_context2.t9={};case 294:saleVoucher[s].Voucher=_context2.t9;saleVoucher[s].type='credit';_context2.next=298;return 0;case 298:saleVoucher[s].debitAmount=_context2.sent;_context2.next=301;return saleVoucher[s].total_amount;case 301:saleVoucher[s].creditAmount=_context2.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context2.next=305;return saleVoucher[s].Voucheris;case 305:if(!_context2.sent){_context2.next=309;break;}_context2.t10=saleVoucher[s].Voucheris.id;_context2.next=310;break;case 309:_context2.t10='';case 310:saleVoucher[s].voucher_number=_context2.t10;_context2.next=313;return saleVoucher[s].Voucheris;case 313:if(!_context2.sent){_context2.next=317;break;}_context2.t11=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context2.next=318;break;case 317:_context2.t11='';case 318:saleVoucher[s].invoice_id=_context2.t11;delete saleVoucher[s].Voucheris;_context2.next=322;return salearray.push(saleVoucher[s]);case 322:_context2.next=324;return array.push(saleVoucher[s]);case 324:_context2.next=373;break;case 326:_context2.next=328;return'sale';case 328:saleVoucher[s].voucher_type=_context2.sent;if(!saleVoucher[s].Voucheris){_context2.next=336;break;}_context2.next=332;return saleVoucher[s].Voucheris.SalesLedger;case 332:saleVoucher[s].ledger=_context2.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context2.next=337;break;case 336:saleVoucher[s].ledger={};case 337:_context2.next=339;return saleVoucher[s].Voucheris;case 339:if(!_context2.sent){_context2.next=343;break;}_context2.t12=saleVoucher[s].Voucheris;_context2.next=344;break;case 343:_context2.t12={};case 344:saleVoucher[s].Voucher=_context2.t12;saleVoucher[s].type='credit';_context2.next=348;return 0;case 348:saleVoucher[s].debitAmount=_context2.sent;_context2.next=351;return saleVoucher[s].total_amount;case 351:saleVoucher[s].creditAmount=_context2.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context2.next=355;return saleVoucher[s].Voucheris;case 355:if(!_context2.sent){_context2.next=359;break;}_context2.t13=saleVoucher[s].Voucheris.id;_context2.next=360;break;case 359:_context2.t13='';case 360:saleVoucher[s].voucher_number=_context2.t13;_context2.next=363;return saleVoucher[s].Voucheris;case 363:if(!_context2.sent){_context2.next=367;break;}_context2.t14=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context2.next=368;break;case 367:_context2.t14='';case 368:saleVoucher[s].invoice_id=_context2.t14;_context2.next=371;return salearray.push(saleVoucher[s]);case 371:_context2.next=373;return array.push(saleVoucher[s]);case 373:_context2.next=456;break;case 375:if(!ledger.dataValues.tax_key){_context2.next=424;break;}_context2.next=378;return'sale';case 378:saleVoucher[s].voucher_type=_context2.sent;if(!saleVoucher[s].tax){_context2.next=386;break;}_context2.next=382;return saleVoucher[s].tax.SalesLedger;case 382:saleVoucher[s].ledger=_context2.sent;delete saleVoucher[s].tax.SalesLedger;_context2.next=387;break;case 386:saleVoucher[s].ledger={};case 387:_context2.next=389;return saleVoucher[s].tax;case 389:if(!_context2.sent){_context2.next=393;break;}_context2.t15=saleVoucher[s].tax;_context2.next=394;break;case 393:_context2.t15={};case 394:saleVoucher[s].Voucher=_context2.t15;saleVoucher[s].type='credit';_context2.next=398;return 0;case 398:saleVoucher[s].debitAmount=_context2.sent;_context2.next=401;return saleVoucher[s].amount;case 401:saleVoucher[s].creditAmount=_context2.sent;saleVoucher[s].amount=saleVoucher[s].amount;_context2.next=405;return saleVoucher[s].tax;case 405:if(!_context2.sent){_context2.next=409;break;}_context2.t16=saleVoucher[s].tax.id;_context2.next=410;break;case 409:_context2.t16='';case 410:saleVoucher[s].voucher_number=_context2.t16;_context2.next=413;return saleVoucher[s].tax;case 413:if(!_context2.sent){_context2.next=417;break;}_context2.t17=saleVoucher[s].tax.invoice_id<=9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].tax.invoice_id):saleVoucher[s].tax.invoice_id>9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].tax.invoice_id):"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/").concat(saleVoucher[s].tax.invoice_id);_context2.next=418;break;case 417:_context2.t17='';case 418:saleVoucher[s].invoice_id=_context2.t17;delete saleVoucher[s].tax;_context2.next=422;return array.push(saleVoucher[s]);case 422:_context2.next=456;break;case 424:_context2.next=426;return'sale';case 426:saleVoucher[s].voucher_type=_context2.sent;_context2.next=429;return saleVoucher[s].SalesLedger;case 429:saleVoucher[s].ledger=_context2.sent;_context2.next=432;return{};case 432:saleVoucher[s].Voucher=_context2.sent;saleVoucher[s].type='debit';_context2.next=436;return saleVoucher[s].total_amount;case 436:saleVoucher[s].debitAmount=_context2.sent;_context2.next=439;return 0;case 439:saleVoucher[s].creditAmount=_context2.sent;saleVoucher[s].amount=saleVoucher[s].total_amount;_context2.next=443;return saleVoucher[s].id;case 443:saleVoucher[s].voucher_number=_context2.sent;_context2.next=446;return saleVoucher[s].invoice_id;case 446:_context2.t18=_context2.sent;if(!(_context2.t18<=9)){_context2.next=451;break;}_context2.t19="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context2.next=452;break;case 451:_context2.t19=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(saleVoucher[s].invoice_id);case 452:saleVoucher[s].invoice_id=_context2.t19;delete saleVoucher[s].SalesLedger;_context2.next=456;return array.push(saleVoucher[s]);case 456:s++;_context2.next=220;break;case 459:if(!(purchaseVoucher&&purchaseVoucher.length>0)){_context2.next=710;break;}purchasearray=[];s=0;case 462:if(!(s<purchaseVoucher.length)){_context2.next=710;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context2.next=510;break;}_context2.next=466;return'purchase';case 466:purchaseVoucher[s].voucher_type=_context2.sent;_context2.next=469;return purchaseVoucher[s].RoundOff;case 469:purchaseVoucher[s].ledger=_context2.sent;_context2.next=472;return{};case 472:purchaseVoucher[s].Voucher=_context2.sent;purchaseVoucher[s].type=purchaseVoucher[s].roundoff_type;_context2.next=476;return purchaseVoucher[s].roundoff_type;case 476:_context2.t20=_context2.sent;if(!(_context2.t20=="debit")){_context2.next=481;break;}_context2.t21=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context2.next=482;break;case 481:_context2.t21=0;case 482:purchaseVoucher[s].debitAmount=_context2.t21;_context2.next=485;return purchaseVoucher[s].roundoff_type;case 485:_context2.t22=_context2.sent;if(!(_context2.t22=="credit")){_context2.next=490;break;}_context2.t23=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context2.next=491;break;case 490:_context2.t23=0;case 491:purchaseVoucher[s].creditAmount=_context2.t23;purchaseVoucher[s].amount=purchaseVoucher[s].roundoff_value;_context2.next=495;return purchaseVoucher[s].id;case 495:purchaseVoucher[s].voucher_number=_context2.sent;_context2.next=498;return purchaseVoucher[s].invoice_id;case 498:_context2.t24=_context2.sent;if(!(_context2.t24<=9)){_context2.next=503;break;}_context2.t25="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context2.next=504;break;case 503:_context2.t25=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 504:purchaseVoucher[s].invoice_id=_context2.t25;delete purchaseVoucher[s].RoundOff;_context2.next=508;return array.push(purchaseVoucher[s]);case 508:_context2.next=707;break;case 510:if(!ledger.dataValues.sale_key){_context2.next=626;break;}if(!(purchaseVoucher.length>0)){_context2.next=572;break;}_context2.next=514;return purchasearray.find(function(it){return purchaseVoucher[s].Voucherip&&it.invoice_idold==purchaseVoucher[s].Voucherip.invoice_id;});case 514:_findSales=_context2.sent;if(!(_findSales&&_findSales.Voucher)){_context2.next=518;break;}_context2.next=570;break;case 518:_context2.next=520;return'purchase';case 520:purchaseVoucher[s].voucher_type=_context2.sent;if(!purchaseVoucher[s].Voucherip){_context2.next=528;break;}_context2.next=524;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 524:purchaseVoucher[s].ledger=_context2.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context2.next=529;break;case 528:purchaseVoucher[s].ledger={};case 529:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context2.next=532;return purchaseVoucher[s].Voucherip;case 532:if(!_context2.sent){_context2.next=536;break;}_context2.t26=purchaseVoucher[s].Voucherip;_context2.next=537;break;case 536:_context2.t26={};case 537:purchaseVoucher[s].Voucher=_context2.t26;purchaseVoucher[s].type='debit';_context2.next=541;return purchaseVoucher[s].total_amount;case 541:purchaseVoucher[s].debitAmount=_context2.sent;_context2.next=544;return 0;case 544:purchaseVoucher[s].creditAmount=_context2.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context2.next=548;return purchaseVoucher[s].Voucherip;case 548:if(!_context2.sent){_context2.next=552;break;}_context2.t27=purchaseVoucher[s].Voucherip.id;_context2.next=553;break;case 552:_context2.t27='';case 553:purchaseVoucher[s].voucher_number=_context2.t27;_context2.next=556;return purchaseVoucher[s].Voucherip;case 556:_context2.t28=_context2.sent;if(!_context2.t28){_context2.next=559;break;}_context2.t28=purchaseVoucher[s].Voucherip.invoice_id;case 559:if(!_context2.t28){_context2.next=563;break;}_context2.t29=purchaseVoucher[s].Voucherip.invoice_id;_context2.next=564;break;case 563:_context2.t29='';case 564:purchaseVoucher[s].invoice_id=_context2.t29;delete purchaseVoucher[s].Voucherip;_context2.next=568;return purchasearray.push(purchaseVoucher[s]);case 568:_context2.next=570;return array.push(purchaseVoucher[s]);case 570:_context2.next=624;break;case 572:_context2.next=574;return'purchase';case 574:purchaseVoucher[s].voucher_type=_context2.sent;if(!purchaseVoucher[s].Voucherip){_context2.next=582;break;}_context2.next=578;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 578:purchaseVoucher[s].ledger=_context2.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context2.next=583;break;case 582:purchaseVoucher[s].ledger={};case 583:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context2.next=586;return purchaseVoucher[s].Voucherip;case 586:if(!_context2.sent){_context2.next=590;break;}_context2.t30=purchaseVoucher[s].Voucherip;_context2.next=591;break;case 590:_context2.t30={};case 591:purchaseVoucher[s].Voucher=_context2.t30;purchaseVoucher[s].type='debit';_context2.next=595;return purchaseVoucher[s].total_amount;case 595:purchaseVoucher[s].debitAmount=_context2.sent;_context2.next=598;return 0;case 598:purchaseVoucher[s].creditAmount=_context2.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context2.next=602;return purchaseVoucher[s].Voucherip;case 602:if(!_context2.sent){_context2.next=606;break;}_context2.t31=purchaseVoucher[s].Voucherip.id;_context2.next=607;break;case 606:_context2.t31='';case 607:purchaseVoucher[s].voucher_number=_context2.t31;_context2.next=610;return purchaseVoucher[s].Voucherip;case 610:_context2.t32=_context2.sent;if(!_context2.t32){_context2.next=613;break;}_context2.t32=purchaseVoucher[s].Voucherip.invoice_id;case 613:if(!_context2.t32){_context2.next=617;break;}_context2.t33=purchaseVoucher[s].Voucherip.invoice_id;_context2.next=618;break;case 617:_context2.t33='';case 618:purchaseVoucher[s].invoice_id=_context2.t33;delete purchaseVoucher[s].Voucherip;_context2.next=622;return purchasearray.push(purchaseVoucher[s]);case 622:_context2.next=624;return array.push(purchaseVoucher[s]);case 624:_context2.next=707;break;case 626:if(!ledger.dataValues.tax_key){_context2.next=675;break;}_context2.next=629;return'purchase';case 629:purchaseVoucher[s].voucher_type=_context2.sent;if(!purchaseVoucher[s].taxp){_context2.next=637;break;}_context2.next=633;return purchaseVoucher[s].taxp.PurchaseLedger;case 633:purchaseVoucher[s].ledger=_context2.sent;delete purchaseVoucher[s].taxp.PurchaseLedger;_context2.next=638;break;case 637:purchaseVoucher[s].ledger={};case 638:_context2.next=640;return purchaseVoucher[s].taxp;case 640:if(!_context2.sent){_context2.next=644;break;}_context2.t34=purchaseVoucher[s].taxp;_context2.next=645;break;case 644:_context2.t34={};case 645:purchaseVoucher[s].Voucher=_context2.t34;purchaseVoucher[s].type='debit';_context2.next=649;return purchaseVoucher[s].amount;case 649:purchaseVoucher[s].debitAmount=_context2.sent;_context2.next=652;return 0;case 652:purchaseVoucher[s].creditAmount=_context2.sent;purchaseVoucher[s].amount=purchaseVoucher[s].amount;_context2.next=656;return purchaseVoucher[s].taxp;case 656:if(!_context2.sent){_context2.next=660;break;}_context2.t35=purchaseVoucher[s].taxp.id;_context2.next=661;break;case 660:_context2.t35='';case 661:purchaseVoucher[s].voucher_number=_context2.t35;_context2.next=664;return purchaseVoucher[s].taxp;case 664:if(!_context2.sent){_context2.next=668;break;}_context2.t36=purchaseVoucher[s].taxp.invoice_id<=9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):purchaseVoucher[s].taxp.invoice_id>9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id);_context2.next=669;break;case 668:_context2.t36='';case 669:purchaseVoucher[s].invoice_id=_context2.t36;delete purchaseVoucher[s].tax;_context2.next=673;return array.push(purchaseVoucher[s]);case 673:_context2.next=707;break;case 675:_context2.next=677;return'purchase';case 677:purchaseVoucher[s].voucher_type=_context2.sent;_context2.next=680;return purchaseVoucher[s].PurchaseLedger;case 680:purchaseVoucher[s].ledger=_context2.sent;_context2.next=683;return{};case 683:purchaseVoucher[s].Voucher=_context2.sent;purchaseVoucher[s].type='credit';_context2.next=687;return 0;case 687:purchaseVoucher[s].debitAmount=_context2.sent;_context2.next=690;return purchaseVoucher[s].total_amount;case 690:purchaseVoucher[s].creditAmount=_context2.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context2.next=694;return purchaseVoucher[s].id;case 694:purchaseVoucher[s].voucher_number=_context2.sent;_context2.next=697;return purchaseVoucher[s].invoice_id;case 697:_context2.t37=_context2.sent;if(!(_context2.t37<=9)){_context2.next=702;break;}_context2.t38="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context2.next=703;break;case 702:_context2.t38=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 703:purchaseVoucher[s].invoice_id=_context2.t38;delete purchaseVoucher[s].PurchaseLedger;_context2.next=707;return array.push(purchaseVoucher[s]);case 707:s++;_context2.next=462;break;case 710:if(!(creditVoucher&&creditVoucher.length>0)){_context2.next=846;break;}s=0;case 712:if(!(s<creditVoucher.length)){_context2.next=846;break;}if(!ledger.dataValues.sale_key){_context2.next=762;break;}_context2.next=716;return'Sale Return';case 716:creditVoucher[s].voucher_type=_context2.sent;if(!creditVoucher[s].Voucheric){_context2.next=724;break;}_context2.next=720;return creditVoucher[s].Voucheric.CreditBuyer;case 720:creditVoucher[s].ledger=_context2.sent;delete creditVoucher[s].Voucheric.CreditBuyer;_context2.next=725;break;case 724:creditVoucher[s].ledger={};case 725:_context2.next=727;return creditVoucher[s].Voucheric;case 727:if(!_context2.sent){_context2.next=731;break;}_context2.t39=creditVoucher[s].Voucheric;_context2.next=732;break;case 731:_context2.t39={};case 732:creditVoucher[s].Voucher=_context2.t39;creditVoucher[s].type='debit';_context2.next=736;return creditVoucher[s].total_amount;case 736:creditVoucher[s].debitAmount=_context2.sent;_context2.next=739;return 0;case 739:creditVoucher[s].creditAmount=_context2.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context2.next=743;return creditVoucher[s].Voucheric;case 743:if(!_context2.sent){_context2.next=747;break;}_context2.t40=creditVoucher[s].Voucheric.id;_context2.next=748;break;case 747:_context2.t40='';case 748:creditVoucher[s].voucher_number=_context2.t40;_context2.next=751;return creditVoucher[s].Voucheric;case 751:if(!_context2.sent){_context2.next=755;break;}_context2.t41=creditVoucher[s].Voucheric.invoice_id<=9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].Voucheric.invoice_id):creditVoucher[s].Voucheric.invoice_id>9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].Voucheric.invoice_id):"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/").concat(creditVoucher[s].Voucheric.invoice_id);_context2.next=756;break;case 755:_context2.t41='';case 756:creditVoucher[s].invoice_id=_context2.t41;delete creditVoucher[s].Voucheric;_context2.next=760;return array.push(creditVoucher[s]);case 760:_context2.next=843;break;case 762:if(!ledger.dataValues.tax_key){_context2.next=811;break;}_context2.next=765;return'Sale Return';case 765:creditVoucher[s].voucher_type=_context2.sent;if(!creditVoucher[s].taxc){_context2.next=773;break;}_context2.next=769;return creditVoucher[s].taxc.CreditBuyer;case 769:creditVoucher[s].ledger=_context2.sent;delete creditVoucher[s].taxc.CreditBuyer;_context2.next=774;break;case 773:creditVoucher[s].ledger={};case 774:_context2.next=776;return creditVoucher[s].taxc;case 776:if(!_context2.sent){_context2.next=780;break;}_context2.t42=creditVoucher[s].taxc;_context2.next=781;break;case 780:_context2.t42={};case 781:creditVoucher[s].Voucher=_context2.t42;creditVoucher[s].type='debit';_context2.next=785;return creditVoucher[s].amount;case 785:creditVoucher[s].debitAmount=_context2.sent;_context2.next=788;return 0;case 788:creditVoucher[s].creditAmount=_context2.sent;creditVoucher[s].amount=creditVoucher[s].amount;_context2.next=792;return creditVoucher[s].taxc;case 792:if(!_context2.sent){_context2.next=796;break;}_context2.t43=creditVoucher[s].taxc.id;_context2.next=797;break;case 796:_context2.t43='';case 797:creditVoucher[s].voucher_number=_context2.t43;_context2.next=800;return creditVoucher[s].taxc;case 800:if(!_context2.sent){_context2.next=804;break;}_context2.t44=creditVoucher[s].taxc.invoice_id<=9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].taxc.invoice_id):creditVoucher[s].taxc.invoice_id>9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].taxc.invoice_id):"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/").concat(creditVoucher[s].taxc.invoice_id);_context2.next=805;break;case 804:_context2.t44='';case 805:creditVoucher[s].invoice_id=_context2.t44;delete creditVoucher[s].taxc;_context2.next=809;return array.push(creditVoucher[s]);case 809:_context2.next=843;break;case 811:_context2.next=813;return'Sale Return';case 813:creditVoucher[s].voucher_type=_context2.sent;_context2.next=816;return creditVoucher[s].CreditBuyer;case 816:creditVoucher[s].ledger=_context2.sent;_context2.next=819;return{};case 819:creditVoucher[s].Voucher=_context2.sent;creditVoucher[s].type='credit';_context2.next=823;return 0;case 823:creditVoucher[s].debitAmount=_context2.sent;_context2.next=826;return creditVoucher[s].total_amount;case 826:creditVoucher[s].creditAmount=_context2.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context2.next=830;return creditVoucher[s].id;case 830:creditVoucher[s].voucher_number=_context2.sent;_context2.next=833;return creditVoucher[s].invoice_id;case 833:_context2.t45=_context2.sent;if(!(_context2.t45<=9)){_context2.next=838;break;}_context2.t46="".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/00").concat(creditVoucher[s].invoice_id);_context2.next=839;break;case 838:_context2.t46=creditVoucher[s].invoice_id>9?"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/0").concat(creditVoucher[s].invoice_id):"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/").concat(creditVoucher[s].invoice_id);case 839:creditVoucher[s].invoice_id=_context2.t46;delete creditVoucher[s].CreditBuyer;_context2.next=843;return array.push(creditVoucher[s]);case 843:s++;_context2.next=712;break;case 846:if(!(debitVoucher&&debitVoucher.length>0)){_context2.next=982;break;}s=0;case 848:if(!(s<debitVoucher.length)){_context2.next=982;break;}if(!ledger.dataValues.sale_key){_context2.next=898;break;}_context2.next=852;return'Purchase Return';case 852:debitVoucher[s].voucher_type=_context2.sent;if(!debitVoucher[s].Voucherid){_context2.next=860;break;}_context2.next=856;return debitVoucher[s].Voucherid.DebitBuyer;case 856:debitVoucher[s].ledger=_context2.sent;delete debitVoucher[s].Voucherid.DebitBuyer;_context2.next=861;break;case 860:debitVoucher[s].ledger={};case 861:_context2.next=863;return debitVoucher[s].Voucherid;case 863:if(!_context2.sent){_context2.next=867;break;}_context2.t47=debitVoucher[s].Voucherid;_context2.next=868;break;case 867:_context2.t47={};case 868:debitVoucher[s].Voucher=_context2.t47;debitVoucher[s].type='Credit';_context2.next=872;return 0;case 872:debitVoucher[s].debitAmount=_context2.sent;_context2.next=875;return debitVoucher[s].total_amount;case 875:debitVoucher[s].creditAmount=_context2.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context2.next=879;return debitVoucher[s].Voucherid;case 879:if(!_context2.sent){_context2.next=883;break;}_context2.t48=debitVoucher[s].Voucherid.id;_context2.next=884;break;case 883:_context2.t48='';case 884:debitVoucher[s].voucher_number=_context2.t48;_context2.next=887;return debitVoucher[s].Voucherid;case 887:if(!_context2.sent){_context2.next=891;break;}_context2.t49=debitVoucher[s].Voucherid.invoice_id<=9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].Voucherid.invoice_id):debitVoucher[s].Voucherid.invoice_id>9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].Voucherid.invoice_id):"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/").concat(debitVoucher[s].Voucherid.invoice_id);_context2.next=892;break;case 891:_context2.t49='';case 892:debitVoucher[s].invoice_id=_context2.t49;delete debitVoucher[s].Voucherid;_context2.next=896;return array.push(debitVoucher[s]);case 896:_context2.next=979;break;case 898:if(!ledger.dataValues.tax_key){_context2.next=947;break;}_context2.next=901;return'Purchase Return';case 901:debitVoucher[s].voucher_type=_context2.sent;if(!debitVoucher[s].taxd){_context2.next=909;break;}_context2.next=905;return debitVoucher[s].taxd.DebitBuyer;case 905:debitVoucher[s].ledger=_context2.sent;delete debitVoucher[s].taxd.DebitBuyer;_context2.next=910;break;case 909:debitVoucher[s].ledger={};case 910:_context2.next=912;return debitVoucher[s].taxd;case 912:if(!_context2.sent){_context2.next=916;break;}_context2.t50=debitVoucher[s].taxd;_context2.next=917;break;case 916:_context2.t50={};case 917:debitVoucher[s].Voucher=_context2.t50;debitVoucher[s].type='Credit';_context2.next=921;return 0;case 921:debitVoucher[s].debitAmount=_context2.sent;_context2.next=924;return debitVoucher[s].amount;case 924:debitVoucher[s].creditAmount=_context2.sent;debitVoucher[s].amount=debitVoucher[s].amount;_context2.next=928;return debitVoucher[s].taxd;case 928:if(!_context2.sent){_context2.next=932;break;}_context2.t51=debitVoucher[s].taxd.id;_context2.next=933;break;case 932:_context2.t51='';case 933:debitVoucher[s].voucher_number=_context2.t51;_context2.next=936;return debitVoucher[s].taxd;case 936:if(!_context2.sent){_context2.next=940;break;}_context2.t52=debitVoucher[s].taxd.invoice_id<=9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].taxd.invoice_id):debitVoucher[s].taxd.invoice_id>9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].taxd.invoice_id):"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/").concat(debitVoucher[s].taxd.invoice_id);_context2.next=941;break;case 940:_context2.t52='';case 941:debitVoucher[s].invoice_id=_context2.t52;delete debitVoucher[s].taxd;_context2.next=945;return array.push(debitVoucher[s]);case 945:_context2.next=979;break;case 947:_context2.next=949;return'Purchase Return';case 949:debitVoucher[s].voucher_type=_context2.sent;_context2.next=952;return debitVoucher[s].DebitBuyer;case 952:debitVoucher[s].ledger=_context2.sent;_context2.next=955;return{};case 955:debitVoucher[s].Voucher=_context2.sent;debitVoucher[s].type='debit';_context2.next=959;return debitVoucher[s].total_amount;case 959:debitVoucher[s].debitAmount=_context2.sent;_context2.next=962;return 0;case 962:debitVoucher[s].creditAmount=_context2.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context2.next=966;return debitVoucher[s].id;case 966:debitVoucher[s].voucher_number=_context2.sent;_context2.next=969;return debitVoucher[s].invoice_id;case 969:_context2.t53=_context2.sent;if(!(_context2.t53<=9)){_context2.next=974;break;}_context2.t54="".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/00").concat(debitVoucher[s].invoice_id);_context2.next=975;break;case 974:_context2.t54=debitVoucher[s].invoice_id>9?"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/0").concat(debitVoucher[s].invoice_id):"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/").concat(debitVoucher[s].invoice_id);case 975:debitVoucher[s].invoice_id=_context2.t54;delete debitVoucher[s].DebitBuyer;_context2.next=979;return array.push(debitVoucher[s]);case 979:s++;_context2.next=848;break;case 982:if(!(recieptVoucher&&recieptVoucher.length>0)){_context2.next=1028;break;}i=0;case 984:if(!(i<recieptVoucher.length)){_context2.next=1028;break;}_context2.next=987;return recieptVoucher[i].type;case 987:_context2.t55=_context2.sent;if(!(_context2.t55==='debit')){_context2.next=997;break;}_context2.next=991;return recieptVoucher[i].total_amount;case 991:recieptVoucher[i].debitAmount=_context2.sent;_context2.next=994;return 0;case 994:recieptVoucher[i].creditAmount=_context2.sent;_context2.next=1003;break;case 997:_context2.next=999;return 0;case 999:recieptVoucher[i].debitAmount=_context2.sent;_context2.next=1002;return recieptVoucher[i].total_amount;case 1002:recieptVoucher[i].creditAmount=_context2.sent;case 1003:_context2.next=1005;return recieptVoucher[i].ReciptBuyer;case 1005:recieptVoucher[i].ledger=_context2.sent;delete recieptVoucher[i].ReciptBuyer;_context2.next=1009;return'reciept';case 1009:recieptVoucher[i].voucher_type=_context2.sent;_context2.next=1012;return recieptVoucher[i].id;case 1012:recieptVoucher[i].voucher_number=_context2.sent;_context2.next=1015;return recieptVoucher[i].invoice_id;case 1015:_context2.t56=_context2.sent;if(!(_context2.t56<=9)){_context2.next=1020;break;}_context2.t57="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context2.next=1021;break;case 1020:_context2.t57=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 1021:recieptVoucher[i].invoice_id=_context2.t57;recieptVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context2.next=1025;return array.push(recieptVoucher[i]);case 1025:i++;_context2.next=984;break;case 1028:if(!(paymentVoucher&&paymentVoucher.length>0)){_context2.next=1074;break;}i=0;case 1030:if(!(i<paymentVoucher.length)){_context2.next=1074;break;}_context2.next=1033;return paymentVoucher[i].type;case 1033:_context2.t58=_context2.sent;if(!(_context2.t58==='debit')){_context2.next=1043;break;}_context2.next=1037;return paymentVoucher[i].total_amount;case 1037:paymentVoucher[i].debitAmount=_context2.sent;_context2.next=1040;return 0;case 1040:paymentVoucher[i].creditAmount=_context2.sent;_context2.next=1049;break;case 1043:_context2.next=1045;return 0;case 1045:paymentVoucher[i].debitAmount=_context2.sent;_context2.next=1048;return paymentVoucher[i].total_amount;case 1048:paymentVoucher[i].creditAmount=_context2.sent;case 1049:_context2.next=1051;return paymentVoucher[i].PaymentBuyer;case 1051:paymentVoucher[i].ledger=_context2.sent;delete paymentVoucher[i].PaymentBuyer;_context2.next=1055;return'payment';case 1055:paymentVoucher[i].voucher_type=_context2.sent;_context2.next=1058;return paymentVoucher[i].id;case 1058:paymentVoucher[i].voucher_number=_context2.sent;_context2.next=1061;return paymentVoucher[i].invoice_id;case 1061:_context2.t59=_context2.sent;if(!(_context2.t59<=9)){_context2.next=1066;break;}_context2.t60="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context2.next=1067;break;case 1066:_context2.t60=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 1067:paymentVoucher[i].invoice_id=_context2.t60;paymentVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context2.next=1071;return array.push(paymentVoucher[i]);case 1071:i++;_context2.next=1030;break;case 1074:if(!(reciverrecieptVoucher&&reciverrecieptVoucher.length>0)){_context2.next=1108;break;}i=0;case 1076:if(!(i<reciverrecieptVoucher.length)){_context2.next=1108;break;}_context2.next=1079;return reciverrecieptVoucher[i].total_amount;case 1079:reciverrecieptVoucher[i].debitAmount=_context2.sent;_context2.next=1082;return 0;case 1082:reciverrecieptVoucher[i].creditAmount=_context2.sent;_context2.next=1085;return reciverrecieptVoucher[i].ReciptReciver;case 1085:reciverrecieptVoucher[i].ledger=_context2.sent;delete reciverrecieptVoucher[i].ReciptReciver;_context2.next=1089;return'reciept reciver';case 1089:reciverrecieptVoucher[i].voucher_type=_context2.sent;_context2.next=1092;return reciverrecieptVoucher[i].id;case 1092:reciverrecieptVoucher[i].voucher_number=_context2.sent;_context2.next=1095;return reciverrecieptVoucher[i].invoice_id;case 1095:_context2.t61=_context2.sent;if(!(_context2.t61<=9)){_context2.next=1100;break;}_context2.t62="".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverrecieptVoucher[i].invoice_id);_context2.next=1101;break;case 1100:_context2.t62=reciverrecieptVoucher[i].invoice_id>9?"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverrecieptVoucher[i].invoice_id):"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/").concat(reciverrecieptVoucher[i].invoice_id);case 1101:reciverrecieptVoucher[i].invoice_id=_context2.t62;reciverrecieptVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context2.next=1105;return array.push(reciverrecieptVoucher[i]);case 1105:i++;_context2.next=1076;break;case 1108:if(!(reciverpaymentVoucher&&reciverpaymentVoucher.length>0)){_context2.next=1142;break;}i=0;case 1110:if(!(i<reciverpaymentVoucher.length)){_context2.next=1142;break;}_context2.next=1113;return 0;case 1113:reciverpaymentVoucher[i].debitAmount=_context2.sent;_context2.next=1116;return reciverpaymentVoucher[i].total_amount;case 1116:reciverpaymentVoucher[i].creditAmount=_context2.sent;_context2.next=1119;return reciverpaymentVoucher[i].PaymentReciver;case 1119:reciverpaymentVoucher[i].ledger=_context2.sent;delete reciverpaymentVoucher[i].PaymentReciver;_context2.next=1123;return'payment reciver';case 1123:reciverpaymentVoucher[i].voucher_type=_context2.sent;_context2.next=1126;return reciverpaymentVoucher[i].id;case 1126:reciverpaymentVoucher[i].voucher_number=_context2.sent;_context2.next=1129;return reciverpaymentVoucher[i].invoice_id;case 1129:_context2.t63=_context2.sent;if(!(_context2.t63<=9)){_context2.next=1134;break;}_context2.t64="".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverpaymentVoucher[i].invoice_id);_context2.next=1135;break;case 1134:_context2.t64=reciverpaymentVoucher[i].invoice_id>9?"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverpaymentVoucher[i].invoice_id):"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/").concat(reciverpaymentVoucher[i].invoice_id);case 1135:reciverpaymentVoucher[i].invoice_id=_context2.t64;reciverpaymentVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context2.next=1139;return array.push(reciverpaymentVoucher[i]);case 1139:i++;_context2.next=1110;break;case 1142:_context2.next=1144;return(0,_arraySort["default"])(array,'invoice_date');case 1144:mainArray=_context2.sent;_context2.next=1147;return mainArray[mainArray.length-1];case 1147:lastObj=_context2.sent;_context2.next=1150;return mainArray.pop(mainArray.length-1);case 1150:mainArray.unshift(lastObj);// return mainArray;
_context2.next=1153;return calculationbank(mainArray);case 1153:calData=_context2.sent;return _context2.abrupt("return",calData);case 1157:return _context2.abrupt("return",[]);case 1158:_context2.next=1164;break;case 1160:_context2.prev=1160;_context2.t65=_context2["catch"](0);console.log("e",_context2.t65);return _context2.abrupt("return",{statusCode:res.statusCode,success:false,error:_context2.t65,message:"Something went wrong!"});case 1164:case"end":return _context2.stop();}},_callee2,null,[[0,1160]]);}));return function(_x36,_x37,_x38,_x39){return _ref2.apply(this,arguments);};}();exports.getProfileSalePurcaseCalculationData=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(ledgerid,accountgroupid,data,res){var journalVoucher,saleVoucher,purchaseVoucher,creditVoucher,debitVoucher,recieptVoucher,paymentVoucher,reciverrecieptVoucher,reciverpaymentVoucher,ledger,_invoice_date53,_invoice_date54,_invoice_date32,_invoice_date33,_invoice_date34,_invoice_date35,_invoice_date36,_invoice_date37,_invoice_date38,_invoice_date39,_invoice_date40,_invoice_date41,_invoice_date42,_invoice_date43,_invoice_date44,_invoice_date45,_invoice_date46,_invoice_date47,_invoice_date48,_invoice_date49,_invoice_date50,_invoice_date51,_invoice_date52,array,totalcalculate_openingblance,i,salearray,s,findSales,purchasearray,_findSales2,mainArray,lastObj,calData;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.prev=0;reciverpaymentVoucher=[];_context3.next=4;return _ledger["default"].findOne({where:{uid:ledgerid,company_id:data.company_id},include:[{model:_accountGroup["default"]}]});case 4:ledger=_context3.sent;if(!(ledger&&ledger.dataValues.id)){_context3.next=1155;break;}if(!ledger.dataValues.tax_key){_context3.next=30;break;}_context3.next=9;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledgerid},{type:'Sales'},{invoice_date:(_invoice_date32={},_defineProperty(_invoice_date32,Op.gte,data.start_date),_defineProperty(_invoice_date32,Op.lte,data.end_date),_invoice_date32)}]),include:[{model:_saleVoucher["default"],as:'tax',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 9:saleVoucher=_context3.sent;_context3.next=12;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledgerid},{type:'Purchase'},{invoice_date:(_invoice_date33={},_defineProperty(_invoice_date33,Op.gte,data.start_date),_defineProperty(_invoice_date33,Op.lte,data.end_date),_invoice_date33)}]),include:[{model:_purchaseVoucher["default"],as:'taxp',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 12:purchaseVoucher=_context3.sent;_context3.next=15;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledgerid},{type:'Debit'},{invoice_date:(_invoice_date34={},_defineProperty(_invoice_date34,Op.gte,data.start_date),_defineProperty(_invoice_date34,Op.lte,data.end_date),_invoice_date34)}]),include:[{model:_creditVoucher["default"],as:'taxc',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 15:creditVoucher=_context3.sent;_context3.next=18;return _taxInteries["default"].findAll({where:_defineProperty({},Op.and,[{tax_ledger_id:ledgerid},{type:'Credit'},{invoice_date:(_invoice_date35={},_defineProperty(_invoice_date35,Op.gte,data.start_date),_defineProperty(_invoice_date35,Op.lte,data.end_date),_invoice_date35)}]),include:[{model:_debitVoucher["default"],as:'taxd',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 18:debitVoucher=_context3.sent;_context3.next=21;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{company_id:data.company_id},{invoice_date:(_invoice_date36={},_defineProperty(_invoice_date36,Op.gte,data.start_date),_defineProperty(_invoice_date36,Op.lte,data.end_date),_invoice_date36)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 21:journalVoucher=_context3.sent;_context3.next=24;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date37={},_defineProperty(_invoice_date37,Op.gte,data.start_date),_defineProperty(_invoice_date37,Op.lte,data.end_date),_invoice_date37)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 24:recieptVoucher=_context3.sent;_context3.next=27;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date38={},_defineProperty(_invoice_date38,Op.gte,data.start_date),_defineProperty(_invoice_date38,Op.lte,data.end_date),_invoice_date38)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 27:paymentVoucher=_context3.sent;_context3.next=75;break;case 30:if(!ledger.dataValues.sale_key){_context3.next=54;break;}_context3.next=33;return _voucherInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{type:'Sales'},{invoice_date:(_invoice_date39={},_defineProperty(_invoice_date39,Op.gte,data.start_date),_defineProperty(_invoice_date39,Op.lte,data.end_date),_invoice_date39)}]),include:[{model:_saleVoucher["default"],as:'Vouchers',include:[{model:_ledger["default"],as:'SalesLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 33:saleVoucher=_context3.sent;_context3.next=36;return _voucherInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{type:'Purchase'},{invoice_date:(_invoice_date40={},_defineProperty(_invoice_date40,Op.gte,data.start_date),_defineProperty(_invoice_date40,Op.lte,data.end_date),_invoice_date40)}]),include:[{model:_purchaseVoucher["default"],as:'Voucherp',include:[{model:_ledger["default"],as:'PurchaseLedger'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 36:purchaseVoucher=_context3.sent;_context3.next=39;return _voucherInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{type:'Debit'},{invoice_date:(_invoice_date41={},_defineProperty(_invoice_date41,Op.gte,data.start_date),_defineProperty(_invoice_date41,Op.lte,data.end_date),_invoice_date41)}]),include:[{model:_creditVoucher["default"],as:'Voucherc',include:[{model:_ledger["default"],as:'CreditBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 39:creditVoucher=_context3.sent;_context3.next=42;return _voucherInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{type:'ow1kac6rc1y'},{invoice_date:(_invoice_date42={},_defineProperty(_invoice_date42,Op.gte,data.start_date),_defineProperty(_invoice_date42,Op.lte,data.end_date),_invoice_date42)}]),include:[{model:_debitVoucher["default"],as:'Voucherd',include:[{model:_ledger["default"],as:'DebitBuyer'}]}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 42:debitVoucher=_context3.sent;_context3.next=45;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{company_id:data.company_id},{invoice_date:(_invoice_date43={},_defineProperty(_invoice_date43,Op.gte,data.start_date),_defineProperty(_invoice_date43,Op.lte,data.end_date),_invoice_date43)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 45:journalVoucher=_context3.sent;_context3.next=48;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date44={},_defineProperty(_invoice_date44,Op.gte,data.start_date),_defineProperty(_invoice_date44,Op.lte,data.end_date),_invoice_date44)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 48:recieptVoucher=_context3.sent;_context3.next=51;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date45={},_defineProperty(_invoice_date45,Op.gte,data.start_date),_defineProperty(_invoice_date45,Op.lte,data.end_date),_invoice_date45)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 51:paymentVoucher=_context3.sent;_context3.next=75;break;case 54:_context3.next=56;return _journalInteries["default"].findAll({where:_defineProperty({},Op.and,[{ledger_id:ledgerid},{company_id:data.company_id},{invoice_date:(_invoice_date46={},_defineProperty(_invoice_date46,Op.gte,data.start_date),_defineProperty(_invoice_date46,Op.lte,data.end_date),_invoice_date46)}]),include:[{model:_ledger["default"],as:"VoucherLedger"},{model:_journalVoucher["default"],as:'Voucher'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 56:journalVoucher=_context3.sent;_context3.next=59;return _saleVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:ledgerid},{invoice_date:(_invoice_date47={},_defineProperty(_invoice_date47,Op.gte,data.start_date),_defineProperty(_invoice_date47,Op.lte,data.end_date),_invoice_date47)}]),include:[{model:_ledger["default"],as:'SalesLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 59:saleVoucher=_context3.sent;_context3.next=62;return _purchaseVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:ledgerid},{invoice_date:(_invoice_date48={},_defineProperty(_invoice_date48,Op.gte,data.start_date),_defineProperty(_invoice_date48,Op.lte,data.end_date),_invoice_date48)}]),include:[{model:_ledger["default"],as:'PurchaseLedger'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 62:purchaseVoucher=_context3.sent;_context3.next=65;return _creditVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:ledgerid},{invoice_date:(_invoice_date49={},_defineProperty(_invoice_date49,Op.gte,data.start_date),_defineProperty(_invoice_date49,Op.lte,data.end_date),_invoice_date49)}]),include:[{model:_ledger["default"],as:'CreditBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 65:creditVoucher=_context3.sent;_context3.next=68;return _debitVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{buyer_ledger_id:ledgerid},{invoice_date:(_invoice_date50={},_defineProperty(_invoice_date50,Op.gte,data.start_date),_defineProperty(_invoice_date50,Op.lte,data.end_date),_invoice_date50)}]),include:[{model:_ledger["default"],as:'DebitBuyer'}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 68:debitVoucher=_context3.sent;_context3.next=71;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date51={},_defineProperty(_invoice_date51,Op.gte,data.start_date),_defineProperty(_invoice_date51,Op.lte,data.end_date),_invoice_date51)}]),include:[{model:_ledger["default"],as:'ReciptBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 71:recieptVoucher=_context3.sent;_context3.next=74;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{ledger_id:ledgerid},{invoice_date:(_invoice_date52={},_defineProperty(_invoice_date52,Op.gte,data.start_date),_defineProperty(_invoice_date52,Op.lte,data.end_date),_invoice_date52)}]),include:[{model:_ledger["default"],as:'PaymentBuyer'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 74:paymentVoucher=_context3.sent;case 75:_context3.next=77;return _recieptVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:ledgerid},{invoice_date:(_invoice_date53={},_defineProperty(_invoice_date53,Op.gte,data.start_date),_defineProperty(_invoice_date53,Op.lte,data.end_date),_invoice_date53)}]),include:[{model:_ledger["default"],as:'ReciptReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 77:reciverrecieptVoucher=_context3.sent;_context3.next=80;return _paymentVoucher["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{receive_id:ledgerid},{invoice_date:(_invoice_date54={},_defineProperty(_invoice_date54,Op.gte,data.start_date),_defineProperty(_invoice_date54,Op.lte,data.end_date),_invoice_date54)}]),include:[{model:_ledger["default"],as:'PaymentReciver'}],order:[['invoice_id','ASC']]}).map(function(node){return node.get({plain:true});});case 80:reciverpaymentVoucher=_context3.sent;_context3.next=83;return(0,_ledger2.decreption)(ledger,'object',data.data.email);case 83:ledger=_context3.sent;_context3.next=86;return(0,_journalEntries.decreptionJournalEntries)(journalVoucher,'array',data.data.email);case 86:journalVoucher=_context3.sent;_context3.next=89;return(0,_receiptvoucher.decreptionReceipt)(recieptVoucher,'array',data.data.email);case 89:recieptVoucher=_context3.sent;_context3.next=92;return(0,_paymentvoucher.decreptionPayment)(paymentVoucher,'array',data.data.email);case 92:paymentVoucher=_context3.sent;_context3.next=95;return(0,_salesvoucher.decreptionSale)(saleVoucher,'array',data.data.email);case 95:saleVoucher=_context3.sent;_context3.next=98;return(0,_purchasevoucher.decreptionPurchase)(purchaseVoucher,'array',data.data.email);case 98:purchaseVoucher=_context3.sent;_context3.next=101;return(0,_creditvoucher.decreptionCredit)(creditVoucher,'array',data.data.email);case 101:creditVoucher=_context3.sent;_context3.next=104;return(0,_debitvoucher.decreptionDebit)(debitVoucher,'array',data.data.email);case 104:debitVoucher=_context3.sent;_context3.next=107;return(0,_receiptvoucher.decreptionReceipt)(reciverrecieptVoucher,'array',data.data.email);case 107:reciverrecieptVoucher=_context3.sent;_context3.next=110;return(0,_paymentvoucher.decreptionPayment)(reciverpaymentVoucher,'array',data.data.email);case 110:reciverpaymentVoucher=_context3.sent;_context3.next=113;return[];case 113:array=_context3.sent;if(!(ledger&&ledger.dataValues.id)){_context3.next=139;break;}if(!(ledger.dataValues.opening_balance==='Debit'||ledger.dataValues.opening_balance==='debit')){_context3.next=124;break;}_context3.next=118;return ledger.dataValues.amount;case 118:ledger.dataValues.debitAmount=_context3.sent;_context3.next=121;return 0;case 121:ledger.dataValues.creditAmount=_context3.sent;_context3.next=130;break;case 124:_context3.next=126;return 0;case 126:ledger.dataValues.debitAmount=_context3.sent;_context3.next=129;return ledger.dataValues.amount;case 129:ledger.dataValues.creditAmount=_context3.sent;case 130:_context3.next=132;return true;case 132:ledger.dataValues.open=_context3.sent;ledger.dataValues.voucher_type='';ledger.dataValues.voucher_number='';ledger.dataValues.invoice_id='';ledger.dataValues.account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context3.next=139;return array.push(ledger.dataValues);case 139:totalcalculate_openingblance={};_context3.next=142;return checkValid(ledger.dataValues.account_group_id);case 142:if(!_context3.sent){_context3.next=148;break;}_context3.next=145;return getAllLedgerVouchercurrent(data.start_date,data.end_date,ledgerid,data.company_id,ledger.dataValues.creditAmount,ledger.dataValues.debitAmount,data.data.email);case 145:totalcalculate_openingblance=_context3.sent;_context3.next=151;break;case 148:_context3.next=150;return getAllLedgerVoucherprivious(data.start_date,data.end_date,ledgerid,data.company_id,ledger.dataValues.creditAmount,ledger.dataValues.debitAmount,data.data.email);case 150:totalcalculate_openingblance=_context3.sent;case 151:if(!(totalcalculate_openingblance>=0)){_context3.next=160;break;}_context3.next=154;return totalcalculate_openingblance.toString();case 154:ledger.dataValues.debitAmount=_context3.sent;_context3.next=157;return 0;case 157:ledger.dataValues.creditAmount=_context3.sent;_context3.next=166;break;case 160:_context3.next=162;return 0;case 162:ledger.dataValues.debitAmount=_context3.sent;_context3.next=165;return totalcalculate_openingblance.toString();case 165:ledger.dataValues.creditAmount=_context3.sent;case 166:if(!(journalVoucher&&journalVoucher.length>0)){_context3.next=215;break;}i=0;case 168:if(!(i<journalVoucher.length)){_context3.next=215;break;}_context3.next=171;return journalVoucher[i].type;case 171:_context3.t0=_context3.sent;if(!(_context3.t0==='debit')){_context3.next=181;break;}_context3.next=175;return journalVoucher[i].amount;case 175:journalVoucher[i].debitAmount=_context3.sent;_context3.next=178;return 0;case 178:journalVoucher[i].creditAmount=_context3.sent;_context3.next=187;break;case 181:_context3.next=183;return 0;case 183:journalVoucher[i].debitAmount=_context3.sent;_context3.next=186;return journalVoucher[i].amount;case 186:journalVoucher[i].creditAmount=_context3.sent;case 187:_context3.next=189;return journalVoucher[i].Voucher.invoice_date;case 189:journalVoucher[i].invoice_date=_context3.sent;_context3.next=192;return'journal';case 192:journalVoucher[i].voucher_type=_context3.sent;_context3.next=195;return journalVoucher[i].Voucher.id;case 195:journalVoucher[i].voucher_number=_context3.sent;_context3.next=198;return journalVoucher[i].Voucher.invoice_id;case 198:_context3.t1=_context3.sent;if(!(_context3.t1<=9)){_context3.next=203;break;}_context3.t2="".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/00").concat(journalVoucher[i].Voucher.invoice_id);_context3.next=204;break;case 203:_context3.t2=journalVoucher[i].Voucher.invoice_id>9?"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/0").concat(journalVoucher[i].Voucher.invoice_id):"".concat(journalVoucher[i].Voucher.current_year.toString().substr(-2)+"-"+journalVoucher[i].Voucher.end_year.toString().substr(-2),"/").concat(journalVoucher[i].Voucher.invoice_id);case 204:journalVoucher[i].invoice_id=_context3.t2;journalVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context3.next=208;return journalVoucher[i].VoucherLedger;case 208:journalVoucher[i].ledger=_context3.sent;delete journalVoucher[i].VoucherLedger;_context3.next=212;return array.push(journalVoucher[i]);case 212:i++;_context3.next=168;break;case 215:if(!(saleVoucher&&saleVoucher.length>0)){_context3.next=457;break;}salearray=[];s=0;case 218:if(!(s<saleVoucher.length)){_context3.next=457;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context3.next=266;break;}_context3.next=222;return'sale';case 222:saleVoucher[s].voucher_type=_context3.sent;_context3.next=225;return saleVoucher[s].RoundOff;case 225:saleVoucher[s].ledger=_context3.sent;_context3.next=228;return{};case 228:saleVoucher[s].Voucher=_context3.sent;saleVoucher[s].type=saleVoucher[s].roundoff_type;_context3.next=232;return saleVoucher[s].roundoff_type;case 232:_context3.t3=_context3.sent;if(!(_context3.t3=="debit")){_context3.next=237;break;}_context3.t4=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context3.next=238;break;case 237:_context3.t4=0;case 238:saleVoucher[s].debitAmount=_context3.t4;_context3.next=241;return saleVoucher[s].roundoff_type;case 241:_context3.t5=_context3.sent;if(!(_context3.t5=="credit")){_context3.next=246;break;}_context3.t6=Number(saleVoucher[s].roundoff_value)>0?Number(saleVoucher[s].roundoff_value):-1*Number(saleVoucher[s].roundoff_value);_context3.next=247;break;case 246:_context3.t6=0;case 247:saleVoucher[s].creditAmount=_context3.t6;saleVoucher[s].amount=saleVoucher[s].roundoff_value;_context3.next=251;return saleVoucher[s].id;case 251:saleVoucher[s].voucher_number=_context3.sent;_context3.next=254;return saleVoucher[s].invoice_id;case 254:_context3.t7=_context3.sent;if(!(_context3.t7<=9)){_context3.next=259;break;}_context3.t8="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context3.next=260;break;case 259:_context3.t8=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(ssaleVoucher[s].invoice_id);case 260:saleVoucher[s].invoice_id=_context3.t8;delete saleVoucher[s].RoundOff;_context3.next=264;return array.push(saleVoucher[s]);case 264:_context3.next=454;break;case 266:if(!ledger.dataValues.sale_key){_context3.next=373;break;}if(!(salearray.length>0)){_context3.next=324;break;}_context3.next=270;return salearray.find(function(it){return saleVoucher[s].Voucheris&&it.invoice_idold==saleVoucher[s].Voucheris.invoice_id;});case 270:findSales=_context3.sent;if(!(findSales&&findSales.Voucher)){_context3.next=274;break;}_context3.next=322;break;case 274:_context3.next=276;return'sale';case 276:saleVoucher[s].voucher_type=_context3.sent;if(!saleVoucher[s].Voucheris){_context3.next=284;break;}_context3.next=280;return saleVoucher[s].Voucheris.SalesLedger;case 280:saleVoucher[s].ledger=_context3.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context3.next=285;break;case 284:saleVoucher[s].ledger={};case 285:_context3.next=287;return saleVoucher[s].Voucheris;case 287:if(!_context3.sent){_context3.next=291;break;}_context3.t9=saleVoucher[s].Voucheris;_context3.next=292;break;case 291:_context3.t9={};case 292:saleVoucher[s].Voucher=_context3.t9;saleVoucher[s].type='credit';_context3.next=296;return 0;case 296:saleVoucher[s].debitAmount=_context3.sent;_context3.next=299;return saleVoucher[s].total_amount;case 299:saleVoucher[s].creditAmount=_context3.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context3.next=303;return saleVoucher[s].Voucheris;case 303:if(!_context3.sent){_context3.next=307;break;}_context3.t10=saleVoucher[s].Voucheris.id;_context3.next=308;break;case 307:_context3.t10='';case 308:saleVoucher[s].voucher_number=_context3.t10;_context3.next=311;return saleVoucher[s].Voucheris;case 311:if(!_context3.sent){_context3.next=315;break;}_context3.t11=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context3.next=316;break;case 315:_context3.t11='';case 316:saleVoucher[s].invoice_id=_context3.t11;delete saleVoucher[s].Voucheris;_context3.next=320;return salearray.push(saleVoucher[s]);case 320:_context3.next=322;return array.push(saleVoucher[s]);case 322:_context3.next=371;break;case 324:_context3.next=326;return'sale';case 326:saleVoucher[s].voucher_type=_context3.sent;if(!saleVoucher[s].Voucheris){_context3.next=334;break;}_context3.next=330;return saleVoucher[s].Voucheris.SalesLedger;case 330:saleVoucher[s].ledger=_context3.sent;delete saleVoucher[s].Voucheris.SalesLedger;_context3.next=335;break;case 334:saleVoucher[s].ledger={};case 335:_context3.next=337;return saleVoucher[s].Voucheris;case 337:if(!_context3.sent){_context3.next=341;break;}_context3.t12=saleVoucher[s].Voucheris;_context3.next=342;break;case 341:_context3.t12={};case 342:saleVoucher[s].Voucher=_context3.t12;saleVoucher[s].type='credit';_context3.next=346;return 0;case 346:saleVoucher[s].debitAmount=_context3.sent;_context3.next=349;return saleVoucher[s].total_amount;case 349:saleVoucher[s].creditAmount=_context3.sent;saleVoucher[s].amount=saleVoucher[s].total_amount,saleVoucher[s].invoice_idold=saleVoucher[s].Voucheris&&saleVoucher[s].Voucheris.invoice_id?saleVoucher[s].Voucheris.invoice_id:'';_context3.next=353;return saleVoucher[s].Voucheris;case 353:if(!_context3.sent){_context3.next=357;break;}_context3.t13=saleVoucher[s].Voucheris.id;_context3.next=358;break;case 357:_context3.t13='';case 358:saleVoucher[s].voucher_number=_context3.t13;_context3.next=361;return saleVoucher[s].Voucheris;case 361:if(!_context3.sent){_context3.next=365;break;}_context3.t14=saleVoucher[s].Voucheris.invoice_id<=9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].Voucheris.invoice_id):saleVoucher[s].Voucheris.invoice_id>9?"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].Voucheris.invoice_id):"".concat(saleVoucher[s].Voucheris.current_year.toString().substr(-2)+"-"+saleVoucher[s].Voucheris.end_year.toString().substr(-2),"/").concat(saleVoucher[s].Voucheris.invoice_id);_context3.next=366;break;case 365:_context3.t14='';case 366:saleVoucher[s].invoice_id=_context3.t14;_context3.next=369;return salearray.push(saleVoucher[s]);case 369:_context3.next=371;return array.push(saleVoucher[s]);case 371:_context3.next=454;break;case 373:if(!ledger.dataValues.tax_key){_context3.next=422;break;}_context3.next=376;return'sale';case 376:saleVoucher[s].voucher_type=_context3.sent;if(!saleVoucher[s].tax){_context3.next=384;break;}_context3.next=380;return saleVoucher[s].tax.SalesLedger;case 380:saleVoucher[s].ledger=_context3.sent;delete saleVoucher[s].tax.SalesLedger;_context3.next=385;break;case 384:saleVoucher[s].ledger={};case 385:_context3.next=387;return saleVoucher[s].tax;case 387:if(!_context3.sent){_context3.next=391;break;}_context3.t15=saleVoucher[s].tax;_context3.next=392;break;case 391:_context3.t15={};case 392:saleVoucher[s].Voucher=_context3.t15;saleVoucher[s].type='credit';_context3.next=396;return 0;case 396:saleVoucher[s].debitAmount=_context3.sent;_context3.next=399;return saleVoucher[s].amount;case 399:saleVoucher[s].creditAmount=_context3.sent;saleVoucher[s].amount=saleVoucher[s].amount;_context3.next=403;return saleVoucher[s].tax;case 403:if(!_context3.sent){_context3.next=407;break;}_context3.t16=saleVoucher[s].tax.id;_context3.next=408;break;case 407:_context3.t16='';case 408:saleVoucher[s].voucher_number=_context3.t16;_context3.next=411;return saleVoucher[s].tax;case 411:if(!_context3.sent){_context3.next=415;break;}_context3.t17=saleVoucher[s].tax.invoice_id<=9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/00").concat(saleVoucher[s].tax.invoice_id):saleVoucher[s].tax.invoice_id>9?"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/0").concat(saleVoucher[s].tax.invoice_id):"".concat(saleVoucher[s].tax.current_year.toString().substr(-2)+"-"+saleVoucher[s].tax.end_year.toString().substr(-2),"/").concat(saleVoucher[s].tax.invoice_id);_context3.next=416;break;case 415:_context3.t17='';case 416:saleVoucher[s].invoice_id=_context3.t17;delete saleVoucher[s].tax;_context3.next=420;return array.push(saleVoucher[s]);case 420:_context3.next=454;break;case 422:_context3.next=424;return'sale';case 424:saleVoucher[s].voucher_type=_context3.sent;_context3.next=427;return saleVoucher[s].SalesLedger;case 427:saleVoucher[s].ledger=_context3.sent;_context3.next=430;return{};case 430:saleVoucher[s].Voucher=_context3.sent;saleVoucher[s].type='Credit';_context3.next=434;return 0;case 434:saleVoucher[s].debitAmount=_context3.sent;_context3.next=437;return saleVoucher[s].total_amount;case 437:saleVoucher[s].creditAmount=_context3.sent;saleVoucher[s].amount=saleVoucher[s].total_amount;_context3.next=441;return saleVoucher[s].id;case 441:saleVoucher[s].voucher_number=_context3.sent;_context3.next=444;return saleVoucher[s].invoice_id;case 444:_context3.t18=_context3.sent;if(!(_context3.t18<=9)){_context3.next=449;break;}_context3.t19="".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/00").concat(saleVoucher[s].invoice_id);_context3.next=450;break;case 449:_context3.t19=saleVoucher[s].invoice_id>9?"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/0").concat(saleVoucher[s].invoice_id):"".concat(saleVoucher[s].current_year.toString().substr(-2)+"-"+saleVoucher[s].end_year.toString().substr(-2),"/").concat(saleVoucher[s].invoice_id);case 450:saleVoucher[s].invoice_id=_context3.t19;delete saleVoucher[s].SalesLedger;_context3.next=454;return array.push(saleVoucher[s]);case 454:s++;_context3.next=218;break;case 457:if(!(purchaseVoucher&&purchaseVoucher.length>0)){_context3.next=708;break;}purchasearray=[];s=0;case 460:if(!(s<purchaseVoucher.length)){_context3.next=708;break;}if(!(ledger.name=="Round Off"||ledger.name=="round off"||ledger.name=="Round Off")){_context3.next=508;break;}_context3.next=464;return'purchase';case 464:purchaseVoucher[s].voucher_type=_context3.sent;_context3.next=467;return purchaseVoucher[s].RoundOff;case 467:purchaseVoucher[s].ledger=_context3.sent;_context3.next=470;return{};case 470:purchaseVoucher[s].Voucher=_context3.sent;purchaseVoucher[s].type=purchaseVoucher[s].roundoff_type;_context3.next=474;return purchaseVoucher[s].roundoff_type;case 474:_context3.t20=_context3.sent;if(!(_context3.t20=="debit")){_context3.next=479;break;}_context3.t21=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context3.next=480;break;case 479:_context3.t21=0;case 480:purchaseVoucher[s].debitAmount=_context3.t21;_context3.next=483;return purchaseVoucher[s].roundoff_type;case 483:_context3.t22=_context3.sent;if(!(_context3.t22=="credit")){_context3.next=488;break;}_context3.t23=Number(purchaseVoucher[s].roundoff_value)>0?Number(purchaseVoucher[s].roundoff_value):-1*Number(purchaseVoucher[s].roundoff_value);_context3.next=489;break;case 488:_context3.t23=0;case 489:purchaseVoucher[s].creditAmount=_context3.t23;purchaseVoucher[s].amount=purchaseVoucher[s].roundoff_value;_context3.next=493;return purchaseVoucher[s].id;case 493:purchaseVoucher[s].voucher_number=_context3.sent;_context3.next=496;return purchaseVoucher[s].invoice_id;case 496:_context3.t24=_context3.sent;if(!(_context3.t24<=9)){_context3.next=501;break;}_context3.t25="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context3.next=502;break;case 501:_context3.t25=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 502:purchaseVoucher[s].invoice_id=_context3.t25;delete purchaseVoucher[s].RoundOff;_context3.next=506;return array.push(purchaseVoucher[s]);case 506:_context3.next=705;break;case 508:if(!ledger.dataValues.sale_key){_context3.next=624;break;}if(!(purchaseVoucher.length>0)){_context3.next=570;break;}_context3.next=512;return purchasearray.find(function(it){return purchaseVoucher[s].Voucherip&&it.invoice_idold==purchaseVoucher[s].Voucherip.invoice_id;});case 512:_findSales2=_context3.sent;if(!(_findSales2&&_findSales2.Voucher)){_context3.next=516;break;}_context3.next=568;break;case 516:_context3.next=518;return'purchase';case 518:purchaseVoucher[s].voucher_type=_context3.sent;if(!purchaseVoucher[s].Voucherip){_context3.next=526;break;}_context3.next=522;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 522:purchaseVoucher[s].ledger=_context3.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context3.next=527;break;case 526:purchaseVoucher[s].ledger={};case 527:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context3.next=530;return purchaseVoucher[s].Voucherip;case 530:if(!_context3.sent){_context3.next=534;break;}_context3.t26=purchaseVoucher[s].Voucherip;_context3.next=535;break;case 534:_context3.t26={};case 535:purchaseVoucher[s].Voucher=_context3.t26;purchaseVoucher[s].type='debit';_context3.next=539;return purchaseVoucher[s].total_amount;case 539:purchaseVoucher[s].debitAmount=_context3.sent;_context3.next=542;return 0;case 542:purchaseVoucher[s].creditAmount=_context3.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context3.next=546;return purchaseVoucher[s].Voucherip;case 546:if(!_context3.sent){_context3.next=550;break;}_context3.t27=purchaseVoucher[s].Voucherip.id;_context3.next=551;break;case 550:_context3.t27='';case 551:purchaseVoucher[s].voucher_number=_context3.t27;_context3.next=554;return purchaseVoucher[s].Voucherip;case 554:_context3.t28=_context3.sent;if(!_context3.t28){_context3.next=557;break;}_context3.t28=purchaseVoucher[s].Voucherip.invoice_id;case 557:if(!_context3.t28){_context3.next=561;break;}_context3.t29=purchaseVoucher[s].Voucherip.invoice_id;_context3.next=562;break;case 561:_context3.t29='';case 562:purchaseVoucher[s].invoice_id=_context3.t29;delete purchaseVoucher[s].Voucherip;_context3.next=566;return purchasearray.push(purchaseVoucher[s]);case 566:_context3.next=568;return array.push(purchaseVoucher[s]);case 568:_context3.next=622;break;case 570:_context3.next=572;return'purchase';case 572:purchaseVoucher[s].voucher_type=_context3.sent;if(!purchaseVoucher[s].Voucherip){_context3.next=580;break;}_context3.next=576;return purchaseVoucher[s].Voucherip.PurchaseLedger;case 576:purchaseVoucher[s].ledger=_context3.sent;delete purchaseVoucher[s].Voucherip.PurchaseLedger;_context3.next=581;break;case 580:purchaseVoucher[s].ledger={};case 581:purchaseVoucher[s].invoice_idold=purchaseVoucher[s].Voucherip&&purchaseVoucher[s].Voucherip.invoice_id?purchaseVoucher[s].Voucherip.invoice_id:'';_context3.next=584;return purchaseVoucher[s].Voucherip;case 584:if(!_context3.sent){_context3.next=588;break;}_context3.t30=purchaseVoucher[s].Voucherip;_context3.next=589;break;case 588:_context3.t30={};case 589:purchaseVoucher[s].Voucher=_context3.t30;purchaseVoucher[s].type='debit';_context3.next=593;return purchaseVoucher[s].total_amount;case 593:purchaseVoucher[s].debitAmount=_context3.sent;_context3.next=596;return 0;case 596:purchaseVoucher[s].creditAmount=_context3.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context3.next=600;return purchaseVoucher[s].Voucherip;case 600:if(!_context3.sent){_context3.next=604;break;}_context3.t31=purchaseVoucher[s].Voucherip.id;_context3.next=605;break;case 604:_context3.t31='';case 605:purchaseVoucher[s].voucher_number=_context3.t31;_context3.next=608;return purchaseVoucher[s].Voucherip;case 608:_context3.t32=_context3.sent;if(!_context3.t32){_context3.next=611;break;}_context3.t32=purchaseVoucher[s].Voucherip.invoice_id;case 611:if(!_context3.t32){_context3.next=615;break;}_context3.t33=purchaseVoucher[s].Voucherip.invoice_id;_context3.next=616;break;case 615:_context3.t33='';case 616:purchaseVoucher[s].invoice_id=_context3.t33;delete purchaseVoucher[s].Voucherip;_context3.next=620;return purchasearray.push(purchaseVoucher[s]);case 620:_context3.next=622;return array.push(purchaseVoucher[s]);case 622:_context3.next=705;break;case 624:if(!ledger.dataValues.tax_key){_context3.next=673;break;}_context3.next=627;return'purchase';case 627:purchaseVoucher[s].voucher_type=_context3.sent;if(!purchaseVoucher[s].taxp){_context3.next=635;break;}_context3.next=631;return purchaseVoucher[s].taxp.PurchaseLedger;case 631:purchaseVoucher[s].ledger=_context3.sent;delete purchaseVoucher[s].taxp.PurchaseLedger;_context3.next=636;break;case 635:purchaseVoucher[s].ledger={};case 636:_context3.next=638;return purchaseVoucher[s].taxp;case 638:if(!_context3.sent){_context3.next=642;break;}_context3.t34=purchaseVoucher[s].taxp;_context3.next=643;break;case 642:_context3.t34={};case 643:purchaseVoucher[s].Voucher=_context3.t34;purchaseVoucher[s].type='debit';_context3.next=647;return purchaseVoucher[s].amount;case 647:purchaseVoucher[s].debitAmount=_context3.sent;_context3.next=650;return 0;case 650:purchaseVoucher[s].creditAmount=_context3.sent;purchaseVoucher[s].amount=purchaseVoucher[s].amount;_context3.next=654;return purchaseVoucher[s].taxp;case 654:if(!_context3.sent){_context3.next=658;break;}_context3.t35=purchaseVoucher[s].taxp.id;_context3.next=659;break;case 658:_context3.t35='';case 659:purchaseVoucher[s].voucher_number=_context3.t35;_context3.next=662;return purchaseVoucher[s].taxp;case 662:if(!_context3.sent){_context3.next=666;break;}_context3.t36=purchaseVoucher[s].taxp.invoice_id<=9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):purchaseVoucher[s].taxp.invoice_id>9?"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id):"".concat(purchaseVoucher[s].taxp.current_year.toString().substr(-2)+"-"+purchaseVoucher[s].taxp.end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].taxp.invoice_id);_context3.next=667;break;case 666:_context3.t36='';case 667:purchaseVoucher[s].invoice_id=_context3.t36;delete purchaseVoucher[s].tax;_context3.next=671;return array.push(purchaseVoucher[s]);case 671:_context3.next=705;break;case 673:_context3.next=675;return'purchase';case 675:purchaseVoucher[s].voucher_type=_context3.sent;_context3.next=678;return purchaseVoucher[s].PurchaseLedger;case 678:purchaseVoucher[s].ledger=_context3.sent;_context3.next=681;return{};case 681:purchaseVoucher[s].Voucher=_context3.sent;purchaseVoucher[s].type='debit';_context3.next=685;return purchaseVoucher[s].total_amount;case 685:purchaseVoucher[s].debitAmount=_context3.sent;_context3.next=688;return 0;case 688:purchaseVoucher[s].creditAmount=_context3.sent;purchaseVoucher[s].amount=purchaseVoucher[s].total_amount;_context3.next=692;return purchaseVoucher[s].id;case 692:purchaseVoucher[s].voucher_number=_context3.sent;_context3.next=695;return purchaseVoucher[s].invoice_id;case 695:_context3.t37=_context3.sent;if(!(_context3.t37<=9)){_context3.next=700;break;}_context3.t38="".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);_context3.next=701;break;case 700:_context3.t38=purchaseVoucher[s].invoice_id>9?"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id):"".concat(purchaseVoucher[s].current_year.toString().substr(-2)+"-"+purchaseVoucher[s].end_year.toString().substr(-2),"/").concat(purchaseVoucher[s].invoice_id);case 701:purchaseVoucher[s].invoice_id=_context3.t38;delete purchaseVoucher[s].PurchaseLedger;_context3.next=705;return array.push(purchaseVoucher[s]);case 705:s++;_context3.next=460;break;case 708:if(!(creditVoucher&&creditVoucher.length>0)){_context3.next=844;break;}s=0;case 710:if(!(s<creditVoucher.length)){_context3.next=844;break;}if(!ledger.dataValues.sale_key){_context3.next=760;break;}_context3.next=714;return'Sale Return';case 714:creditVoucher[s].voucher_type=_context3.sent;if(!creditVoucher[s].Voucheric){_context3.next=722;break;}_context3.next=718;return creditVoucher[s].Voucheric.CreditBuyer;case 718:creditVoucher[s].ledger=_context3.sent;delete creditVoucher[s].Voucheric.CreditBuyer;_context3.next=723;break;case 722:creditVoucher[s].ledger={};case 723:_context3.next=725;return creditVoucher[s].Voucheric;case 725:if(!_context3.sent){_context3.next=729;break;}_context3.t39=creditVoucher[s].Voucheric;_context3.next=730;break;case 729:_context3.t39={};case 730:creditVoucher[s].Voucher=_context3.t39;creditVoucher[s].type='debit';_context3.next=734;return creditVoucher[s].total_amount;case 734:creditVoucher[s].debitAmount=_context3.sent;_context3.next=737;return 0;case 737:creditVoucher[s].creditAmount=_context3.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context3.next=741;return creditVoucher[s].Voucheric;case 741:if(!_context3.sent){_context3.next=745;break;}_context3.t40=creditVoucher[s].Voucheric.id;_context3.next=746;break;case 745:_context3.t40='';case 746:creditVoucher[s].voucher_number=_context3.t40;_context3.next=749;return creditVoucher[s].Voucheric;case 749:if(!_context3.sent){_context3.next=753;break;}_context3.t41=creditVoucher[s].Voucheric.invoice_id<=9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].Voucheric.invoice_id):creditVoucher[s].Voucheric.invoice_id>9?"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].Voucheric.invoice_id):"".concat(creditVoucher[s].Voucheric.current_year.toString().substr(-2)+"-"+creditVoucher[s].Voucheric.end_year.toString().substr(-2),"/").concat(creditVoucher[s].Voucheric.invoice_id);_context3.next=754;break;case 753:_context3.t41='';case 754:creditVoucher[s].invoice_id=_context3.t41;delete creditVoucher[s].Voucheric;_context3.next=758;return array.push(creditVoucher[s]);case 758:_context3.next=841;break;case 760:if(!ledger.dataValues.tax_key){_context3.next=809;break;}_context3.next=763;return'Sale Return';case 763:creditVoucher[s].voucher_type=_context3.sent;if(!creditVoucher[s].taxc){_context3.next=771;break;}_context3.next=767;return creditVoucher[s].taxc.CreditBuyer;case 767:creditVoucher[s].ledger=_context3.sent;delete creditVoucher[s].taxc.CreditBuyer;_context3.next=772;break;case 771:creditVoucher[s].ledger={};case 772:_context3.next=774;return creditVoucher[s].taxc;case 774:if(!_context3.sent){_context3.next=778;break;}_context3.t42=creditVoucher[s].taxc;_context3.next=779;break;case 778:_context3.t42={};case 779:creditVoucher[s].Voucher=_context3.t42;creditVoucher[s].type='debit';_context3.next=783;return creditVoucher[s].amount;case 783:creditVoucher[s].debitAmount=_context3.sent;_context3.next=786;return 0;case 786:creditVoucher[s].creditAmount=_context3.sent;creditVoucher[s].amount=creditVoucher[s].amount;_context3.next=790;return creditVoucher[s].taxc;case 790:if(!_context3.sent){_context3.next=794;break;}_context3.t43=creditVoucher[s].taxc.id;_context3.next=795;break;case 794:_context3.t43='';case 795:creditVoucher[s].voucher_number=_context3.t43;_context3.next=798;return creditVoucher[s].taxc;case 798:if(!_context3.sent){_context3.next=802;break;}_context3.t44=creditVoucher[s].taxc.invoice_id<=9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/00").concat(creditVoucher[s].taxc.invoice_id):creditVoucher[s].taxc.invoice_id>9?"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/0").concat(creditVoucher[s].taxc.invoice_id):"".concat(creditVoucher[s].taxc.current_year.toString().substr(-2)+"-"+creditVoucher[s].taxc.end_year.toString().substr(-2),"/").concat(creditVoucher[s].taxc.invoice_id);_context3.next=803;break;case 802:_context3.t44='';case 803:creditVoucher[s].invoice_id=_context3.t44;delete creditVoucher[s].taxc;_context3.next=807;return array.push(creditVoucher[s]);case 807:_context3.next=841;break;case 809:_context3.next=811;return'Sale Return';case 811:creditVoucher[s].voucher_type=_context3.sent;_context3.next=814;return creditVoucher[s].CreditBuyer;case 814:creditVoucher[s].ledger=_context3.sent;_context3.next=817;return{};case 817:creditVoucher[s].Voucher=_context3.sent;creditVoucher[s].type='debit';_context3.next=821;return creditVoucher[s].total_amount;case 821:creditVoucher[s].debitAmount=_context3.sent;_context3.next=824;return 0;case 824:creditVoucher[s].creditAmount=_context3.sent;creditVoucher[s].amount=creditVoucher[s].total_amount;_context3.next=828;return creditVoucher[s].id;case 828:creditVoucher[s].voucher_number=_context3.sent;_context3.next=831;return creditVoucher[s].invoice_id;case 831:_context3.t45=_context3.sent;if(!(_context3.t45<=9)){_context3.next=836;break;}_context3.t46="".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/00").concat(creditVoucher[s].invoice_id);_context3.next=837;break;case 836:_context3.t46=creditVoucher[s].invoice_id>9?"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/0").concat(creditVoucher[s].invoice_id):"".concat(creditVoucher[s].current_year.toString().substr(-2)+"-"+creditVoucher[s].end_year.toString().substr(-2),"/").concat(creditVoucher[s].invoice_id);case 837:creditVoucher[s].invoice_id=_context3.t46;delete creditVoucher[s].CreditBuyer;_context3.next=841;return array.push(creditVoucher[s]);case 841:s++;_context3.next=710;break;case 844:if(!(debitVoucher&&debitVoucher.length>0)){_context3.next=980;break;}s=0;case 846:if(!(s<debitVoucher.length)){_context3.next=980;break;}if(!ledger.dataValues.sale_key){_context3.next=896;break;}_context3.next=850;return'Purchase Return';case 850:debitVoucher[s].voucher_type=_context3.sent;if(!debitVoucher[s].Voucherid){_context3.next=858;break;}_context3.next=854;return debitVoucher[s].Voucherid.DebitBuyer;case 854:debitVoucher[s].ledger=_context3.sent;delete debitVoucher[s].Voucherid.DebitBuyer;_context3.next=859;break;case 858:debitVoucher[s].ledger={};case 859:_context3.next=861;return debitVoucher[s].Voucherid;case 861:if(!_context3.sent){_context3.next=865;break;}_context3.t47=debitVoucher[s].Voucherid;_context3.next=866;break;case 865:_context3.t47={};case 866:debitVoucher[s].Voucher=_context3.t47;debitVoucher[s].type='Credit';_context3.next=870;return 0;case 870:debitVoucher[s].debitAmount=_context3.sent;_context3.next=873;return debitVoucher[s].total_amount;case 873:debitVoucher[s].creditAmount=_context3.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context3.next=877;return debitVoucher[s].Voucherid;case 877:if(!_context3.sent){_context3.next=881;break;}_context3.t48=debitVoucher[s].Voucherid.id;_context3.next=882;break;case 881:_context3.t48='';case 882:debitVoucher[s].voucher_number=_context3.t48;_context3.next=885;return debitVoucher[s].Voucherid;case 885:if(!_context3.sent){_context3.next=889;break;}_context3.t49=debitVoucher[s].Voucherid.invoice_id<=9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].Voucherid.invoice_id):debitVoucher[s].Voucherid.invoice_id>9?"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].Voucherid.invoice_id):"".concat(debitVoucher[s].Voucherid.current_year.toString().substr(-2)+"-"+debitVoucher[s].Voucherid.end_year.toString().substr(-2),"/").concat(debitVoucher[s].Voucherid.invoice_id);_context3.next=890;break;case 889:_context3.t49='';case 890:debitVoucher[s].invoice_id=_context3.t49;delete debitVoucher[s].Voucherid;_context3.next=894;return array.push(debitVoucher[s]);case 894:_context3.next=977;break;case 896:if(!ledger.dataValues.tax_key){_context3.next=945;break;}_context3.next=899;return'Purchase Return';case 899:debitVoucher[s].voucher_type=_context3.sent;if(!debitVoucher[s].taxd){_context3.next=907;break;}_context3.next=903;return debitVoucher[s].taxd.DebitBuyer;case 903:debitVoucher[s].ledger=_context3.sent;delete debitVoucher[s].taxd.DebitBuyer;_context3.next=908;break;case 907:debitVoucher[s].ledger={};case 908:_context3.next=910;return debitVoucher[s].taxd;case 910:if(!_context3.sent){_context3.next=914;break;}_context3.t50=debitVoucher[s].taxd;_context3.next=915;break;case 914:_context3.t50={};case 915:debitVoucher[s].Voucher=_context3.t50;debitVoucher[s].type='Credit';_context3.next=919;return 0;case 919:debitVoucher[s].debitAmount=_context3.sent;_context3.next=922;return debitVoucher[s].amount;case 922:debitVoucher[s].creditAmount=_context3.sent;debitVoucher[s].amount=debitVoucher[s].amount;_context3.next=926;return debitVoucher[s].taxd;case 926:if(!_context3.sent){_context3.next=930;break;}_context3.t51=debitVoucher[s].taxd.id;_context3.next=931;break;case 930:_context3.t51='';case 931:debitVoucher[s].voucher_number=_context3.t51;_context3.next=934;return debitVoucher[s].taxd;case 934:if(!_context3.sent){_context3.next=938;break;}_context3.t52=debitVoucher[s].taxd.invoice_id<=9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/00").concat(debitVoucher[s].taxd.invoice_id):debitVoucher[s].taxd.invoice_id>9?"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/0").concat(debitVoucher[s].taxd.invoice_id):"".concat(debitVoucher[s].taxd.current_year.toString().substr(-2)+"-"+debitVoucher[s].taxd.end_year.toString().substr(-2),"/").concat(debitVoucher[s].taxd.invoice_id);_context3.next=939;break;case 938:_context3.t52='';case 939:debitVoucher[s].invoice_id=_context3.t52;delete debitVoucher[s].taxd;_context3.next=943;return array.push(debitVoucher[s]);case 943:_context3.next=977;break;case 945:_context3.next=947;return'Purchase Return';case 947:debitVoucher[s].voucher_type=_context3.sent;_context3.next=950;return debitVoucher[s].DebitBuyer;case 950:debitVoucher[s].ledger=_context3.sent;_context3.next=953;return{};case 953:debitVoucher[s].Voucher=_context3.sent;debitVoucher[s].type='Credit';_context3.next=957;return 0;case 957:debitVoucher[s].debitAmount=_context3.sent;_context3.next=960;return debitVoucher[s].total_amount;case 960:debitVoucher[s].creditAmount=_context3.sent;debitVoucher[s].amount=debitVoucher[s].total_amount;_context3.next=964;return debitVoucher[s].id;case 964:debitVoucher[s].voucher_number=_context3.sent;_context3.next=967;return debitVoucher[s].invoice_id;case 967:_context3.t53=_context3.sent;if(!(_context3.t53<=9)){_context3.next=972;break;}_context3.t54="".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/00").concat(debitVoucher[s].invoice_id);_context3.next=973;break;case 972:_context3.t54=debitVoucher[s].invoice_id>9?"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/0").concat(debitVoucher[s].invoice_id):"".concat(debitVoucher[s].current_year.toString().substr(-2)+"-"+debitVoucher[s].end_year.toString().substr(-2),"/").concat(debitVoucher[s].invoice_id);case 973:debitVoucher[s].invoice_id=_context3.t54;delete debitVoucher[s].DebitBuyer;_context3.next=977;return array.push(debitVoucher[s]);case 977:s++;_context3.next=846;break;case 980:if(!(recieptVoucher&&recieptVoucher.length>0)){_context3.next=1026;break;}i=0;case 982:if(!(i<recieptVoucher.length)){_context3.next=1026;break;}_context3.next=985;return recieptVoucher[i].type;case 985:_context3.t55=_context3.sent;if(!(_context3.t55==='debit')){_context3.next=995;break;}_context3.next=989;return recieptVoucher[i].total_amount;case 989:recieptVoucher[i].debitAmount=_context3.sent;_context3.next=992;return 0;case 992:recieptVoucher[i].creditAmount=_context3.sent;_context3.next=1001;break;case 995:_context3.next=997;return 0;case 997:recieptVoucher[i].debitAmount=_context3.sent;_context3.next=1000;return recieptVoucher[i].total_amount;case 1000:recieptVoucher[i].creditAmount=_context3.sent;case 1001:_context3.next=1003;return recieptVoucher[i].ReciptBuyer;case 1003:recieptVoucher[i].ledger=_context3.sent;delete recieptVoucher[i].ReciptBuyer;_context3.next=1007;return'reciept';case 1007:recieptVoucher[i].voucher_type=_context3.sent;_context3.next=1010;return recieptVoucher[i].id;case 1010:recieptVoucher[i].voucher_number=_context3.sent;_context3.next=1013;return recieptVoucher[i].invoice_id;case 1013:_context3.t56=_context3.sent;if(!(_context3.t56<=9)){_context3.next=1018;break;}_context3.t57="".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/00").concat(recieptVoucher[i].invoice_id);_context3.next=1019;break;case 1018:_context3.t57=recieptVoucher[i].invoice_id>9?"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/0").concat(recieptVoucher[i].invoice_id):"".concat(recieptVoucher[i].current_year.toString().substr(-2)+"-"+recieptVoucher[i].end_year.toString().substr(-2),"/").concat(recieptVoucher[i].invoice_id);case 1019:recieptVoucher[i].invoice_id=_context3.t57;recieptVoucher[s].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context3.next=1023;return array.push(recieptVoucher[i]);case 1023:i++;_context3.next=982;break;case 1026:if(!(paymentVoucher&&paymentVoucher.length>0)){_context3.next=1072;break;}i=0;case 1028:if(!(i<paymentVoucher.length)){_context3.next=1072;break;}_context3.next=1031;return paymentVoucher[i].type;case 1031:_context3.t58=_context3.sent;if(!(_context3.t58==='debit')){_context3.next=1041;break;}_context3.next=1035;return paymentVoucher[i].total_amount;case 1035:paymentVoucher[i].debitAmount=_context3.sent;_context3.next=1038;return 0;case 1038:paymentVoucher[i].creditAmount=_context3.sent;_context3.next=1047;break;case 1041:_context3.next=1043;return 0;case 1043:paymentVoucher[i].debitAmount=_context3.sent;_context3.next=1046;return paymentVoucher[i].total_amount;case 1046:paymentVoucher[i].creditAmount=_context3.sent;case 1047:_context3.next=1049;return paymentVoucher[i].PaymentBuyer;case 1049:paymentVoucher[i].ledger=_context3.sent;delete paymentVoucher[i].PaymentBuyer;_context3.next=1053;return'payment';case 1053:paymentVoucher[i].voucher_type=_context3.sent;_context3.next=1056;return paymentVoucher[i].id;case 1056:paymentVoucher[i].voucher_number=_context3.sent;_context3.next=1059;return paymentVoucher[i].invoice_id;case 1059:_context3.t59=_context3.sent;if(!(_context3.t59<=9)){_context3.next=1064;break;}_context3.t60="".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/00").concat(paymentVoucher[i].invoice_id);_context3.next=1065;break;case 1064:_context3.t60=paymentVoucher[i].invoice_id>9?"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/0").concat(paymentVoucher[i].invoice_id):"".concat(paymentVoucher[i].current_year.toString().substr(-2)+"-"+paymentVoucher[i].end_year.toString().substr(-2),"/").concat(paymentVoucher[i].invoice_id);case 1065:paymentVoucher[i].invoice_id=_context3.t60;paymentVoucher[s].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context3.next=1069;return array.push(paymentVoucher[i]);case 1069:i++;_context3.next=1028;break;case 1072:if(!(reciverrecieptVoucher&&reciverrecieptVoucher.length>0)){_context3.next=1106;break;}i=0;case 1074:if(!(i<reciverrecieptVoucher.length)){_context3.next=1106;break;}_context3.next=1077;return reciverrecieptVoucher[i].total_amount;case 1077:reciverrecieptVoucher[i].debitAmount=_context3.sent;_context3.next=1080;return 0;case 1080:reciverrecieptVoucher[i].creditAmount=_context3.sent;_context3.next=1083;return reciverrecieptVoucher[i].ReciptReciver;case 1083:reciverrecieptVoucher[i].ledger=_context3.sent;delete reciverrecieptVoucher[i].ReciptReciver;_context3.next=1087;return'reciept reciver';case 1087:reciverrecieptVoucher[i].voucher_type=_context3.sent;_context3.next=1090;return reciverrecieptVoucher[i].id;case 1090:reciverrecieptVoucher[i].voucher_number=_context3.sent;_context3.next=1093;return reciverrecieptVoucher[i].invoice_id;case 1093:_context3.t61=_context3.sent;if(!(_context3.t61<=9)){_context3.next=1098;break;}_context3.t62="".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverrecieptVoucher[i].invoice_id);_context3.next=1099;break;case 1098:_context3.t62=reciverrecieptVoucher[i].invoice_id>9?"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverrecieptVoucher[i].invoice_id):"".concat(reciverrecieptVoucher[i].current_year.toString().substr(-2)+"-"+reciverrecieptVoucher[i].end_year.toString().substr(-2),"/").concat(reciverrecieptVoucher[i].invoice_id);case 1099:reciverrecieptVoucher[i].invoice_id=_context3.t62;reciverrecieptVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context3.next=1103;return array.push(reciverrecieptVoucher[i]);case 1103:i++;_context3.next=1074;break;case 1106:if(!(reciverpaymentVoucher&&reciverpaymentVoucher.length>0)){_context3.next=1140;break;}i=0;case 1108:if(!(i<reciverpaymentVoucher.length)){_context3.next=1140;break;}_context3.next=1111;return 0;case 1111:reciverpaymentVoucher[i].debitAmount=_context3.sent;_context3.next=1114;return reciverpaymentVoucher[i].total_amount;case 1114:reciverpaymentVoucher[i].creditAmount=_context3.sent;_context3.next=1117;return reciverpaymentVoucher[i].PaymentReciver;case 1117:reciverpaymentVoucher[i].ledger=_context3.sent;delete reciverpaymentVoucher[i].PaymentReciver;_context3.next=1121;return'payment reciver';case 1121:reciverpaymentVoucher[i].voucher_type=_context3.sent;_context3.next=1124;return reciverpaymentVoucher[i].id;case 1124:reciverpaymentVoucher[i].voucher_number=_context3.sent;_context3.next=1127;return reciverpaymentVoucher[i].invoice_id;case 1127:_context3.t63=_context3.sent;if(!(_context3.t63<=9)){_context3.next=1132;break;}_context3.t64="".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/00").concat(reciverpaymentVoucher[i].invoice_id);_context3.next=1133;break;case 1132:_context3.t64=reciverpaymentVoucher[i].invoice_id>9?"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/0").concat(reciverpaymentVoucher[i].invoice_id):"".concat(reciverpaymentVoucher[i].current_year.toString().substr(-2)+"-"+reciverpaymentVoucher[i].end_year.toString().substr(-2),"/").concat(reciverpaymentVoucher[i].invoice_id);case 1133:reciverpaymentVoucher[i].invoice_id=_context3.t64;reciverpaymentVoucher[i].account_group_type=ledger.dataValues.account_group.dataValues.type=='dr'?'debit':'credit';_context3.next=1137;return array.push(reciverpaymentVoucher[i]);case 1137:i++;_context3.next=1108;break;case 1140:_context3.next=1142;return(0,_arraySort["default"])(array,'invoice_date');case 1142:mainArray=_context3.sent;_context3.next=1145;return mainArray[mainArray.length-1];case 1145:lastObj=_context3.sent;_context3.next=1148;return mainArray.pop(mainArray.length-1);case 1148:mainArray.unshift(lastObj);_context3.next=1151;return calculationbank(mainArray);case 1151:calData=_context3.sent;return _context3.abrupt("return",calData);case 1155:return _context3.abrupt("return",[]);case 1156:_context3.next=1161;break;case 1158:_context3.prev=1158;_context3.t65=_context3["catch"](0);return _context3.abrupt("return",{statusCode:res.statusCode,success:false,error:_context3.t65,message:"Something went wrong!"});case 1161:case"end":return _context3.stop();}},_callee3,null,[[0,1158]]);}));return function(_x40,_x41,_x42,_x43){return _ref3.apply(this,arguments);};}();exports.groupData=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(account_id,data,res){var _invoice_date55,_invoice_date56,_invoice_date57,_invoice_date58,_invoice_date59,_invoice_date60,_invoice_date61,_invoice_date62,_invoice_date63,_invoice_date64,_invoice_date65,_invoice_date66,_invoice_date67,_invoice_date68,_invoice_date69,_invoice_date70,_invoice_date71,_invoice_date72,Mainarray,query,ledger,totalcalculate_openingblance,returngroup,calData;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return account_id;case 3:data.account_id=_context5.sent;_context5.next=6;return[];case 6:Mainarray=_context5.sent;if(!data.account_id){_context5.next=11;break;}_context5.next=10;return{account_group_id:data.account_id};case 10:query=_context5.sent;case 11:if(!data.sub_account_id){_context5.next=15;break;}_context5.next=14;return{sub_account_group_id:data.sub_account_id};case 14:query=_context5.sent;case 15:_context5.next=17;return _ledger["default"].findAll({where:_defineProperty({},Op.and,[query,{company_id:data.company_id}]),attributes:['id','uid','name','amount','opening_balance','account_group_id','sub_account_group_id'],include:[{model:_accountGroup["default"]},{model:_subAccountGroup["default"]},{model:_journalInteries["default"],where:{invoice_date:(_invoice_date55={},_defineProperty(_invoice_date55,Op.gte,data.start_date),_defineProperty(_invoice_date55,Op.lte,data.end_date),_invoice_date55)},required:false,attributes:['id','uid','type','invoice_date','amount','journa_voucher_id'],include:[{model:_journalVoucher["default"],required:false,attributes:['id','uid','total_amount','invoice_id','invoice_date'],as:'Voucher'}]},{model:_recieptVoucher["default"],as:'Buyer',where:{invoice_date:(_invoice_date56={},_defineProperty(_invoice_date56,Op.gte,data.start_date),_defineProperty(_invoice_date56,Op.lte,data.end_date),_invoice_date56)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PBuyer',required:false,where:{invoice_date:(_invoice_date57={},_defineProperty(_invoice_date57,Op.gte,data.start_date),_defineProperty(_invoice_date57,Op.lte,data.end_date),_invoice_date57)},attributes:['id','uid','total_amount','type','receive_type']},{model:_recieptVoucher["default"],as:'RBuyer',where:{invoice_date:(_invoice_date58={},_defineProperty(_invoice_date58,Op.gte,data.start_date),_defineProperty(_invoice_date58,Op.lte,data.end_date),_invoice_date58)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PRBuyer',required:false,where:{invoice_date:(_invoice_date59={},_defineProperty(_invoice_date59,Op.gte,data.start_date),_defineProperty(_invoice_date59,Op.lte,data.end_date),_invoice_date59)},attributes:['id','uid','total_amount','type','receive_type']},{model:_saleVoucher["default"],where:{invoice_date:(_invoice_date60={},_defineProperty(_invoice_date60,Op.gte,data.start_date),_defineProperty(_invoice_date60,Op.lte,data.end_date),_invoice_date60)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],where:{invoice_date:(_invoice_date61={},_defineProperty(_invoice_date61,Op.gte,data.start_date),_defineProperty(_invoice_date61,Op.lte,data.end_date),_invoice_date61)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_saleVoucher["default"],as:"roundsales",where:{invoice_date:(_invoice_date62={},_defineProperty(_invoice_date62,Op.gte,data.start_date),_defineProperty(_invoice_date62,Op.lte,data.end_date),_invoice_date62)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"roundpurchase",where:{invoice_date:(_invoice_date63={},_defineProperty(_invoice_date63,Op.gte,data.start_date),_defineProperty(_invoice_date63,Op.lte,data.end_date),_invoice_date63)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_creditVoucher["default"],where:{invoice_date:(_invoice_date64={},_defineProperty(_invoice_date64,Op.gte,data.start_date),_defineProperty(_invoice_date64,Op.lte,data.end_date),_invoice_date64)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Debit'}}]},{model:_debitVoucher["default"],where:{invoice_date:(_invoice_date65={},_defineProperty(_invoice_date65,Op.gte,data.start_date),_defineProperty(_invoice_date65,Op.lte,data.end_date),_invoice_date65)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Credit'}}]},{model:_itemInteries["default"],required:false,where:{invoice_date:(_invoice_date66={},_defineProperty(_invoice_date66,Op.gte,data.start_date),_defineProperty(_invoice_date66,Op.lte,data.end_date),_invoice_date66)},include:[{model:_saleVoucher["default"],as:"ItemVouchers",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_purchaseVoucher["default"],as:"ItemVoucherp",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_debitVoucher["default"],as:"ItemVoucherd",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_creditVoucher["default"],as:"ItemVoucherc",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']}]},{model:_voucherInteries["default"],as:'vocher_entries',required:false,where:{invoice_date:(_invoice_date67={},_defineProperty(_invoice_date67,Op.gte,data.start_date),_defineProperty(_invoice_date67,Op.lte,data.end_date),_invoice_date67)},attributes:['id','uid','amount','type','ledger_id']},{model:_taxInteries["default"],as:'tax_entries',required:false,where:{invoice_date:(_invoice_date68={},_defineProperty(_invoice_date68,Op.gte,data.start_date),_defineProperty(_invoice_date68,Op.lte,data.end_date),_invoice_date68)},attributes:['id','uid','amount','type','tax_ledger_id']},{model:_saleVoucher["default"],as:"discountsales",where:{invoice_date:(_invoice_date69={},_defineProperty(_invoice_date69,Op.gte,data.start_date),_defineProperty(_invoice_date69,Op.lte,data.end_date),_invoice_date69)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"discountPurchases",where:{invoice_date:(_invoice_date70={},_defineProperty(_invoice_date70,Op.gte,data.start_date),_defineProperty(_invoice_date70,Op.lte,data.end_date),_invoice_date70)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_creditVoucher["default"],as:"discountCredit",where:{invoice_date:(_invoice_date71={},_defineProperty(_invoice_date71,Op.gte,data.start_date),_defineProperty(_invoice_date71,Op.lte,data.end_date),_invoice_date71)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_debitVoucher["default"],as:"discountDebit",where:{invoice_date:(_invoice_date72={},_defineProperty(_invoice_date72,Op.gte,data.start_date),_defineProperty(_invoice_date72,Op.lte,data.end_date),_invoice_date72)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]}]}).map(function(node){return node.get({plain:true});});case 17:ledger=_context5.sent;_context5.next=20;return(0,_voucherReport.decreptionReport)(ledger,'array',data.data.email);case 20:ledger=_context5.sent;if(!(ledger.length>0)){_context5.next=61;break;}_context5.next=24;return{creditbalnce:0,debitbalnce:0,totalbalnce:0};case 24:totalcalculate_openingblance=_context5.sent;_context5.next=27;return ledger.map(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(item){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:item.total_amount=0;item.open_type=item.opening_balance;item.name=item.name;item.subAccount=item.sub_account_group?item.sub_account_group:{};item.account=item.account_group?item.account_group:{};item.accounttype=item.account_group&&item.account_group.type=="dr"?'debit':'credit';item.open_amount=item.amount?Number(item.amount):item.amount;delete item.amount;delete item.opening_balance;delete item.sub_account_group;delete item.account_group;item.invoice_id='';item.voucher_type='';item.debitAmount=0;item.creditAmount=0;if(item.journal_entries.length>0){item.journal_entries.forEach(function(journal){if(journal.type==='debit'){item.debitAmount=Number(journal.amount)+Number(item.debitAmount);}else{item.creditAmount=Number(journal.amount)+Number(item.creditAmount);}item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.Buyer.length>0){item.Buyer.forEach(function(reciept){if(reciept.type==='debit'){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(reciept.total_amount)+Number(item.creditAmount);}item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.PBuyer.length>0){item.PBuyer.forEach(function(payment){if(payment.type==='debit'){item.debitAmount=Number(payment.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);}item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.RBuyer.length>0){item.RBuyer.forEach(function(reciept){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));});}if(item.PRBuyer.length>0){item.PRBuyer.forEach(function(payment){item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.sales_vouchers&&item.sales_vouchers.length>0){item.sales_vouchers.forEach(function(sale){item.debitAmount=Number(sale.total_amount)+Number(item.debitAmount);item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.purchase_vouchers.length>0){item.purchase_vouchers.forEach(function(purchase){item.creditAmount=Number(purchase.total_amount)+Number(item.creditAmount);item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.roundsales&&item.roundsales.length>0){item.roundsales.forEach(function(sale){if(sale.roundoff_ledger_id){if(sale.roundoff_type=="debit"||sale.roundoff_type=="Debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.roundpurchase.length>0){item.roundpurchase.forEach(function(purchase){if(purchase.roundoff_ledger_id){if(purchase.roundoff_type=="debit"||purchase.roundoff_type=="debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.roundsales&&item.roundsales.length<0||item.roundpurchase.length<0){if(item.discountsales&&item.discountsales.length>0){item.discountsales.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountPurchases&&item.discountPurchases.length>0){item.discountPurchases.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountCredit&&item.discountCredit.length>0){item.discountCredit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountDebit&&item.discountDebit.length>0){item.discountDebit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}}if(item.credit_vouchers.length>0){item.credit_vouchers.forEach(function(credit){item.debitAmount=Number(credit.total_amount)+Number(item.debitAmount);item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.debit_vouchers.length>0){item.debit_vouchers.forEach(function(debit){item.debitAmount=Number(debit.total_amount)+Number(item.debitAmount);item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.item_entries.length>0){item.item_entries.forEach(function(voucher){if(voucher.ItemVouchers){item.invoice_date=voucher.ItemVouchers.invoice_date;item.invoice_id=voucher.ItemVouchers.invoice_id<=9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/00").concat(voucher.ItemVouchers.invoice_id):voucher.ItemVouchers.invoice_id>9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/0").concat(voucher.ItemVouchers.invoice_id):"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/").concat(voucher.ItemVouchers.invoice_id);item.voucher_type='sale';}if(voucher.ItemVoucherc){item.invoice_date=voucher.ItemVoucherc.invoice_date;item.invoice_id=voucher.ItemVoucherc.invoice_id<=9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherc.invoice_id):voucher.ItemVoucherc.invoice_id>9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherc.invoice_id):"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherc.invoice_id);item.voucher_type='credit';}if(voucher.ItemVoucherd){item.invoice_date=voucher.ItemVoucherd.invoice_date;item.invoice_id=voucher.ItemVoucherd.invoice_id<=9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherd.invoice_id):voucher.ItemVoucherd.invoice_id>9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherd.invoice_id):"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherd.invoice_id);item.voucher_type='debit';}if(voucher.ItemVoucherp){item.invoice_date=voucher.ItemVoucherp.invoice_date;item.invoice_id=voucher.ItemVoucherp.invoice_id;item.voucher_type='purchase';}if(voucher.type==="Sales"||voucher.type==="sales"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}else if(voucher.type==="Purchase"||voucher.type==="purchase"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Debit"||voucher.type==="Debit"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Credit"||voucher.type==="Credit"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.vocher_entries.length>0){
//     item.vocher_entries.forEach(voucher=>{
//         if(voucher.type==="Sales" || voucher.type==="sales"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Purchase" || voucher.type==="purchase"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Debit" || voucher.type==="Debit"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.debitAmount);
//         }else if(voucher.type==="Credit" || voucher.type==="Credit"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount))+Number(item.open_amount);
//     })
// }
if(item.tax_entries.length>0){item.tax_entries.forEach(function(tax){if(tax.type==="Sales"||tax.type==="sales"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}else if(tax.type==="Purchase"||tax.type==="purchase"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Debit"||tax.type==="debit"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Credit"||tax.type==="credit"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}item.total_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.discountsales && item.discountsales.length>0){
//     item.discountsales.forEach(sale=>{
//         item.debitAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.creditAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.total_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountPurchases && item.discountPurchases.length>0){
//     item.discountPurchases.forEach(sale=>{
//         item.creditAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.debitAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.total_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountCredit && item.discountCredit.length>0){
//     item.discountCredit.forEach(sale=>{
//         item.debitAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.creditAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.total_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.discountDebit && item.discountDebit.length>0){
//     item.discountDebit.forEach(sale=>{
//         item.creditAmount = sale.discount && Number(sale.discount)<0 ? -1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount)
//         item.debitAmount = sale.discount && Number(sale.discount)>0 ? Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount)
//         item.total_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount));
//     })
// }
// if(item.accounttype === "debit"){
//     item.total_amount = Number(item.total_amount)-Number(item.open_amount);
// }
// if(item.accounttype === "credit"){
//     item.total_amount = Number(item.total_amount)+Number(item.open_amount);
// }
if(item.open_type==="debit"){item.total_amount=Number(item.total_amount)-Number(item.open_amount);if(item.total_amount<0){item.total_amount=-1*Number(item.total_amount);}item.closeing_type='debit';item.accounttype=item.closeing_type;}if(item.open_type==="credit"){item.total_amount=Number(item.total_amount)+Number(item.open_amount);if(item.total_amount<0){item.total_amount=-1*Number(item.total_amount);}item.closeing_type='credit';item.accounttype=item.closeing_type;}delete item.journal_entries;delete item.reciept_vouchers;delete item.payment_vouchers;delete item.sales_vouchers;delete item.purchase_vouchers;delete item.credit_vouchers;delete item.debit_vouchers;delete item.item_entries;delete item.vocher_entries;delete item.tax_entries;delete item.Buyer;delete item.PBuyer;delete item.PRBuyer;delete item.RBuyer;delete item.roundsales;delete item.roundpurchase;delete item.discountsales;delete item.discountPurchases;delete item.discountCredit;delete item.discountDebit;case 51:case"end":return _context4.stop();}},_callee4);}));return function(_x47){return _ref5.apply(this,arguments);};}());case 27:_context5.next=29;return groupFuncation(ledger);case 29:returngroup=_context5.sent;if(!returngroup){_context5.next=33;break;}_context5.next=33;return Object.keys(returngroup).map(function(item){if(item==="MainGroup"){if(returngroup[item].length>0){var _a={name:returngroup[item][0].account.name,open_amount:0,total_amount:0,closeing_type:'',sub_uid:'',account_group_id:'',subAccount:{},accounttype:'debit',debitAmount:0,creditAmount:0,ishead:true,ismain:true};var b=[];returngroup[item].map(function(element){// a.open_amount = Number(a.open_amount)+Number(element.open_amount?element.open_amount:0);
// a.subAccount = {};
// a.total_amount = Number(a.total_amount?a.total_amount:0)+Number(element.total_amount?element.total_amount:0);
// a.debitAmount =  Number(a.debitAmount)+Number(element.debitAmount?element.debitAmount:0);
// a.creditAmount =  Number(a.creditAmount)+Number(element.creditAmount?element.creditAmount:0);
// a.account_group_id = element.account_group_id;   
if(element.open_type=="credit"){if(element.open_type==element.accounttype){if(Number(Number(element.creditAmount)+Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)+Number(Number(element.open_amount)))){element.accounttype='debit';}}else{if(Number(Number(element.creditAmount)-Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)-Number(Number(element.open_amount)))){element.accounttype='debit';}}}else{if(element.open_type==element.accounttype){if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}else{if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}}if(element.accounttype==element.open_type){if(element.account.type=="dr"){if(element.accounttype=="credit"){element.creditAmount=-1*Number(element.creditAmount);element.total_amount=-1*Number(element.total_amount);}}if(element.account.type=="cr"){if(element.accounttype=="debit"){element.debitAmount=-1*Number(element.debitAmount);element.total_amount=-1*Number(element.total_amount);}}}else{if(element.accounttype=="credit"){element.creditAmount=-1*Number(element.creditAmount);element.total_amount=-1*Number(element.total_amount);}if(element.accounttype=="debit"){element.debitAmount=-1*Number(element.debitAmount);element.total_amount=-1*Number(element.total_amount);}}// console.log("element.accounttype", element)
// a.closeing_amount = Number(element.closeing_amount?element.closeing_amount:0)+Number(Number(b.length>0?b[b.length-1].closeing_amount:0));
b.push(element);});// if(Number(a.creditAmount)>Number(a.debitAmount)){
//     a.accounttype = 'credit';
//     a.total_amount = Number(a.creditAmount)-Number(a.debitAmount);
// }else if(Number(a.debitAmount)>Number(a.creditAmount)){
//     a.accounttype = 'debit';
//     a.total_amount = Number(a.debitAmount)-Number(a.creditAmount);
// }
// b.unshift(a);
Mainarray=Mainarray.concat(b);}}else{// let a = {
//     name:returngroup[item][0].account.name,
//     open_amount:0,
//     total_amount:0,
//     closeing_type:'',
//     sub_uid:'',
//     account_group_id:'',
//     subAccount:{},
//     accounttype:'debit',
//     debitAmount:0,
//     creditAmount:0,
//     ishead:true,
//     ismain:true
// };
var _b=[];returngroup[item].map(function(element){// a.open_amount = Number(a.open_amount)+Number(element.open_amount?element.open_amount:0);
// a.subAccount = {};
// a.total_amount = Number(a.total_amount?a.total_amount:0)+Number(element.total_amount?element.total_amount:0);
// a.debitAmount =  Number(a.debitAmount)+Number(element.debitAmount?element.debitAmount:0);
// a.creditAmount =  Number(a.creditAmount)+Number(element.creditAmount?element.creditAmount:0);
// a.account_group_id = element.account_group_id;   
if(element.open_type=="credit"){if(element.open_type==element.accounttype){if(Number(Number(element.creditAmount)+Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)+Number(Number(element.open_amount)))){element.accounttype='debit';}}else{if(Number(Number(element.creditAmount)-Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)-Number(Number(element.open_amount)))){element.accounttype='debit';}}}else{if(element.open_type==element.accounttype){if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}else{if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}}if(element.accounttype==element.open_type){if(element.account.type=="dr"){if(element.accounttype=="credit"){element.creditAmount=-1*Number(element.creditAmount);element.total_amount=-1*Number(element.total_amount);}}if(element.account.type=="cr"){if(element.accounttype=="debit"){element.debitAmount=-1*Number(element.debitAmount);element.total_amount=-1*Number(element.total_amount);}}}else{if(element.accounttype=="credit"){element.creditAmount=-1*Number(element.creditAmount);element.total_amount=-1*Number(element.total_amount);}if(element.accounttype=="debit"){element.debitAmount=-1*Number(element.debitAmount);element.total_amount=-1*Number(element.total_amount);}}// a.closeing_amount = Number(element.closeing_amount?element.closeing_amount:0)+Number(Number(b.length>0?b[b.length-1].closeing_amount:0));
_b.push(element);});if(Number(a.creditAmount)>Number(a.debitAmount)){a.accounttype='credit';a.total_amount=Number(a.creditAmount)-Number(a.debitAmount);}else if(Number(a.debitAmount)>Number(a.creditAmount)){a.accounttype='debit';a.total_amount=Number(a.debitAmount)-Number(a.creditAmount);}_b.unshift(a);Mainarray=Mainarray.concat(_b);}});case 33:if(!(Mainarray.length>0)){_context5.next=58;break;}_context5.next=36;return checkValid(Mainarray[0].account_group_id);case 36:if(!_context5.sent){_context5.next=45;break;}_context5.next=39;return getAllGroupVouchercurrent(data.start_date,data.end_date,Mainarray[0].account_group_id,data.company_id,data.data.email);case 39:totalcalculate_openingblance=_context5.sent;Mainarray[0].total_amount=Number(Mainarray[0].total_amount)+Number(totalcalculate_openingblance.totalbalnce?totalcalculate_openingblance.totalbalnce:0);Mainarray[0].creditAmount=Number(Mainarray[0].creditAmount)+Number(totalcalculate_openingblance.creditbalnce?totalcalculate_openingblance.creditbalnce:0);Mainarray[0].debitAmount=Number(Mainarray[0].debitAmount)+Number(totalcalculate_openingblance.debitbalnce?totalcalculate_openingblance.debitbalnce:0);// if(Mainarray[0].accounttype=='debit'){
//     if(Mainarray[0].total_amount<0){
//         Mainarray[0].total_amount = -1*Number(Mainarray[0].total_amount);
//     }
// }
// if(Mainarray[0].accounttype=='credit'){
//     if(Mainarray[0].total_amount<0){
//         Mainarray[0].total_amount = -1*Number(Mainarray[0].total_amount);
//     }
// }
_context5.next=51;break;case 45:_context5.next=47;return getAllGroupVoucherprivious(data.start_date,data.end_date,Mainarray[0].account_group_id,data.company_id,data.data.email);case 47:totalcalculate_openingblance=_context5.sent;Mainarray[0].total_amount=Number(Mainarray[0].total_amount)+Number(totalcalculate_openingblance.totalbalnce?totalcalculate_openingblance.totalbalnce:0);Mainarray[0].creditAmount=Number(Mainarray[0].creditAmount)+Number(totalcalculate_openingblance.creditbalnce?totalcalculate_openingblance.creditbalnce:0);Mainarray[0].debitAmount=Number(Mainarray[0].debitAmount)+Number(totalcalculate_openingblance.debitbalnce?totalcalculate_openingblance.debitbalnce:0);// if(Mainarray[0].accounttype=='debit'){
//     if(Mainarray[0].total_amount<0){
//         Mainarray[0].total_amount = -1*Number(Mainarray[0].total_amount);
//     }
// }
// if(Mainarray[0].accounttype=='credit'){
//     if(Mainarray[0].total_amount<0){
//         Mainarray[0].total_amount = -1*Number(Mainarray[0].total_amount);
//     }
// }
case 51:return _context5.abrupt("return",Mainarray);case 54:calData=_context5.sent;return _context5.abrupt("return",calData.name?[calData]:[]);case 58:return _context5.abrupt("return",[]);case 59:_context5.next=62;break;case 61:return _context5.abrupt("return",[]);case 62:_context5.next=67;break;case 64:_context5.prev=64;_context5.t0=_context5["catch"](0);return _context5.abrupt("return",{statusCode:res.statusCode,success:false,error:_context5.t0.message,message:"Something went wrong!"});case 67:case"end":return _context5.stop();}},_callee5,null,[[0,64]]);}));return function(_x44,_x45,_x46){return _ref4.apply(this,arguments);};}();exports.getCurrentYearData=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(data,res,finalAmount,pricerate){var _invoice_date73,_invoice_date74,_invoice_date75,_invoice_date76,_invoice_date77,stockVoucher,saleVoucher,purchaseVoucher,creditVoucher,debitVoucher,mainArray,itemArray,group,returnAmount,_i,_Object$entries,_Object$entries$_i,key,value,salevoucherAmount,purchasevoucherAmount,debitvoucherAmount,creditvoucherAmount,stockcreditvoucherAmount,stockdebitvoucherAmount,_loop,_i2,_Object$entries2,closeStockAmount;return _regeneratorRuntime().wrap(function _callee6$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_context7.prev=0;// return {finalAmount:finalAmount, pricerate:pricerate, data:data}
debitVoucher=[];_context7.next=4;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{type:'Sales'},{company_id:data.company_id},{invoice_date:(_invoice_date73={},_defineProperty(_invoice_date73,Op.gte,data.start_date),_defineProperty(_invoice_date73,Op.lte,data.end_date),_invoice_date73)}]),include:[{model:_items["default"],as:"itemone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 4:saleVoucher=_context7.sent;_context7.next=7;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{type:'Purchase'},{company_id:data.company_id},{invoice_date:(_invoice_date74={},_defineProperty(_invoice_date74,Op.gte,data.start_date),_defineProperty(_invoice_date74,Op.lte,data.end_date),_invoice_date74)}]),include:[{model:_items["default"],as:"itemone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 7:purchaseVoucher=_context7.sent;_context7.next=10;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{type:'Debit'},{company_id:data.company_id},{invoice_date:(_invoice_date75={},_defineProperty(_invoice_date75,Op.gte,data.start_date),_defineProperty(_invoice_date75,Op.lte,data.end_date),_invoice_date75)}]),include:[{model:_items["default"],as:"itemone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 10:creditVoucher=_context7.sent;_context7.next=13;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{type:'Credit'},{company_id:data.company_id},{invoice_date:(_invoice_date76={},_defineProperty(_invoice_date76,Op.gte,data.start_date),_defineProperty(_invoice_date76,Op.lte,data.end_date),_invoice_date76)}]),include:[{model:_items["default"],as:"itemone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 13:debitVoucher=_context7.sent;_context7.next=16;return _item_stock_voucher_entries["default"].findAll({where:_defineProperty({},Op.and,[{invoice_date:(_invoice_date77={},_defineProperty(_invoice_date77,Op.gte,data.start_date),_defineProperty(_invoice_date77,Op.lte,data.end_date),_invoice_date77)},{company_id:data.company_id}]),include:[{model:_items["default"],as:"itemsone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 16:stockVoucher=_context7.sent;mainArray=[];_context7.next=20;return _items["default"].findAll({where:{company_id:data.company_id}});case 20:itemArray=_context7.sent;_context7.next=23;return(0,_itemEntries.decreptionItem)(itemArray,'array',data.data.email);case 23:itemArray=_context7.sent;_context7.next=26;return(0,_itemEntries.decreptionItem)(saleVoucher,'array',data.data.email);case 26:saleVoucher=_context7.sent;_context7.next=29;return(0,_itemEntries.decreptionItem)(purchaseVoucher,'array',data.data.email);case 29:purchaseVoucher=_context7.sent;_context7.next=32;return(0,_itemEntries.decreptionItem)(creditVoucher,'array',data.data.email);case 32:creditVoucher=_context7.sent;_context7.next=35;return(0,_itemEntries.decreptionItem)(debitVoucher,'array',data.data.email);case 35:debitVoucher=_context7.sent;_context7.next=38;return(0,_itemEntries.decreptionItem)(stockVoucher,'array',data.data.email);case 38:stockVoucher=_context7.sent;// return {saleVoucher:saleVoucher}
if(saleVoucher.length>0){saleVoucher.map(function(item){item.voucher='sales';mainArray.push(item);});}if(purchaseVoucher.length>0){purchaseVoucher.map(function(item){item.voucher='purchase';mainArray.push(item);});}if(creditVoucher.length>0){creditVoucher.map(function(item){item.voucher='credit';mainArray.push(item);});}if(debitVoucher.length>0){debitVoucher.map(function(item){item.voucher='debit';mainArray.push(item);});}if(stockVoucher.length>0){stockVoucher.map(function(item){item.voucher='stock';item.itemone=item.itemsone;delete item.itemsone;mainArray.push(item);});}// return {itemArray:itemArray, mainArray:mainArray, data:data}
group=mainArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});// let returnAmount = 0;
// let amount = await itemArray.map(calAmount => {
//     if(calAmount.rate){
//         return  Number(calAmount.quantity)*Number(calAmount.rate);
//     }else{
//         return 0;
//     }
// });
returnAmount=0;//await Number(amount.reduce((a, b) => Number(a) + Number(b), 0));
for(_i=0,_Object$entries=Object.entries(finalAmount);_i<_Object$entries.length;_i++){_Object$entries$_i=_slicedToArray(_Object$entries[_i],2),key=_Object$entries$_i[0],value=_Object$entries$_i[1];returnAmount=Number(returnAmount)+Number(Number(value?value:0)*Number(pricerate[key]?pricerate[key]:0));}// return {group:group}
salevoucherAmount=0;purchasevoucherAmount=0;debitvoucherAmount=0;creditvoucherAmount=0;stockcreditvoucherAmount=0;stockdebitvoucherAmount=0;_loop=/*#__PURE__*/_regeneratorRuntime().mark(function _loop(){var _Object$entries2$_i,key,value;return _regeneratorRuntime().wrap(function _loop$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:_Object$entries2$_i=_slicedToArray(_Object$entries2[_i2],2),key=_Object$entries2$_i[0],value=_Object$entries2$_i[1];value.map(function(item){if(item.voucher==='sales'&&item.name==key){salevoucherAmount+=Number(item.quantity)*Number(pricerate[key]);}if(item.voucher==='purchase'&&item.name==key){purchasevoucherAmount+=Number(item.quantity)*Number(pricerate[key]);}if(item.voucher==='debit'&&item.name==key){debitvoucherAmount+=Number(item.quantity)*Number(pricerate[key]);}if(item.voucher==='credit'&&item.name==key){creditvoucherAmount+=Number(item.quantity)*Number(pricerate[key]);}if(item.voucher==='stock'&&item.type=="Debit"&&item.name==key){stockdebitvoucherAmount+=Number(item.quantity)*Number(pricerate[key]);}if(item.voucher==='stock'&&item.type=="Credit"&&item.name==key){stockcreditvoucherAmount+=Number(item.quantity)*Number(pricerate[key]);}});case 2:case"end":return _context6.stop();}},_loop);});_i2=0,_Object$entries2=Object.entries(group);case 55:if(!(_i2<_Object$entries2.length)){_context7.next=60;break;}return _context7.delegateYield(_loop(),"t0",57);case 57:_i2++;_context7.next=55;break;case 60:// finalAmount = await getOldYearData(data, res);
closeStockAmount=Number(returnAmount)-Number(salevoucherAmount)+Number(purchasevoucherAmount)+Number(creditvoucherAmount)-Number(debitvoucherAmount)+Number(stockdebitvoucherAmount)-Number(stockcreditvoucherAmount);// return {salevoucherAmount:salevoucherAmount, purchasevoucherAmount:purchasevoucherAmount, creditvoucherAmount:creditvoucherAmount, debitvoucherAmount:debitvoucherAmount , finalAmount:closeStockAmount}
return _context7.abrupt("return",{closeStockAmount:closeStockAmount,returnAmount:returnAmount});case 64:_context7.prev=64;_context7.t1=_context7["catch"](0);return _context7.abrupt("return",{statusCode:res.statusCode,success:false,error:_context7.t1,message:"Something went wrong!"});case 67:case"end":return _context7.stop();}},_callee6,null,[[0,64]]);}));return function(_x48,_x49,_x50,_x51){return _ref6.apply(this,arguments);};}();exports.getOldYearData=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(data,res){var stockJournalVoucher,saleVoucher,purchaseVoucher,creditVoucher,debitVoucher,oldPrice,mainArray,itemArray,groupItem,group,amount,qty,returnAmount,finalQty,salevoucherAmountqty,purchasevoucherAmountqty,debitvoucherAmountqty,creditvoucherAmountqty,stockcreditvoucherAmountqty,stockdebitvoucherAmountqty,newoldPrice,_loop2,_i5,_Object$entries5,finalAmount,finalAmountqty,_loop3,_i6,_Object$entries6,_i7,_Object$entries7,_Object$entries7$_i,key,value;return _regeneratorRuntime().wrap(function _callee7$(_context10){while(1)switch(_context10.prev=_context10.next){case 0:_context10.prev=0;debitVoucher=[];_context10.next=4;return oldyearPriceItem(data,res);case 4:oldPrice=_context10.sent;_context10.next=7;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{type:'Sales'},{company_id:data.company_id},{invoice_date:_defineProperty({},Op.lt,data.start_date)}]),include:[{model:_items["default"],as:"itemone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 7:saleVoucher=_context10.sent;_context10.next=10;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{type:'Purchase'},{company_id:data.company_id},{invoice_date:_defineProperty({},Op.lt,data.start_date)}]),include:[{model:_items["default"],as:"itemone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 10:purchaseVoucher=_context10.sent;_context10.next=13;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{type:'Debit'},{company_id:data.company_id},{invoice_date:_defineProperty({},Op.lt,data.start_date)}]),include:[{model:_items["default"],as:"itemone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 13:creditVoucher=_context10.sent;_context10.next=16;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[{type:'Credit'},{company_id:data.company_id},{invoice_date:_defineProperty({},Op.lt,data.start_date)}]),include:[{model:_items["default"],as:"itemone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 16:debitVoucher=_context10.sent;_context10.next=19;return _item_stock_voucher_entries["default"].findAll({where:_defineProperty({},Op.and,[{company_id:data.company_id},{invoice_date:_defineProperty({},Op.lt,data.start_date)}]),include:[{model:_items["default"],as:"itemsone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 19:stockJournalVoucher=_context10.sent;mainArray=[];_context10.next=23;return _items["default"].findAll({where:{company_id:data.company_id}});case 23:itemArray=_context10.sent;_context10.next=26;return(0,_itemEntries.decreptionItem)(itemArray,'array',data.data.email);case 26:itemArray=_context10.sent;_context10.next=29;return(0,_itemEntries.decreptionItem)(saleVoucher,'array',data.data.email);case 29:saleVoucher=_context10.sent;_context10.next=32;return(0,_itemEntries.decreptionItem)(purchaseVoucher,'array',data.data.email);case 32:purchaseVoucher=_context10.sent;_context10.next=35;return(0,_itemEntries.decreptionItem)(creditVoucher,'array',data.data.email);case 35:creditVoucher=_context10.sent;_context10.next=38;return(0,_itemEntries.decreptionItem)(debitVoucher,'array',data.data.email);case 38:debitVoucher=_context10.sent;_context10.next=41;return(0,_itemEntries.decreptionItem)(stockJournalVoucher,'array',data.data.email);case 41:stockJournalVoucher=_context10.sent;// return {saleVoucher:saleVoucher}
if(saleVoucher.length>0){saleVoucher.map(function(item){item.voucher='sales';mainArray.push(item);});}if(purchaseVoucher.length>0){purchaseVoucher.map(function(item){item.voucher='purchase';mainArray.push(item);});}if(creditVoucher.length>0){creditVoucher.map(function(item){item.voucher='credit';mainArray.push(item);});}if(debitVoucher.length>0){debitVoucher.map(function(item){item.voucher='debit';mainArray.push(item);});}if(stockJournalVoucher.length>0){stockJournalVoucher.map(function(item){item.voucher='stock';item.itemone=item.itemsone;delete item.itemsone;mainArray.push(item);});}// return {itemArray:itemArray, mainArray:mainArray}
// let group = mainArray.reduce((r, a) => {
//     r[a.itemone.name] = [...r[a.itemone.name] || [], a];
//     return r;
// }, {});
// let itemArray = await Item.findAll({where:{
//     company_id:data.company_id
// }})
// itemArray = await decreptionItem(itemArray, 'array', data.data.email);
_context10.next=49;return itemArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});case 49:groupItem=_context10.sent;group={};if(!(mainArray.length>0)){_context10.next=57;break;}_context10.next=54;return mainArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});case 54:group=_context10.sent;_context10.next=60;break;case 57:_context10.next=59;return itemArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});case 59:group=_context10.sent;case 60:_context10.next=62;return itemArray.map(function(calAmount){for(var _i3=0,_Object$entries3=Object.entries(oldPrice);_i3<_Object$entries3.length;_i3++){var _Object$entries3$_i=_slicedToArray(_Object$entries3[_i3],2),key=_Object$entries3$_i[0],value=_Object$entries3$_i[1];if(calAmount.name==key){if(calAmount.rate){return Number(calAmount.quantity)*Number(value);}else{return 0;}}}});case 62:amount=_context10.sent;_context10.next=65;return itemArray.map(function(calAmount){for(var _i4=0,_Object$entries4=Object.entries(oldPrice);_i4<_Object$entries4.length;_i4++){var _Object$entries4$_i=_slicedToArray(_Object$entries4[_i4],2),key=_Object$entries4$_i[0],value=_Object$entries4$_i[1];if(calAmount.name==key){if(calAmount.quantity){return Number(calAmount.quantity);}else{return 0;}}}});case 65:qty=_context10.sent;_context10.next=68;return Number(amount.reduce(function(a,b){return Number(a)+Number(b);},0));case 68:returnAmount=_context10.sent;_context10.next=71;return Number(qty.reduce(function(a,b){return Number(a)+Number(b);},0));case 71:finalQty=_context10.sent;salevoucherAmountqty={};purchasevoucherAmountqty={};debitvoucherAmountqty={};creditvoucherAmountqty={};stockcreditvoucherAmountqty={};stockdebitvoucherAmountqty={};newoldPrice={};// return {group:group}
_loop2=/*#__PURE__*/_regeneratorRuntime().mark(function _loop2(){var _Object$entries5$_i,key,value,updatedata,amount,amount1,amount2,amount3,amountStockCredit,amountStockDebit;return _regeneratorRuntime().wrap(function _loop2$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:_Object$entries5$_i=_slicedToArray(_Object$entries5[_i5],2),key=_Object$entries5$_i[0],value=_Object$entries5$_i[1];_context8.next=3;return(0,_arraySort["default"])(value,'updated_date');case 3:updatedata=_context8.sent;newoldPrice[key]=Number(updatedata[updatedata.length-1].rate)?Number(updatedata[updatedata.length-1].rate):Number(updatedata[updatedata.length-1].price);_context8.next=7;return value.map(function(calAmount){if(calAmount.voucher=='sales'&&calAmount.name==key){return Number(calAmount.quantity);}else{return 0;}});case 7:amount=_context8.sent;_context8.next=10;return Number(amount.reduce(function(a,b){return Number(a)+Number(b);},0));case 10:salevoucherAmountqty[key]=_context8.sent;_context8.next=13;return value.map(function(calAmount){if(calAmount.voucher=='purchase'&&calAmount.name==key){return Number(calAmount.quantity);}else{return 0;}});case 13:amount1=_context8.sent;_context8.next=16;return Number(amount1.reduce(function(a,b){return Number(a)+Number(b);},0));case 16:purchasevoucherAmountqty[key]=_context8.sent;_context8.next=19;return value.map(function(calAmount){if(calAmount.voucher=='debit'&&calAmount.name==key){return Number(calAmount.quantity);}else{return 0;}});case 19:amount2=_context8.sent;_context8.next=22;return Number(amount2.reduce(function(a,b){return Number(a)+Number(b);},0));case 22:debitvoucherAmountqty[key]=_context8.sent;_context8.next=25;return value.map(function(calAmount){if(calAmount.voucher=='credit'&&calAmount.name==key){return Number(calAmount.quantity);}else{return 0;}});case 25:amount3=_context8.sent;_context8.next=28;return Number(amount3.reduce(function(a,b){return Number(a)+Number(b);},0));case 28:creditvoucherAmountqty[key]=_context8.sent;_context8.next=31;return value.map(function(calAmount){if(calAmount.voucher=='stock'&&calAmount.type=='Credit'&&calAmount.name==key){return Number(calAmount.quantity);}else{return 0;}});case 31:amountStockCredit=_context8.sent;_context8.next=34;return Number(amountStockCredit.reduce(function(a,b){return Number(a)+Number(b);},0));case 34:stockcreditvoucherAmountqty[key]=_context8.sent;_context8.next=37;return value.map(function(calAmount){if(calAmount.voucher=='stock'&&calAmount.type=='Debit'&&calAmount.name==key){return Number(calAmount.quantity);}else{return 0;}});case 37:amountStockDebit=_context8.sent;_context8.next=40;return Number(amountStockDebit.reduce(function(a,b){return Number(a)+Number(b);},0));case 40:stockdebitvoucherAmountqty[key]=_context8.sent;case 41:case"end":return _context8.stop();}},_loop2);});_i5=0,_Object$entries5=Object.entries(group);case 81:if(!(_i5<_Object$entries5.length)){_context10.next=86;break;}return _context10.delegateYield(_loop2(),"t0",83);case 83:_i5++;_context10.next=81;break;case 86:finalAmount=0;finalAmountqty={};_loop3=/*#__PURE__*/_regeneratorRuntime().mark(function _loop3(){var _Object$entries6$_i,key,value,itemQty;return _regeneratorRuntime().wrap(function _loop3$(_context9){while(1)switch(_context9.prev=_context9.next){case 0:_Object$entries6$_i=_slicedToArray(_Object$entries6[_i6],2),key=_Object$entries6$_i[0],value=_Object$entries6$_i[1];_context9.next=3;return value.map(function(calAmount){if(calAmount.name==key&&calAmount.quantity){return Number(calAmount.quantity);}else{return 0;}});case 3:itemQty=_context9.sent;finalAmountqty[key]=Number(itemQty)-Number(salevoucherAmountqty[key]?salevoucherAmountqty[key]:0)+Number(purchasevoucherAmountqty[key]?purchasevoucherAmountqty[key]:0)+Number(creditvoucherAmountqty[key]?creditvoucherAmountqty[key]:0)-Number(debitvoucherAmountqty[key]?debitvoucherAmountqty[key]:0)+Number(stockdebitvoucherAmountqty[key]?stockdebitvoucherAmountqty[key]:0)-Number(stockcreditvoucherAmountqty[key]?stockcreditvoucherAmountqty[key]:0);case 5:case"end":return _context9.stop();}},_loop3);});_i6=0,_Object$entries6=Object.entries(groupItem);case 90:if(!(_i6<_Object$entries6.length)){_context10.next=95;break;}return _context10.delegateYield(_loop3(),"t1",92);case 92:_i6++;_context10.next=90;break;case 95:for(_i7=0,_Object$entries7=Object.entries(finalAmountqty);_i7<_Object$entries7.length;_i7++){_Object$entries7$_i=_slicedToArray(_Object$entries7[_i7],2),key=_Object$entries7$_i[0],value=_Object$entries7$_i[1];finalAmount=Number(finalAmount)+Number(Number(value?value:0)*Number(oldPrice[key]?oldPrice[key]:0));}return _context10.abrupt("return",{finalAmount:finalAmount,finalAmountqty:finalAmountqty});case 99:_context10.prev=99;_context10.t2=_context10["catch"](0);return _context10.abrupt("return",{statusCode:res.statusCode,success:false,error:_context10.t2,message:"Something went wrong!"});case 102:case"end":return _context10.stop();}},_callee7,null,[[0,99]]);}));return function(_x52,_x53){return _ref7.apply(this,arguments);};}();exports.getLeaderDiffrenc=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(data,res){var getAll,debitAmount,creditAmount,amount;return _regeneratorRuntime().wrap(function _callee8$(_context11){while(1)switch(_context11.prev=_context11.next){case 0:_context11.next=2;return _ledger["default"].findAll({where:{company_id:data.company_id}});case 2:getAll=_context11.sent;_context11.next=5;return(0,_ledger2.decreption)(getAll,'array',data.data.email);case 5:getAll=_context11.sent;debitAmount=0;creditAmount=0;_context11.next=10;return getAll.map(function(item){if(item.opening_balance==="debit"){debitAmount=Number(debitAmount)+Number(item.amount?item.amount:0);}else{creditAmount=Number(creditAmount)+Number(item.amount?item.amount:0);}});case 10:_context11.next=12;return{'name':"Opening Balance Difference","amount":Number(creditAmount)-Number(debitAmount),"debitAmount":debitAmount,"creditAmount":creditAmount};case 12:amount=_context11.sent;return _context11.abrupt("return",amount);case 14:case"end":return _context11.stop();}},_callee8);}));return function(_x54,_x55){return _ref8.apply(this,arguments);};}();exports.getOldPriceCurrentItem=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(data,res){var itemEnteriesVoucher,stockitemEnteriesVoucher,mainArray,itemArray,itemgroup,group,oldPrice,_i8,_Object$entries8,_Object$entries8$_i,key,value,updatedata,availableKeys,_loop4,_i9,_Object$entries9;return _regeneratorRuntime().wrap(function _callee9$(_context13){while(1)switch(_context13.prev=_context13.next){case 0:_context13.prev=0;stockitemEnteriesVoucher=[];// ,{
//     invoice_date: {
//         [Op.gte]: data.start_date,
//         [Op.lte]: data.end_date
//     }
// }
_context13.next=4;return _itemInteries["default"].findAll({where:_defineProperty({},Op.and,[_defineProperty({},Op.or,[{type:'Purchase'},{type:'Debit'}]),{company_id:data.company_id}]),include:[{model:_items["default"],as:"itemone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 4:itemEnteriesVoucher=_context13.sent;_context13.next=7;return _item_stock_voucher_entries["default"].findAll({where:_defineProperty({},Op.and,[{type:'Debit'},{company_id:data.company_id}]),include:[{model:_items["default"],as:"itemsone",required:true,where:{company_id:data.company_id}}],order:[['invoice_date','ASC']]}).map(function(node){return node.get({plain:true});});case 7:stockitemEnteriesVoucher=_context13.sent;mainArray=[];_context13.next=11;return _items["default"].findAll({where:{company_id:data.company_id}});case 11:itemArray=_context13.sent;_context13.next=14;return(0,_itemEntries.decreptionItem)(itemArray,'array',data.data.email);case 14:itemArray=_context13.sent;_context13.next=17;return(0,_itemEntries.decreptionItem)(itemEnteriesVoucher,'array',data.data.email);case 17:itemEnteriesVoucher=_context13.sent;_context13.next=20;return(0,_itemEntries.decreptionItem)(stockitemEnteriesVoucher,'array',data.data.email);case 20:stockitemEnteriesVoucher=_context13.sent;// purchaseVoucher = await decreptionItem(purchaseVoucher, 'array', data.data.email);
// creditVoucher = await decreptionItem(creditVoucher, 'array', data.data.email);
// debitVoucher = await decreptionItem(debitVoucher, 'array', data.data.email);
// return {stockitemEnteriesVoucher:stockitemEnteriesVoucher, itemEnteriesVoucher:itemEnteriesVoucher}
if(itemEnteriesVoucher.length>0){itemEnteriesVoucher.map(function(item){mainArray.push(item);});}if(stockitemEnteriesVoucher.length>0){stockitemEnteriesVoucher.map(function(item){item.itemone=item.itemsone;delete item.itemsone;mainArray.push(item);});}_context13.next=25;return itemArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});case 25:itemgroup=_context13.sent;group=mainArray.reduce(function(r,a){r[a.name]=[].concat(_toConsumableArray(r[a.name]||[]),[a]);return r;},{});oldPrice={};_i8=0,_Object$entries8=Object.entries(group);case 29:if(!(_i8<_Object$entries8.length)){_context13.next=38;break;}_Object$entries8$_i=_slicedToArray(_Object$entries8[_i8],2),key=_Object$entries8$_i[0],value=_Object$entries8$_i[1];_context13.next=33;return(0,_arraySort["default"])(value,'updated_date');case 33:updatedata=_context13.sent;oldPrice[key]=Number(updatedata[updatedata.length-1].price);case 35:_i8++;_context13.next=29;break;case 38:_context13.next=40;return Object.keys(oldPrice);case 40:availableKeys=_context13.sent;_loop4=/*#__PURE__*/_regeneratorRuntime().mark(function _loop4(){var _Object$entries9$_i,key,value,find,_updatedata;return _regeneratorRuntime().wrap(function _loop4$(_context12){while(1)switch(_context12.prev=_context12.next){case 0:_Object$entries9$_i=_slicedToArray(_Object$entries9[_i9],2),key=_Object$entries9$_i[0],value=_Object$entries9$_i[1];find=availableKeys.find(function(k){return k==key;});if(find){_context12.next=7;break;}_context12.next=5;return(0,_arraySort["default"])(value,'updated_date');case 5:_updatedata=_context12.sent;oldPrice[key]=Number(_updatedata[_updatedata.length-1].rate)?Number(_updatedata[_updatedata.length-1].rate):0;case 7:case"end":return _context12.stop();}},_loop4);});_i9=0,_Object$entries9=Object.entries(itemgroup);case 43:if(!(_i9<_Object$entries9.length)){_context13.next=48;break;}return _context13.delegateYield(_loop4(),"t0",45);case 45:_i9++;_context13.next=43;break;case 48:return _context13.abrupt("return",oldPrice);case 51:_context13.prev=51;_context13.t1=_context13["catch"](0);return _context13.abrupt("return",{statusCode:res.statusCode,success:false,error:_context13.t1,message:"Something went wrong!"});case 54:case"end":return _context13.stop();}},_callee9,null,[[0,51]]);}));return function(_x56,_x57){return _ref9.apply(this,arguments);};}();exports.getTrailbalancfunction=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee11(ledgerid,accountId,data,res){var _invoice_date83,_invoice_date84,_invoice_date85,_invoice_date86,_invoice_date87,_invoice_date88,_invoice_date89,_invoice_date90,_invoice_date91,_invoice_date92,_invoice_date93,_invoice_date94,_invoice_date95,_invoice_date96,_invoice_date97,_invoice_date98,_invoice_date99,_invoice_date100,Mainarray,query,ledger,totalcalculate_openingblance,returngroup,sb,opendebittatal,opencredittatal,credittatal,debittatal,closingdebittatal,closingcredittatal,findLedgerType,findCompany;return _regeneratorRuntime().wrap(function _callee11$(_context15){while(1)switch(_context15.prev=_context15.next){case 0:_context15.prev=0;console.log("accountId",accountId);_context15.next=4;return[];case 4:Mainarray=_context15.sent;_context15.next=7;return _ledger["default"].findAll({where:_defineProperty({},Op.and,[{account_group_id:accountId},{company_id:data.company_id}]),attributes:['id','uid','name','amount','opening_balance','account_group_id','sub_account_group_id'],include:[{model:_accountGroup["default"]},{model:_subAccountGroup["default"]},{model:_journalInteries["default"],where:{invoice_date:(_invoice_date83={},_defineProperty(_invoice_date83,Op.gte,data.start_date),_defineProperty(_invoice_date83,Op.lte,data.end_date),_invoice_date83)},required:false,attributes:['id','uid','type','invoice_date','amount','journa_voucher_id'],include:[{model:_journalVoucher["default"],required:false,attributes:['id','uid','total_amount','invoice_id','invoice_date'],as:'Voucher'}]},{model:_recieptVoucher["default"],as:'Buyer',where:{invoice_date:(_invoice_date84={},_defineProperty(_invoice_date84,Op.gte,data.start_date),_defineProperty(_invoice_date84,Op.lte,data.end_date),_invoice_date84)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PBuyer',required:false,where:{invoice_date:(_invoice_date85={},_defineProperty(_invoice_date85,Op.gte,data.start_date),_defineProperty(_invoice_date85,Op.lte,data.end_date),_invoice_date85)},attributes:['id','uid','total_amount','type','receive_type']},{model:_recieptVoucher["default"],as:'RBuyer',where:{invoice_date:(_invoice_date86={},_defineProperty(_invoice_date86,Op.gte,data.start_date),_defineProperty(_invoice_date86,Op.lte,data.end_date),_invoice_date86)},required:false,attributes:['id','uid','total_amount','type','receive_type']},{model:_paymentVoucher["default"],as:'PRBuyer',required:false,where:{invoice_date:(_invoice_date87={},_defineProperty(_invoice_date87,Op.gte,data.start_date),_defineProperty(_invoice_date87,Op.lte,data.end_date),_invoice_date87)},attributes:['id','uid','total_amount','type','receive_type']},{model:_saleVoucher["default"],where:{invoice_date:(_invoice_date88={},_defineProperty(_invoice_date88,Op.gte,data.start_date),_defineProperty(_invoice_date88,Op.lte,data.end_date),_invoice_date88)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],where:{invoice_date:(_invoice_date89={},_defineProperty(_invoice_date89,Op.gte,data.start_date),_defineProperty(_invoice_date89,Op.lte,data.end_date),_invoice_date89)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_saleVoucher["default"],as:"roundsales",where:{invoice_date:(_invoice_date90={},_defineProperty(_invoice_date90,Op.gte,data.start_date),_defineProperty(_invoice_date90,Op.lte,data.end_date),_invoice_date90)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"roundpurchase",where:{invoice_date:(_invoice_date91={},_defineProperty(_invoice_date91,Op.gte,data.start_date),_defineProperty(_invoice_date91,Op.lte,data.end_date),_invoice_date91)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Purchase'}}]},{model:_creditVoucher["default"],where:{invoice_date:(_invoice_date92={},_defineProperty(_invoice_date92,Op.gte,data.start_date),_defineProperty(_invoice_date92,Op.lte,data.end_date),_invoice_date92)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Debit'}}]},{model:_debitVoucher["default"],where:{invoice_date:(_invoice_date93={},_defineProperty(_invoice_date93,Op.gte,data.start_date),_defineProperty(_invoice_date93,Op.lte,data.end_date),_invoice_date93)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Credit'}}]},{model:_itemInteries["default"],required:false,where:{invoice_date:(_invoice_date94={},_defineProperty(_invoice_date94,Op.gte,data.start_date),_defineProperty(_invoice_date94,Op.lte,data.end_date),_invoice_date94)},include:[{model:_saleVoucher["default"],as:"ItemVouchers",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_purchaseVoucher["default"],as:"ItemVoucherp",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_debitVoucher["default"],as:"ItemVoucherd",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']},{model:_creditVoucher["default"],as:"ItemVoucherc",attributes:['uid','id','invoice_id','invoice_date','current_year','end_year']}]},{model:_voucherInteries["default"],as:'vocher_entries',required:false,where:{invoice_date:(_invoice_date95={},_defineProperty(_invoice_date95,Op.gte,data.start_date),_defineProperty(_invoice_date95,Op.lte,data.end_date),_invoice_date95)},attributes:['id','uid','amount','type','ledger_id']},{model:_taxInteries["default"],as:'tax_entries',required:false,where:{invoice_date:(_invoice_date96={},_defineProperty(_invoice_date96,Op.gte,data.start_date),_defineProperty(_invoice_date96,Op.lte,data.end_date),_invoice_date96)},attributes:['id','uid','amount','type','tax_ledger_id']},{model:_saleVoucher["default"],as:"discountsales",where:{invoice_date:(_invoice_date97={},_defineProperty(_invoice_date97,Op.gte,data.start_date),_defineProperty(_invoice_date97,Op.lte,data.end_date),_invoice_date97)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_purchaseVoucher["default"],as:"discountPurchases",where:{invoice_date:(_invoice_date98={},_defineProperty(_invoice_date98,Op.gte,data.start_date),_defineProperty(_invoice_date98,Op.lte,data.end_date),_invoice_date98)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','roundoff_ledger_id',"roundoff_type","roundoff_value",'buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_creditVoucher["default"],as:"discountCredit",where:{invoice_date:(_invoice_date99={},_defineProperty(_invoice_date99,Op.gte,data.start_date),_defineProperty(_invoice_date99,Op.lte,data.end_date),_invoice_date99)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]},{model:_debitVoucher["default"],as:"discountDebit",where:{invoice_date:(_invoice_date100={},_defineProperty(_invoice_date100,Op.gte,data.start_date),_defineProperty(_invoice_date100,Op.lte,data.end_date),_invoice_date100)},required:false,attributes:['id','uid','narration','sub_amount','total_amount','is_local','is_bank','discount','discount_type','discount_percentage','discount_ledger','buyer_ledger_id','invoice_id'],include:[{model:_itemInteries["default"],required:false,where:{type:'Sales'}}]}]}).map(function(node){return node.get({plain:true});});case 7:ledger=_context15.sent;_context15.next=10;return(0,_voucherReport.decreptionReport)(ledger,'array',data.data.email);case 10:ledger=_context15.sent;if(!(ledger.length>0)){_context15.next=79;break;}_context15.next=14;return{creditbalnce:0,debitbalnce:0,totalbalnce:0};case 14:totalcalculate_openingblance=_context15.sent;_context15.next=17;return ledger.map(/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10(item){return _regeneratorRuntime().wrap(function _callee10$(_context14){while(1)switch(_context14.prev=_context14.next){case 0:item.closeing_amount=0;item.open_type=item.opening_balance;item.name=item.name;item.subAccount=item.sub_account_group?item.sub_account_group:{};item.account=item.account_group?item.account_group:{};item.accounttype=item.account_group&&item.account_group.type=="dr"?'debit':'credit';item.open_amount=item.amount?Number(item.amount):item.amount;delete item.amount;delete item.opening_balance;delete item.sub_account_group;delete item.account_group;item.invoice_id='';item.voucher_type='';item.debitAmount=0;item.creditAmount=0;item.closeing_type='';if(item.journal_entries.length>0){item.journal_entries.forEach(function(journal){if(journal.type=='debit'||journal.type=='Debit'){item.debitAmount=Number(journal.amount)+Number(item.debitAmount);}else{item.creditAmount=Number(journal.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.Buyer.length>0){item.Buyer.forEach(function(reciept){if(reciept.type=='debit'||reciept.type=='Debit'){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(reciept.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.PBuyer.length>0){item.PBuyer.forEach(function(payment){if(payment.type=='debit'||payment.type=='Debit'){item.debitAmount=Number(payment.total_amount)+Number(item.debitAmount);}else{item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.RBuyer.length>0){item.RBuyer.forEach(function(reciept){item.debitAmount=Number(reciept.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));});}if(item.PRBuyer.length>0){item.PRBuyer.forEach(function(payment){item.creditAmount=Number(payment.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.roundsales&&item.roundsales.length>0){item.roundsales.forEach(function(sale){if(sale.roundoff_ledger_id){if(sale.roundoff_type=="debit"||sale.roundoff_type=="Debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(sale.roundoff_value)>0?Number(sale.roundoff_value):-1*Number(sale.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.roundpurchase.length>0){item.roundpurchase.forEach(function(purchase){if(purchase.roundoff_ledger_id){if(purchase.roundoff_type=="debit"||purchase.roundoff_type=="Debit"){item.debitAmount=Number(item.debitAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}else{item.creditAmount=Number(item.creditAmount)+Number(Number(purchase.roundoff_value)>0?Number(purchase.roundoff_value):-1*Number(purchase.roundoff_value));}// if(item.debitAmount<0){
//     item.debitAmount = -1*Number(item.debitAmount)
// }
item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
}});}if(item.roundsales&&item.roundsales.length<0||item.roundpurchase.length<0){if(item.discountsales&&item.discountsales.length>0){item.discountsales.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountPurchases&&item.discountPurchases.length>0){item.discountPurchases.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountCredit&&item.discountCredit.length>0){item.discountCredit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.debitAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.creditAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}if(item.discountDebit&&item.discountDebit.length>0){item.discountDebit.forEach(function(sale){if(item.name=="Round Off"||item.name=="round off"||item.name=="Round Off"){if(item.roundoff_ledger_id){}else{item.creditAmount=sale.discount&&Number(sale.discount)<0?-1*Number(sale.discount)+Number(item.creditAmount):0+Number(item.creditAmount);item.debitAmount=sale.discount&&Number(sale.discount)>0?Number(sale.discount)+Number(item.debitAmount):0+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));}}});}}if(item.sales_vouchers&&item.sales_vouchers.length>0){item.sales_vouchers.forEach(function(sale){item.debitAmount=Number(sale.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.purchase_vouchers.length>0){item.purchase_vouchers.forEach(function(purchase){item.creditAmount=Number(purchase.total_amount)+Number(item.creditAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.credit_vouchers.length>0){item.credit_vouchers.forEach(function(credit){item.debitAmount=Number(credit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.debit_vouchers.length>0){item.debit_vouchers.forEach(function(debit){item.debitAmount=Number(debit.total_amount)+Number(item.debitAmount);item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}if(item.item_entries.length>0){item.item_entries.forEach(function(voucher){if(voucher.ItemVouchers){item.invoice_date=voucher.ItemVouchers.invoice_date;item.invoice_id=voucher.ItemVouchers.invoice_id<=9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/00").concat(voucher.ItemVouchers.invoice_id):voucher.ItemVouchers.invoice_id>9?"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/0").concat(voucher.ItemVouchers.invoice_id):"".concat(voucher.ItemVouchers.current_year.toString().substr(-2)+"-"+voucher.ItemVouchers.end_year.toString().substr(-2),"/").concat(voucher.ItemVouchers.invoice_id);item.voucher_type='sale';}if(voucher.ItemVoucherc){item.invoice_date=voucher.ItemVoucherc.invoice_date;item.invoice_id=voucher.ItemVoucherc.invoice_id<=9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherc.invoice_id):voucher.ItemVoucherc.invoice_id>9?"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherc.invoice_id):"".concat(voucher.ItemVoucherc.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherc.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherc.invoice_id);item.voucher_type='credit';}if(voucher.ItemVoucherd){item.invoice_date=voucher.ItemVoucherd.invoice_date;item.invoice_id=voucher.ItemVoucherd.invoice_id<=9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/00").concat(voucher.ItemVoucherd.invoice_id):voucher.ItemVoucherd.invoice_id>9?"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/0").concat(voucher.ItemVoucherd.invoice_id):"".concat(voucher.ItemVoucherd.current_year.toString().substr(-2)+"-"+voucher.ItemVoucherd.end_year.toString().substr(-2),"/").concat(voucher.ItemVoucherd.invoice_id);item.voucher_type='debit';}if(voucher.ItemVoucherp){item.invoice_date=voucher.ItemVoucherp.invoice_date;item.invoice_id=voucher.ItemVoucherp.invoice_id;item.voucher_type='purchase';}if(voucher.type==="Sales"||voucher.type==="sales"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}else if(voucher.type==="Purchase"||voucher.type==="purchase"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Debit"||voucher.type==="Debit"){item.debitAmount=Number(voucher.total_amount)+Number(item.debitAmount);}else if(voucher.type==="Credit"||voucher.type==="Credit"){item.creditAmount=Number(voucher.total_amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.vocher_entries.length>0){
//     item.vocher_entries.forEach(voucher=>{
//         if(voucher.type==="Sales" || voucher.type==="sales"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Purchase" || voucher.type==="purchase"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }else if(voucher.type==="Debit" || voucher.type==="Debit"){
//             item.debitAmount =  Number(voucher.amount)+Number(item.debitAmount);
//         }else if(voucher.type==="Credit" || voucher.type==="Credit"){
//             item.creditAmount =  Number(voucher.amount)+Number(item.creditAmount);
//         }
//         item.closeing_amount =  Number(Number(item.creditAmount)-Number(item.debitAmount))+Number(item.open_amount);
//     })
// }
if(item.tax_entries.length>0){item.tax_entries.forEach(function(tax){if(tax.type==="Sales"||tax.type==="sales"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}else if(tax.type==="Purchase"||tax.type==="purchase"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Debit"||tax.type==="debit"){item.debitAmount=Number(tax.amount)+Number(item.debitAmount);}else if(tax.type==="Credit"||tax.type==="credit"){item.creditAmount=Number(tax.amount)+Number(item.creditAmount);}item.closeing_amount=Number(Number(item.creditAmount)-Number(item.debitAmount));// if(item.accounttype=="debit"){
//     item.closeing_amount = Number(item.open_amount)-Number(item.closeing_amount);
// }else{
//     item.closeing_amount = Number(item.open_amount)+Number(item.closeing_amount);
// }
});}// if(item.open_type=="debit"){
//     item.debitAmount = Number(item.debitAmount)+ item.open_amount;
// }
// if(item.open_type=="credit"){
//     item.creditAmount = Number(item.creditAmount)+ item.open_amount;
// }
if(item.open_type==="debit"){item.closeing_amount=Number(item.closeing_amount)-Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='debit';item.accounttype=item.closeing_type;}if(item.open_type==="credit"){item.closeing_amount=Number(item.closeing_amount)+Number(item.open_amount);if(item.closeing_amount<0){item.closeing_amount=-1*Number(item.closeing_amount);}item.closeing_type='credit';item.accounttype=item.closeing_type;}delete item.journal_entries;delete item.reciept_vouchers;delete item.payment_vouchers;delete item.sales_vouchers;delete item.purchase_vouchers;delete item.credit_vouchers;delete item.debit_vouchers;delete item.item_entries;delete item.vocher_entries;delete item.tax_entries;delete item.Buyer;delete item.PBuyer;delete item.PRBuyer;delete item.RBuyer;case 46:case"end":return _context14.stop();}},_callee10);}));return function(_x62){return _ref12.apply(this,arguments);};}());case 17:_context15.next=19;return groupFuncation(ledger);case 19:returngroup=_context15.sent;// return [returngroup]
sb=[];if(!returngroup){_context15.next=24;break;}_context15.next=24;return Object.keys(returngroup).map(function(item){//    console.log(returngroup, " == = = = =")
if(item==="MainGroup"){if(returngroup[item].length>0){var _a2={name:returngroup[item][0].account.name,ledger_id:returngroup[item][0].uid,open_amount:0,closeing_amount:0,closeing_type:'',sub_uid:'',account_group_id:'',subAccount:{},accounttype:'debit',debitAmount:0,creditAmount:0,ishead:true,ismain:true,issub:false};var b=[];returngroup[item].map(function(element){if(element.open_type=="credit"){_a2.open_amount=Number(_a2.open_amount)+Number(element.open_amount?element.open_amount:0);}else{_a2.open_amount=Number(_a2.open_amount)-Number(element.open_amount?element.open_amount:0);if(_a2.open_amount<0){// a.open_amount = -1*Number(a.open_amount)
_a2.open_type="debit";}}// a.open_amount = Number(a.open_amount)+Number(element.open_amount?element.open_amount:0);
_a2.subAccount={};element.name=element.name.toLowerCase();element.main="true";_a2.closeing_amount=Number(_a2.closeing_amount?_a2.closeing_amount:0)+Number(element.closeing_amount?element.closeing_amount:0);_a2.debitAmount=Number(_a2.debitAmount)+Number(element.debitAmount?element.debitAmount:0);_a2.creditAmount=Number(_a2.creditAmount)+Number(element.creditAmount?element.creditAmount:0);_a2.account_group_id=element.account_group_id;if(element.open_type=="credit"){if(element.open_type==element.accounttype){if(Number(Number(element.creditAmount)+Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)+Number(Number(element.open_amount)))){element.accounttype='debit';}}else{if(Number(Number(element.creditAmount)-Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)-Number(Number(element.open_amount)))){element.accounttype='debit';}}}else{if(element.open_type==element.accounttype){if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}else{if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}}// a.closeing_amount = Number(element.closeing_amount?element.closeing_amount:0)+Number(Number(b.length>0?b[b.length-1].closeing_amount:0));
b.push(element);b.sort(function(a,c){return a.name.localeCompare(c.name);}//using String.prototype.localCompare()
);});if(Number(_a2.creditAmount)>Number(_a2.debitAmount)){_a2.accounttype='credit';_a2.open_type='credit';_a2.closeing_amount=Number(_a2.creditAmount)-Number(_a2.debitAmount);}else if(Number(_a2.debitAmount)>Number(_a2.creditAmount)){_a2.accounttype='debit';_a2.open_type='debit';_a2.closeing_amount=Number(_a2.debitAmount)-Number(_a2.creditAmount);}b.unshift(_a2);Mainarray=Mainarray.concat(b);}}else{var _a3={name:returngroup[item][0].subAccount.name,ledger_id:returngroup[item][0].uid,open_amount:0,closeing_amount:0,closeing_type:'',sub_uid:'',account_group_id:'',subAccount:{},accounttype:'debit',debitAmount:0,creditAmount:0,ishead:false,ismain:false,issub:true};returngroup[item].map(function(element){if(element.open_type=="credit"){_a3.open_amount=Number(_a3.open_amount)+Number(element.open_amount?element.open_amount:0);}else{_a3.open_amount=Number(_a3.open_amount)-Number(element.open_amount?element.open_amount:0);if(_a3.open_amount<0){_a3.open_amount=-1*Number(_a3.open_amount);_a3.open_type="debit";}}_a3.subAccount={};element.sub="true";_a3.closeing_amount=Number(_a3.closeing_amount?_a3.closeing_amount:0)+Number(element.closeing_amount?element.closeing_amount:0);_a3.debitAmount=Number(_a3.debitAmount)+Number(element.debitAmount?element.debitAmount:0);_a3.creditAmount=Number(_a3.creditAmount)+Number(element.creditAmount?element.creditAmount:0);_a3.account_group_id=element.account_group_id;element.name=element.name.toLowerCase();if(element.open_type=="credit"){if(element.open_type==element.accounttype){if(Number(Number(element.creditAmount)+Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)+Number(Number(element.open_amount)))){element.accounttype='debit';}}else{if(Number(Number(element.creditAmount)-Number(Number(element.open_amount)))>Number(element.debitAmount)){element.accounttype='credit';}else if(Number(element.debitAmount)>Number(Number(element.creditAmount)-Number(Number(element.open_amount)))){element.accounttype='debit';}}}else{if(element.open_type==element.accounttype){if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}else{if(Number(element.creditAmount)>Number(Number(element.debitAmount)+Number(element.open_amount))){element.accounttype='credit';}else if(Number(Number(element.debitAmount)+Number(element.open_amount))>Number(element.creditAmount)){element.accounttype='debit';}}}// a.closeing_amount = Number(element.closeing_amount?element.closeing_amount:0)+Number(Number(b.length>0?b[b.length-1].closeing_amount:0));
sb.push(element);sb.sort(function(a,b){return a.name.localeCompare(b.name);}//using String.prototype.localCompare()
);});if(Number(_a3.creditAmount)>Number(_a3.debitAmount)){_a3.accounttype='credit';_a3.open_type='credit';_a3.closeing_amount=Number(_a3.creditAmount)-Number(_a3.debitAmount);}else if(Number(_a3.debitAmount)>Number(_a3.creditAmount)){_a3.accounttype='debit';_a3.open_type='debit';_a3.closeing_amount=Number(_a3.debitAmount)-Number(_a3.creditAmount);}sb.unshift(_a3);// Mainarray = Mainarray.concat(b);
}});case 24:if(!(Mainarray.length>0)){_context15.next=76;break;}opendebittatal=0;opencredittatal=0;credittatal=0;debittatal=0;closingdebittatal=0;closingcredittatal=0;// Mainarray = await arraySort(Mainarray, 'name')
_context15.next=33;return sb.length;case 33:_context15.t0=_context15.sent;if(!(_context15.t0>0)){_context15.next=38;break;}_context15.next=37;return Mainarray.concat(sb);case 37:Mainarray=_context15.sent;case 38:_context15.next=40;return Mainarray.map(function(item){if(item.ishead&&item.ismain&&!item.issub){}else if(!item.ishead&&!item.ismain&&item.issub){// console.log("item.issub", item.issub)
}else{debittatal=Number(debittatal)+Number(item.debitAmount);credittatal=Number(credittatal)+Number(item.creditAmount);if(item.open_type=="debit"){opendebittatal=Number(opendebittatal)+Number(item.open_amount);}else{opencredittatal=Number(opencredittatal)+Number(item.open_amount);}if(item.accounttype=="debit"){closingdebittatal=Number(closingdebittatal)+Number(item.closeing_amount);}else{closingcredittatal=Number(closingcredittatal)+Number(item.closeing_amount);}}});case 40:_context15.next=42;return _ledger["default"].findOne({where:{uid:Mainarray[0].ledger_id}});case 42:findLedgerType=_context15.sent;_context15.next=45;return _company["default"].findOne({where:{uid:data.company_id}});case 45:findCompany=_context15.sent;_context15.next=48;return(0,_ledger2.decreption)(findLedgerType,'object',data.data.email);case 48:findLedgerType=_context15.sent;if(Number(opencredittatal)>Number(opendebittatal)){Mainarray[0].open_type=Number(opendebittatal)==0?findLedgerType.opening_balance:'credit';Mainarray[0].open_amount=Number(opencredittatal)-Number(opendebittatal);Mainarray[0].closeing_amount=Number(Mainarray[0].creditAmount)+Number(Number(opencredittatal)-Number(opendebittatal));}else{Mainarray[0].open_type=Number(opencredittatal)==0?findLedgerType.opening_balance:'debit';Mainarray[0].open_amount=Number(opendebittatal)-Number(opencredittatal);Mainarray[0].closeing_amount=Number(Mainarray[0].debitAmount)+Number(Number(opendebittatal)-Number(opencredittatal));}if(Number(closingcredittatal)>Number(closingdebittatal)){Mainarray[0].accounttype='credit';Mainarray[0].closeing_amount=Number(closingcredittatal)-Number(closingdebittatal);}else{Mainarray[0].accounttype='debit';Mainarray[0].closeing_amount=Number(closingdebittatal)-Number(closingcredittatal);}_context15.next=53;return checkValid(Mainarray[0].account_group_id);case 53:if(!_context15.sent){_context15.next=64;break;}_context15.next=56;return getAllGroupVouchercurrent(data.start_date,data.end_date,Mainarray[0].account_group_id,data.company_id,data.data.email);case 56:totalcalculate_openingblance=_context15.sent;if(totalcalculate_openingblance.totalbalnce!=0){if(totalcalculate_openingblance.totalbalnce<0){Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)-Number(Mainarray[0].open_amount);}else{Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)+Number(Mainarray[0].open_amount);}}else{Mainarray[0].closeing_amount=Number(Mainarray[0].closeing_amount)+Number(totalcalculate_openingblance.totalbalnce?totalcalculate_openingblance.totalbalnce:0);}// Mainarray[0].closeing_amount = Number(Mainarray[0].closeing_amount)+Number(totalcalculate_openingblance.totalbalnce?totalcalculate_openingblance.totalbalnce:0);
Mainarray[0].creditAmount=Number(Mainarray[0].creditAmount)+Number(totalcalculate_openingblance.creditbalnce?totalcalculate_openingblance.creditbalnce:0);Mainarray[0].debitAmount=Number(Mainarray[0].debitAmount)+Number(totalcalculate_openingblance.debitbalnce?totalcalculate_openingblance.debitbalnce:0);if(Mainarray[0].accounttype=='debit'){if(Mainarray[0].closeing_amount<0){Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}}if(Mainarray[0].accounttype=='credit'){if(Mainarray[0].closeing_amount<0){Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}}_context15.next=73;break;case 64:_context15.next=66;return getAllGroupVoucherprivious(data.start_date,data.end_date,Mainarray[0].account_group_id,data.company_id,data.data.email);case 66:totalcalculate_openingblance=_context15.sent;console.log("totalcalculate_openingblance",totalcalculate_openingblance);if(totalcalculate_openingblance.totalbalnce!=0){if(totalcalculate_openingblance.totalbalnce<0){// if(Mainarray[0].open_type=="debit"){
// Mainarray[0].closeing_amount  = Number(totalcalculate_openingblance.totalbalnce)-Number(Mainarray[0].open_amount);
// }
if(Mainarray[0].open_type=="debit"){Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)-Number(Mainarray[0].open_amount);if(Number(Mainarray[0].closeing_amount)<0){Mainarray[0].accounttype="debit";Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}else{Mainarray[0].accounttype="credit";}}else{Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)+Number(Mainarray[0].open_amount);if(Number(Mainarray[0].closeing_amount)<0){Mainarray[0].accounttype="debit";Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}else{Mainarray[0].accounttype="credit";}}}else{if(Mainarray[0].open_type=="debit"){Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)-Number(Mainarray[0].open_amount);if(Number(Mainarray[0].closeing_amount)<0){Mainarray[0].accounttype="debit";Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}else{Mainarray[0].accounttype="credit";}}else{Mainarray[0].closeing_amount=Number(totalcalculate_openingblance.totalbalnce)+Number(Mainarray[0].open_amount);if(Number(Mainarray[0].closeing_amount)<0){Mainarray[0].accounttype="debit";Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}else{Mainarray[0].accounttype="credit";}}// Mainarray[0].closeing_amount  = Number(totalcalculate_openingblance.totalbalnce)+Number(Mainarray[0].open_amount);
}}else{Mainarray[0].closeing_amount=Number(Mainarray[0].closeing_amount)+Number(totalcalculate_openingblance.totalbalnce?totalcalculate_openingblance.totalbalnce:0);}// Mainarray[0].closeing_amount = Number(Mainarray[0].closeing_amount)+Number(totalcalculate_openingblance.totalbalnce?totalcalculate_openingblance.totalbalnce:0);
Mainarray[0].creditAmount=Number(Mainarray[0].creditAmount)+Number(totalcalculate_openingblance.creditbalnce?totalcalculate_openingblance.creditbalnce:0);Mainarray[0].debitAmount=Number(Mainarray[0].debitAmount)+Number(totalcalculate_openingblance.debitbalnce?totalcalculate_openingblance.debitbalnce:0);if(Mainarray[0].accounttype=='debit'){if(Mainarray[0].closeing_amount<0){Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}}if(Mainarray[0].accounttype=='credit'){if(Mainarray[0].closeing_amount<0){Mainarray[0].closeing_amount=-1*Number(Mainarray[0].closeing_amount);}}case 73:return _context15.abrupt("return",Mainarray);case 76:return _context15.abrupt("return",[]);case 77:_context15.next=80;break;case 79:return _context15.abrupt("return",[]);case 80:_context15.next=85;break;case 82:_context15.prev=82;_context15.t1=_context15["catch"](0);return _context15.abrupt("return",[]);case 85:case"end":return _context15.stop();}},_callee11,null,[[0,82]]);}));return function(_x58,_x59,_x60,_x61){return _ref11.apply(this,arguments);};}();